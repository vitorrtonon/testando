var WM=window.angular,wm={};wm.init=function(){"use strict";wm.modules={},wm.plugins={}}(),WM.module("wm.layouts.page",[]),WM.module("wm.layouts.containers",[]),WM.module("wm.layouts.device",[]),WM.module("wm.widgets.basic",["toaster"]),WM.module("wm.widgets.form",[]),WM.module("wm.widgets.dialog",["ui.bootstrap.modal"]),WM.module("wm.widgets.grid",[]),WM.module("wm.widgets.live",[]),WM.module("wm.widgets.advanced",["ui.calendar"]),WM.module("wm.prefabs",["wm.widgets.base"]),WM.module("wm.themes",["wm.widgets.base"]),WM.module("wm.layouts",["wm.layouts.page","wm.layouts.containers","wm.layouts.device"]),WM.module("wm.widgets",["wm.widgets.base","wm.widgets.basic","wm.widgets.form","wm.widgets.dialog","wm.widgets.grid","wm.widgets.live","wm.widgets.advanced"]),WM.module("wm.utils",[]).service("Utils",["$rootScope","$location","$window","CONSTANTS","$sce",function($rootScope,$location,$window,APPCONSTANTS,$sce){"use strict";function hyphenate(name){return name.replace(REGEX.SNAKE_CASE,function(letter,pos){return(pos?"-":"")+letter.toLowerCase()})}function deHyphenate(name){return name.split("-").join(" ")}function spaceSeparate(name){return name===name.toUpperCase()?name:name.replace(REGEX.SNAKE_CASE,function(letter,pos){return(pos?" ":"")+letter})}function replaceAt(string,index,character){return string.substr(0,index)+character+string.substr(index+character.length)}function periodSeparate(name){var dotIndex;return dotIndex=name.indexOf("."),-1!==dotIndex&&(name=replaceAt(name,dotIndex+1,name.charAt(dotIndex+1).toUpperCase()),name=replaceAt(name,dotIndex," ")),name}function initCaps(name){return name?name.charAt(0).toUpperCase()+name.substring(1):""}function firstCaps(name){return name?name.charAt(0).toUpperCase()+name.slice(1).toLowerCase():""}function prettifyLabel(label){return label=initCaps(label),label=spaceSeparate(label),label=periodSeparate(label)}function getVariableName(iScope,scope){if(iScope.binddataset){var variableName,widgetScope,widgetName,isBoundToVariable,isBoundToWidget,parts=iScope.binddataset.split(".");return isBoundToVariable=_.includes(iScope.binddataset,"bind:Variables."),isBoundToVariable||(isBoundToWidget=_.includes(iScope.binddataset,"bind:Widgets.")),isBoundToVariable?variableName=parts[1]:isBoundToWidget&&WM.isString(iScope.binddataset)&&""!==iScope.binddataset&&(_.includes(iScope.binddataset,"selecteditem.")?variableName=null:(widgetName=parts[1],widgetScope=(scope||iScope).Widgets[widgetName],variableName=getVariableName(widgetScope))),variableName}}function isValidWebURL(url){return REGEX.VALID_WEB_URL.test(url)}function getParentOverlayElZIndex(element){var parentEl,parentOverlay,parentOvleryZIndex;return parentEl=element.parent().closest("[widgetid]"),parentEl.length>0?(parentEl=parentEl.eq(0),parentOverlay=parentEl.data("overlayElement"),parentOvleryZIndex=parentOverlay?parentOverlay.css("zIndex"):parentEl.parent().data("overlayElement")?parseInt(parentEl.parent().data("overlayElement").css("zIndex"),10)+10:10,+parentOvleryZIndex):100}function getValidMarkUp(htmlString,handleValidMarkUp,handleInValidMarkUp){var $htm,$outerEle,$innerEle,newMarkup="",checkValidRootElement=function(ele){return WM.element(ele).is("wm-page, wm-partial, wm-template")};return $htm=WM.element.parseHTML(htmlString),checkValidRootElement($htm[0])?(newMarkup=htmlString,triggerFn(handleValidMarkUp)):(triggerFn(handleInValidMarkUp),$outerEle=WM.element("<div>"+htmlString+"</div>"),$innerEle=$outerEle.find("wm-page, wm-partial, wm-template"),$innerEle.length>0&&(newMarkup=$innerEle[0].outerHTML)),newMarkup}function formatVariableIconClass(variableCategory){return variableCategoryMap[variableCategory]}function pushFieldDef(dataObject,columnDefObj,namePrefix,propObj,noModifyTitle){var modifiedTitle;WM.forEach(dataObject,function(value,title){noModifyTitle?modifiedTitle=title:WM.isString(title)?(modifiedTitle=initCaps(title),modifiedTitle=spaceSeparate(modifiedTitle),modifiedTitle=periodSeparate(modifiedTitle),modifiedTitle=deHyphenate(modifiedTitle),modifiedTitle=namePrefix?initCaps(namePrefix)+" "+modifiedTitle:modifiedTitle):modifiedTitle=title,title=namePrefix?namePrefix+"."+title:title;var defObj=propObj.setBindingField?{displayName:modifiedTitle,field:title}:{displayName:modifiedTitle};if(!WM.isObject(value)||WM.isArray(value)&&!value[0]){if(propObj.columnCount===propObj.upperBound)return;columnDefObj.push(defObj),propObj.columnCount+=1}else propObj.includeParentNode&&propObj.columnCount!==propObj.upperBound&&columnDefObj.push(defObj),WM.isArray(value)&&value[0]?pushFieldDef(value[0],columnDefObj,title+"[0]",propObj):pushFieldDef(value,columnDefObj,title,propObj)})}function prepareFieldDefs(data,columnUpperBound,includeParentNode,noModifyTitle){var dataObject,defaultDefs=!1,columnDef=[];return data&&0!==data.length||(data=[{column1:"",column2:"",column3:"",column4:"",column5:""}],defaultDefs=!0),dataObject=WM.isArray(data)?data[0]:[data],pushFieldDef(dataObject,columnDef,"",{upperBound:columnUpperBound,columnCount:0,includeParentNode:includeParentNode,setBindingField:!defaultDefs},noModifyTitle),columnDef}function swapArrayElements(array,index1,index2){var temp=array[index1];return array[index1]=array[index2],array[index2]=temp,array}function swapProperties(data,property1,property2){var temp=data[property1];data[property1]=data[property2],data[property2]=temp}function triggerFn(fn){var start=1,len=arguments.length,args=new Array(len-start);for(start;len>start;start++)args[start-1]=arguments[start];return WM.isFunction(fn)?fn.apply(null,args):void 0}function isStyleSheetLoaded(href){return WM.element('link[href="'+href+'"]').length>0}function removeStyleSheetLoaded(href){var styleTag=WM.element('link[href="'+href+'"]');styleTag.length&&styleTag.remove()}function loadStyleSheet(url,attr){if(!isStyleSheetLoaded(url)){var link=linkEl.cloneNode();link.href=url,attr&&attr.name&&link.setAttribute(attr.name,attr.value),headNode.appendChild(link)}}function loadStyleSheets(urlArray){urlArray&&(WM.isArray(urlArray)||(urlArray=[urlArray]),WM.forEach(urlArray,loadStyleSheet))}function isScriptLoaded(src){return WM.element('script[src="'+src+'"]').length>0||WM.element('script[data-src="'+src+'"]').length>0}function fetchContent(dataType,url,successCallback,errorCallback,inSync){if(inSync&&window.nativeXMLHTTP){var response,xhr=new window.nativeXMLHTTP;xhr.open("GET",url,!1),xhr.onload=function(){4===xhr.readyState&&(200===xhr.status?(response=xhr.responseText,"json"===dataType&&(response=JSON.parse(xhr.responseText)),successCallback(response)):errorCallback())},xhr.send()}else WM.element.ajax({type:"get",dataType:dataType,url:url,success:successCallback,error:errorCallback,async:!inSync})}function loadScripts(scripts,onsuccess,onerror,hasError,jqxhr){if(!scripts||0===scripts.length)return void(hasError?triggerFn(onerror,jqxhr):triggerFn(onsuccess,jqxhr));var url=scripts.shift();return isScriptLoaded(url)?void loadScripts(scripts,onsuccess,onerror):void WM.element.getScript(url).done(function(script,textStatus,jqxhr){loadScripts(scripts,onsuccess,onerror,!1,jqxhr)}).fail(function(jqxhr){loadScripts([],onsuccess,onerror,!0,jqxhr)})}function loadScriptsInSync(urlArray){if(0!==urlArray.length){var url=urlArray.shift();!isScriptLoaded(url)&&url&&url&&fetchContent("text",url,function(response){var script=scriptEl.cloneNode();script.text=response,script.setAttribute("data-src",url),headNode.appendChild(script),loadScriptsInSync(urlArray)},null,!0)}}function isImageFile(fileName){return REGEX.SUPPORTED_IMAGE_FORMAT.test(fileName)}function isZipFile(fileName){return REGEX.ZIP_FILE.test(fileName)}function isExeFile(fileName){return REGEX.EXE_FILE.test(fileName)}function isTextLikeFile(fileName){return REGEX.SUPPORTED_FILE_FORMAT.test(fileName)}function isAudioFile(fileName){return REGEX.SUPPORTED_AUDIO_FORMAT.test(fileName)}function isVideoFile(fileName){return REGEX.SUPPORTED_VIDEO_FORMAT.test(fileName)}function isPageResource(path){return REGEX.PAGE_RESOURCE_PATH.test(path)&&!REGEX.MIN_PAGE_RESOURCE_PATH.test(path)}function isAndroid(){return REGEX.ANDROID.test(userAgent)}function isAndroidPhone(){return isAndroid()&&REGEX.MOBILE.test(userAgent)}function isIphone(){return REGEX.IPHONE.test(userAgent)}function isIpod(){return REGEX.IPOD.test(userAgent)}function isWindowsPhone(){return REGEX.WINDOWS.test(userAgent)}function isMobile(){return APPCONSTANTS.isRunMode?isAndroidPhone()||isIphone()||isIpod()||isWindowsPhone()||WM.element("#wm-mobile-display:visible").length>0:!1}function isValidJavaPackageName(pkgName){return pkgName.match(/^\w[\w\d_.]*[\w\d]$/)}function isQuoteNotPresent(str){return REGEX.NO_QUOTES_ALLOWED.test(str)}function isValidHtml(str){return REGEX.VALID_HTML.test(str)}function getImageUrl(urlString){return APPCONSTANTS.isRunMode?urlString:isValidWebURL(urlString)?urlString:(isImageFile(urlString)||(urlString="resources/images/imagelists/default-image.png"),stringStartsWith(urlString,"services/prefabs")?urlString:urlString="services/projects/"+$rootScope.project.id+"/resources/web/"+urlString)}function getResourceURL(urlString){return isValidWebURL(urlString)?$sce.trustAsResourceUrl(urlString):APPCONSTANTS.isRunMode?urlString:stringStartsWith(urlString,"services/prefabs")?urlString:urlString="services/projects/"+$rootScope.project.id+"/resources/web/"+urlString}function getBackGroundImageUrl(urlString){return""===urlString||"none"===urlString?urlString:"url("+getImageUrl(urlString)+")"}function stringStartsWith(str,startsWith,ignoreCase){if(!str)return!1;var regEx=new RegExp("^"+startsWith,ignoreCase?"i":[]);return regEx.test(str)}function stringEndsWith(str,endsWith,ignoreCase){if(!str)return!1;var regEx=new RegExp(endsWith+"$",ignoreCase?"i":[]);return regEx.test(str)}function isEmptyObject(obj){return WM.isObject(obj)&&!WM.isArray(obj)?0===Object.keys(obj).length:!1}function isValidEmail(email){return REGEX.VALID_EMAIL.test(email)}function fetchPropertiesMapColumns(propertiesMap,namePrefix){var columns={},relatedColumnsArr=[];return WM.forEach(propertiesMap.columns,function(val){if(val.isRelated){if(val.isPrimaryKey||(val.disableInlineEditing="true"),val.isList)return;relatedColumnsArr.push(val)}else{var columnName=namePrefix?namePrefix+"."+val.fieldName:val.fieldName;columns[columnName]={type:val.type,isPrimaryKey:val.isPrimaryKey,generator:val.generator,disableInlineEditing:val.disableInlineEditing,isRelatedPk:val.isRelatedPk}}}),WM.forEach(relatedColumnsArr,function(val){WM.forEach(val.columns,function(col){col.isPrimaryKey?val.isRelated&&col.isPrimaryKey&&(col.isRelatedPk="true"):col.disableInlineEditing="true"}),WM.extend(columns,fetchPropertiesMapColumns(val,val.fieldName))}),columns}function resetObjectWithEmptyValues(object){var properties;return object&&(properties={},WM.forEach(object,function(value,key){properties[key]=""})),properties}function getCurrentPage(){var pathName=location.pathname;return pathName.split("/").pop()||"index.html"}function isDebugMode(){return-1!==getCurrentPage().indexOf("-debug")}function getIndexPage(){return isDebugMode()?"index-debug.html":"index.html"}function redirectToIndexPage(path){path?$window.location=indexPage+"#"+path:$window.location=indexPage}function redirectToLoginPage(){var locationHash=$location.$$path,currentPageName=getCurrentPage();browserStorage.storeItem("wm.referenceUrlToStudio",currentPageName+"#"+locationHash),$window.location=APPCONSTANTS.LOGIN_PAGE}function handleUploadIFrameOnLoad(iFrameElement,successCallback,errorCallback,evt){var serverResponse;iFrameElement.off("load",handleUploadIFrameOnLoad),serverResponse=WM.element("#fileUploadIFrame").contents().find("body").text(),evt&&evt.currentTarget&&(evt.currentTarget.responseText=serverResponse),iFrameElement.first().remove(),serverResponse.errorDetails?triggerFn(errorCallback):triggerFn(successCallback,evt)}function fileUploadFallback(uploadConfig,successCallback,errorCallback){var formElement,formAction,dataArray,index,dataObj,dataElement,elementName,elementValue,key,iFrameElement=WM.element('<iframe id="fileUploadIFrame" name="fileUploadIFrame" class="ng-hide"></iframe>');if(uploadConfig&&(formAction=uploadConfig.url),WM.element("body").append(iFrameElement),iFrameElement.on("load",function(evt){handleUploadIFrameOnLoad(iFrameElement,successCallback,errorCallback,evt)}),formElement=WM.element("*[name="+uploadConfig.formName+"]").first(),uploadConfig.data)for(dataArray=uploadConfig.data,index=0;index<dataArray.length;index+=1){dataObj=dataArray[index];for(key in dataObj)dataObj.hasOwnProperty(key)&&(elementName=key,elementValue=dataObj[key]);dataElement=WM.element('<input type="hidden" name="'+elementName+'" value="'+elementValue+'"/>'),formElement.append(dataElement)}formElement.attr({target:"fileUploadIFrame",action:formAction,method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"}),formElement.submit()}function findValueOf(obj,key){if(obj&&key){for(var parts=key.split(".");0!==parts.length&&obj;)obj=obj[parts.shift()];return obj}}function replace(template,map){return template?template.replace(REGEX.REPLACE_PATTERN,function(match,key){return findValueOf(map,key)}):void 0}function getLoadedPrefabNames(){return WM.element("[prefabname]").map(function(){return WM.element(this).attr("prefabname")})}function initializeAction(op,callback){var img=new Image;img.onload=function(){triggerFn(callback)},img.onerror=function(){triggerFn(callback)}}function getNodeFromJson(tree,nodeId,parentNodeId){var nodeUId,parentNodeUId,nodeIndex,nodeStartIndex,node;return WM.element.each(tree[0].nodeMap,function(uid,name){if(name===nodeId){if(nodeUId=uid,!parentNodeId)return!1;if(parentNodeUId=nodeUId.substr(0,nodeUId.lastIndexOf("-")),tree[0].nodeMap[parentNodeUId]===parentNodeId)return!1}}),nodeUId?(nodeIndex=nodeUId.split("-"),nodeStartIndex=nodeIndex.shift(),node=tree[nodeStartIndex],nodeIndex.forEach(function(index){node=node.children[index]}),node):void 0}function addNodeToJson(tree,nodeId,parentNodeUId,options,parentNodeId){options=options||{};var parentIndex,parentStartIndex,parentNode,existingNode,node={id:nodeId,label:options.label,collapsed:options.collapsed,"class":options["class"],active:options.active,props:options.nodeProps,isDeletable:options.isDeletable,onDelete:options.onDelete};if(!WM.isUndefined(tree)){if(WM.isUndefined(parentNodeUId)&&WM.isUndefined(parentNodeId)?parentNode=tree[0]:(parentNodeId&&!parentNodeUId&&(parentNodeUId=getNodeFromJson(tree,parentNodeId).uid),parentIndex=parentNodeUId.split("-"),parentStartIndex=parentIndex.shift(),parentNode=tree[parentStartIndex],parentIndex.forEach(function(index){parentNode=parentNode.children[index]})),!parentNode)return node.uid="0",node.nodeMap={0:node.id},tree.push(node),node;if(parentNode.children&&WM.isArray(parentNode.children)){if(existingNode=getNode(parentNode.children,nodeId))return existingNode}else parentNode.children=[];return node.uid=parentNode.uid+"-"+parentNode.children.length,parentNode.children.push(node),tree[0].nodeMap[node.uid]=nodeId,node}}function removeJsonNodeChildren(tree,nodeId,parentNodeId){var node=getNodeFromJson(tree,nodeId,parentNodeId);node&&(node.children=void 0)}function getValidJSON(content){if(!content)return!1;try{return JSON.parse(content)}catch(e){return!1}}function prettifyJS(content){return window.js_beautify?window.js_beautify(content):(loadScriptsInSync(["_static_/components/js-beautify/js/lib/beautify.js"]),window.js_beautify(content))}function prettifyHTML(content){return window.html_beautify?window.html_beautify(content):(loadScriptsInSync(["_static_/components/js-beautify/js/lib/beautify-html.js"]),window.html_beautify(content))}function prettifyCSS(content){return window.css_beautify?window.css_beautify(content):(loadScriptsInSync(["_static_/components/js-beautify/js/lib/beautify-css.js"]),window.css_beautify(content))}function getActionFromKey(event){var ctrlOrMetaKey=isAppleProduct?event.metaKey:event.ctrlKey,altKey=event.altKey;if(isAppleProduct){if(8===event.which)return"DELETE"}else if(46===event.which)return"DELETE";if(ctrlOrMetaKey)switch(event.which){case 82:return altKey?"RUN":"UNKNOWN";case 68:return altKey?"DEPLOY":"UNKNOWN";case 83:return"SAVE";case 88:return"CUT";case 67:return"COPY";case 86:return"PASTE";case 90:return event.shiftKey?"REDO":"UNDO"}else switch(event.which){case 13:return"ENTER";case 27:return"ESC";case 38:return"UP-ARROW";case 40:return"DOWN-ARROW"}return"UNKNOWN"}function preventCachingOf(url){return url}function getAllKeysOf(obj,prefix){var keys=[];return prefix=prefix?prefix+".":"",WM.isObject(obj)&&!WM.isArray(obj)&&Object.keys(obj).forEach(function(key){keys.push(prefix+key),keys=keys.concat(getAllKeysOf(obj[key],prefix+key))}),keys}function getService(serviceName){if(serviceName){var injector,appEl=WM.element("[id=ng-app]");if(appEl)try{if(injector=appEl.injector())return injector.get(serviceName)}catch(e){return void 0}}}function removeProtocol(url){var newUrl;return newUrl=-1!==url.indexOf("http")?-1!==url.indexOf("https:")?url.substr(6):url.substr(5):url}function getCookieByName(name){var cookiesArray=document.cookie.split("; "),cookies={};return cookiesArray.forEach(function(cookie){var cookieArray=cookie.split("=");cookies[cookieArray[0]]=cookieArray[1]}),cookies[name]}function isPageable(obj){var pageable={content:[],first:!0,last:!0,number:0,numberOfElements:10,size:20,sort:null,totalElements:10,totalPages:1};return WM.equals(Object.keys(pageable),Object.keys(obj).sort())}function isFileUploadSupported(){return window.File&&window.FileReader&&window.FileList&&window.Blob}function processMarkup(markupStr){if(!markupStr)return"";markupStr=getValidMarkUp(markupStr);var content=markupStr.replace(/>\s+</g,"><"),root=WM.element("<div></div>");return APPCONSTANTS.isRunMode&&(root.html(content).find("wm-livelist, wm-login, wm-template").each(function(){var wrapper,widget=WM.element(this),ctrlName=widget.attr("data-ng-controller")||widget.attr("ng-controller");ctrlName&&(wrapper=WM.element('<div class="app-controller"></div>').attr("data-ng-controller",ctrlName),widget.removeAttr("data-ng-controller ng-controller").wrap(wrapper))}),content=root[0].innerHTML),content}function getFieldTypeWidgetTypesMap(){return fieldTypeWidgetTypeMap}function getDateTimeTypes(){return dateTimeTypes}function getDateTimeDefaultFormats(){return dateTimeDefaultFormats}function isValidDataSet(dataset){return WM.isArray(dataset)&&dataset.length>0||WM.isObject(dataset)&&Object.keys(dataset).length>0}function parseCombinedPageContent(pageContent,pageName){var pageDom=WM.element("<div>"+pageContent+"</div>"),htmlEle=pageDom.find('script[id="'+pageName+'.html"]'),variableContext="_"+pageName+"Page_Variables_";APPCONSTANTS.isStudioMode&&WM.element('script[id="'+pageName+'.css"]').remove();try{WM.element("head").append(pageDom.find("style, script"))}catch(e){console.log(e.message)}return{html:htmlEle.html()||"",variables:window[variableContext]||{}}}function extractType(typeRef){return typeRef?typeRef.substring(typeRef.lastIndexOf(".")+1):"string"}function isNumberType(type){return-1!==NUMBER_TYPES.indexOf(extractType(type).toLowerCase())}function isDeleteResourceAllowed(context,path){return!SYSTEM_FOLDER_PATHS[context]||-1===SYSTEM_FOLDER_PATHS[context].indexOf(path)}function random(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function generateGUId(){return random()+"-"+random()+"-"+random()}function isDuplicateName(list,newName,caseSensitive){var i,retVal=!1;if(!list||!newName)return retVal;if(caseSensitive){for(i=0;i<list.length;i+=1)if(list[i].toLowerCase()===newName.toLowerCase()){retVal=!0;break}}else-1!==list.indexOf(newName)&&(retVal=!0);return retVal}function scrollIntoView(element,container){var $container=WM.element(container),$element=WM.element(element),containerTop=$container.scrollTop(),containerHeight=$container.height(),containerBottom=containerTop+containerHeight,elemTop=$element[0]&&$element[0].offsetTop,elemBottom=elemTop+$element.height();containerTop>elemTop?$container.scrollTop(elemTop):elemBottom>containerBottom&&$container.scrollTop(elemBottom-containerHeight)}function arraysEqual(arr1,arr2){var i;if(arr1.length!==arr2.length)return!1;for(i=0;i<arr1.length;i++)if(arr1[i]!==arr2[i])return!1;return!0}function getNewEventsObject(prefix,events){var newEventName,newCustomEvent,eventNumber=0,customEvents=[],args="($event, $scope)";return _.forEach(events,function(event,index){if("Javascript"===event){for(newCustomEvent=prefix,newEventName=newCustomEvent+args;_.includes(events,newEventName);)eventNumber+=1,newCustomEvent=prefix+eventNumber,newEventName=newCustomEvent+args;events[index]=newEventName,customEvents=customEvents.concat(newCustomEvent)}}),{events:events,customEvents:customEvents}}function getEvaluatedExprValue(object,expression,scope){var keys,relatedFieldKeys,dataObj,requiredFields=[],str="";keys=Object.keys(object),keys.forEach(function(column){_.includes(expression,column)&&(WM.isObject(object[column])?(dataObj=object[column],relatedFieldKeys=Object.keys(dataObj),relatedFieldKeys.forEach(function(field){str=column+"."+field,_.includes(expression,column)&&requiredFields.push({field:str,value:dataObj[field]})})):requiredFields.push({field:column,value:object[column]}))}),requiredFields.forEach(function(column){var regexExpr=new RegExp("\\b"+column.field+"\\b","g"),val=column.value;WM.isString(val)&&(val='"'+val+'"'),expression=expression.replace(regexExpr,val)});try{return scope.$eval(expression)}catch(e){return expression}}var userAgent=navigator.userAgent,scriptEl=document.createElement("script"),linkEl=document.createElement("link"),headNode=document.getElementsByTagName("head")[0],isAppleProduct=/Mac|iPod|iPhone|iPad/.test(navigator.platform),REGEX={SNAKE_CASE:/[A-Z]/g,ANDROID:/Android/i,IPHONE:/iPhone/i,IPOD:/iPod/i,MOBILE:/Mobile/i,WINDOWS:/Windows Phone/i,SUPPORTED_IMAGE_FORMAT:/\.(bmp|gif|jpe|jpg|jpeg|tif|tiff|pbm|png|ico)$/i,SUPPORTED_FILE_FORMAT:/\.(txt|js|css|html|script|properties|json|java|xml|smd|xmi|sql|log|wsdl)$/i,SUPPORTED_AUDIO_FORMAT:/\.(mp3|ogg|webm|wma|3gp|wav)$/i,SUPPORTED_VIDEO_FORMAT:/\.(mp4|ogg|webm|wmv|mpeg|mpg|avi)$/i,PAGE_RESOURCE_PATH:/^\/pages\/.*\.(js|css|html|json)$/,MIN_PAGE_RESOURCE_PATH:/.*(page.min.html)$/,VALID_EMAIL:/^[a-zA-Z][\w.]+@[a-zA-Z_]+?\.[a-zA-Z.]{1,4}[a-zA-Z]$/,VALID_WEB_URL:/^(http[s]?:\/\/)(www\.){0,1}[a-zA-Z0-9\.\-]+\.[a-zA-Z]{2,5}[\.]{0,1}/,REPLACE_PATTERN:/\$\{([^\}]+)\}/g,ZIP_FILE:/\.zip$/i,EXE_FILE:/\.exe$/i,NO_QUOTES_ALLOWED:/^[^'|"]*$/,VALID_HTML:/<[a-z][\s\S]*>/i},NUMBER_TYPES=["int","integer","float","double","short","byte","big_integer","big_decimal"],SYSTEM_FOLDER_PATHS={project:["../lib","../project","../project/services","../project/lib","../project/src","../project/test","../project/src/main","../project/src/main/webapp","../project/src/main/resources","../project/src/main/webapp/services","../project/src/main/webapp/resources","../project/src/main/webapp/pages","../project/src/main/webapp/resources/images","../project/src/main/webapp/resources/WEB-INF","../project/src/main/webapp/resources/ngLocale","../project/src/main/webapp/resources/i18n","../project/src/main/webapp/resources/images/imagelists","../project/src/main/webapp/resources/audio","../project/src/main/webapp/resources/video"],resources:["","/services","/resources","/WEB-INF","/app","/pages","/resources/i18n","/resources/ngLocale","resources/images","resources/audio","resources/video","resources/images/imagelists"],lib:["../lib"],jar:["../lib"],locale:["resources/i18n"],services:["services"],image:["resources/images","resources/images/imagelists"],audio:["resources/audio"],video:["resources/video"]},hasLocalStorage="localStorage"in window&&null!==window.localStorage,browserStorage={storeItem:function(key,value){hasLocalStorage&&window.localStorage.setItem(key,value)},getItem:function(key){return hasLocalStorage?window.localStorage.getItem(key):void 0},deleteItem:function(key){hasLocalStorage&&delete window.localStorage[key]}},isIE=function(){return userAgent.indexOf("MSIE")>-1},isIE11=function(){return navigator.appVersion.indexOf("Trident/")>-1},getNode=function(tree,nodeId){var index,treeLength;if(WM.isUndefined(tree))return void 0;for(treeLength=tree.length,index=0;treeLength>index;index+=1)if(tree[index].id===nodeId)return tree[index];return void 0},variableCategoryMap={"wm.Variable":"variable","wm.ServiceVariable":"service-variable","wm.LiveVariable":"live-variable","wm.LoginVariable":"login-variable","wm.LogoutVariable":"logout-variable","wm.NavigationVariable":"navigation-variable","wm.NotificationVariable":"notification-variable","wm.TimerVariable":"time"},fieldTypeWidgetTypeMap={integer:["Number","Text","Slider","Select","Radioset","Rating"],big_integer:["Number","Text","Slider","Select","Radioset"],"short":["Number","Text","Slider","Select","Radioset"],"byte":["Number","Text","Slider","Select","Radioset"],date:["Date","Text","Select","Radioset"],"boolean":["Checkbox","Text","Select","Radioset","Toggle"],list:["Select","Radioset","Text","Datalist"],"float":["Number","Text","Slider","Select","Radioset"],big_decimal:["Number","Text","Slider","Select","Radioset"],"double":["Number","Text","Slider","Select","Radioset"],string:["Text","Textarea","Password","RichText","Select","Radioset","Date","Time","Timestamp"],character:["Text","Textarea","RichText","Select","Radioset","Date","Time","Timestamp"],text:["Textarea","Text","RichText","Select","Radioset","Date","Time","Timestamp"],clob:["Textarea","Text","RichText"],blob:["Upload","Textarea","Text","RichText"],time:["Time","Text","Select","Radioset"],timestamp:["Timestamp","Text","Date","Time","Select","Radioset"],datetime:["Datetime","Text","Date","Time","Select","Radioset"],custom:["Text","Textarea","Password","RichText","Checkbox","Number","Slider","Select","Radioset","Date","Time","Timestamp"]},dateTimeTypes={date:!0,time:!0,timestamp:!0,datetime:!0},dateTimeDefaultFormats={date:"yyyy-MM-dd",time:"HH:mm:ss",timestamp:"epoch format",datetime:"yyyy-MM-ddTHH:mm:ss",datetime_oracle:"yyyy-MM-dd HH:mm:ss"},indexPage=getIndexPage();linkEl.rel="stylesheet",linkEl.type="text/css",$rootScope.$safeApply=function($scope,fn){$rootScope.$$phase||$scope.$$phase?triggerFn(fn):$scope.$apply(fn)},$.fn.extend({scrollParent:function(includeHidden){var position=this.css("position"),excludeStaticParent="absolute"===position,overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,docHeight=document.body.clientHeight,scrollParent=this.parents().filter(function(){var hasOverFlowAuto,parent=$(this);return excludeStaticParent&&"static"===parent.css("position")?!1:(hasOverFlowAuto=overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")),hasOverFlowAuto&&this.clientHeight<=docHeight)}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(this[0].ownerDocument||document)}}),this.camelCase=WM.element.camelCase,this.initCaps=initCaps,this.firstCaps=firstCaps,this.periodSeparate=periodSeparate,this.spaceSeparate=spaceSeparate,this.prettifyLabel=prettifyLabel,this.getVariableName=getVariableName,this.getImageUrl=getImageUrl,this.getResourceUrl=getResourceURL,this.formatVariableIconClass=formatVariableIconClass,this.getBackGroundImageUrl=getBackGroundImageUrl,this.getParentOverlayElZIndex=getParentOverlayElZIndex,this.hyphenate=hyphenate,this.deHyphenate=deHyphenate,this.isAndroid=isAndroid,this.isAndroidPhone=isAndroidPhone,this.isIphone=isIphone,this.isIpod=isIpod,this.isMobile=isMobile,this.isScriptLoaded=isScriptLoaded,this.isValidJavaPackageName=isValidJavaPackageName,this.isValidHtml=isValidHtml,this.isQuoteNotPresent=isQuoteNotPresent,this.stringStartsWith=stringStartsWith,this.stringEndsWith=stringEndsWith,this.isStyleSheetLoaded=isStyleSheetLoaded,this.isValidWebURL=isValidWebURL,this.loadScripts=loadScripts,this.loadStyleSheets=loadStyleSheets,this.loadStyleSheet=loadStyleSheet,this.prepareFieldDefs=prepareFieldDefs,this.prettifyCSS=prettifyCSS,this.prettifyHTML=prettifyHTML,this.prettifyJS=prettifyJS,this.swapArrayElements=swapArrayElements,this.swapProperties=swapProperties,this.triggerFn=triggerFn,this.isEmptyObject=isEmptyObject,this.isValidEmail=isValidEmail,this.resetObjectWithEmptyValues=resetObjectWithEmptyValues,this.isImageFile=isImageFile,this.isZipFile=isZipFile,this.isExeFile=isExeFile,this.isTextLikeFile=isTextLikeFile,this.isAudioFile=isAudioFile,this.isVideoFile=isVideoFile,this.isPageResource=isPageResource,this.findValueOf=findValueOf,this.replace=replace,this.removeStyleSheetLoaded=removeStyleSheetLoaded,this.fileUploadFallback=fileUploadFallback,this.getCurrentPage=getCurrentPage,this.isDebugMode=isDebugMode,this.getIndexPage=getIndexPage,this.redirectToIndexPage=redirectToIndexPage,this.redirectToLoginPage=redirectToLoginPage,this.browserStorage=browserStorage,this.fetchPropertiesMapColumns=fetchPropertiesMapColumns,this.getLoadedPrefabNames=getLoadedPrefabNames,this.initializeAction=initializeAction,this.addNodeToJson=addNodeToJson,this.getNodeFromJson=getNodeFromJson,this.removeJsonNodeChildren=removeJsonNodeChildren,this.isIE=isIE,this.isIE11=isIE11,this.getValidJSON=getValidJSON,this.getActionFromKey=getActionFromKey,this.preventCachingOf=preventCachingOf,this.getAllKeysOf=getAllKeysOf,this.fetchContent=fetchContent,this.getService=getService,this.removeProtocol=removeProtocol,this.getCookieByName=getCookieByName,this.isPageable=isPageable,this.isNumberType=isNumberType,this.isFileUploadSupported=isFileUploadSupported,this.processMarkup=processMarkup,this.getFieldTypeWidgetTypesMap=getFieldTypeWidgetTypesMap,this.getDateTimeTypes=getDateTimeTypes,this.getDateTimeDefaultFormats=getDateTimeDefaultFormats,this.isValidDataSet=isValidDataSet,this.parseCombinedPageContent=parseCombinedPageContent,this.extractType=extractType,this.isDeleteResourceAllowed=isDeleteResourceAllowed,this.generateGUId=generateGUId,this.isDuplicateName=isDuplicateName,this.getValidMarkUp=getValidMarkUp,this.scrollIntoView=scrollIntoView,this.arraysEqual=arraysEqual,this.getNewEventsObject=getNewEventsObject,this.getEvaluatedExprValue=getEvaluatedExprValue}]),WM.module("wm.utils").config(["$filterProvider",function($filterProvider){"use strict";WM.module("wm.utils").$filter=$filterProvider.register}]).service("DataFormatService",["$filter","CURRENCYCONSTANTS",function($filter,CURRENCYCONSTANTS){"use strict";function getDateTimePatterns(){return DATE_TIME_PATTERNS}function getDatePatterns(){return DATE_PATTERNS}function getTimePatterns(){return TIME_PATTERNS}function getCurrencyOptions(){return CURRENCY_OPTIONS}function getFormatPatterns(){return FORMAT_OPTIONS}function epoch2dateStr(epoch,format){return $filter("date")(epoch,format)}function date2dateStr(date,format){return $filter("date")(date,format)}function string2number(data,fracSize){return $filter("number")(data,fracSize)}function number2currency(data,currencySymbol,fractionSize){var _sym=currencySymbol||"",_val=string2number(data,fractionSize);return _val?_sym+_val:""}function toDate(data,format){var isDate,timestamp,isEpoch=!isNaN(+data);return"null"===data?"":isEpoch?epoch2dateStr(data,format):(isDate=WM.isDate(data))?date2dateStr(data,format):(timestamp=moment(data).valueOf(),data&&timestamp?date2dateStr(timestamp,format):void 0)}function toNumber(data,fracSize){return string2number(data,fracSize)}function toCurrency(data,currencySymbol,fracSize){var _currencySymbol=(CURRENCYCONSTANTS[currencySymbol]||{}).symbol||currencySymbol;return number2currency(data,_currencySymbol,fracSize)}function lpad(data,padding){return data?padding+data:padding}function rpad(data,padding){return data?data+padding:padding}function prefix(data,padding){return data?padding+data:padding}function suffix(data,padding){return data?data+padding:padding}function register(formatterName,formatterFn){WM.module("wm.utils").$filter(formatterName,formatterFn)}var DATE_PATTERNS=["yyyy-MM-dd","yyyy-M-dd","M-dd-yyyy","MM-dd-yy","yyyy, dd MMMM","yyyy, MMM dd","MM/dd/yyyy","M/d/yyyy","EEE, dd MMM yyyy","EEE MMM dd yyyy","EEEE, MMMM dd, yyyy","timestamp"],DATE_TIME_PATTERNS=["dd/mm/yyyy","yyyy-MM-dd","yyyy-M-dd","M-dd-yyyy","M/d/yyyy","MM/dd/yyyy","yyyy, MMM dd","yyyy, dd MMMM","yyyy-MM-ddTHH:mm:ss","MM-dd-yy hh:mm:ss a","MM-dd-yy hh:mm:ss a Z","dd-MMM-yyyy HH:mm:ss","yyyy-MM-dd HH:mm","yyyy-MM-dd HH:mm:ss:sss","yyyy-MM-dd hh:mm a","yyyy-MM-dd hh:mm:ss a","yyyy-MM-dd hh:mm:ss:sss Z","yyyy-MM-dd hh:mm:ss:sss a","EEE MMM dd hh:mm:ss Z yyyy","EEE, dd MMM yyyy HH:mm:ss Z","EEEE, MMMM dd, yyyy","timestamp"],TIME_PATTERNS=["HH:mm:ss","HH:mm","hh:mm:ss","hh:mm","hh:mm a","H:m:s","h:m:s","timestamp"],CURRENCY_OPTIONS=["AED","AFN","ALL","AMD","ARS","AUD","AZN","BAM","BDT","BGN","BHD","BIF","BND","BOB","BRL","BWP","BYR","BZD","CAD","CDF","CHF","CLP","CNY","COP","CRC","CVE","CZK","DJF","DKK","DOP","DZD","EEK","EGP","ERN","ETB","EUR","GBP","GEL","GHS","GNF","GTQ","HKD","HNL","HRK","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KHR","KMF","KRW","KWD","KZT","LBP","LKR","LTL","LVL","LYD","MAD","MDL","MGA","MKD","MMK","MOP","MUR","MXN","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SDG","SEK","SGD","SOS","SYP","THB","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","UYU","UZS","VEF","VND","XAF","XOF","YER","ZAR","ZMK"],FORMAT_OPTIONS=["toDate","toCurrency","prefix","suffix","toNumber","None"],customFilters={};
customFilters.toDate=toDate,customFilters.toNumber=toNumber,customFilters.toCurrency=toCurrency,customFilters.lpad=lpad,customFilters.rpad=rpad,customFilters.prefix=prefix,customFilters.suffix=suffix,Object.keys(customFilters).forEach(function(filterName){WM.module("wm.utils").$filter(filterName,function(){return customFilters[filterName]})}),this.register=register,this.getDateTimePatterns=getDateTimePatterns,this.getDatePatterns=getDatePatterns,this.getTimePatterns=getTimePatterns,this.getCurrencyOptions=getCurrencyOptions,this.getFormatPatterns=getFormatPatterns}]).constant("CURRENCYCONSTANTS",{USD:{symbol:"$",name:"US Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"USD",name_plural:"US dollars"},CAD:{symbol:"CA$",name:"Canadian Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"CAD",name_plural:"Canadian dollars"},EUR:{symbol:"€",name:"Euro",symbol_native:"€",decimal_digits:2,rounding:0,code:"EUR",name_plural:"euros"},AED:{symbol:"AED",name:"United Arab Emirates Dirham",symbol_native:"د.إ.‏",decimal_digits:2,rounding:0,code:"AED",name_plural:"UAE dirhams"},AFN:{symbol:"Af",name:"Afghan Afghani",symbol_native:"؋",decimal_digits:0,rounding:0,code:"AFN",name_plural:"Afghan Afghanis"},ALL:{symbol:"ALL",name:"Albanian Lek",symbol_native:"Lek",decimal_digits:0,rounding:0,code:"ALL",name_plural:"Albanian lekë"},AMD:{symbol:"AMD",name:"Armenian Dram",symbol_native:"դր.",decimal_digits:0,rounding:0,code:"AMD",name_plural:"Armenian drams"},ARS:{symbol:"AR$",name:"Argentine Peso",symbol_native:"$",decimal_digits:2,rounding:0,code:"ARS",name_plural:"Argentine pesos"},AUD:{symbol:"AU$",name:"Australian Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"AUD",name_plural:"Australian dollars"},AZN:{symbol:"man.",name:"Azerbaijani Manat",symbol_native:"ман.",decimal_digits:2,rounding:0,code:"AZN",name_plural:"Azerbaijani manats"},BAM:{symbol:"KM",name:"Bosnia-Herzegovina Convertible Mark",symbol_native:"KM",decimal_digits:2,rounding:0,code:"BAM",name_plural:"Bosnia-Herzegovina convertible marks"},BDT:{symbol:"Tk",name:"Bangladeshi Taka",symbol_native:"৳",decimal_digits:2,rounding:0,code:"BDT",name_plural:"Bangladeshi takas"},BGN:{symbol:"BGN",name:"Bulgarian Lev",symbol_native:"лв.",decimal_digits:2,rounding:0,code:"BGN",name_plural:"Bulgarian leva"},BHD:{symbol:"BD",name:"Bahraini Dinar",symbol_native:"د.ب.‏",decimal_digits:3,rounding:0,code:"BHD",name_plural:"Bahraini dinars"},BIF:{symbol:"FBu",name:"Burundian Franc",symbol_native:"FBu",decimal_digits:0,rounding:0,code:"BIF",name_plural:"Burundian francs"},BND:{symbol:"BN$",name:"Brunei Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"BND",name_plural:"Brunei dollars"},BOB:{symbol:"Bs",name:"Bolivian Boliviano",symbol_native:"Bs",decimal_digits:2,rounding:0,code:"BOB",name_plural:"Bolivian bolivianos"},BRL:{symbol:"R$",name:"Brazilian Real",symbol_native:"R$",decimal_digits:2,rounding:0,code:"BRL",name_plural:"Brazilian reals"},BWP:{symbol:"BWP",name:"Botswanan Pula",symbol_native:"P",decimal_digits:2,rounding:0,code:"BWP",name_plural:"Botswanan pulas"},BYR:{symbol:"BYR",name:"Belarusian Ruble",symbol_native:"BYR",decimal_digits:0,rounding:0,code:"BYR",name_plural:"Belarusian rubles"},BZD:{symbol:"BZ$",name:"Belize Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"BZD",name_plural:"Belize dollars"},CDF:{symbol:"CDF",name:"Congolese Franc",symbol_native:"FrCD",decimal_digits:2,rounding:0,code:"CDF",name_plural:"Congolese francs"},CHF:{symbol:"CHF",name:"Swiss Franc",symbol_native:"CHF",decimal_digits:2,rounding:.05,code:"CHF",name_plural:"Swiss francs"},CLP:{symbol:"CL$",name:"Chilean Peso",symbol_native:"$",decimal_digits:0,rounding:0,code:"CLP",name_plural:"Chilean pesos"},CNY:{symbol:"CN¥",name:"Chinese Yuan",symbol_native:"CN¥",decimal_digits:2,rounding:0,code:"CNY",name_plural:"Chinese yuan"},COP:{symbol:"CO$",name:"Colombian Peso",symbol_native:"$",decimal_digits:0,rounding:0,code:"COP",name_plural:"Colombian pesos"},CRC:{symbol:"₡",name:"Costa Rican Colón",symbol_native:"₡",decimal_digits:0,rounding:0,code:"CRC",name_plural:"Costa Rican colóns"},CVE:{symbol:"CV$",name:"Cape Verdean Escudo",symbol_native:"CV$",decimal_digits:2,rounding:0,code:"CVE",name_plural:"Cape Verdean escudos"},CZK:{symbol:"Kč",name:"Czech Republic Koruna",symbol_native:"Kč",decimal_digits:2,rounding:0,code:"CZK",name_plural:"Czech Republic korunas"},DJF:{symbol:"Fdj",name:"Djiboutian Franc",symbol_native:"Fdj",decimal_digits:0,rounding:0,code:"DJF",name_plural:"Djiboutian francs"},DKK:{symbol:"Dkr",name:"Danish Krone",symbol_native:"kr",decimal_digits:2,rounding:0,code:"DKK",name_plural:"Danish kroner"},DOP:{symbol:"RD$",name:"Dominican Peso",symbol_native:"RD$",decimal_digits:2,rounding:0,code:"DOP",name_plural:"Dominican pesos"},DZD:{symbol:"DA",name:"Algerian Dinar",symbol_native:"د.ج.‏",decimal_digits:2,rounding:0,code:"DZD",name_plural:"Algerian dinars"},EEK:{symbol:"Ekr",name:"Estonian Kroon",symbol_native:"kr",decimal_digits:2,rounding:0,code:"EEK",name_plural:"Estonian kroons"},EGP:{symbol:"EGP",name:"Egyptian Pound",symbol_native:"ج.م.‏",decimal_digits:2,rounding:0,code:"EGP",name_plural:"Egyptian pounds"},ERN:{symbol:"Nfk",name:"Eritrean Nakfa",symbol_native:"Nfk",decimal_digits:2,rounding:0,code:"ERN",name_plural:"Eritrean nakfas"},ETB:{symbol:"Br",name:"Ethiopian Birr",symbol_native:"Br",decimal_digits:2,rounding:0,code:"ETB",name_plural:"Ethiopian birrs"},GBP:{symbol:"£",name:"British Pound Sterling",symbol_native:"£",decimal_digits:2,rounding:0,code:"GBP",name_plural:"British pounds sterling"},GEL:{symbol:"GEL",name:"Georgian Lari",symbol_native:"GEL",decimal_digits:2,rounding:0,code:"GEL",name_plural:"Georgian laris"},GHS:{symbol:"GH₵",name:"Ghanaian Cedi",symbol_native:"GH₵",decimal_digits:2,rounding:0,code:"GHS",name_plural:"Ghanaian cedis"},GNF:{symbol:"FG",name:"Guinean Franc",symbol_native:"FG",decimal_digits:0,rounding:0,code:"GNF",name_plural:"Guinean francs"},GTQ:{symbol:"GTQ",name:"Guatemalan Quetzal",symbol_native:"Q",decimal_digits:2,rounding:0,code:"GTQ",name_plural:"Guatemalan quetzals"},HKD:{symbol:"HK$",name:"Hong Kong Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"HKD",name_plural:"Hong Kong dollars"},HNL:{symbol:"HNL",name:"Honduran Lempira",symbol_native:"L",decimal_digits:2,rounding:0,code:"HNL",name_plural:"Honduran lempiras"},HRK:{symbol:"kn",name:"Croatian Kuna",symbol_native:"kn",decimal_digits:2,rounding:0,code:"HRK",name_plural:"Croatian kunas"},HUF:{symbol:"Ft",name:"Hungarian Forint",symbol_native:"Ft",decimal_digits:0,rounding:0,code:"HUF",name_plural:"Hungarian forints"},IDR:{symbol:"Rp",name:"Indonesian Rupiah",symbol_native:"Rp",decimal_digits:0,rounding:0,code:"IDR",name_plural:"Indonesian rupiahs"},ILS:{symbol:"₪",name:"Israeli New Sheqel",symbol_native:"₪",decimal_digits:2,rounding:0,code:"ILS",name_plural:"Israeli new sheqels"},INR:{symbol:"₹",name:"Indian Rupee",symbol_native:"টকা",decimal_digits:2,rounding:0,code:"INR",name_plural:"Indian rupees"},IQD:{symbol:"IQD",name:"Iraqi Dinar",symbol_native:"د.ع.‏",decimal_digits:0,rounding:0,code:"IQD",name_plural:"Iraqi dinars"},IRR:{symbol:"IRR",name:"Iranian Rial",symbol_native:"﷼",decimal_digits:0,rounding:0,code:"IRR",name_plural:"Iranian rials"},ISK:{symbol:"Ikr",name:"Icelandic Króna",symbol_native:"kr",decimal_digits:0,rounding:0,code:"ISK",name_plural:"Icelandic krónur"},JMD:{symbol:"J$",name:"Jamaican Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"JMD",name_plural:"Jamaican dollars"},JOD:{symbol:"JD",name:"Jordanian Dinar",symbol_native:"د.أ.‏",decimal_digits:3,rounding:0,code:"JOD",name_plural:"Jordanian dinars"},JPY:{symbol:"¥",name:"Japanese Yen",symbol_native:"￥",decimal_digits:0,rounding:0,code:"JPY",name_plural:"Japanese yen"},KES:{symbol:"Ksh",name:"Kenyan Shilling",symbol_native:"Ksh",decimal_digits:2,rounding:0,code:"KES",name_plural:"Kenyan shillings"},KHR:{symbol:"KHR",name:"Cambodian Riel",symbol_native:"៛",decimal_digits:2,rounding:0,code:"KHR",name_plural:"Cambodian riels"},KMF:{symbol:"CF",name:"Comorian Franc",symbol_native:"FC",decimal_digits:0,rounding:0,code:"KMF",name_plural:"Comorian francs"},KRW:{symbol:"₩",name:"South Korean Won",symbol_native:"₩",decimal_digits:0,rounding:0,code:"KRW",name_plural:"South Korean won"},KWD:{symbol:"KD",name:"Kuwaiti Dinar",symbol_native:"د.ك.‏",decimal_digits:3,rounding:0,code:"KWD",name_plural:"Kuwaiti dinars"},KZT:{symbol:"KZT",name:"Kazakhstani Tenge",symbol_native:"тңг.",decimal_digits:2,rounding:0,code:"KZT",name_plural:"Kazakhstani tenges"},LBP:{symbol:"LB£",name:"Lebanese Pound",symbol_native:"ل.ل.‏",decimal_digits:0,rounding:0,code:"LBP",name_plural:"Lebanese pounds"},LKR:{symbol:"SLRs",name:"Sri Lankan Rupee",symbol_native:"SL Re",decimal_digits:2,rounding:0,code:"LKR",name_plural:"Sri Lankan rupees"},LTL:{symbol:"Lt",name:"Lithuanian Litas",symbol_native:"Lt",decimal_digits:2,rounding:0,code:"LTL",name_plural:"Lithuanian litai"},LVL:{symbol:"Ls",name:"Latvian Lats",symbol_native:"Ls",decimal_digits:2,rounding:0,code:"LVL",name_plural:"Latvian lati"},LYD:{symbol:"LD",name:"Libyan Dinar",symbol_native:"د.ل.‏",decimal_digits:3,rounding:0,code:"LYD",name_plural:"Libyan dinars"},MAD:{symbol:"MAD",name:"Moroccan Dirham",symbol_native:"د.م.‏",decimal_digits:2,rounding:0,code:"MAD",name_plural:"Moroccan dirhams"},MDL:{symbol:"MDL",name:"Moldovan Leu",symbol_native:"MDL",decimal_digits:2,rounding:0,code:"MDL",name_plural:"Moldovan lei"},MGA:{symbol:"MGA",name:"Malagasy Ariary",symbol_native:"MGA",decimal_digits:0,rounding:0,code:"MGA",name_plural:"Malagasy Ariaries"},MKD:{symbol:"MKD",name:"Macedonian Denar",symbol_native:"MKD",decimal_digits:2,rounding:0,code:"MKD",name_plural:"Macedonian denari"},MMK:{symbol:"MMK",name:"Myanma Kyat",symbol_native:"K",decimal_digits:0,rounding:0,code:"MMK",name_plural:"Myanma kyats"},MOP:{symbol:"MOP$",name:"Macanese Pataca",symbol_native:"MOP$",decimal_digits:2,rounding:0,code:"MOP",name_plural:"Macanese patacas"},MUR:{symbol:"MURs",name:"Mauritian Rupee",symbol_native:"MURs",decimal_digits:0,rounding:0,code:"MUR",name_plural:"Mauritian rupees"},MXN:{symbol:"MX$",name:"Mexican Peso",symbol_native:"$",decimal_digits:2,rounding:0,code:"MXN",name_plural:"Mexican pesos"},MYR:{symbol:"RM",name:"Malaysian Ringgit",symbol_native:"RM",decimal_digits:2,rounding:0,code:"MYR",name_plural:"Malaysian ringgits"},MZN:{symbol:"MTn",name:"Mozambican Metical",symbol_native:"MTn",decimal_digits:2,rounding:0,code:"MZN",name_plural:"Mozambican meticals"},NAD:{symbol:"N$",name:"Namibian Dollar",symbol_native:"N$",decimal_digits:2,rounding:0,code:"NAD",name_plural:"Namibian dollars"},NGN:{symbol:"₦",name:"Nigerian Naira",symbol_native:"₦",decimal_digits:2,rounding:0,code:"NGN",name_plural:"Nigerian nairas"},NIO:{symbol:"C$",name:"Nicaraguan Córdoba",symbol_native:"C$",decimal_digits:2,rounding:0,code:"NIO",name_plural:"Nicaraguan córdobas"},NOK:{symbol:"Nkr",name:"Norwegian Krone",symbol_native:"kr",decimal_digits:2,rounding:0,code:"NOK",name_plural:"Norwegian kroner"},NPR:{symbol:"NPRs",name:"Nepalese Rupee",symbol_native:"नेरू",decimal_digits:2,rounding:0,code:"NPR",name_plural:"Nepalese rupees"},NZD:{symbol:"NZ$",name:"New Zealand Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"NZD",name_plural:"New Zealand dollars"},OMR:{symbol:"OMR",name:"Omani Rial",symbol_native:"ر.ع.‏",decimal_digits:3,rounding:0,code:"OMR",name_plural:"Omani rials"},PAB:{symbol:"B/.",name:"Panamanian Balboa",symbol_native:"B/.",decimal_digits:2,rounding:0,code:"PAB",name_plural:"Panamanian balboas"},PEN:{symbol:"S/.",name:"Peruvian Nuevo Sol",symbol_native:"S/.",decimal_digits:2,rounding:0,code:"PEN",name_plural:"Peruvian nuevos soles"},PHP:{symbol:"₱",name:"Philippine Peso",symbol_native:"₱",decimal_digits:2,rounding:0,code:"PHP",name_plural:"Philippine pesos"},PKR:{symbol:"PKRs",name:"Pakistani Rupee",symbol_native:"₨",decimal_digits:0,rounding:0,code:"PKR",name_plural:"Pakistani rupees"},PLN:{symbol:"zł",name:"Polish Zloty",symbol_native:"zł",decimal_digits:2,rounding:0,code:"PLN",name_plural:"Polish zlotys"},PYG:{symbol:"₲",name:"Paraguayan Guarani",symbol_native:"₲",decimal_digits:0,rounding:0,code:"PYG",name_plural:"Paraguayan guaranis"},QAR:{symbol:"QR",name:"Qatari Rial",symbol_native:"ر.ق.‏",decimal_digits:2,rounding:0,code:"QAR",name_plural:"Qatari rials"},RON:{symbol:"RON",name:"Romanian Leu",symbol_native:"RON",decimal_digits:2,rounding:0,code:"RON",name_plural:"Romanian lei"},RSD:{symbol:"din.",name:"Serbian Dinar",symbol_native:"дин.",decimal_digits:0,rounding:0,code:"RSD",name_plural:"Serbian dinars"},RUB:{symbol:"RUB",name:"Russian Ruble",symbol_native:"руб.",decimal_digits:2,rounding:0,code:"RUB",name_plural:"Russian rubles"},RWF:{symbol:"RWF",name:"Rwandan Franc",symbol_native:"FR",decimal_digits:0,rounding:0,code:"RWF",name_plural:"Rwandan francs"},SAR:{symbol:"SR",name:"Saudi Riyal",symbol_native:"ر.س.‏",decimal_digits:2,rounding:0,code:"SAR",name_plural:"Saudi riyals"},SDG:{symbol:"SDG",name:"Sudanese Pound",symbol_native:"SDG",decimal_digits:2,rounding:0,code:"SDG",name_plural:"Sudanese pounds"},SEK:{symbol:"Skr",name:"Swedish Krona",symbol_native:"kr",decimal_digits:2,rounding:0,code:"SEK",name_plural:"Swedish kronor"},SGD:{symbol:"S$",name:"Singapore Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"SGD",name_plural:"Singapore dollars"},SOS:{symbol:"Ssh",name:"Somali Shilling",symbol_native:"Ssh",decimal_digits:0,rounding:0,code:"SOS",name_plural:"Somali shillings"},SYP:{symbol:"SY£",name:"Syrian Pound",symbol_native:"ل.س.‏",decimal_digits:0,rounding:0,code:"SYP",name_plural:"Syrian pounds"},THB:{symbol:"฿",name:"Thai Baht",symbol_native:"฿",decimal_digits:2,rounding:0,code:"THB",name_plural:"Thai baht"},TND:{symbol:"DT",name:"Tunisian Dinar",symbol_native:"د.ت.‏",decimal_digits:3,rounding:0,code:"TND",name_plural:"Tunisian dinars"},TOP:{symbol:"T$",name:"Tongan Paʻanga",symbol_native:"T$",decimal_digits:2,rounding:0,code:"TOP",name_plural:"Tongan paʻanga"},TRY:{symbol:"TL",name:"Turkish Lira",symbol_native:"TL",decimal_digits:2,rounding:0,code:"TRY",name_plural:"Turkish Lira"},TTD:{symbol:"TT$",name:"Trinidad and Tobago Dollar",symbol_native:"$",decimal_digits:2,rounding:0,code:"TTD",name_plural:"Trinidad and Tobago dollars"},TWD:{symbol:"NT$",name:"New Taiwan Dollar",symbol_native:"NT$",decimal_digits:2,rounding:0,code:"TWD",name_plural:"New Taiwan dollars"},TZS:{symbol:"TSh",name:"Tanzanian Shilling",symbol_native:"TSh",decimal_digits:0,rounding:0,code:"TZS",name_plural:"Tanzanian shillings"},UAH:{symbol:"₴",name:"Ukrainian Hryvnia",symbol_native:"₴",decimal_digits:2,rounding:0,code:"UAH",name_plural:"Ukrainian hryvnias"},UGX:{symbol:"USh",name:"Ugandan Shilling",symbol_native:"USh",decimal_digits:0,rounding:0,code:"UGX",name_plural:"Ugandan shillings"},UYU:{symbol:"$U",name:"Uruguayan Peso",symbol_native:"$",decimal_digits:2,rounding:0,code:"UYU",name_plural:"Uruguayan pesos"},UZS:{symbol:"UZS",name:"Uzbekistan Som",symbol_native:"UZS",decimal_digits:0,rounding:0,code:"UZS",name_plural:"Uzbekistan som"},VEF:{symbol:"Bs.F.",name:"Venezuelan Bolívar",symbol_native:"Bs.F.",decimal_digits:2,rounding:0,code:"VEF",name_plural:"Venezuelan bolívars"},VND:{symbol:"₫",name:"Vietnamese Dong",symbol_native:"₫",decimal_digits:0,rounding:0,code:"VND",name_plural:"Vietnamese dong"},XAF:{symbol:"FCFA",name:"CFA Franc BEAC",symbol_native:"FCFA",decimal_digits:0,rounding:0,code:"XAF",name_plural:"CFA francs BEAC"},XOF:{symbol:"CFA",name:"CFA Franc BCEAO",symbol_native:"CFA",decimal_digits:0,rounding:0,code:"XOF",name_plural:"CFA francs BCEAO"},YER:{symbol:"YR",name:"Yemeni Rial",symbol_native:"ر.ي.‏",decimal_digits:0,rounding:0,code:"YER",name_plural:"Yemeni rials"},ZAR:{symbol:"R",name:"South African Rand",symbol_native:"R",decimal_digits:2,rounding:0,code:"ZAR",name_plural:"South African rand"},ZMK:{symbol:"ZK",name:"Zambian Kwacha",symbol_native:"ZK",decimal_digits:0,rounding:0,code:"ZMK",name_plural:"Zambian kwachas"}}),WM.module("wm.widgets.live").service("LiveWidgetUtils",["Utils","CONSTANTS","Variables",function(Utils,CONSTANTS,Variables){"use strict";function formatBooleanValue(value){return"true"===value?!0:"false"===value?!1:value}function getEventTypes(){return["onChange","onBlur","onFocus","onMouseleave","onMouseenter","onClick"]}function getDefaultValue(value,type){return Utils.isNumberType(type)?isNaN(Number(value))?null:Number(value):"boolean"===type?formatBooleanValue(value):value}function getFormButtons(){return[{key:"reset","class":"form-reset btn-secondary",iconclass:"glyphicon glyphicon-refresh",action:"reset()",displayName:"Reset",show:!0,type:"button",updateMode:!0},{key:"cancel","class":"form-cancel btn-secondary",iconclass:"glyphicon glyphicon-remove-circle",action:"cancel()",displayName:"Cancel",show:!0,type:"button",updateMode:!0},{key:"save","class":"form-save btn-success",iconclass:"glyphicon glyphicon-save",action:"",displayName:"Save",show:!0,type:"Submit",updateMode:!0},{key:"delete","class":"form-delete btn-secondary",iconclass:"glyphicon glyphicon-remove",action:"delete()",displayName:"Delete",show:!0,type:"button",updateMode:!1},{key:"edit","class":"form-update btn-secondary",iconclass:"glyphicon glyphicon-pencil",action:"edit()",displayName:"Edit",show:!0,type:"button",updateMode:!1},{key:"new","class":"form-new btn-success",iconclass:"glyphicon glyphicon-plus",action:"new()",displayName:"New",show:!0,type:"button",updateMode:!1}]}function getFormActions(getFlat){var actions={edit:["cancel()","reset()","save()","saveAndNew()"],view:["delete()","new()","edit()"]};return getFlat?actions.view.concat(["formSave()","formCancel()"]).concat(actions.edit):actions}function getGridActions(){return["addNewRow()","deleteRow()","editRow()"]}function getColumnDef(attrs){return{displayName:attrs.displayName||attrs.caption,show:"1"===attrs.show||"true"===attrs.show,type:attrs.type||"text",primaryKey:"true"===attrs.primaryKey||attrs.primaryKey===!0,generator:attrs.generator,readonly:"true"===attrs.readonly||attrs.readonly===!0,multiple:"true"===attrs.multiple||attrs.multiple===!0,datepattern:attrs.datepattern,"class":attrs["class"]||"",required:"true"===attrs.required||attrs.required===!0,placeholder:attrs.placeholder,maxValue:attrs.maxValue,minValue:attrs.minValue,maxvalue:attrs.maxvalue,step:attrs.step,onChange:attrs.onChange,onBlur:attrs.onBlur,onFocus:attrs.onFocus,onMouseleave:attrs.onMouseleave,onMouseenter:attrs.onMouseenter,onClick:attrs.onClick}}function getStepValue(type){return"text"===type?"":"float"===type?.01:"double"===type?.001:"integer"===type?1:void 0}function getCaptionByWidget(type,index){var caption="formFields["+index+"].value";return"password"===type?caption="********":("datetime"===type||"timestamp"===type?caption+=" | date:formFields["+index+"].datepattern || 'yyyy-MM-dd HH:mm:ss'":"time"===type?caption+=" | date:'HH:mm:ss'":"date"===type&&(caption+=" | date:formFields["+index+"].datepattern"),"select"===type?caption="formFields["+index+"].isRelated ? getDisplayExpr(formFields["+index+"].value, formFields["+index+"].displayvalue || formFields["+index+"].displayfield) : formFields["+index+"].value":"rating"===type&&(caption=""),"{{"+caption+"}}")}function getFormFields(fieldDef,index,type){var fields="",dateTypes=["date","datetime"],textTypes=["text","password","textarea"],excludeMaxValTypes=["rating"],eventTypes=getEventTypes();return Object.keys(fieldDef).forEach(function(field){fieldDef[field]&&("key"===field||"field"===field?fields+=' name="{{formFields['+index+"]."+field+'}}"':"displayvalue"===field?fields+=' displayexpression="{{formFields['+index+"]."+field+'}}"':"permitted"===field?fields+=' accept="{{formFields['+index+"]."+field+'}}"':"caption"===field||"type"===field||"show"===field||"placeholder"===field||"minPlaceholder"===field||"maxPlaceholder"===field||(!_.includes(dateTypes,type)||"minvalue"!==field&&"maxvalue"!==field?_.includes(textTypes,type)&&"maxvalue"===field?fields+=' maxchars="{{formFields['+index+"]."+field+'}}"':_.includes(eventTypes,field)?fields+=" "+Utils.hyphenate(field)+'="{{formFields['+index+"]."+field+'}}"':_.includes(excludeMaxValTypes,type)||(fields+=" "+field+'="{{formFields['+index+"]."+field+'}}"'):"minvalue"===field?fields+=' mindate="{{formFields['+index+"]."+field+'}}"':"maxvalue"===field&&(fields+=' maxdate="{{formFields['+index+"]."+field+'}}"')))}),fields}function dateTimeTemplate(fieldDef,index){var template="";return fieldDef.isRange?(fieldDef.minPlaceholder=fieldDef.minPlaceholder||"Select Min date time",fieldDef.maxPlaceholder=fieldDef.maxPlaceholder||"Select Max date time",template=template+'<div class="col-md-4 col-sm-4"><wm-datetime '+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].minValue" placeholder="{{formFields['+index+'].minPlaceholder}}" show="{{isUpdateMode}}" ></wm-datetime></div><div class="col-md-1 col-sm-1"></div><div class="col-md-4 col-sm-4"><wm-datetime '+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].maxValue" placeholder="{{formFields['+index+'].maxPlaceholder}}" show="{{isUpdateMode}}" ></wm-datetime></div>'):(fieldDef.placeholder=fieldDef.placeholder||"Select date time",template=template+"<wm-datetime "+getFormFields(fieldDef,index,"datetime")+' scopedatavalue="formFields['+index+'].value" placeholder="{{formFields['+index+'].placeholder}}" show="{{isUpdateMode}}" ></wm-datetime>'),template}function timeTemplate(fieldDef,index){var template="";return fieldDef.isRange?(fieldDef.minPlaceholder=fieldDef.minPlaceholder||"Select Min time",fieldDef.maxPlaceholder=fieldDef.maxPlaceholder||"Select Max time",template=template+'<div class="col-md-4 col-sm-4"><wm-time '+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].minValue" placeholder="{{formFields['+index+'].minPlaceholder}}" show="{{isUpdateMode}}"> </wm-time></div><div class="col-md-1 col-sm-1"></div><div class="col-md-4 col-sm-4"><wm-time '+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].maxValue" placeholder="{{formFields['+index+'].maxPlaceholder}}" show="{{isUpdateMode}}"> </wm-time></div>'):(fieldDef.placeholder=fieldDef.placeholder||"Select time",template=template+"<wm-time "+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].value" placeholder="{{formFields['+index+'].placeholder}}"  show="{{isUpdateMode}}"> </wm-time>'),template}function dateTemplate(fieldDef,index){var template="";return fieldDef.isRange?(fieldDef.minPlaceholder=fieldDef.minPlaceholder||"Select Min time",fieldDef.maxPlaceholder=fieldDef.maxPlaceholder||"Select Max time",template=template+'<div class="col-md-4 col-sm-4"><wm-date '+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].minValue" placeholder="{{formFields['+index+'].minPlaceholder}}"show="{{isUpdateMode}}"> </wm-date></div><div class="col-md-1 col-sm-1"></div><div class="col-md-4 col-sm-4"><wm-date '+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].maxValue" placeholder="{{formFields['+index+'].maxPlaceholder}}" show="{{isUpdateMode}}"></wm-date></div>'):(fieldDef.placeholder=fieldDef.placeholder||"Select date",template=template+"<wm-date "+getFormFields(fieldDef,index,"date")+' scopedatavalue="formFields['+index+'].value" placeholder="{{formFields['+index+'].placeholder}}"show="{{isUpdateMode}}"> </wm-date>'),template}function uploadTemplate(fieldDef,index){var template="";return template="image"===fieldDef.filetype?template+'<a class="col-md-8 col-sm-8 form-control-static" target="_blank" href="{{formFields['+index+'].href}}" data-ng-show="formFields['+index+"].value || formFields["+index+'].href"><img width="48px" height="28px" class="wm-icon wm-icon24 glyphicon glyphicon-file" src="{{formFields['+index+'].href}}"/></a>':template+'<a class="col-md-8 col-sm-8 form-control-static" target="_blank" href="{{formFields['+index+'].href}}" data-ng-show="formFields['+index+'].value != null"><i class="wm-icon wm-icon24 glyphicon glyphicon-file"></i></a>',template=template+"<input data-ng-class=\"{'form-control app-textbox': true, 'file-readonly': formFields["+index+'].readonly}" required="{{formFields['+index+'].required}}" type="file" name="{{formFields['+index+'].key}}" ng-required="{{formFields['+index+'].required}}" ng-readonly="{{formFields['+index+'].readonly}}" data-ng-show="isUpdateMode" data-ng-model="formFields['+index+'].value" accept="{{formFields['+index+'].permitted}}"/>'}function textareaTemplate(fieldDef,index){var template="";return fieldDef.placeholder=fieldDef.placeholder||"Enter value",template+="<wm-textarea"+getFormFields(fieldDef,index,"textarea")+'scopedatavalue="formFields['+index+'].value" show="{{isUpdateMode}}"></wm-textarea>'}function richtextTemplate(fieldDef,index){var template="";return template+="<wm-richtexteditor "+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].value" show="{{isUpdateMode}}"></wm-richtexteditor>'}function passwordTemplate(fieldDef,index){var template="";return fieldDef.placeholder=fieldDef.placeholder||"Enter value",template=template+"<wm-text "+getFormFields(fieldDef,index,"password")+' scopedatavalue="formFields['+index+'].value" show="{{isUpdateMode}}" type="password" ></wm-text>'}function sliderTemplate(fieldDef,index){var template="",stepVal=fieldDef.step||getStepValue(fieldDef.type);return template=template+"<wm-slider  "+getFormFields(fieldDef,index)+' show="{{isUpdateMode}}" scopedatavalue="formFields['+index+'].value"',stepVal&&(template=template+' step="'+stepVal+'" '),template+=" ></wm-slider>"}function radiosetTemplate(fieldDef,index){var template="";return template=template+"<wm-radioset "+getFormFields(fieldDef,index)+' scopedataset="formFields['+index+'].dataset" scopedatavalue="formFields['+index+'].value" dataset="" show="{{isUpdateMode}}" datafield="{{formFields['+index+'].datafield}}" displayfield="{{formFields['+index+'].displayfield}}" ></wm-radioset>'}function checkboxsetTemplate(fieldDef,index){var template="";return template=template+"<wm-checkboxset "+getFormFields(fieldDef,index)+' scopedataset="formFields['+index+'].dataset" scopedatavalue="formFields['+index+'].value" dataset="" show="{{isUpdateMode}}" datafield="{{formFields['+index+'].datafield}}" displayfield="{{formFields['+index+'].displayfield}}" ></wm-checkboxset>'}function checkboxTemplate(fieldDef,index,widgetType){var template="",addToggle="toggle"===widgetType?'type="toggle"':"";return template=template+"<wm-checkbox "+getFormFields(fieldDef,index)+addToggle+' scopedatavalue="formFields['+index+'].value" show="{{isUpdateMode}}" ></wm-checkbox>'}function selectTemplate(fieldDef,index){var template="";return fieldDef.isRange?(fieldDef.minPlaceholder=fieldDef.minPlaceholder||"Select Min Value",fieldDef.maxPlaceholder=fieldDef.maxPlaceholder||"Select Max Value",template=template+'<div class="col-md-4 col-sm-4"><wm-select '+getFormFields(fieldDef,index)+' scopedataset="formFields['+index+'].dataset" scopedatavalue="formFields['+index+'].minValue" placeholder="{{formFields['+index+'].minPlaceholder}}" show="{{isUpdateMode}}" datafield="{{formFields['+index+'].datafield}}" displayfield="{{formFields['+index+'].displayfield}}" ></wm-select></div><div class="col-md-1 col-sm-1"></div><div class="col-md-4 col-sm-4"><wm-select '+getFormFields(fieldDef,index)+' scopedataset="formFields['+index+'].dataset" scopedatavalue="formFields['+index+'].maxValue" placeholder="{{formFields['+index+'].maxPlaceholder}}" show="{{isUpdateMode}}" datafield="{{formFields['+index+'].datafield}}" displayfield="{{formFields['+index+'].displayfield}}" ></wm-select></div>'):(fieldDef.placeholder=fieldDef.placeholder||"Select value",template=template+"<wm-select "+getFormFields(fieldDef,index)+' scopedataset="formFields['+index+'].dataset" scopedatavalue="formFields['+index+'].value" placeholder="{{formFields['+index+'].placeholder}}" show="{{isUpdateMode}}" datafield="{{formFields['+index+'].datafield}}" displayfield="{{formFields['+index+'].displayfield}}"></wm-select>'),template}function textNumberTemplate(fieldDef,index,type){var stepVal,template="";return stepVal=fieldDef.step||getStepValue(fieldDef.type),fieldDef.isRange?(fieldDef.minPlaceholder=fieldDef.minPlaceholder||"Enter Min Value",fieldDef.maxPlaceholder=fieldDef.maxPlaceholder||"Enter Max Value",template=template+'<div class="col-md-4 col-sm-4"><wm-text '+getFormFields(fieldDef,index)+' scopedatavalue="'+(CONSTANTS.isRunMode?"formFields["+index+"].minValue":"")+'" type="'+type+'" '+(stepVal?' step="'+stepVal+'"':"")+' placeholder="{{formFields['+index+'].minPlaceholder}}" show="{{isUpdateMode}}"></wm-text></div><div class="col-md-1 col-sm-1"></div><div class="col-md-4 col-sm-4"><wm-text '+getFormFields(fieldDef,index)+' scopedatavalue="'+(CONSTANTS.isRunMode?"formFields["+index+"].maxValue":"")+'" type="'+type+'" '+(stepVal?' step="'+stepVal+'"':"")+' placeholder="{{formFields['+index+'].maxPlaceholder}}" show="{{isUpdateMode}}"></wm-text></div>'):(fieldDef.placeholder=fieldDef.placeholder||"Enter value",template=template+"<wm-text "+getFormFields(fieldDef,index,type)+' scopedatavalue="'+(CONSTANTS.isRunMode?"formFields["+index+"].value":"")+'" type="'+type+'" '+(stepVal?' step="'+stepVal+'"':"")+' placeholder="{{formFields['+index+'].placeholder}}" show="{{isUpdateMode}}"></wm-text>'),template}function ratingTemplate(fieldDef,index,liveType){var readonly,template="";return fieldDef.isRange?template=template+'<div class="col-md-4 col-sm-4"><wm-rating '+getFormFields(fieldDef,index,"rating")+' scopedatavalue="formFields['+index+'].minValue" maxvalue="{{formFields['+index+'].maxvalue}}" readonly="{{formFields['+index+'].readonly}}"></wm-rating></div><div class="col-md-4 col-sm-4"></div><div class="col-md-4 col-sm-4"><wm-rating'+getFormFields(fieldDef,index,"rating")+' scopedatavalue="formFields['+index+'].maxValue" maxvalue="{{formFields['+index+'].maxvalue}}" readonly="{{formFields['+index+'].readonly}}"></wm-rating></div>':(readonly="form"===liveType?"{{!isUpdateMode}}":"{{formFields["+index+"].readonly}}",template=template+"<wm-rating "+getFormFields(fieldDef,index,"rating")+' scopedatavalue="formFields['+index+'].value" maxvalue="{{formFields['+index+'].maxvalue}}" readonly="'+readonly+'"></wm-rating>'),template}function defaultTemplate(fieldDef,index){var template="";return template=fieldDef.isRange?template+'<div class="col-md-4 col-sm-4"><wm-text '+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].minValue" type="text" placeholder="{{formFields['+index+'].minPlaceholder}}" show="{{isUpdateMode}}"></wm-text></div><div class="col-md-4 col-sm-4"></div><div class="col-md-4 col-sm-4"><wm-text'+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].maxValue" type="text" placeholder="{{formFields['+index+'].maxPlaceholder}}" show="{{isUpdateMode}}"></wm-text></div>':template+"<wm-text "+getFormFields(fieldDef,index)+' scopedatavalue="formFields['+index+'].value" type="text" placeholder="{{formFields['+index+'].placeholder}}" show="{{isUpdateMode}}"></wm-text>'}function getTemplate(fieldDef,index,liveType){var fieldTypeWidgetTypeMap,widgetType,template="";switch("form"===liveType?(fieldDef.readonly&&"identity"===fieldDef.generator&&(fieldDef.placeholder=fieldDef.placeholder||""),fieldTypeWidgetTypeMap=Utils.getFieldTypeWidgetTypesMap(),widgetType=(fieldDef.widgetType||fieldTypeWidgetTypeMap[fieldDef.type][0]).toLowerCase()):"filter"===liveType&&(fieldDef.placeholder=fieldDef.minPlaceholder||"",widgetType=fieldDef.widget.toLowerCase()),template=template+'<wm-composite widget="'+widgetType+'" show="{{formFields['+index+'].show}}" class="live-field"><wm-label class="col-sm-3 col-xs-12" caption="{{formFields['+index+'].displayName}}" hint="{{formFields['+index+'].displayName}}" required="{{formFields['+index+'].required}}"></wm-label><div class="col-sm-9 col-xs-12 {{formFields['+index+'].class}}"><wm-label class="form-control-static" caption="'+getCaptionByWidget(widgetType,index)+'" show="{{!isUpdateMode}}"></wm-label>',
widgetType){case"number":case"text":template+=textNumberTemplate(fieldDef,index,widgetType);break;case"select":template+=selectTemplate(fieldDef,index);break;case"checkbox":case"toggle":template+=checkboxTemplate(fieldDef,index,widgetType);break;case"checkboxset":template+=checkboxsetTemplate(fieldDef,index);break;case"radioset":template+=radiosetTemplate(fieldDef,index);break;case"slider":template+=sliderTemplate(fieldDef,index);break;case"password":template+=passwordTemplate(fieldDef,index);break;case"richtext":template+=richtextTemplate(fieldDef,index);break;case"textarea":template+=textareaTemplate(fieldDef,index);break;case"upload":template+=uploadTemplate(fieldDef,index);break;case"date":template+=dateTemplate(fieldDef,index);break;case"time":template+=timeTemplate(fieldDef,index);break;case"datetime":case"timestamp":template+=dateTimeTemplate(fieldDef,index);break;case"rating":template+=ratingTemplate(fieldDef,index,liveType);break;default:template+=defaultTemplate(fieldDef,index)}return template+="</div></wm-composite>"}function getCustomItems(actions,definedActions){var customItems=[];return actions=actions&&actions.split(";"),WM.isArray(actions)&&actions.forEach(function(action){_.includes(definedActions,action)||(action=action.substring(0,action.indexOf("(")),customItems.push(action))}),customItems}function translateVariableObject(rawObject,scope){var translatedObj=[],columnArray=rawObject.propertiesMap.columns;return scope&&(scope.propertiesMap=rawObject.propertiesMap,scope.columnArray=scope.propertiesMap.columns,scope.primaryKey=scope.primaryKey||[]),columnArray.forEach(function(fieldObj,index){translatedObj[index]={displayName:Utils.prettifyLabel(fieldObj.fieldName),show:!0,primaryKey:fieldObj.isPrimaryKey,generator:fieldObj.generator,key:fieldObj.fieldName,value:"",type:fieldObj.isRelated?"list":fieldObj.fullyQualifiedType,maxvalue:"",isRelated:fieldObj.isRelated,readonly:fieldObj.isPrimaryKey,required:"true"===fieldObj.notNull||fieldObj.notNull===!0,relatedFieldName:fieldObj.columns&&fieldObj.columns[index]&&fieldObj.columns[index].fieldName},fieldObj.defaultValue&&(translatedObj[index].defaultValue=getDefaultValue(fieldObj.defaultValue,fieldObj.type)),("string"===fieldObj.type||"character"===fieldObj.type||"text"===fieldObj.type||"blob"===fieldObj.type||"clob"===fieldObj.type)&&(translatedObj[index].maxvalue=fieldObj.length),fieldObj.isPrimaryKey&&(scope&&scope.setPrimaryKey(fieldObj.fieldName),"assigned"===fieldObj.generator?translatedObj[index].readonly=!1:translatedObj[index].show=!1)}),translatedObj}function getColumnCountByLayoutType(layout){var layoutObj={"One Column":1,"Two Column":2,"Three Column":3,"Four Column":4};return layoutObj[layout]||1}function getEventOptions(){var eventsObject,eventsArray=["NoEvent","Javascript"].concat(Variables.retrieveEventCallbackVariables());return eventsObject=eventsArray.map(function(event){return{name:event,type:"Default"}})}function toggleActionMessage(selectedItem,actionsList,isField,eventType,value){return isField&&eventType?(selectedItem[eventType]=value,selectedItem.include&&!selectedItem.remove&&_.includes(selectedItem[eventType],"Javascript")):selectedItem.include&&!selectedItem.remove&&!_.includes(actionsList,selectedItem.action)}function getCustomFieldKey(fields,key,prefix){var index,keys=fields.map(function(event){return event[key]});if(keys&&_.includes(keys,prefix)){for(index=1;_.includes(keys,prefix+index);)index+=1;prefix+=index}return prefix}this.toggleActionMessage=toggleActionMessage,this.getEventOptions=getEventOptions,this.getEventTypes=getEventTypes,this.getDefaultValue=getDefaultValue,this.getFormButtons=getFormButtons,this.getGridActions=getGridActions,this.getCustomItems=getCustomItems,this.getColumnDef=getColumnDef,this.getTemplate=getTemplate,this.getFormActions=getFormActions,this.translateVariableObject=translateVariableObject,this.getColumnCountByLayoutType=getColumnCountByLayoutType,this.getCustomFieldKey=getCustomFieldKey,this.getStepValue=getStepValue}]),wm.modules.wmCommon=WM.module("wm.common",[]),wm.modules.wmCommon.controllers={},wm.modules.wmCommon.directives={},wm.modules.wmCommon.factories={},wm.modules.wmCommon.services={},wm.modules.wmCommon.providers={},wm.modules.wmCommon.services.$ocLazyLoad=WM.noop,wm.modules.wmCommon.controller(wm.modules.wmCommon.controllers),wm.modules.wmCommon.directive(wm.modules.wmCommon.directives),wm.modules.wmCommon.factory(wm.modules.wmCommon.factories),wm.modules.wmCommon.service(wm.modules.wmCommon.services),wm.modules.wmCommon.provider(wm.modules.wmCommon.providers),wm.modules.wmCommon.constant("SERVICE_TYPE_CONSTANTS",{JAVA_SERVICE:"JavaService",WM_JAVA_SERVICE:"wm.JavaService",JAVA_SERVICE_WORKSPACE_TYPE:"javaservice",DEFAULT_JAVA_SERVICE_NAME:"MyJavaService",JAVA_SERVICE_TREE_ROOT_NODE_ICON_CLASS:"java-service",SECURITY_SERVICE:"Security",SECURITY_SERVICE_CLASS:"security-service",SECURITY_SERVICE_WORKSPACE_TYPE:"securityservice",SECURITY_SERVICE_TYPE:"SecurityServiceType"}),wm.modules.wmCommon.constant("WM_COMMON_SERVICE_URLS",{Project_Run:{inplaceDeploy:{url:"services/projects/:projectId/deployment/inplaceDeploy",method:"POST"}},FILE_RUN:{read:{url:":filePath",method:"GET"}}}),wm.modules.wmCommon.config(function(BaseServiceManagerProvider,WM_COMMON_SERVICE_URLS){"use strict";BaseServiceManagerProvider.register(WM_COMMON_SERVICE_URLS)}),wm.modules.wmCommon.run(function(Utils,CONSTANTS){"use strict";CONSTANTS.isMobile=Utils.isMobile(),CONSTANTS.isIE=Utils.isIE(),CONSTANTS.isIE11=Utils.isIE11()}),wm.modules.wmCommon.providers.BaseServiceManager=function(){"use strict";function register(serviceConfig){WM.extend(baseServiceConfig,serviceConfig)}function getConfig(){return WM.copy(baseServiceConfig)}var baseServiceConfig={};this.getConfig=getConfig,this.register=register,this.$get=function(){return{getConfig:getConfig,register:register}}},wm.modules.wmCommon.services.BaseService=["$http","$rootScope","$injector","BaseServiceManager","DialogService","Utils","CONSTANTS","$q",function($http,$rootScope,$injector,BaseServiceManager,DialogService,Utils,CONSTANTS,$q){"use strict";var wmLogger,wmToaster,isUnAuthorized,localeObject,errorCallStack=[],logAction=function(type,message,description){if(wmLogger)switch(type){case"debug":wmLogger.debug(message,description);break;case"success":wmLogger.success(message,description);break;case"failure":wmLogger.error(message,description)}},getLocaleObject=function(){return $rootScope.locale||$rootScope.appLocale},displayMessage=function(type,messageTitle,messageDescription){if(wmToaster)switch(type){case"success":wmToaster.show("success",messageTitle,messageDescription);break;case"failure":wmToaster.show("error",messageTitle,messageDescription)}},parseReplace=function(serviceParams){var val,param,config=BaseServiceManager.getConfig(),urlParams=serviceParams.urlParams;if(config.hasOwnProperty(serviceParams.target)&&config[serviceParams.target].hasOwnProperty(serviceParams.action)){if(config=WM.copy(config[serviceParams.target][serviceParams.action]),serviceParams.config&&(config.url=(serviceParams.config.url||"")+config.url,config.method=serviceParams.config.method||config.method,config.headers=config.headers||{},WM.forEach(serviceParams.config.headers,function(val,key){config.headers[key]=val})),urlParams)for(param in urlParams)urlParams.hasOwnProperty(param)&&(val=urlParams[param],WM.isDefined(val)&&null!==val&&(config.url=config.url.replace(new RegExp(":"+param,"g"),val)));return config.url=Utils.preventCachingOf(config.url),serviceParams.params&&(config.params=serviceParams.params),serviceParams.data&&(config.data=serviceParams.data),serviceParams.dataParams&&(config.data.params=serviceParams.dataParams),serviceParams.headers&&(config.headers=serviceParams.headers),config.byPassResult=serviceParams.byPassResult,config}return null},parseError=function(errorDetails){var errMsg;return localeObject=localeObject||getLocaleObject(),localeObject&&localeObject[errorDetails.messageKey]?(errMsg=WM.copy(localeObject[errorDetails.messageKey]),errMsg=Utils.replace(errMsg,errorDetails.parameters)):errMsg=errorDetails.message||""},getHttpPromise=function(params){var config=params;return config.headers=config.headers||{},config.headers["X-Requested-With"]="XMLHttpRequest",params.hasOwnProperty("target")&&params.hasOwnProperty("action")&&(config=parseReplace(params)),$http(config)},successHandler=function(config,successCallback,response){var returnVal;return isUnAuthorized=!1,!config.byPassResult&&response.data.hasOwnProperty("result")?(Utils.triggerFn(successCallback,response.data.result),returnVal=response.data.result):(Utils.triggerFn(successCallback,response.data),returnVal=response.data),logAction("success","GOT_RESPONSE_FROM_SERVER",config.url),returnVal},failureHandler=function(config,successCallback,failureCallback,error){var errTitle,errMsg,errorDetails;return 401!==error.status||error.headers("X-WM-Login-ErrorMessage")?(isUnAuthorized=!1,403===error.status?(pushToErrorCallStack(config,successCallback,failureCallback),void displayMessage("failure",$rootScope.appLocale.LABEL_ACCESS_DENIED||"Access Denied",$rootScope.appLocale.LABEL_FORBIDDEN_MESSAGE||"The requested resource access/action is forbidden.")):(localeObject?(errTitle=localeObject.MESSAGE_ERROR_HTTP_ERROR_TITLE,errMsg=localeObject.MESSAGE_ERROR_HTTP_STATUS_ERROR_DESC):(errTitle="Error!",errMsg="Service call failed"),error.data&&error.data.errors&&(errMsg="",errorDetails=error.data.errors,errorDetails.error&&errorDetails.error.forEach(function(errorDetails){errMsg+=parseError(errorDetails)+"\n"})),error.headers("X-WM-Login-ErrorMessage")&&(errMsg=error.headers("X-WM-Login-ErrorMessage")),WM.isFunction(failureCallback)?Utils.triggerFn(failureCallback,errMsg,errorDetails):displayMessage("failure",errTitle,errMsg),logAction("failure","GOT_RESPONSE_FROM_SERVER",config.url+" as "+errMsg),error)):(pushToErrorCallStack(config,successCallback,failureCallback),void handleSessionTimeOut())},makeCall=function(config,successCallback,failureCallback){logAction("debug","SEND_REQUEST_TO_SERVER",config.url);var pattern=new RegExp("^services");CONSTANTS.isRunMode&&$rootScope.isMobileApplicationType&&pattern.test(config.url)&&(config.url=$rootScope.project.deployedUrl+"/"+config.url);var promiseObj,deferred=$q.defer();return config.timeout=deferred.promise,promiseObj=getHttpPromise(config).then(successHandler.bind(void 0,config,successCallback),failureHandler.bind(void 0,config,successCallback,failureCallback)),promiseObj.abort=function(){deferred.resolve()},promiseObj["finally"](function(){promiseObj.abort=WM.noop,deferred=promiseObj=null}),promiseObj},send=function(params,successCallback,failureCallback){var serviceSettings=parseReplace(params);return serviceSettings?makeCall(serviceSettings,successCallback,failureCallback):(localeObject=localeObject||getLocaleObject(),void displayMessage("failure",localeObject.MESSAGE_ERROR_HTTP_ERROR_TITLE,localeObject.MESSAGE_ERROR_HTTP_CONFIG_ERROR_DESC))},execute=function(params,successCallback,failureCallback){return params.hasOwnProperty("target")&&params.hasOwnProperty("action")?send(params,successCallback,failureCallback):void Utils.triggerFn(successCallback)},initializeDependencies=function(){try{$injector.get("wmLogger")&&(wmLogger=$injector.get("wmLogger"),wmLogger.compile($rootScope))}catch(exception){wmLogger&&wmLogger.error("EXCEPTION_CAUSED",["initializeDependencies in wmService.baseService",exception&&exception.message])}try{$injector.get("wmToaster")&&(wmToaster=$injector.get("wmToaster"),wmToaster.compile($rootScope))}catch(exception){wmLogger&&wmLogger.error("EXCEPTION_CAUSED",["initializeDependencies in wmService.baseService",exception&&exception.message])}},pushToErrorCallStack=function(config,success,failure){errorCallStack.push({config:config,success:success,failure:failure})},executeErrorCallStack=function(){errorCallStack.length&&(errorCallStack.forEach(function(call){call.config?makeCall(call.config,call.success,call.failure):Utils.triggerFn(call.success)}),errorCallStack.length=0)},handleSessionTimeOut=function(){if(!isUnAuthorized){var dialogId=CONSTANTS.isStudioMode?"sessionTimeOutDialog":"CommonLoginDialog";$rootScope.isStudioDisabled=!1,DialogService.closeAllDialogs(),DialogService.showDialog(dialogId,{resolve:{OnLogin:function(){return function(){executeErrorCallStack(),DialogService.hideDialog(dialogId)}}}}),isUnAuthorized=!0}};return initializeDependencies(),{execute:execute,send:send,getHttpPromise:getHttpPromise,pushToErrorCallStack:pushToErrorCallStack,executeErrorCallStack:executeErrorCallStack,handleSessionTimeOut:handleSessionTimeOut,parseError:parseError}}],wm.modules.wmCommon.services.FileService=function(BaseService,CONSTANTS){"use strict";var target=CONSTANTS.isRunMode?"FILE_RUN":"FILE";return{read:function(params,successCallback,failureCallback){var urlParams={filePath:params.path};CONSTANTS.isStudioMode&&(urlParams.projectID=params.projectID),BaseService.execute({target:target,action:"read",urlParams:urlParams},successCallback,failureCallback)}}},wm.modules.wmCommon.services.ProjectService=function(BaseService,CONSTANTS,$location){"use strict";function run(details,successCallback,failureCallback){var target=CONSTANTS.isRunMode?"Project_Run":"Project";BaseService.execute({target:target,action:"inplaceDeploy",urlParams:{projectId:details.projectId},config:details.config},successCallback,failureCallback)}function getDeployedUrl(){var locationUrl,lastIndex,projectDeployedUrl;return CONSTANTS.isRunMode?(locationUrl=$location.$$absUrl,lastIndex=locationUrl.split("#")[0].lastIndexOf("/"),projectDeployedUrl=locationUrl.substr(0,lastIndex),lastIndex=projectDeployedUrl.lastIndexOf("/"),"#"===projectDeployedUrl[lastIndex+1]&&(projectDeployedUrl=projectDeployedUrl.substr(0,lastIndex)),-1!==projectDeployedUrl.indexOf("http")&&(projectDeployedUrl=-1!==projectDeployedUrl.indexOf("https:")?projectDeployedUrl.substr(6):projectDeployedUrl.substr(5)),projectDeployedUrl):void 0}function getId(){return $location.$$absUrl.split("/")[3]}return{run:run,getDeployedUrl:getDeployedUrl,getId:getId}},WM.module("wm.prefabs").service("PrefabManager",["$rootScope","$timeout","$ocLazyLoad","PrefabService","ProjectService","Variables","Utils","wmToaster","CONSTANTS","i18nService","$q","$interval","DialogService","FileService",function($rootScope,$timeout,$ocLazyLoad,PrefabService,ProjectService,Variables,Utils,wmToaster,CONSTANTS,i18nService,$q,$interval,DialogService,FileService){"use strict";function getProjectId(){return projectDetails?projectDetails.id:(projectDetails=ProjectService.getDetails(),projectDetails&&projectDetails.id)}function onStudioPrefabsLoad(prefabs){prefabs.forEach(function(prefab){studioPrefabNamePropertiesMap[prefab.name]=prefab})}function listStudioPrefabs(){return studioPrefabNamePropertiesMap={},PrefabService.list().then(onStudioPrefabsLoad)}function onAppPrefabsLoad(prefabs){prefabs.forEach(function(prefab){appPrefabNamePropertiesMap[prefab.name]=prefab})}function listAppPrefabs(callback){appPrefabNamePropertiesMap={},Utils.fetchContent("json",Utils.preventCachingOf("services/projects/"+getProjectId()+"/prefabs"),function(response){onAppPrefabsLoad(response),Utils.triggerFn(callback)},function(){wmToaster.show("error",$rootScope.locale.MESSAGE_ERROR_TITLE,$rootScope.locale.MESSAGE_ERROR_PROJECT_PREFAB_LIST_FAILED_DESC)},!0)}function loadAppPrefabConfig(prefabName,callback){var configUrl,config;config=appPrefabNameConfigMap[prefabName],config?Utils.triggerFn(callback,config):(configUrl=CONSTANTS.isRunMode?"app/prefabs/"+prefabName+"/config.json":"services/projects/"+getProjectId()+"/resources/web/app/prefabs/"+prefabName+"/config.json",Utils.fetchContent("json",Utils.preventCachingOf(configUrl),function(response){appPrefabNameConfigMap[prefabName]=response,Utils.triggerFn(callback,response)},function(){wmToaster.show("error",$rootScope.locale.MESSAGE_PREFAB_CONFIG_ERROR_TITLE,$rootScope.locale.MESSAGE_PREFAB_CONFIG_ERROR_DESC)},!0))}function loadStudioPrefabConfig(prefabName){var configUrl,deferred=$q.defer();return configUrl="services/prefabs/"+studioPrefabNamePropertiesMap[prefabName].id+"/files/webapp/config.json",Utils.fetchContent("json",Utils.preventCachingOf(configUrl),function(response){studioPrefabNameConfigMap[prefabName]=response,deferred.resolve(response)},function(error){delete studioPrefabNamePropertiesMap[prefabName],delete studioPrefabNameConfigMap[prefabName],deferred.reject(error)}),deferred.promise}function getAllStudioPrefabsConfig(){function onConfigLoad(){if(count-=1,!count){var content=WM.copy(studioPrefabNamePropertiesMap);Object.keys(studioPrefabNameConfigMap).forEach(function(prefabName){content[prefabName].config=studioPrefabNameConfigMap[prefabName]}),deferred.resolve(content)}}var deferred=$q.defer(),prefabNames=Object.keys(studioPrefabNamePropertiesMap),count=prefabNames.length;return studioPrefabNameConfigMap={},prefabNames.forEach(function(prefabName){loadStudioPrefabConfig(prefabName)["finally"](onConfigLoad)}),deferred.promise}function isPrefabVersionMismatch(prefabName){return studioPrefabNamePropertiesMap[prefabName].version!==appPrefabNamePropertiesMap[prefabName].version}function doRegistration(prefabName,callback){PrefabService.register({projectId:getProjectId(),prefabId:studioPrefabNamePropertiesMap[prefabName].id},function(){appPrefabNamePropertiesMap[prefabName]=WM.copy(studioPrefabNamePropertiesMap[prefabName]),appPrefabNameConfigMap[prefabName]=studioPrefabNameConfigMap[prefabName],Utils.triggerFn(callback)},function(){wmToaster.show("error",$rootScope.locale.MESSAGE_ERROR_TITLE,$rootScope.locale.MESSAGE_ERROR_PREFAB_REGISTER_FAILED_DESC)})}function showPrefabUpgradeDialog(prefabName){DialogService.showDialog("upgradePrefabDialog",{resolve:{upgradeFn:function(){return function(){doRegistration(prefabName,function(){$rootScope.$emit("save-workspace",function(){window.location.reload()})})}},prefabName:function(){return prefabName}}})}function validateAndRegister(prefabName,callback){appPrefabNamePropertiesMap[prefabName]?isPrefabVersionMismatch(prefabName)?(showPrefabUpgradeDialog(prefabName),Utils.triggerFn(callback)):Utils.triggerFn(callback):doRegistration(prefabName,callback)}function registerPrefab(prefabName,callback){void 0===appPrefabNamePropertiesMap?listAppPrefabs(validateAndRegister.bind(void 0,prefabName,callback)):validateAndRegister(prefabName,callback)}function OnPrefabResourceLoad(count){this.count=count,this.updateCount=function(){this.count-=1},this.getCount=function(){return this.count}}function loadScripts(scripts){function onResourcesReady(){!obj.getCount()&&intervalHandler&&($interval.cancel(intervalHandler),intervalHandler=null,deferred.resolve())}var obj,intervalHandler,deferred=$q.defer(),rand=Date.now(),count=0,fnName="onPrefabResourceLoad"+rand;return scripts=scripts.map(function(script){return-1!==script.indexOf("onPrefabResourceLoad")&&(count+=1,script=script.replace("onPrefabResourceLoad",fnName)),script}),obj=new OnPrefabResourceLoad(count),window[fnName]=obj.updateCount.bind(obj),scripts&&scripts.length?Utils.loadScripts(scripts,function(){intervalHandler=$interval(onResourcesReady,50,10)}):deferred.resolve(),deferred.promise}function loadModules(modules){var deferred=$q.defer();return modules&&modules.length?$ocLazyLoad.load(modules).then(function(){$timeout(deferred.resolve,300,!1)}):deferred.resolve(),deferred.promise}function loadPrefabMinifiedPage(prefabName){var url,config=appPrefabNameConfigMap[prefabName],deferred=$q.defer();return url=config.templateUrl.substr(0,config.templateUrl.lastIndexOf("/")+1)+"page.min.html",FileService.read({path:"app/prefabs/"+prefabName+url,projectID:$rootScope.project.id},function(prefabContent){var pageDom=WM.element("<div>"+prefabContent+"</div>"),htmlMarkup=pageDom.find('script[id="Main.html"]').html()||"";WM.element("head").append(pageDom.find("style, script")),WM.forEach(window._MainPage_Variables_,function(variable){variable.prefabName=prefabName}),Variables.setPageVariables(prefabName,window._MainPage_Variables_),deferred.resolve(htmlMarkup)}),deferred.promise}function getPrefabResourceUrl(resourcePath,resourceBasePath,preventCache){var _url=resourcePath;return Utils.stringStartsWith(resourcePath,"http://|https://|//")||(_url=(resourceBasePath+_url).replace("//","/")),preventCache&&(_url=Utils.preventCachingOf(_url)),_url}function extendAppLocale(root){var localePath=root+(root.lastIndexOf("/")===root.length-1?"":"/")+"resources/i18n/";CONSTANTS.isRunMode?i18nService.loadComponentLocaleBundle(localePath):$rootScope.$emit("load-component-locale-bundle",localePath)}function loadDependencies(prefabName){var resources,resourcePath,scriptFiles,styleFiles,modules,handler,config=appPrefabNameConfigMap[prefabName],deferred=$q.defer();return config?(resources=config.resources||{},resourcePath=CONSTANTS.isRunMode?"app/prefabs/"+prefabName+"/":"services/projects/"+getProjectId()+"/resources/web/app/prefabs/"+prefabName+"/",pendingTasks.resources[prefabName]?handler=$rootScope.$on(prefabName+"-dependencies-ready",function(evt,prefabContent){evt.stopPropagation(),deferred.resolve(prefabContent),handler()}):(pendingTasks.resources[prefabName]=!0,scriptFiles=resources.scripts||[],styleFiles=resources.styles||[],modules=resources.modules||[],scriptFiles=scriptFiles.map(function(file){return getPrefabResourceUrl(file,resourcePath,!0)}),modules=modules.map(function(module){return module.files=module.files.map(function(file){return getPrefabResourceUrl(file,resourcePath,!0)}),module}),styleFiles=styleFiles.map(function(file){return Utils.stringEndsWith(file,"/pages/Main/Main.css")?void 0:getPrefabResourceUrl(file,resourcePath,!0)}).filter(function(file){return!!file}),Utils.loadStyleSheets(styleFiles),extendAppLocale(resourcePath),loadScripts(scriptFiles).then(loadModules.bind(void 0,modules)).then(loadPrefabMinifiedPage.bind(void 0,prefabName)).then(function(prefabContent){pendingTasks.resources[prefabName]=void 0,$rootScope.$emit(prefabName+"-dependencies-ready",prefabContent),deferred.resolve(prefabContent)})),deferred.promise):(deferred.reject(),deferred.promise)}function removePrefab(params){return PrefabService.remove(params)}function getConfig(success,error,reload){return activePrefabConfig&&!reload?void Utils.triggerFn(success,activePrefabConfig):($rootScope.reloadPrefabConfig=void 0,void FileService.read({projectID:$rootScope.project.id,path:"config.json"},function(response){activePrefabConfig=response,Utils.triggerFn(success,response)},function(response){Utils.triggerFn(error,response)}))}function setConfig(config,success,error){activePrefabConfig=config,FileService.write({projectID:$rootScope.project.id,path:"config.json",content:config},function(response){Utils.triggerFn(success,response)},function(response){Utils.triggerFn(error,response)})}var studioPrefabNamePropertiesMap,appPrefabNamePropertiesMap,activePrefabConfig,projectDetails,studioPrefabNameConfigMap={},appPrefabNameConfigMap={},pendingTasks={resources:{}};return{removePrefab:removePrefab,loadDependencies:loadDependencies,loadScripts:loadScripts,loadModules:loadModules,listStudioPrefabs:listStudioPrefabs,getAllStudioPrefabsConfig:getAllStudioPrefabsConfig,registerPrefab:registerPrefab,loadAppPrefabConfig:loadAppPrefabConfig,getConfig:getConfig,setConfig:setConfig}}]),wm.variables=WM.module("wm.variables",["base64"]),wm.variables.controllers={},wm.variables.services={},wm.variables.factories={},wm.variables.filters={},wm.variables.controller(wm.variables.controllers),wm.variables.service(wm.variables.services),wm.variables.factory(wm.variables.factories),wm.variables.filter(wm.variables.filters),wm.variables.constant("VARIABLE_CONSTANTS",{EVENTS:["onCanUpdate","onBeforeUpdate","onPrepareSetData","onResult","onSuccess","onError","onOk","onCancel","onClose","onTimerFire"],OWNER:{APP:"App",PAGE:"Page"},SERVICE_TYPE_JAVA:"JavaService",SERVICE_TYPE_REST:"RestService",SERVICE_TYPE_SOAP:"SoapService",SERVICE_TYPE_FEED:"FeedService",SERVICE_TYPE_DATA:"DataService",SERVICE_TYPE_SECURITY:"SecurityServiceType",SERVICE_NAME_FEED:"FeedService",REST_SUPPORTED_SERVICES:["JavaService","SoapService","FeedService","RestService","SecurityServiceType"]}),wm.variables.factories.BaseVariablePropertyFactory=["WIDGET_CONSTANTS","Utils",function(WIDGET_CONSTANTS,Utils){"use strict";function addNavigationOption(name,label){properties["wm.NavigationVariable"].operation.options[name]=label}function getPropertiesOf(variableCategory,parentCategories){var tempPropertiesObject,variablePropertiesObject={};return parentCategories?(parentCategories=WM.isArray(parentCategories)?parentCategories:[parentCategories],parentCategories.push(variableCategory),tempPropertiesObject={},WM.forEach(parentCategories,function(parent){WM.forEach(properties[parent],function(propObj,propName){tempPropertiesObject[propName]||(tempPropertiesObject[propName]={}),WM.forEach(propObj,function(value,key){tempPropertiesObject[propName][key]=value})})}),variablePropertiesObject.variableProps=tempPropertiesObject):variablePropertiesObject.variableProps=WM.copy(properties[variableCategory]),WM.forEach(variablePropertiesObject.variableProps,function(propObj,propName){variablePropertiesObject[propName]||(variablePropertiesObject[propName]=void 0===propObj.value?"":propObj.value)}),variablePropertiesObject}function register(category,properties,parentCategories,methods){variableMap[category]={},WM.extend(properties,getPropertiesOf(category,parentCategories)),variableMap[category].propertyMap=properties.variableProps,delete properties.variableProps,variableMap[category].properties=properties,variableMap[category].methods=methods}function getProperties(category){return variableMap[category]?WM.copy(variableMap[category].properties):{}}function getPropertyGroups(){return propertyGroups}function getPropertyMap(category){return variableMap[category]?variableMap[category].propertyMap:void 0}function invoke(method,variableType,variable,options,successCallBack,errorCallBack){return variableMap[variableType]?variableMap[variableType].methods[method](variable,options,successCallBack,errorCallBack):void Utils.triggerFn(errorCallBack,"variable is not valid")}var result,properties,propertyGroups,variableMap,variableEventOptions={},variableRegex="^[a-zA-Z_][A-Za-z0-9_-]+$";return WM.forEach(WM.copy(WIDGET_CONSTANTS.EVENTS_OPTIONS),function(event){variableEventOptions[event]=event}),result={properties:{"wm.Variable":{name:{type:"string",required:!0,pattern:variableRegex},type:{type:"list",options:{string:"LABEL_STRING","boolean":"LABEL_BOOLEAN",number:"LABEL_NUMBER",date:"LABEL_DATE",entry:"LABEL_ENTRY"},value:"string",required:!0},isList:{type:"boolean",value:!1},owner:{type:"list",options:{Page:"LABEL_PAGE",App:"LABEL_APPLICATION"},value:"Page"},editJson:{type:"json"},isBound:{type:"boolean"},dataSet:{type:"string",value:{dataValue:""},hide:!0},dataBinding:{type:"list",value:[{name:"dataSet",type:"object",fields:[{name:"dataValue",type:"string"}]}],hide:!0},saveInPhonegap:{type:"boolean",value:!1,hide:!0}},"wm.ServiceVariable":{isList:{hide:!0,required:!1},editJson:{hide:!0,required:!1},dataSet:{type:"string",value:{dataValue:""},hide:!0},type:{hide:!0,required:!1},firstRow:{type:"number",value:0,disabled:!0,hide:!0},maxResults:{type:"number",value:20,disabled:!0,hide:!0},designMaxResults:{type:"number",value:10,disabled:!0,hide:!0},service:{type:"list",required:!0},operation:{type:"list",required:!0},operationType:{type:"string",hide:!0},startUpdate:{type:"boolean",value:!1},autoUpdate:{type:"boolean",value:!0},inFlightBehavior:{type:"list",options:{doNotExecute:"doNotExecute",executeLast:"executeLast",executeAll:"executeAll"},value:"executeLast"},transformationRequired:{type:"boolean-labelfirst",value:!1},columnField:{type:"list",options:{},hide:!0},dataField:{type:"list",options:{},hide:!0},dataBinding:{type:"list",value:[{name:"dataBinding",type:"object",fields:[]}],hide:!0},onCanUpdate:{type:"list",options:variableEventOptions},onBeforeUpdate:{type:"list",options:variableEventOptions},onResult:{type:"list",options:variableEventOptions},onSuccess:{type:"list",options:variableEventOptions},onError:{type:"list",options:variableEventOptions}},"wm.LiveVariable":{service:{hide:!0,required:!1},editJson:{hide:!0},transformationRequired:{hide:!0},operation:{options:{read:"read",insert:"insert",update:"update","delete":"delete"},value:"read"},liveSource:{type:"list",required:!0},type:{hide:!1,options:{},required:!0},firstRow:{disabled:!1,hide:!1},maxResults:{disabled:!1,hide:!1},designMaxResults:{disabled:!1,hide:!1},ignoreCase:{type:"boolean",value:!1},matchMode:{type:"list",options:{start:"start",end:"end",anywhere:"anywhere",exact:"exact"},value:"start"},orderBy:{type:"string",placeholder:"e.g: 'field1,asc&field2,desc'"},autoUpdate:{value:!0},startUpdate:{value:!1},inFlightBehavior:{type:"list",options:{doNotExecute:"doNotExecute",executeLast:"executeLast",executeAll:"executeAll"},value:"executeLast"}},"wm.LoginVariable":{transformationRequired:{hide:!0},isList:{value:""},firstRow:{value:""},maxResults:{value:""},designMaxResults:{value:""},operation:{hide:!0,required:!1},service:{hide:!0,required:!1},dataSet:{value:{username:"",password:""}},dataBinding:{type:"list",value:[{name:"dataBinding",type:"object",fields:[{name:"username",type:"string"},{name:"password",type:"string"}]}],hide:!0},startUpdate:{value:!1},autoUpdate:{value:!1},useDefaultSuccessHandler:{type:"boolean",value:!0}},"wm.LogoutVariable":{transformationRequired:{hide:!0},isList:{value:""},firstRow:{value:""},maxResults:{value:""},designMaxResults:{value:""},operation:{hide:!0,required:!1},service:{hide:!0,required:!1},dataSet:{value:""},dataBinding:{value:""},startUpdate:{hide:!0,value:""},autoUpdate:{hide:!0,value:""},redirectTo:{type:"list",options:[],value:""},useDefaultSuccessHandler:{type:"boolean",value:!0}},"wm.NavigationVariable":{name:{type:"string",required:!0,pattern:variableRegex},owner:{type:"list",options:{Page:"LABEL_PAGE",App:"LABEL_APPLICATION"},value:"Page"},operation:{type:"list",options:{gotoPage:"gotoPage",gotoView:"gotoView",gotoTab:"gotoTab",gotoAccordion:"gotoAccordion"},value:"gotoPage"},pageName:{type:"string",required:!0,options:{},widgettype:"list"},viewName:{type:"string",options:{},widgettype:"list",hide:!0},tabName:{type:"string",options:{},widgettype:"list",hide:!0},accordionName:{type:"string",options:{},widgettype:"list",hide:!0},segmentName:{type:"string",options:{},widgettype:"list",hide:!0},dataBinding:{type:"string",value:{},hide:!0}},"wm.NotificationVariable":{name:{type:"string",required:!0,pattern:variableRegex},owner:{type:"list",options:{Page:"LABEL_PAGE",App:"LABEL_APPLICATION"},value:"Page"},operation:{type:"list",options:{alert:"alert",confirm:"confirm",toast:"toast"},value:"alert"},text:{type:"string"},okButtonText:{type:"string"},alerttype:{type:"list",options:{information:"information",success:"success",error:"error",warning:"warning"}},cancelButtonText:{type:"string",disabled:!0,hide:!0},onCancel:{type:"list",options:variableEventOptions,disabled:!0,hide:!0},onClose:{type:"list",options:variableEventOptions},onOk:{type:"list",options:variableEventOptions},duration:{type:"list",options:[0,1e3,2e3,3e3,4e3,5e3,6e3,7e3,8e3,9e3,1e4,15e3],hide:!0},"class":{type:"list",options:{Success:"Success",Error:"Error",Warning:"Warning",Info:"Info",Misc:"Misc"},hide:!0},toasterPosition:{type:"list",options:{"top left":"top left","top center":"top center","top right":"top right","center left":"center left","center center":"center center","center right":"center right","bottom left":"bottom left","bottom center":"bottom center","bottom right":"bottom right"},hide:!0},dataBinding:{type:"string",value:{},hide:!0}},"wm.TimerVariable":{name:{type:"string",required:!0,pattern:variableRegex},owner:{type:"list",options:{Page:"LABEL_PAGE",App:"LABEL_APPLICATION"},value:"Page"},autoStart:{type:"boolean",value:!1},repeating:{type:"boolean",
value:!1},delay:{type:"number",value:500},onTimerFire:{type:"list",options:variableEventOptions}},"wm.DeviceVariable":{name:{type:"string",required:!0,pattern:variableRegex},owner:{type:"list",options:{Page:"LABEL_PAGE",App:"LABEL_APPLICATION"},value:"Page"},dataSet:{type:"string",value:{dataValue:""},hide:!0},dataBinding:{type:"object",value:{},hide:!0},service:{type:"list",options:[]},operation:{type:"list",hide:!0,options:[]},startUpdate:{type:"boolean",value:!1,hide:!0},eventTitle:{type:"string",dataBinding:!0,hide:!0},eventNotes:{type:"string",dataBinding:!0,hide:!0},eventLocation:{type:"string",dataBinding:!0,hide:!0},eventStart:{type:"string",dataBinding:!0,hide:!0},eventEnd:{type:"string",dataBinding:!0,hide:!0},recurringEvent:{type:"boolean",dataBinding:!0,hide:!0},recurringEventFrequency:{type:"string",dataBinding:!0,hide:!0},imageQuality:{type:"number",value:80,hide:!0},imageEncodingType:{type:"list",options:{0:"JPEG",1:"PNG"},value:"0",hide:!0},allowImageEdit:{type:"boolean",value:!1,hide:!0},correctOrientation:{type:"boolean",value:!0,hide:!0},saveToPhotoAlbum:{type:"boolean",value:!1,hide:!0},geolocationHighAccuracy:{type:"boolean",value:!0,hide:!0},geolocationMaximumAge:{type:"number",value:3,hide:!0},geolocationTimeout:{type:"number",value:5,hide:!0},contactFilter:{type:"string",dataBinding:!0,value:"",hide:!0},localFile:{type:"string",dataBinding:!0,value:"",hide:!0},remoteFolder:{type:"string",dataBinding:!0,value:"",hide:!0},onSuccess:{type:"list",options:variableEventOptions},onError:{type:"list",options:variableEventOptions},vibrationtime:{type:"number",value:2,hide:!0}}},propertyGroups:[{name:"properties",parent:""},{name:"data",parent:""},{name:"events",parent:""},{properties:["liveSource","type","isList"],parent:"properties"},{name:"service",properties:["service","operation"],parent:"properties"},{name:"serveroptions",properties:["downloadFile","matchMode","firstRow","maxResults","designMaxResults","orderBy","ignoreCase"],parent:"properties"},{name:"behavior",properties:["useDefaultSuccessHandler","clearDataOnLogout","autoUpdate","startUpdate","inFlightBehavior","loadingDialog","saveInCookie","refireOnDbChange","redirectTo","autoStart","delay","repeating"],parent:"properties"},{name:"mobile",properties:["saveInPhonegap"],parent:"properties"},{name:"json",properties:["editJson"],parent:"properties"},{name:"Inputs",properties:["pageName","viewName","tabName","accordionName","segmentName","dataBinding"],parent:"properties"},{name:"Inputs",properties:["text","duration","class","toasterPosition","okButtonText","cancelButtonText","alerttype","dataBinding","eventTitle","eventNotes","eventLocation","eventStart","eventEnd","recurringEvent","recurringEventFrequency","allowImageEdit","imageEncodingType","imageQuality","correctOrientation","saveToPhotoAlbum","geolocationMaximumAge","geolocationTimeout","geolocationHighAccuracy","contactFilter","localFile","remoteFolder","vibrationtime"],parent:"data"},{name:"inputfields",properties:["dataSet","dataBinding"],parent:"data"},{name:"filterfields",properties:["dataSet"],parent:"data"},{name:"bindings",properties:[],parent:"data"},{name:"dataTransformation",properties:["transformationRequired","columnField","dataField"],parent:"data"},{properties:["onCanUpdate","onBeforeUpdate","onResult","onSuccess","onError","onPrepareSetData","onOk","onCancel","onClose","onTimerFire"],parent:"events"}]},properties=result.properties,propertyGroups=result.propertyGroups,variableMap={},{addNavigationOption:addNavigationOption,getPropertiesOf:getPropertiesOf,register:register,getProperties:getProperties,getPropertyGroups:getPropertyGroups,getPropertyMap:getPropertyMap,invoke:invoke}}],wm.variables.services.Variables=["$rootScope","BaseVariablePropertyFactory","ProjectService","FileService","CONSTANTS","VARIABLE_CONSTANTS","DialogService","$timeout","Utils",function($rootScope,BaseVariablePropertyFactory,ProjectService,FileService,CONSTANTS,VARIABLE_CONSTANTS,DialogService,$timeout,Utils){"use strict";var returnObject,activeScope,activePage,runMode=CONSTANTS.isRunMode,variableConfig=[{collectionType:"call",category:"wm.NavigationVariable",labelKey:"LABEL_VARIABLE_NAVIGATION",defaultName:"navigationVariable"},{collectionType:"call",category:"wm.NotificationVariable",labelKey:"LABEL_VARIABLE_NOTIFICATION",defaultName:"notificationVariable"},{collectionType:"data",category:"wm.Variable",labelKey:"LABEL_VARIABLE_BASIC",defaultName:"staticVariable"},{collectionType:"data",category:"wm.ServiceVariable",labelKey:"LABEL_VARIABLE_SERVICE",defaultName:"serviceVariable"},{collectionType:"data",category:"wm.LiveVariable",labelKey:"LABEL_VARIABLE_LIVE",defaultName:"liveVariable"},{collectionType:"data",category:"wm.TimerVariable",labelKey:"LABEL_VARIABLE_TIMER",defaultName:"timerVariable"},{collectionType:"data",category:"wm.LoginVariable",labelKey:"LABEL_VARIABLE_LOGIN",defaultName:"loginVariable",appOnly:!0},{collectionType:"data",category:"wm.LogoutVariable",labelKey:"LABEL_VARIABLE_LOGOUT",defaultName:"logoutVariable",appOnly:!0}],variableCategoryToNameMap={},self=this,pageScopeMap={},watchers={},initVariableNameMap=function(){variableCategoryToNameMap={},variableConfig.forEach(function(variable){variableCategoryToNameMap[variable.category]=variable.defaultName})},resetVariableNameIterator=function(){self.variableNameIterator={},Object.keys(variableCategoryToNameMap).forEach(function(category){self.variableNameIterator[category]=1})},resetVariables=function(newVariablesObject){self.variableCollection=newVariablesObject||self.variableCollection,newVariablesObject||resetVariableNameIterator()},bindVariableField=function(props){var bindingVal=props.bindingVal,param=props.paramName,variable=props.variable,variableName=props.variableName,variableScope=props.scope||{};Utils.stringStartsWith(bindingVal,"bind:")?watchers[variableScope.$id][variableName].push(variableScope.$watch(bindingVal.replace("bind:",""),function(newVal,oldVal){newVal===oldVal&&WM.isUndefined(newVal)||WM.isUndefined(newVal)&&!WM.isUndefined(oldVal)||("wm.Variable"===variable.category?variable.dataSet[param]=newVal:"wm.ServiceVariable"===variable.category?(props.parentNode?variable.dataBinding[props.parentNode][param]=newVal:variable.dataBinding[param]=newVal,variable.autoUpdate&&!WM.isUndefined(newVal)&&variable.update()):"wm.LiveVariable"===variable.category?"read"===variable.operation?(variable.filterFields[param]={value:newVal},variable.autoUpdate&&!WM.isUndefined(newVal)&&variable.update()):(variable.inputFields[param]=newVal,variable.autoUpdate&&!WM.isUndefined(newVal)&&variable[variable.operation+"Record"]()):"wm.NotificationVariable"===variable.category||"wm.NavigationVariable"===variable.category?variable.dataBinding[param]=newVal:"wm.LoginVariable"===variable.category?(variable.dataBinding[param]=newVal,variable.autoUpdate&&!WM.isUndefined(newVal)&&variable.login()):"wm.DeviceVariable"===variable.category&&(variable[param]=newVal))})):"wm.LiveVariable"===variable.category?"read"===variable.operation?variable.filterFields[param]={value:bindingVal}:variable.inputFields[param]=bindingVal:"wm.Variable"===variable.category?variable.dataBinding[param]&&(variable.dataSet[param]=variable.dataSet[param]||variable.dataBinding[param]):"wm.DeviceVariable"===variable.category&&(variable[param]=bindingVal)},processVariablePostBindUpdate=function(nodeName,nodeVal,variable){"wm.LiveVariable"===variable.category?"read"===variable.operation?(variable.filterFields[nodeName]={value:nodeVal},variable.autoUpdate&&!WM.isUndefined(nodeVal)&&variable.update()):(variable.inputFields[nodeName]=nodeVal,variable.autoUpdate&&!WM.isUndefined(nodeVal)&&variable[variable.operation+"Record"]()):"wm.ServiceVariable"===variable.category?variable.autoUpdate&&!WM.isUndefined(nodeVal)&&variable.update():"wm.LoginVariable"===variable.category&&variable.autoUpdate&&!WM.isUndefined(nodeVal)&&variable.login()},processBindNode=function(node,parentNode,scope,variable){Utils.stringStartsWith(node.value,"bind:")?scope.$watch(node.value.replace("bind:",""),function(newVal,oldVal){newVal===oldVal&&WM.isUndefined(newVal)||!(!WM.isUndefined(newVal)||WM.isUndefined(oldVal)&&WM.isUndefined(parentNode[node.name]))||(parentNode[node.name]=newVal,processVariablePostBindUpdate(node.name,newVal,variable))},!0):(WM.isDefined(node.value)&&(parentNode[node.name]=node.value,"wm.LiveVariable"===variable.category&&("read"===variable.operation?variable.filterFields[node.name]={value:node.value}:variable.inputFields[node.name]=node.value)),node.fields&&node.fields.length&&(parentNode[node.name]=WM.isObject(parentNode[node.name])?parentNode[node.name]:{},WM.forEach(node.fields,function(field){processBindNode(field,parentNode[node.name],scope,variable)})))},updateVariableBinding=function(variable,name,scope){if(watchers[scope.$id][name]=watchers[scope.$id][name]||[],watchers[scope.$id][name].forEach(Utils.triggerFn),WM.isArray(variable.dataBinding)){var bindMap=variable.dataBinding;variable.dataBinding={},bindMap.forEach(function(node){processBindNode(node,variable,scope,variable)})}else WM.forEach(variable.dataBinding,function(binding,param){"object"==typeof binding&&"wm.ServiceVariable"===variable.category&&WM.forEach(binding,function(subParamBinding,subParam){bindVariableField({bindingVal:subParamBinding,paramName:subParam,variable:variable,variableName:name,parentNode:param,scope:scope})}),bindVariableField({bindingVal:binding,paramName:param,variable:variable,variableName:name,scope:scope})})},updateContextVariables=function(context,scope){$rootScope.variables=$rootScope.variables||{},self.studioCopy[context]={},scope=scope||pageScopeMap[context]||{},watchers[scope.$id]={},self.variableCollection[scope.$id]=WM.copy(self.variableCollection[context])||{},scope.Variables=self.variableCollection[scope.$id],CONSTANTS.isStudioMode&&context!==VARIABLE_CONSTANTS.OWNER.APP&&(scope.Variables.hasOwnProperty(name)||WM.forEach(self.variableCollection[$rootScope.$id],function(variable,name){Object.defineProperty(scope.Variables,name,{configurable:!0,get:function(){return variable}})})),WM.forEach(self.variableCollection[scope.$id],function(variable,name){if(variable.name=name,runMode?variable.activeScope=scope:self.studioCopy[context][name]=variable,updateVariableBinding(variable,name,scope),"wm.Variable"===variable.category){if($rootScope.variables[name]=variable.dataSet.dataValue,CONSTANTS.isRunMode&&variable.isList&&1===variable.dataSet.length){var obj=variable.dataSet[0],keys=Object.keys(obj),isValueEmpty=function(val){return""===obj[val]||WM.isObject(obj[val])};keys.every(isValueEmpty)&&(variable.dataSet=[])}}else"wm.ServiceVariable"===variable.category?(!runMode||variable.startUpdate)&&$timeout(function(){variable.update()},null,!1):"wm.LiveVariable"===variable.category?($rootScope.variables[name]=$rootScope.variables[name]||{},variable.startUpdate?runMode&&"read"!==variable.operation?$timeout(function(){variable[variable.operation+"Record"]()},null,!1):$timeout(function(){variable.update()},null,!1):runMode||$timeout(function(){variable.update({skipFetchData:!0})},null,!1)):"wm.LoginVariable"===variable.category?runMode&&variable.startUpdate&&$timeout(function(){variable.login()},null,!1):"wm.TimerVariable"===variable.category?runMode&&variable.autoStart&&$timeout(function(){variable.fire()},null,!1):"wm.DeviceVariable"===variable.category&&runMode&&variable.startUpdate&&$timeout(function(){variable.invoke()},null,!1)})},updateVariableValues=function(activePageName,isUpdatePageVariables){isUpdatePageVariables||updateContextVariables(VARIABLE_CONSTANTS.OWNER.APP),activePageName&&updateContextVariables(activePageName)},writeFile=function(params,success,error){FileService.write({projectID:$rootScope.project.id,path:params.path,content:"object"==typeof params.content?JSON.stringify(params.content,null,"	"):params.content},function(){Utils.triggerFn(success)},function(){Utils.triggerFn(error,$rootScope.locale.MESSAGE_ERROR_SAVE_FILE_DESC)})},setPageVariables=function(pageName,pageVariables){self.variableCollection=self.variableCollection||{},self.variableCollection[pageName]=pageVariables||{}},getPageVariables=function(pageName,success,error){var params;return null!==self.variableCollection&&self.variableCollection[pageName]?void Utils.triggerFn(success,self.variableCollection[pageName]):(params={path:"pages/"+pageName+"/"+pageName+".variables.json"},runMode||(params.projectID=$rootScope.project.id),void FileService.read(params,function(variables){WM.isObject(variables)||(variables={}),setPageVariables(pageName,variables),Utils.triggerFn(success,variables)},function(errMsg){setPageVariables(pageName,void 0),Utils.triggerFn(error,errMsg)}))},getAppVariables=function(success,error){if(null!==self.variableCollection&&self.variableCollection[VARIABLE_CONSTANTS.OWNER.APP])return void Utils.triggerFn(success,self.variableCollection[VARIABLE_CONSTANTS.OWNER.APP]);var requestParams={path:"app.variables.json"};runMode||(requestParams.projectID=$rootScope.project.id),FileService.read(requestParams,function(variables){WM.isObject(variables)||(variables={}),Utils.triggerFn(success,variables,!0)},function(errMsg){Utils.triggerFn(error,errMsg)})},extendVariables=function(variables){return WM.forEach(variables,function(variable,name){variables[name]=WM.extend(BaseVariablePropertyFactory.getProperties(variable.category),variable)}),variables},initAppVariables=function(scope,success,error){self.variableCollection=self.variableCollection||{},getAppVariables(function(appVariables,freshVariables){"object"!=typeof appVariables&&(appVariables={}),freshVariables&&(appVariables=extendVariables(appVariables),self.variableCollection[VARIABLE_CONSTANTS.OWNER.APP]=appVariables,pageScopeMap[VARIABLE_CONSTANTS.OWNER.APP]=$rootScope,updateContextVariables(VARIABLE_CONSTANTS.OWNER.APP,$rootScope),$rootScope.$emit("on-app-variables-ready",appVariables)),Utils.triggerFn(success,appVariables)},function(errMsg){self.variableCollection[VARIABLE_CONSTANTS.OWNER.APP]={},pageScopeMap[VARIABLE_CONSTANTS.OWNER.APP]=$rootScope,Utils.triggerFn(error,errMsg)})},initPageVariables=function(pageName,scope,options){options=options||{},options.updateAppVariables=options.updateAppVariables||!1,activeScope=scope,activePage=pageName,self.variableCollection=self.variableCollection||{},getPageVariables(activePage,function(pageVariables){"object"!=typeof pageVariables&&(pageVariables={}),pageVariables=extendVariables(pageVariables),self.variableCollection[activePage]=pageVariables,updateVariableValues(activePage,!options.updateAppVariables),$rootScope.$emit("on-"+activePage+"-variables-ready",pageVariables),Utils.triggerFn(options.success,self.variableCollection)},function(errMsg){self.variableCollection[activePage]={},Utils.triggerFn(options.error,errMsg)})},initVariableCollection=function(activeWorkspaceName,scope,success,error,isUpdatePageVariables){activeScope=scope,activePage=activeWorkspaceName,self.variableCollection=self.variableCollection||{},getAppVariables(activePage,function(appVariables,freshVariables){"object"!=typeof appVariables&&(appVariables={}),appVariables=extendVariables(appVariables),self.variableCollection[VARIABLE_CONSTANTS.OWNER.APP]=appVariables,freshVariables&&$rootScope.$emit("on-app-variables-ready",appVariables),getPageVariables(activeWorkspaceName,function(pageVariables){"object"!=typeof pageVariables&&(pageVariables={}),pageVariables=extendVariables(pageVariables),self.variableCollection[activeWorkspaceName]=pageVariables,updateVariableValues(activeWorkspaceName,isUpdatePageVariables),$rootScope.$emit("on-"+activeWorkspaceName+"-variables-ready",pageVariables),Utils.triggerFn(success,self.variableCollection)},function(errMsg){self.variableCollection[activeWorkspaceName]={},Utils.triggerFn(error,errMsg)})},function(errMsg){self.variableCollection[VARIABLE_CONSTANTS.OWNER.APP]={},Utils.triggerFn(error,errMsg)})},getVariableByName=function(variableName,scope){var scopes,i,n,variables=self.variableCollection;if(scope)return variables[scope.$id]&&variables[scope.$id][variableName]||self.variableCollection[$rootScope.$id][variableName];if(CONSTANTS.isRunMode){if(scope=pageScopeMap[$rootScope.activePageName],scope&&variables[scope.$id][variableName])return variables[scope.$id][variableName];if(scope=pageScopeMap[VARIABLE_CONSTANTS.OWNER.APP],scope&&variables[scope.$id][variableName])return variables[scope.$id][variableName];for(i=0,scopes=Object.keys(variables),n=scopes.length;n>i;i+=1)if(scope=scopes[i],variables[scopes[i]][variableName])return variables[scopes[i]][variableName]}return variables[$rootScope.activePageName]&&variables[$rootScope.activePageName][variableName]||variables[VARIABLE_CONSTANTS.OWNER.APP]&&variables[VARIABLE_CONSTANTS.OWNER.APP][variableName]||null},getType=function(name){return getVariableByName(name)&&getVariableByName(name).category},getVariableCategoryList=function(collectionType,getKeysList){var categoryList={},isPrefabProject=$rootScope.isPrefabTemplate,filteredVariables=[];return isPrefabProject?variableConfig.forEach(function(variable){variable.appOnly||collectionType&&"all"!==collectionType.toLowerCase()&&variable.collectionType!==collectionType||filteredVariables.push(variable)}):variableConfig.forEach(function(variable){collectionType&&"all"!==collectionType.toLowerCase()&&variable.collectionType!==collectionType||filteredVariables.push(variable)}),_.forEach(_.sortBy(filteredVariables,"defaultName"),function(variable){categoryList[variable.category]=variable.labelKey}),getKeysList&&(categoryList=Object.keys(categoryList)),categoryList},isExists=function(variableName,caseSensitive){var item,variables=self.variableCollection,arrOfVariables=[],iter=0;if(variables[VARIABLE_CONSTANTS.OWNER.APP])for(item in variables[VARIABLE_CONSTANTS.OWNER.APP])arrOfVariables[iter++]=item;if(variables[$rootScope.activePageName])for(item in variables[$rootScope.activePageName])arrOfVariables[iter++]=item;return Utils.isDuplicateName(arrOfVariables,variableName,caseSensitive)},call=function(method,name,options,success,error){if(options=options||{},!name||!method)return void Utils.triggerFn(error);var variable=getVariableByName(name,options.scope),type=variable.category;return BaseVariablePropertyFactory.invoke(method,type,variable,options,function(data,propertiesMap,relatedData,pagingOptions){Utils.triggerFn(success,data,propertiesMap,relatedData,pagingOptions)},error)},updateVariableDataSet=function(name,data,propertiesMap,relatedData,pagingOptions){if(returnObject[name]){if(!WM.isObject(data)){var temp=data;data={},data.value=temp}propertiesMap?returnObject[name].dataSet={data:data,propertiesMap:propertiesMap,relatedData:relatedData,pagingOptions:pagingOptions}:returnObject[name].dataSet=data}},generateUniqueName=function(category,name,overWrite){var defaultName;return defaultName=name?name:variableCategoryToNameMap[category]+self.variableNameIterator[category],!isExists(defaultName,!0)||overWrite?defaultName:(self.variableNameIterator[category]+=1,generateUniqueName(category))},register=function(nameSpace,variables,loadValuesInStudio,scope){variables=extendVariables(variables),pageScopeMap[nameSpace]=scope,self.variableCollection=self.variableCollection||{},self.variableCollection[nameSpace]=variables,(loadValuesInStudio||runMode)&&(updateContextVariables(nameSpace,scope),$rootScope.$emit("on-"+nameSpace+"-variables-ready",variables))},isEventCallbackVariable=function(category){var retVal=!1;return"wm.Variable"!==category&&(retVal=!0),retVal},retrieveEventCallbackVariables=function(variableName){var key,index,contextVariables,currentVariable,variableArray=[],varCollection=self.variableCollection;for(key in varCollection){contextVariables=varCollection[key];for(index in contextVariables)currentVariable=contextVariables[index],variableName?index!==variableName&&isEventCallbackVariable(currentVariable.category)&&variableArray.push(index):isEventCallbackVariable(currentVariable.category)&&variableArray.push(index)}return _.uniq(variableArray)},saveContextVariables=function(context,contextVariables){var variables=self.variableCollection;variables[context]=contextVariables},filterVariables=function(variables){return WM.forEach(variables,function(variable){WM.forEach(variable,function(propertyValue,propertyName){(""===propertyValue||void 0===propertyValue)&&delete variable[propertyName]})}),variables},create=function(type,options,name,overWrite){type=type||"wm.Variable";var variableObj={},defaultName="";return options=WM.isObject(options)?options:{},defaultName=name?generateUniqueName(type,name,overWrite):generateUniqueName(type),WM.extend(variableObj,BaseVariablePropertyFactory.getProperties(type),{name:defaultName},options),variableObj},store=function(owner,name,variableObj,variableCollectionObject,isUpdate){if(variableObj){var scope,varCollectionObj=variableCollectionObject||self.variableCollection;owner=owner||VARIABLE_CONSTANTS.OWNER.APP,scope=pageScopeMap[owner],varCollectionObj.hasOwnProperty(owner)&&varCollectionObj[owner]||(varCollectionObj[owner]={}),variableObj._id="wm-"+name+"-"+variableObj.category+"-"+(new Date).getTime(),varCollectionObj[owner][name]=variableObj,varCollectionObj[scope.$id][name]=WM.copy(variableObj),varCollectionObj[scope.$id][name].name=name,self.studioCopy[owner][name]=varCollectionObj[scope.$id][name],owner===VARIABLE_CONSTANTS.OWNER.APP&&Object.defineProperty(pageScopeMap[$rootScope.activePageName].Variables,name,{configurable:!0,get:function(){return varCollectionObj[scope.$id][name]}}),isUpdate&&call("getData",name,{scope:scope,skipFetchData:!0})}},initiateCallback=function(event,variable,callBackScope,response){var eventValues=variable[event];callBackScope=variable.activeScope,eventValues&&_.forEach(eventValues.split(";"),function(eventValue){return"Javascript"===eventValue?Utils.triggerFn(callBackScope[variable.name+event],variable,response):_.includes(eventValue,".show")?void DialogService.showDialog(eventValue.slice(0,eventValue.indexOf(".show"))):_.includes(eventValue,".hide")?void DialogService.hideDialog(eventValue.slice(0,eventValue.indexOf(".hide"))):_.includes(eventValue,"(")?Utils.triggerFn(callBackScope[eventValue.substring(0,eventValue.indexOf("("))],variable,response):void $timeout(function(){$rootScope.$emit("invoke-service",eventValue,{scope:callBackScope}),$rootScope.$safeApply(callBackScope)},null,!1)})},unload=function(namespace,scope){namespace&&(self.variableCollection=self.variableCollection||{},watchers[scope.$id]&&WM.forEach(self.variableCollection[namespace],function(variable,name){watchers[scope.$id][name]&&watchers[scope.$id][name].forEach(Utils.triggerFn)}),delete self.variableCollection[namespace],delete self.variableCollection[scope.$id])},processRequestQueue=function(variable,requestQueue,handler){if(requestQueue&&requestQueue[variable.name]&&requestQueue[variable.name].length){var requestObj;switch(variable.inFlightBehavior){case"executeLast":requestObj=requestQueue[variable.name].pop(),handler(requestObj.variable,requestObj.options,requestObj.success,requestObj.error),requestQueue[variable.name]=null;break;case"executeAll":requestObj=requestQueue[variable.name].splice(0,1).pop(),handler(requestObj.variable,requestObj.options,requestObj.success,requestObj.error);break;default:requestQueue[variable.name]=null}}},deleteVariable=function(name,pageName){var i,pageContext;if(pageName)return void(name?(delete self.variableCollection[pageName][name],CONSTANTS.isStudioMode&&(delete returnObject[name],delete self.studioCopy[pageName][name])):(delete self.variableCollection[pageName],CONSTANTS.isStudioMode&&delete self.studioCopy[pageName]));for(i in self.variableCollection)self.variableCollection.hasOwnProperty(i)&&self.variableCollection[i].hasOwnProperty(name)&&(delete self.variableCollection[i][name],CONSTANTS.isStudioMode&&self.studioCopy[i]&&delete self.studioCopy[i][name],ProjectService.getPages().indexOf(i)>-1&&(pageContext=i));return pageContext?pageContext:!1},filterByVariableKeys=function(variableParams,searchAllContexts){function findMatchingVariables(contextVariables,context){for(variableNames=Object.keys(contextVariables),index=0;index<variableNames.length;index++){for(currentVariable=variables[context][variableNames[index]],varParamCounter=0;varParamCounter<varParamsArray.length&&(currentVarParam=varParamsArray[varParamCounter],currentVariable[currentVarParam]===variableParams[currentVarParam]);varParamCounter++);varParamCounter===varParamsArray.length&&-1===filteredVariables.indexOf(currentVariable)&&(currentVariable.name=variableNames[index],filteredVariables.push(currentVariable))}}var currentVariable,variableOwner,variableNames,index,varParamCounter,currentVarParam,variables=self.variableCollection,varParamsArray=Object.keys(variableParams),filteredVariables=[],defaultContextArray=["App",$rootScope.activePageName];return variableParams.owner&&(variableOwner=variableParams.owner===VARIABLE_CONSTANTS.OWNER.APP?VARIABLE_CONSTANTS.OWNER.APP:$rootScope.activePageName),searchAllContexts?Object.keys(variables).forEach(function(context){isNaN(context)&&findMatchingVariables(variables[context],context)}):variableOwner?findMatchingVariables(variables[variableOwner],variableOwner):defaultContextArray.forEach(function(context){findMatchingVariables(variables[context],context)}),filteredVariables},getBindMap=function(type,parentReference,oldBindings,typeChain){var curFieldObj,typeChainArr,types=$rootScope.dataTypes;oldBindings=oldBindings||{},typeChain=typeChain||"",typeChainArr=typeChain.split("~"),-1===typeChainArr.indexOf(type)&&(typeChain+="~"+type,types&&types[type]&&types[type].fields&&(parentReference.fields=[],WM.forEach(types[type].fields,function(field,fieldName){curFieldObj={name:fieldName,type:field.type,isList:field.isList},oldBindings[fieldName]&&!WM.isObject(oldBindings[fieldName])&&(curFieldObj.value=oldBindings[fieldName]),parentReference.fields.push(curFieldObj),getBindMap(field.type,curFieldObj,oldBindings[fieldName],typeChain)})))};return this.variableCollection=null,this.studioCopy={},runMode&&($rootScope.project={id:ProjectService.getId()}),$rootScope.variables=$rootScope.variables||{},initVariableNameMap(),resetVariableNameIterator(),CONSTANTS.isStudioMode&&$rootScope.$on("bind-widget-to-variable",function(event,variableName,isBind,scope,bindCount){event.stopPropagation();var variable=getVariableByName(variableName,scope),writableVariable=getVariableByName(variableName);variable&&"wm.LiveVariable"===variable.category&&"read"===variable.operation&&(isBind?variable.startUpdate||(variable.bindCount=(variable.bindCount||0)+(bindCount||1),writableVariable.startUpdate=variable.startUpdate=!0,variable.update()):(variable.bindCount-=1,variable.bindCount||(writableVariable.startUpdate=variable.startUpdate=!1)),writableVariable.bindCount=variable.bindCount,$rootScope.saveVariables=!0)}),returnObject={create:create,store:store,isExists:isExists,isNameAvailable:function(variableObj){var variableNameAvailable=!1,existingVariable=getVariableByName(variableObj.name);return variableObj&&variableObj._id===existingVariable._id&&(variableNameAvailable=!0),variableNameAvailable},getVariableByName:getVariableByName,updateVariable:function(newProperties){var i;for(i in self.variableCollection)self.variableCollection.hasOwnProperty(i)&&self.variableCollection[i].hasOwnProperty(newProperties.name)&&(self.variableCollection[i][newProperties.name]=newProperties);return!1},"delete":deleteVariable,getAll:function(){return self.variableCollection},getStudioCopy:function(){return self.studioCopy},saveVariables:function(activePageName,success,error,updateValues){var variables=self.variableCollection,appVariables=WM.copy(variables[VARIABLE_CONSTANTS.OWNER.APP]),pageVariables=WM.copy(variables[activePageName]);activePageName&&updateValues&&updateVariableValues(activePageName),appVariables=filterVariables(appVariables),pageVariables=filterVariables(pageVariables),writeFile({path:"app.variables.json",content:appVariables},function(){activePageName?writeFile({path:"../../pages/"+activePageName+"/"+activePageName+".variables.json",content:pageVariables},function(){Utils.triggerFn(success)},function(errMsg){Utils.triggerFn(error,errMsg)}):Utils.triggerFn(success)},function(errMsg){Utils.triggerFn(error,errMsg)})},savePageVariables:function(activePageName,success,error,updateValues){if(activePageName){var variables=self.variableCollection,pageVariables=WM.copy(variables[activePageName]);updateValues&&updateVariableValues(activePageName),pageVariables=filterVariables(pageVariables),writeFile({path:"pages/"+activePageName+"/"+activePageName+".variables.json",content:pageVariables},function(){Utils.triggerFn(success)},function(errMsg){Utils.triggerFn(error,errMsg)})}},saveAppVariables:function(success,error,updateValues){var variables=self.variableCollection,appVariables=WM.copy(variables[VARIABLE_CONSTANTS.OWNER.APP]);updateValues&&updateVariableValues(),appVariables=filterVariables(appVariables),writeFile({path:"app.variables.json",content:appVariables},function(){Utils.triggerFn(success)},function(errMsg){Utils.triggerFn(error,errMsg)})},init:initVariableCollection,initAppVariables:initAppVariables,initPageVariables:initPageVariables,resetVariables:resetVariables,getVariableCategoryList:getVariableCategoryList,getType:getType,getVariableNameIterator:function(){return self.variableNameIterator},resetVariableNameIterator:resetVariableNameIterator,call:call,generateUniqueName:generateUniqueName,register:register,retrieveEventCallbackVariables:retrieveEventCallbackVariables,isEventCallbackVariable:isEventCallbackVariable,saveContextVariables:saveContextVariables,updateVariableDataSet:updateVariableDataSet,createLiveVariable:function(variableDetails){var defaultName,createdVariable,variableName,variableOwner,variableCategory="wm.LiveVariable";return defaultName=variableDetails.name||Utils.initCaps(variableDetails.service)+Utils.initCaps(variableDetails.table)+"Data",isExists(defaultName)?variableName=defaultName:(createdVariable=create(variableCategory,{owner:variableDetails.owner||"Page",isList:!0},defaultName),variableName=createdVariable.name,variableOwner=createdVariable.owner===VARIABLE_CONSTANTS.OWNER.PAGE?$rootScope.activePageName:null,createdVariable.liveSource=variableDetails.service,createdVariable.type=variableDetails.table,createdVariable.category=variableCategory,createdVariable.isDefault=!0,createdVariable.dbSystem=variableDetails.dbSystem,delete createdVariable.name,store(variableOwner,variableName,createdVariable,null,!0),$rootScope.$emit("update-variables-tree",{name:variableName,category:variableCategory,properties:createdVariable})),variableName},createServiceVariable:function(variableDetails,overWrite){var createdVariable,variableName,variableOwner,bindMapCollection,variableCategory="wm.ServiceVariable",defaultName=variableDetails.name||Utils.initCaps(variableDetails.service)+Utils.initCaps(variableDetails.operation);return!isExists(defaultName)||overWrite?(createdVariable=create(variableCategory,{owner:variableDetails.owner||"Page"},defaultName,overWrite),variableName=createdVariable.name,variableOwner=createdVariable.owner===VARIABLE_CONSTANTS.OWNER.PAGE?$rootScope.activePageName:null,createdVariable.service=variableDetails.service,createdVariable.operation=variableDetails.operation,createdVariable.operationType=variableDetails.operationType,createdVariable.serviceType=variableDetails.serviceType,createdVariable.category=variableCategory,createdVariable.dataBinding[0].fields=[],createdVariable.isDefault=!0,createdVariable.type=variableDetails.returnType,variableDetails.wmServiceOperationInfo&&(createdVariable.wmServiceOperationInfo=variableDetails.wmServiceOperationInfo),delete createdVariable.name,bindMapCollection=createdVariable.dataBinding[0].fields,WM.forEach(variableDetails.sampleParamValues,function(val,key){bindMapCollection.push({name:key,value:val,type:"java.lang.String"})}),store(variableOwner,variableName,createdVariable,null,!0),
$rootScope.$emit("update-variables-tree",{name:variableName,category:variableCategory,properties:createdVariable})):variableName=defaultName,variableName},deleteDefaultVariable:function(variableDetails){var filteredVariables=filterByVariableKeys(variableDetails,!1),owner=VARIABLE_CONSTANTS.OWNER.APP;filteredVariables.forEach(function(variable){variable.owner===VARIABLE_CONSTANTS.OWNER.PAGE&&(owner=$rootScope.activePageName),deleteVariable(variable.name,owner)})},initiateCallback:initiateCallback,unload:unload,getAppVariables:getAppVariables,getPageVariables:getPageVariables,setPageVariables:setPageVariables,processRequestQueue:processRequestQueue,filterByVariableKeys:filterByVariableKeys,getBindMap:getBindMap,addVariableConfig:function(config){variableConfig.push(config),variableCategoryToNameMap[config.category]=config.defaultName,self.variableNameIterator[config.category]=1}}}],wm.variables.services.BasicVariableService=["BaseVariablePropertyFactory","Utils",function(BaseVariablePropertyFactory,Utils){"use strict";var methods={getData:function(variable,options,success){return Utils.triggerFn(success,variable.dataSet),variable.dataSet},setData:function(variable,dataSet){return dataSet?variable.isList&&!WM.isArray(dataSet)?variable.dataSet:(variable.dataSet=dataSet,variable.dataSet):variable.dataSet},getValue:function(variable,key,index){return index=index||0,variable.isList?variable.dataSet[index][key]:variable.dataSet[key]},setValue:function(variable,key,value){return key&&value&&!variable.isList?(variable.dataSet[key]=value,variable.dataSet):variable.dataSet},getItem:function(variable,index){return variable.isList?variable.dataSet[index]:variable.dataSet},setItem:function(variable,index,value){return index&&value&&variable.isList?(variable.dataSet[index]=value,variable.dataSet):variable.dataSet},addItem:function(variable,value,index){return value&&variable.isList?(index=void 0!==index?index:variable.dataSet.length,variable.dataSet.splice(index,0,value),variable.dataSet):variable.dataSet},removeItem:function(variable,index){return index=void 0!==index?index:variable.dataSet.length-1,variable.dataSet.splice(index,1),variable.dataSet},clearData:function(variable){return variable.dataSet=variable.isList?[]:{},variable.dataSet},getCount:function(variable){return variable.isList?variable.dataSet.length:1}},basicVariableObj={getData:function(){return methods.getData(this)},setData:function(dataSet){return methods.setData(this,dataSet)},getValue:function(key,index){return methods.getValue(this,key,index)},setValue:function(key,value){return methods.setValue(this,key,value)},getItem:function(index){return methods.getItem(this,index)},setItem:function(index,value){return methods.setItem(this,index,value)},addItem:function(value,index){return methods.addItem(this,value,index)},removeItem:function(index){return methods.removeItem(this,index)},clearData:function(){return methods.clearData(this)},getCount:function(){return methods.getCount(this)}};return BaseVariablePropertyFactory.register("wm.Variable",basicVariableObj,[],methods),{}}],wm.variables.services.$liveVariable=["$rootScope","DatabaseService","Variables","BaseVariablePropertyFactory","CONSTANTS","Utils","VARIABLE_CONSTANTS","ProjectService","DB_CONSTANTS","wmToaster","$filter",function($rootScope,DatabaseService,Variables,BaseVariablePropertyFactory,CONSTANTS,Utils,VARIABLE_CONSTANTS,ProjectService,DB_CONSTANTS,wmToaster,$filter){"use strict";var projectDeployReqQueue,isDeployReqSourceChanged,isProjectDeployed=CONSTANTS.isRunMode,DataModelDesignManager=CONSTANTS.isStudioMode&&Utils.getService("DataModelDesignManager"),isProjectDeployInProgress=!1,callbackParams=[],requestQueue={},variableActive={},invalidVariables=[],packageDetails={},dateTimeFormats=Utils.getDateTimeDefaultFormats(),isDateTime=Utils.getDateTimeTypes(),reset=function(){isProjectDeployed=CONSTANTS.isRunMode,isDeployReqSourceChanged=!0},getDateInDefaultFormat=function(value,type){var epoch=moment(value).valueOf();return"time"!==type||epoch||(epoch=moment((new Date).toDateString()+" "+value).valueOf()),value&&$filter("date")(epoch,dateTimeFormats[type])},processResponse=function(responseData){responseData&&responseData.forEach(function(rowData){var tempData;rowData&&WM.isObject(rowData.id)&&(tempData=rowData.id,delete rowData.id,WM.extend(rowData,tempData))})},getHibernateType=function(variable,fieldName){var index,column,columns=variable.propertiesMap.columns,columnsCount=columns.length;for(index=0;columnsCount>index;index+=1)if(column=columns[index],column.fieldName===fieldName)return column.hibernateType},getSqlType=function(variable,fieldName){var index,column,columns=variable.propertiesMap.columns,columnsCount=columns.length;for(index=0;columnsCount>index;index+=1)if(column=columns[index],column.fieldName===fieldName)return column.type},isRelatedFieldMany=function(variable,fieldName){var index,column,columns=variable.propertiesMap.columns,columnsCount=columns.length;for(index=0;columnsCount>index;index+=1)if(column=columns[index],column.fieldName===fieldName)return!1;return!0},updateVariableDataset=function(variable,data,propertiesMap,relatedData,pagingOptions){variable.dataSet={data:data,propertiesMap:propertiesMap,relatedData:relatedData,pagingOptions:pagingOptions}},setVariableProp=function(variable,writableVariable,propertyName,propertyValue){variable[propertyName]=propertyValue,writableVariable&&(writableVariable[propertyName]=propertyValue)},getTableMetaData=function(projectID,variable,writableVariable,options,callback,success){var tableDetails={};DataModelDesignManager.getDataModel(projectID,variable.liveSource,!1,function(database){var variableTable,variableType,tableNameToEntityNameMap={},entityNameToTableNameMap={};return WM.forEach(database.dataTables,function(table){tableNameToEntityNameMap[table.tableName]=table.entityName,entityNameToTableNameMap[table.entityName]=table.tableName}),(variableType=entityNameToTableNameMap[variable.type])?(WM.forEach(database.dataTables,function(table){var tableName=table.tableName,tablePackageName=database.packageName+"."+table.entityName;tableDetails[tableName]={},tableDetails[tableName].columns=[],tableDetails[tableName].primaryKeys=[],packageDetails[tablePackageName]=packageDetails[tablePackageName]||{},packageDetails[tablePackageName].primaryKeys=[],tableName===variableType&&(setVariableProp(variable,writableVariable,"package",tablePackageName),setVariableProp(variable,writableVariable,"tableName",table.tableName),setVariableProp(variable,writableVariable,"tableType",WM.isDefined(table.tableType)?table.tableType:"TABLE")),WM.forEach(table.dataColumns,function(column){var sqlType;sqlType=column.sqlType,!column.isRelated&&DB_CONSTANTS.DATABASE_SECONDARY_DATA_TYPES[sqlType]&&(sqlType=DB_CONSTANTS.DATABASE_DATA_TYPES[DB_CONSTANTS.DATABASE_SECONDARY_DATA_TYPES[sqlType].sql_type].sql_type),column.isPk&&-1===WM.element.inArray(column.fieldName,packageDetails[tablePackageName].primaryKeys)&&(tableDetails[tableName].primaryKeys.push(column.fieldName),packageDetails[tablePackageName].primaryKeys.push(column.fieldName)),tableDetails[tableName].columns.push({fieldName:column.fieldName,type:sqlType,hibernateType:column.hibernateType,fullyQualifiedType:sqlType,columnName:column.columnName,isPrimaryKey:column.isPk,notNull:column.notNull,length:column.length,precision:column.precision,generator:column.generator,isRelated:column.isFk,defaultValue:column.defaultValue})}),WM.forEach(table.dataRelations,function(relation){WM.forEach(tableDetails[tableName].columns,function(column){var fkColumnName=column.columnName;column.isRelated&&-1!==WM.element.inArray(fkColumnName,relation.relatedColumns)&&tableName===variableType&&(setVariableProp(variable,writableVariable,"properties",variable.properties||[]),column.relatedTableName=relation.relatedType,column.relatedEntityName=tableNameToEntityNameMap[relation.relatedType],-1===WM.element.inArray(relation.name,variable.properties)&&(variable.properties.push(relation.name),setVariableProp(variable,writableVariable,"relatedTables",variable.relatedTables||[]),variable.relatedTables.push({columnName:column.fieldName,relationName:relation.name,type:tableNameToEntityNameMap[relation.relatedType],"package":relation.fullyQualifiedName,watchOn:Utils.initCaps(variable.liveSource)+tableNameToEntityNameMap[relation.relatedType]+"Data"})))})})}),tableDetails[variableType].entityName=variable.type,tableDetails[variableType].fullyQualifiedName=variable["package"],tableDetails[variableType].tableType=variable.tableType,variableTable=tableDetails[variableType],WM.forEach(variableTable.columns,function(column){var columnDef;column.isRelated&&(column.columns=WM.copy(tableDetails[column.relatedTableName].columns),column.relatedFieldName=column.fieldName+"."+tableDetails[column.relatedTableName].primaryKeys[0],$rootScope.dataTypes[variable["package"]]&&(columnDef=$rootScope.dataTypes[variable["package"]].fields[column.fieldName],column.isList=columnDef&&columnDef.isList))}),setVariableProp(variable,writableVariable,"propertiesMap",tableDetails[variableType]),$rootScope.variables[variable.name].propertiesMap=variable.propertiesMap,$rootScope.saveVariables=!0,void Utils.triggerFn(callback,projectID,variable,options,success)):void invalidVariables.push(variable.name)},WM.noop)},prepareTableOptions=function(variable,options){var filterFields,orderByFields,filterOptions=[],orderByOptions="",primaryKey=variable.getPrimaryKey(),hasCompositeKey=variable.isCompositeKey(primaryKey),hasNoPrimaryKey=variable.isNoPrimaryKey(primaryKey);return filterFields=!options.filterFields||WM.element.isEmptyObject(options.filterFields)?variable.filterFields:options.filterFields,"read"===variable.operation&&WM.forEach(filterFields,function(fieldOptions,fieldName){var attributeName,fieldValue=fieldOptions.value,fieldType=fieldOptions.type||getHibernateType(variable,fieldName)||getSqlType(variable,fieldName)||"integer",filterCondition=DB_CONSTANTS.DATABASE_MATCH_MODES[options.matchMode||variable.matchMode];if(WM.isObject(fieldValue)&&!WM.isArray(fieldValue))WM.forEach(fieldValue,function(subFieldValue,subFieldName){subFieldValue&&!WM.isObject(subFieldValue)&&filterOptions.push(fieldName+"."+subFieldName+"="+subFieldValue)});else if(fieldValue){switch(fieldType){case"integer":fieldValue=parseInt(fieldValue,10),filterCondition=DB_CONSTANTS.DATABASE_MATCH_MODES.exact;break;case"big_decimal":case"big_integer":case"character":case"double":case"float":case"boolean":case"short":case"byte":case"time":filterCondition=DB_CONSTANTS.DATABASE_MATCH_MODES.exact;break;case"date":fieldValue=getDateInDefaultFormat(fieldValue,fieldType),filterCondition=DB_CONSTANTS.DATABASE_MATCH_MODES.exact;break;case"timestamp":fieldValue=new Date(fieldValue).getTime(),filterCondition=DB_CONSTANTS.DATABASE_MATCH_MODES.exact;break;case"datetime":fieldValue=getDateInDefaultFormat(fieldValue,fieldType),filterCondition=DB_CONSTANTS.DATABASE_MATCH_MODES.exact;break;case"string":filterCondition=WM.isArray(fieldValue)?DB_CONSTANTS.DATABASE_MATCH_MODES.exact:DB_CONSTANTS.DATABASE_MATCH_MODES.anywhere}attributeName=fieldName,variable.propertiesMap.columns.forEach(function(column){column.fieldName===fieldName&&column.isRelated&&(attributeName=column.relatedFieldName)}),hasCompositeKey&&(hasNoPrimaryKey||-1!==primaryKey.indexOf(attributeName))&&(attributeName="id."+attributeName),filterOptions.push({attributeName:attributeName,attributeValue:fieldValue,attributeType:fieldType.toUpperCase(),filterCondition:filterCondition})}}),orderByFields=!options.orderBy||WM.element.isEmptyObject(options.orderBy)?variable.orderBy:options.orderBy,orderByFields.split("&").forEach(function(orderByOption){orderByOptions+="sort="+orderByOption+"&"}),orderByOptions=orderByOptions.slice(0,-1),{filter:filterOptions,sort:orderByOptions}},initiateCallback=Variables.initiateCallback,processRequestQueue=Variables.processRequestQueue,getPrimaryTableData=function(projectID,variable,options,success,error){var tableOptions,dbOperation,callBackScope,promiseObj,variableOwner=variable.owner,variableEvents=VARIABLE_CONSTANTS.EVENTS,handleError=function(response){CONSTANTS.isRunMode&&initiateCallback("onError",variable,callBackScope,response),updateVariableDataset(variable,[],variable.propertiesMap,$rootScope.variables[variable.name].relatedData||{},$rootScope.variables[variable.name].pagingOptions),Utils.triggerFn(error,response),CONSTANTS.isRunMode&&(variableActive[variable.activeScope.$id][variable.name]=!1,processRequestQueue(variable,requestQueue[variable.activeScope.$id],deployProjectAndFetchData))};tableOptions=prepareTableOptions(variable,options),dbOperation=tableOptions.filter&&tableOptions.filter.length?"searchTableData":"readTableData",promiseObj=DatabaseService[dbOperation]({projectID:projectID,service:variable.prefabName?"":"services",dataModelName:variable.liveSource,entityName:variable.type,page:options.page||1,size:CONSTANTS.isRunMode?variable.maxResults||20:variable.designMaxResults||20,sort:tableOptions.sort,data:tableOptions.filter,url:variable.prefabName?$rootScope.project.deployedUrl+"/prefabs/"+variable.prefabName:$rootScope.project.deployedUrl},function(response){return response&&response.error||!response||!WM.isArray(response.content)?void Utils.triggerFn(handleError,response.error):(processResponse(response.content),$rootScope.variables[variable.name].data=response.content,$rootScope.variables[variable.name].pagingOptions={dataSize:response?response.totalElements:null,maxResults:variable.maxResults},callBackScope="App"===variableOwner?$rootScope||{}:variable.prefabName?options.scope||{}:options.scope&&options.scope.$$childTail?options.scope.$$childTail:{},CONSTANTS.isRunMode&&WM.forEach(variableEvents,function(event){if("onError"!==event)if("onBeforeUpdate"===event){var newDataSet=initiateCallback(event,variable,callBackScope,response.content);newDataSet&&($rootScope.variables[variable.name].data=newDataSet)}else initiateCallback(event,variable,callBackScope,response.content)}),updateVariableDataset(variable,$rootScope.variables[variable.name].data,variable.propertiesMap,$rootScope.variables[variable.name].relatedData||{},$rootScope.variables[variable.name].pagingOptions),Utils.triggerFn(success,$rootScope.variables[variable.name].data,variable.propertiesMap,$rootScope.variables[variable.name].relatedData||{},$rootScope.variables[variable.name].pagingOptions),void(CONSTANTS.isRunMode&&(variableActive[variable.activeScope.$id][variable.name]=!1,processRequestQueue(variable,requestQueue[variable.activeScope.$id],deployProjectAndFetchData))))},function(error){Utils.triggerFn(handleError,error)}),CONSTANTS.isRunMode&&(variable.promise=promiseObj)},getRelatedTablesData=function(projectID,variable,options,success){var promiseObj,resultProperties={firstResult:0,maxResults:CONSTANTS.isRunMode?variable.maxResults:variable.designMaxResults};variable.orderBy&&(resultProperties.orderBy=variable.orderBy.split(",")),WM.forEach(variable.relatedTables,function(relatedTable){promiseObj=DatabaseService.readTableData({projectID:projectID,service:variable.prefabName?"":"services",dataModelName:variable.liveSource,entityName:relatedTable.type,page:1,size:resultProperties.maxResults,url:variable.prefabName?$rootScope.project.deployedUrl+"/prefabs/"+variable.prefabName:$rootScope.project.deployedUrl},function(response){var primaryDataSize=$rootScope.variables[variable.name].pagingOptions&&$rootScope.variables[variable.name].pagingOptions.dataSize||null;$rootScope.variables[variable.name].relatedData=$rootScope.variables[variable.name].relatedData||{},$rootScope.variables[variable.name].relatedData[relatedTable.columnName]=response.content,updateVariableDataset(variable,$rootScope.variables[variable.name].data,variable.propertiesMap,$rootScope.variables[variable.name].relatedData,{dataSize:primaryDataSize,maxResults:variable.maxResults,relatedDataChange:!0}),Utils.triggerFn(success,$rootScope.variables[variable.name].data,variable.propertiesMap,$rootScope.variables[variable.name].relatedData,{dataSize:primaryDataSize,maxResults:variable.maxResults,relatedDataChange:!0}),relatedTable.watchOn!==variable.name&&$rootScope.$watch("variables."+relatedTable.watchOn+".data",function(newVal,oldVal){newVal&&!WM.equals(oldVal,newVal)&&($rootScope.variables[variable.name].relatedData[relatedTable.columnName]=newVal,options.isNotTriggerForRelated=!0,getPrimaryTableData(projectID,variable,options,success),updateVariableDataset(variable,$rootScope.variables[variable.name].data,variable.propertiesMap,$rootScope.variables[variable.name].relatedData,{dataSize:primaryDataSize,maxResults:variable.maxResults,relatedDataChange:!0}),Utils.triggerFn(success,$rootScope.variables[variable.name].data,variable.propertiesMap,$rootScope.variables[variable.name].relatedData,{dataSize:primaryDataSize,maxResults:variable.maxResults,relatedDataChange:!0}))})}),CONSTANTS.isRunMode&&(variable.promise=promiseObj)})},getTableData=function(projectID,variable,options,success,error){var variableIndex=WM.element.inArray(variable.name,invalidVariables);-1===variableIndex?(getPrimaryTableData(projectID,variable,options,success,error),CONSTANTS.isRunMode&&!options.isNotTriggerForRelated&&variable.relatedTables&&variable.relatedTables.length&&getRelatedTablesData(projectID,variable,options,success)):invalidVariables.splice(variableIndex,1)},getDataFromService=function(variable,options,success,error){var projectID=$rootScope.project.id||$rootScope.projectName;"read"===variable.operation&&getTableData(projectID,variable,options,success,error)},deployProjectAndFetchData=function(variable,options,success,error){return isProjectDeployed?void getDataFromService(variable,options,success,error):void(isProjectDeployInProgress?isDeployReqSourceChanged&&!projectDeployReqQueue?(projectDeployReqQueue={variable:variable,options:options,success:success,error:error},isDeployReqSourceChanged=void 0):callbackParams.push({variable:variable,options:options,success:success,error:error}):(isProjectDeployInProgress=!0,ProjectService.run({projectId:$rootScope.project.id},function(result){return $rootScope.project.deployedUrl=Utils.removeProtocol(result),projectDeployReqQueue?(isProjectDeployed=!1,isProjectDeployInProgress=!1,deployProjectAndFetchData(projectDeployReqQueue.variable,projectDeployReqQueue.options,projectDeployReqQueue.success,projectDeployReqQueue.error),callbackParams.push({variable:variable,options:options,success:success,error:error}),projectDeployReqQueue=void 0,void 0):(getDataFromService(variable,options,success,error),isProjectDeployed=!0,isProjectDeployInProgress=!1,callbackParams.length&&(WM.forEach(callbackParams,function(callbackParam){deployProjectAndFetchData(callbackParam.variable,callbackParam.options,callbackParam.success,callbackParam.error)}),callbackParams=[]),!0)},function(error){wmToaster.show("error",$rootScope.locale.MESSAGE_ERROR_TITLE,$rootScope.locale.MESSAGE_INFO_DATABASE_DATA_LOADING_FAILED+" : "+error),isProjectDeployInProgress=!1,updateVariableDataset(variable,{error:!0,errorMessage:$rootScope.locale.MESSAGE_INFO_DATABASE_DATA_LOADING_FAILED},variable.propertiesMap,{},{}),callbackParams.length&&(WM.forEach(callbackParams,function(callbackParam){updateVariableDataset(callbackParam.variable,{error:!0,errorMessage:$rootScope.locale.MESSAGE_INFO_DATABASE_DATA_LOADING_FAILED},callbackParam.variable.propertiesMap,{},{})}),callbackParams=[])})))},getFieldType=function(fieldName,variable){var fieldType,columns,result;return variable.propertiesMap&&(columns=variable.propertiesMap.columns||[],result=_.find(columns,function(obj){return obj.fieldName===fieldName}),fieldType=result&&result.type),fieldType},performDataAction=function(action,variableDetails,options,success,error){var dbName,prevData,callBackScope,promiseObj,primaryKey,id,columnName,compositeId="",projectID=$rootScope.project.id||$rootScope.projectName,rowObject={},formattedData={},variableEvents=VARIABLE_CONSTANTS.EVENTS,compositeKeysData={},prevCompositeKeysData={};switch(callBackScope="App"===variableDetails.owner?$rootScope||{}:options.scope&&options.scope.$$childTail?options.scope.$$childTail:{},options.row?rowObject=options.row:WM.forEach(variableDetails.inputFields,function(fieldValue,fieldName){var fieldType;WM.isDefined(fieldValue)&&""!==fieldValue&&("deleteTableData"===action&&(compositeId=fieldValue),"updateTableData"===action&&variableDetails.propertiesMap.primaryKeys.forEach(function(key){fieldName===key&&(compositeId=fieldValue)}),"deleteTableData"!==action&&(fieldType=getFieldType(fieldName,variableDetails),isDateTime[fieldType]&&"timestamp"!==fieldType&&(fieldValue=getDateInDefaultFormat(fieldValue,fieldType)),rowObject[fieldName]=fieldValue))}),action){case"insertTableData":case"insertMultiPartTableData":primaryKey=variableDetails.getPrimaryKey(),variableDetails.isCompositeKey(primaryKey)&&(variableDetails.isNoPrimaryKey(primaryKey)?(formattedData.id=WM.copy(rowObject),rowObject={}):(formattedData.id={},primaryKey.forEach(function(key){formattedData.id[key]=rowObject[key],delete rowObject[key]})),rowObject.id=formattedData.id);break;case"updateTableData":case"updateMultiPartTableData":prevData=options.prevData||{},primaryKey=variableDetails.getPrimaryKey(),variableDetails.isCompositeKey(primaryKey)?(variableDetails.isNoPrimaryKey(primaryKey)?(prevCompositeKeysData=prevData,compositeKeysData=rowObject,rowObject={}):primaryKey.forEach(function(key){compositeKeysData[key]=rowObject[key],prevCompositeKeysData[key]=prevData[key],delete rowObject[key]}),rowObject.id=compositeKeysData,options.row=rowObject,options.compositeKeysData=prevCompositeKeysData):(primaryKey.forEach(function(key){-1===key.indexOf(".")?id=prevData[key]||options.rowData&&options.rowData[key]||rowObject[key]:(columnName=key.split("."),id=prevData[columnName[0]][columnName[1]])}),options.id=id,options.row=rowObject);break;case"deleteTableData":primaryKey=variableDetails.getPrimaryKey(),variableDetails.isCompositeKey(primaryKey)?(variableDetails.isNoPrimaryKey(primaryKey)?compositeKeysData=rowObject:primaryKey.forEach(function(key){compositeKeysData[key]=rowObject[key]}),options.compositeKeysData=compositeKeysData):WM.element.isEmptyObject(rowObject)||(primaryKey.forEach(function(key){-1===key.indexOf(".")?id=rowObject[key]:(columnName=key.split("."),id=rowObject[columnName[0]][columnName[1]])}),options.id=id)}if(options.compositeKeysData){switch(action){case"updateTableData":action="updateCompositeTableData";break;case"deleteTableData":action="deleteCompositeTableData"}WM.forEach(options.compositeKeysData,function(paramValue,paramName){compositeId+=paramName+"="+encodeURIComponent(paramValue)+"&"}),compositeId=compositeId.slice(0,-1)}dbName=variableDetails.liveSource,WM.element.isEmptyObject(rowObject)&&"deleteTableData"===action&&(rowObject=void 0),promiseObj=DatabaseService[action]({projectID:projectID,service:variableDetails.prefabName?"":"services",dataModelName:dbName,entityName:variableDetails.type,id:WM.isDefined(options.id)?encodeURIComponent(options.id):compositeId,data:rowObject,url:variableDetails.prefabName?$rootScope.project.deployedUrl+"/prefabs/"+variableDetails.prefabName:$rootScope.project.deployedUrl},function(response){response&&response.error?(CONSTANTS.isRunMode&&initiateCallback("onError",variableDetails,callBackScope,response.error),Utils.triggerFn(error,response.error)):(CONSTANTS.isRunMode&&WM.forEach(variableEvents,function(event){"onError"!==event&&initiateCallback(event,variableDetails,callBackScope,response)}),Utils.triggerFn(success,response))},function(response){CONSTANTS.isRunMode&&initiateCallback("onError",variableDetails,callBackScope,response),Utils.triggerFn(error,response)}),CONSTANTS.isRunMode&&(variableDetails.promise=promiseObj)},methods={getPrimaryKey:function(variable){var primaryKey=[];return WM.element.each(variable.propertiesMap.columns,function(index,column){column.isPrimaryKey&&(column.isRelated&&-1===WM.element.inArray(column.relatedFieldName,primaryKey)?primaryKey.push(column.relatedFieldName):-1===WM.element.inArray(column.fieldName,primaryKey)&&primaryKey.push(column.fieldName))}),primaryKey},isCompositeKey:function(variable,primaryKey){return!primaryKey||primaryKey&&(!primaryKey.length||primaryKey.length>1)},isNoPrimaryKey:function(variable,primaryKey){return!primaryKey||primaryKey&&!primaryKey.length},getData:function(variable,options,success,error){var writableVariable,variableName=variable.name,projectID=$rootScope.project.id||$rootScope.projectName;if(!Utils.isEmptyObject(variable)&&(CONSTANTS.isStudioMode&&-1!==WM.element.inArray(variable.liveSource,$rootScope.databaseNames)||CONSTANTS.isRunMode||variable.prefabName)){if(variable.name=variableName,CONSTANTS.isRunMode){if(variableActive[variable.activeScope.$id]=variableActive[variable.activeScope.$id]||{},variableActive[variable.activeScope.$id][variableName])return requestQueue[variable.activeScope.$id]=requestQueue[variable.activeScope.$id]||{},requestQueue[variable.activeScope.$id][variableName]=requestQueue[variable.activeScope.$id][variableName]||[],void requestQueue[variable.activeScope.$id][variableName].push({variable:variable,options:options,success:success,error:error});variableActive[variable.activeScope.$id][variableName]=!0}$rootScope.variables=$rootScope.variables||{},$rootScope.variables[variable.name]=$rootScope.variables[variable.name]||{},CONSTANTS.isRunMode||variable.prefabName||(writableVariable=Variables.getVariableByName(variable.name),getTableMetaData(projectID,variable,writableVariable,options,function(){updateVariableDataset(variable,{},variable.propertiesMap,{},{}),Utils.triggerFn(success,$rootScope.variables[variable.name].data,variable.propertiesMap,{},{dataSize:null,maxResults:variable.maxResults})})),CONSTANTS.isRunMode&&"read"!==variable.operation&&updateVariableDataset(variable,{},variable.propertiesMap,{},{}),options.skipFetchData||deployProjectAndFetchData(variable,options,success,error)}},updateRelatedData:function(variable,options,success,error){var projectID=$rootScope.project.id||$rootScope.projectName;options.relatedFieldName&&isRelatedFieldMany(variable,options.relatedFieldName)&&DatabaseService.readTableRelatedData({projectID:projectID,service:variable.prefabName?"":"services",dataModelName:variable.liveSource,entityName:variable.type,id:options.id,relatedFieldName:options.relatedFieldName,page:options.page||1,size:CONSTANTS.isRunMode?variable.maxResults||20:variable.designMaxResults||20,url:variable.prefabName?$rootScope.project.deployedUrl+"/prefabs/"+variable.prefabName:$rootScope.project.deployedUrl},function(response){return response&&response.error||!response||!WM.isArray(response.content)?void Utils.triggerFn(error,response.error):(response.content.forEach(function(rowData){var tempData;rowData&&WM.isObject(rowData.id)&&(tempData=rowData.id,delete rowData.id,WM.extend(rowData,tempData))}),void Utils.triggerFn(success,response.content,void 0,{},{dataSize:response?response.totalElements:null,maxResults:variable.maxResults}))},function(error){Utils.triggerFn(error,error)})},deleteRecord:function(variable,options,success,error){performDataAction("deleteTableData",variable,options,success,error)},updateRecord:function(variable,options,success,error){options.multipartData?performDataAction("updateMultiPartTableData",variable,options,success,error):performDataAction("updateTableData",variable,options,success,error)},insertRecord:function(variable,options,success,error){options.multipartData?performDataAction("insertMultiPartTableData",variable,options,success,error):performDataAction("insertTableData",variable,options,success,error)},setOrderBy:function(variable,expression){return variable.orderBy=expression,variable.autoUpdate&&variable.update(),variable.orderBy},getDataSet:function(variable){return variable.dataSet},clearData:function(variable){return variable.dataSet={},variable.dataSet},cancel:function(variable){variableActive[variable.activeScope.$id][variable.name]&&variable.promise&&variable.promise.abort()},setInput:function(variable,key,val){var paramObj={},targetObj={};return WM.isObject(key)?paramObj=key:paramObj[key]=val,variable.inputFields||(variable.inputFields={}),targetObj=variable.inputFields,WM.forEach(paramObj,function(paramVal,paramKey){targetObj[paramKey]=paramVal}),targetObj},setFilter:function(variable,key,val){var paramObj={},targetObj={};return WM.isObject(key)?paramObj=key:paramObj[key]=val,variable.filterFields||(variable.filterFields={}),targetObj=variable.filterFields,WM.forEach(paramObj,function(paramVal,paramKey){targetObj[paramKey]={value:paramVal}}),targetObj},getModifiedFieldName:function(variable,fieldName){var primaryKey=variable.getPrimaryKey(),modifiedFieldName=fieldName;return variable.isCompositeKey(primaryKey)&&(variable.isNoPrimaryKey(primaryKey)||-1!==primaryKey.indexOf(fieldName))&&(modifiedFieldName="id."+fieldName),modifiedFieldName}},liveVariableObj={update:function(options,success,error){var name=this.name;options=options||{},options.scope=this.activeScope,CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!0),methods.getData(this,options,function(data,propertiesMap,relatedData,pageOptions){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1),Utils.triggerFn(success,data,propertiesMap,relatedData,pageOptions)},function(errMsg){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1),Utils.triggerFn(error,errMsg)})},updateRecord:function(options,success,error){var name=this.name;options=options||{},options.scope=this.activeScope,CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!0),methods.updateRecord(this,options,function(response){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1),Utils.triggerFn(success,response)},function(errMsg){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1),Utils.triggerFn(error,errMsg)})},insertRecord:function(options,success,error){var name=this.name;options=options||{},options.scope=this.activeScope,CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!0),methods.insertRecord(this,options,function(response){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1),Utils.triggerFn(success,response)},function(errMsg){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1),Utils.triggerFn(error,errMsg)})},deleteRecord:function(options,success,error){var name=this.name;options=options||{},options.scope=this.activeScope,CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!0),methods.deleteRecord(this,options,function(response){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1),Utils.triggerFn(success,response)},function(errMsg){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1),Utils.triggerFn(error,errMsg)})},updateRelatedData:function(options,success,error){options=options||{},options.scope=this.activeScope,methods.updateRelatedData(this,options,function(data,propertiesMap,relatedData,pageOptions){Utils.triggerFn(success,data,propertiesMap,relatedData,pageOptions)},function(errMsg){Utils.triggerFn(error,errMsg)})},getPrimaryKey:function(){return methods.getPrimaryKey(this)},isCompositeKey:function(primaryKey){return methods.isCompositeKey(this,primaryKey)},isNoPrimaryKey:function(primaryKey){return methods.isNoPrimaryKey(this,primaryKey)},setOrderBy:function(expression){return methods.setOrderBy(this,expression)},getData:function(){return methods.getDataSet(this)},clearData:function(){return methods.clearData(this)},cancel:function(){return methods.cancel(this)},setInput:function(key,val){return methods.setInput(this,key,val)},setFilter:function(key,val){return methods.setFilter(this,key,val)},getModifiedFieldName:function(fieldName){return methods.getModifiedFieldName(this,fieldName)}};return BaseVariablePropertyFactory.register("wm.LiveVariable",liveVariableObj,["wm.Variable","wm.ServiceVariable"],methods),
{reset:reset,processResponse:processResponse}}],wm.variables.services.$servicevariable=["Variables","BaseVariablePropertyFactory","WebService","ServiceFactory","$rootScope","CONSTANTS","Utils","ProjectService","VARIABLE_CONSTANTS","WS_CONSTANTS","DatabaseService","$base64",function(Variables,BaseVariablePropertyFactory,WebService,ServiceFactory,$rootScope,CONSTANTS,Utils,ProjectService,VARIABLE_CONSTANTS,WS_CONSTANTS,DatabaseService,$base64){"use strict";var serviceModel={},requestQueue={},variableActive={},prefabDataTypes={},REST_METHOD_NAME="executeRestCall",REST_SUPPORTED_SERVICES=VARIABLE_CONSTANTS.REST_SUPPORTED_SERVICES,SERVICE_TYPE_FEED=VARIABLE_CONSTANTS.SERVICE_TYPE_FEED,SERVICE_TYPE_REST=VARIABLE_CONSTANTS.SERVICE_TYPE_REST,SERVICE_TYPE_SOAP=VARIABLE_CONSTANTS.SERVICE_TYPE_SOAP,SERVICE_TYPE_DATA=VARIABLE_CONSTANTS.SERVICE_TYPE_DATA,AUTH_TYPE_BASIC=(VARIABLE_CONSTANTS.SERVICE_TYPE_JAVA,"BASIC"),AUTH_TYPE_NONE="NONE",supportedOperations=WS_CONSTANTS.HTTP_METHODS.map(function(method){return method.toLowerCase()}),BASE_PATH_KEY="x-WM-BASE_PATH",RELATIVE_PATH_KEY="x-WM-RELATIVE_PATH",parameterTypeKey="in",AUTH_HDR_KEY="Authorization",isPrimitiveType=function(type){return-1!==WS_CONSTANTS.PRIMITIVE_DATA_TYPES.indexOf(type)},prepareServiceModel=function(type,parentNode,startNode,variable,typeChain){var modelTypes=variable.prefabName?prefabDataTypes[variable.prefabName]:$rootScope.dataTypes;if(startNode)modelTypes[type]&&modelTypes[type].fields&&WM.forEach(modelTypes[type].fields,function(field,fieldName){fieldName===startNode?prepareServiceModel(field.type,parentNode,null,variable):prepareServiceModel(field.type,parentNode,startNode,variable)});else if(type&&modelTypes[type]||isPrimitiveType(type)){if(modelTypes[type]&&modelTypes[type].primitiveType||isPrimitiveType(type))return variable.isList||(parentNode.value=""),void(variable.buildTreeFromDataSet=!0);typeChain=typeChain||"";var typeChainArr=typeChain.split("~");if(-1!==typeChainArr.indexOf(type))return;typeChain+="~"+type,WM.forEach(modelTypes[type].fields,function(field,fieldName){field.isList&&variable.serviceType!==SERVICE_TYPE_SOAP&&variable.serviceType!==SERVICE_TYPE_FEED&&variable.serviceType!==SERVICE_TYPE_REST||(modelTypes[field.type]&&modelTypes[field.type].fields?(parentNode[fieldName]=field.isList?[{}]:{},prepareServiceModel(field.type,field.isList?parentNode[fieldName][0]:parentNode[fieldName],"",variable,typeChain)):parentNode[fieldName]=field.isList?[]:"")})}},initiateCallback=Variables.initiateCallback,processRequestQueue=Variables.processRequestQueue,transformData=function(data,variable){data.wmTransformedData=[];var columnsArray=variable.transformationColumns,dataArray=data[variable.dataField]||[],transformedData=data.wmTransformedData;return WM.forEach(dataArray,function(datum,index){transformedData[index]={},WM.forEach(columnsArray,function(column,columnIndex){transformedData[index][column]=datum[columnIndex]})}),data},processErrorResponse=function(errMsg,variable,callBackScope,error){initiateCallback("onError",variable,callBackScope,errMsg),Utils.triggerFn(error,errMsg),CONSTANTS.isRunMode&&(variableActive[variable.activeScope.$id][variable.name]=!1,processRequestQueue(variable,requestQueue[variable.activeScope.$id],getDataInRun))},processSuccessResponse=function(response,variable,callBackScope,options,success,error){var variableEvents=VARIABLE_CONSTANTS.EVENTS;response&&response.error?processErrorResponse(response,variable,callBackScope,error):(variable.transformationColumns&&(response=transformData(response,variable)),WM.forEach(variableEvents,function(event){if("onError"!==event)if("onBeforeUpdate"===event){var newDataSet=initiateCallback(event,variable,callBackScope,response);newDataSet&&(response=newDataSet)}else initiateCallback(event,variable,callBackScope,response)}),options.forceRunMode||(variable.dataSet=WM.isObject(response)?response:{value:response}),Utils.triggerFn(success,response),CONSTANTS.isRunMode&&(variableActive[variable.activeScope.$id][variable.name]=!1,processRequestQueue(variable,requestQueue[variable.activeScope.$id],getDataInRun)))},constructRestRequestParams=function(operationInfo,serviceType,variable){var requestBody,url,target,pathParamRex,invokeParams,uname,pswd,queryParams="",endPointRelativePath=operationInfo.relativePath||"/",headers={},authType=AUTH_TYPE_NONE;return WM.forEach(operationInfo.parameters,function(param){var paramValue=param.sampleValue;if(WM.isDefined(paramValue)&&""!==paramValue)switch(param.parameterType.toUpperCase()){case"QUERY":queryParams?queryParams+="&"+param.name+"="+encodeURIComponent(paramValue):queryParams="?"+param.name+"="+encodeURIComponent(paramValue);break;case"AUTH":"wm_auth_username"===param.name?uname=paramValue:"wm_auth_password"===param.name&&(pswd=paramValue),uname&&pswd&&(headers[AUTH_HDR_KEY]="Basic "+$base64.encode(uname+":"+pswd),authType=AUTH_TYPE_BASIC);break;case"PATH":pathParamRex=new RegExp("\\s*\\{\\s*"+param.name+"(:\\.\\+)?\\s*\\}\\s*"),endPointRelativePath=endPointRelativePath.replace(pathParamRex,paramValue);break;case"HEADER":headers[param.name]=paramValue;break;case"BODY":requestBody=paramValue;break;case"FORM":}}),url=$rootScope.project.deployedUrl,variable.prefabName&&-1!==VARIABLE_CONSTANTS.REST_SUPPORTED_SERVICES.indexOf(serviceType)&&variable.wmServiceOperationInfo&&(url+="/prefabs/"+variable.prefabName,target="invokePrefabRestService"),url+=(variable.prefabName?"":"/services")+endPointRelativePath+queryParams,invokeParams={projectID:$rootScope.project.id,url:url,target:target,method:operationInfo.httpMethod||operationInfo.methodType,headers:headers,dataParams:requestBody,authType:authType}},getDataInRun=function(variable,options,success,error){var requestMethod,params,callBackScope,methodInfo,service=variable.service,operation=variable.operation,variableOwner=variable.owner,serviceType=variable.serviceType,dataParams=[],requestParams="";serviceType!==SERVICE_TYPE_DATA&&WM.forEach(variable.dataBinding,function(param){dataParams.push(param)}),serviceType===SERVICE_TYPE_DATA?(WM.forEach(variable.dataBinding,function(paramValue,paramName){paramValue=WM.isDefined(paramValue)?paramValue:"",requestParams+=paramName+"="+encodeURIComponent(paramValue)+"&"}),requestParams=requestParams.slice(0,-1),params="procedure"===variable.operationType?{projectID:$rootScope.project.id,service:variable.prefabName?"":"services",dataModelName:service,procedureName:operation,page:options.page||1,procedureParams:requestParams,size:parseInt(variable.maxResults,10)||20,url:$rootScope.project.deployedUrl}:{projectID:$rootScope.project.id,service:variable.prefabName?"":"services",dataModelName:service,queryName:operation,page:options.page||1,queryParams:requestParams,size:parseInt(variable.maxResults,10)||20,url:$rootScope.project.deployedUrl}):-1!==VARIABLE_CONSTANTS.REST_SUPPORTED_SERVICES.indexOf(serviceType)&&variable.wmServiceOperationInfo?(methodInfo=WM.copy(variable.wmServiceOperationInfo),methodInfo.parameters&&methodInfo.parameters.forEach(function(param){param.sampleValue=variable.dataBinding[param.name]}),params=constructRestRequestParams(methodInfo,serviceType,variable)):serviceType===SERVICE_TYPE_REST?(dataParams=[service,operation,WM.copy(variable.dataBinding)],params={method:REST_METHOD_NAME,params:dataParams,url:$rootScope.project.deployedUrl,target:"invokeRestService"}):params={method:operation,serviceFile:service+".json",params:dataParams,url:$rootScope.project.deployedUrl},variable.prefabName&&-1===VARIABLE_CONSTANTS.REST_SUPPORTED_SERVICES.indexOf(serviceType)&&(params.url+="/prefabs/"+variable.prefabName,params.target="invokePrefabRestService"),callBackScope="App"===variableOwner?$rootScope||{}:variable.prefabName?options.scope||{}:options.scope&&options.scope.$$childTail?options.scope.$$childTail:{},CONSTANTS.isRunMode&&(variableActive[variable.activeScope.$id][variable.name]=!0),serviceType===SERVICE_TYPE_DATA?(requestMethod="procedure"===variable.operationType?"executeNamedProcedure":"executeNamedQuery",variable.promise=DatabaseService[requestMethod](params,function(response){processSuccessResponse(response,variable,callBackScope,options,success,error)},function(errorMsg){processErrorResponse(errorMsg,variable,callBackScope,error)})):-1!==REST_SUPPORTED_SERVICES.indexOf(serviceType)&&variable.wmServiceOperationInfo?variable.promise=WebService.invokeJavaService(params,function(response){processSuccessResponse(response,variable,callBackScope,options,success,error)},function(errorMsg){processErrorResponse(errorMsg,variable,callBackScope,error)}):serviceType===SERVICE_TYPE_REST?variable.promise=WebService.invokeRestService(params,function(response){processSuccessResponse(response,variable,callBackScope,options,success,error)},function(errorMsg){processErrorResponse(errorMsg,variable,callBackScope,error)}):variable.promise=WebService.invoke(params,function(response){processSuccessResponse(response,variable,callBackScope,options,success,error)},function(errMsg){processErrorResponse(errMsg,variable,callBackScope,error)})},getDataInStudio=function(variable,startNode,success){var service=variable.service,operation=variable.operation;ServiceFactory.getServicesWithType(function(){ServiceFactory.getServiceOperations(service,function(){ServiceFactory.getServiceOperationParams(service,operation,function(response){var typeRef=response["return"].typeRef,fieldValue=startNode?startNode.substring(variable.name.length+1,startNode.length):startNode;serviceModel={},variable.type=typeRef,variable.isList=response.isList,prepareServiceModel(typeRef,serviceModel,fieldValue,variable),variable.transformationColumns&&(serviceModel.wmTransformedData={},WM.forEach(variable.transformationColumns,function(columnName){serviceModel.wmTransformedData[columnName]=""})),variable.dataSet=serviceModel,Utils.triggerFn(success,serviceModel)})})})},setMatchedOperationParams=function(model,selectedOperation,operation){return operation.operationId===selectedOperation?(model.methodType=operation.operationType,model.name=operation.operationId,model.parameters=[],operation.parameters&&operation.parameters.length&&operation.parameters.forEach(function(parameter){model.parameters.push({name:parameter.name||parameter[parameterTypeKey]&&parameter[parameterTypeKey].toLowerCase(),parameterType:parameter[parameterTypeKey]})}),!0):void 0},getServiceOperationInfo=function(selectedOperation,selectedService,success,error,forceReload){var operationInfo={};setMatchedOperationParams.bind(void 0,operationInfo,selectedOperation);ServiceFactory.getServiceDef(selectedService,function(response){for(var pathsArr=Object.keys(response.paths),securityDefinitions=response.securityDefinitions,AUTH_TYPE_KEY="WM_Rest_Service_Authorization",i=0,nPaths=pathsArr.length;nPaths>i;i++){for(var pathKey=pathsArr[i],path=response.paths[pathKey],j=0,nOps=supportedOperations.length;nOps>j;j++){var opType=supportedOperations[j],operation=path[opType];if(operation&&operation.operationId===selectedOperation){operationInfo.methodType=opType,operationInfo.name=selectedOperation,operationInfo.relativePath=(path[BASE_PATH_KEY]||"")+path[RELATIVE_PATH_KEY],operation.consumes&&operation.consumes.length&&(operationInfo.consumes=operation.consumes),operationInfo.parameters=[],operation.parameters&&operation.parameters.length&&operation.parameters.forEach(function(parameter){operationInfo.parameters.push({name:parameter.name||parameter[parameterTypeKey]&&parameter[parameterTypeKey].toLowerCase(),parameterType:parameter[parameterTypeKey]})}),securityDefinitions&&securityDefinitions[AUTH_TYPE_KEY]&&"basic"===securityDefinitions[AUTH_TYPE_KEY].type&&operation.security[0][AUTH_TYPE_KEY]&&(operationInfo.authorization=securityDefinitions[AUTH_TYPE_KEY].type,operationInfo.parameters.push({name:"wm_auth_username",parameterType:"auth"}),operationInfo.parameters.push({name:"wm_auth_password",parameterType:"auth"}));break}}if(nOps>j)break}Utils.triggerFn(success,operationInfo)},function(errMsg){Utils.triggerFn(error,errMsg)},forceReload)},isPostRequest=function(variable){var opInfo=variable.wmServiceOperationInfo;return opInfo&&"POST"===opInfo.methodType&&1===opInfo.parameters.length&&"BODY"===opInfo.parameters[0].parameterType},methods={getDataSet:function(variable){return variable.dataSet},getData:function(variable,options,success,error){var variableName=variable.name,startNode=options.startNode;if(Utils.isEmptyObject(variable))return void error();if(CONSTANTS.isRunMode||options.forceRunMode){if(CONSTANTS.isRunMode&&(variableActive[variable.activeScope.$id]=variableActive[variable.activeScope.$id]||{},requestQueue[variable.activeScope.$id]=requestQueue[variable.activeScope.$id]||{},variableActive[variable.activeScope.$id][variableName]))return requestQueue[variable.activeScope.$id][variableName]=requestQueue[variable.activeScope.$id][variableName]||[],void requestQueue[variable.activeScope.$id][variableName].push({variable:variable,options:options,success:success,error:error});options.forceRunMode?ProjectService.run({projectId:$rootScope.project.id},function(result){$rootScope.project.deployedUrl=Utils.removeProtocol(result),getDataInRun(variable,options,success,error)}):getDataInRun(variable,options,success,error)}else if(variable.prefabName){var serviceModel={};prefabDataTypes[variable.prefabName]?(prepareServiceModel(variable.type,serviceModel,null,variable),variable.dataSet=serviceModel,Utils.triggerFn(success,serviceModel)):WebService.listPrefabTypes({projectID:$rootScope.project.id,prefabName:variable.prefabName},function(response){prefabDataTypes[variable.prefabName]=response.types,prepareServiceModel(variable.type,serviceModel,null,variable),variable.dataSet=serviceModel,Utils.triggerFn(success,serviceModel)})}else getDataInStudio(variable,startNode,success,error)},setService:function(variable,service){return service&&(variable.service=service),variable.service},setOperation:function(variable,operation){return operation&&(variable.operation=operation),variable.operation},clearData:function(variable){return variable.dataSet={},variable.dataSet},cancel:function(variable){variableActive[variable.activeScope.$id][variable.name]&&variable.promise&&variable.promise.abort()},setInput:function(variable,key,val){var paramObj={},targetObj=variable.dataBinding;return WM.isObject(key)?paramObj=key:paramObj[key]=val,isPostRequest(variable)&&(variable.dataBinding.body||(variable.dataBinding.body={}),targetObj=variable.dataBinding.body),WM.forEach(paramObj,function(paramVal,paramKey){targetObj[paramKey]=paramVal}),variable.dataBinding}},serviceVariableObj={update:function(options,success,error){var name=this.name;options=options||{},options.scope=this.activeScope||options.scope,CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!0),methods.getData(this,options,function(response){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1,response),Utils.triggerFn(success,response)},function(errMsg){CONSTANTS.isRunMode&&$rootScope.$emit("toggle-variable-state",name,!1),Utils.triggerFn(error,errMsg)})},setService:function(service){return methods.setService(this,service)},setOperation:function(operation){return methods.setOperation(this,operation)},getData:function(){return methods.getDataSet(this)},clearData:function(){return methods.clearData(this)},cancel:function(){return methods.cancel(this)},setInput:function(key,val){return methods.setInput(this,key,val)}};return BaseVariablePropertyFactory.register("wm.ServiceVariable",serviceVariableObj,["wm.Variable"],methods),{getServiceModel:function(params){var model={};return prepareServiceModel(params.typeRef,model,null,params.variable),model},getServiceOperationInfo:getServiceOperationInfo}}],wm.variables.services.NavigationVariableService=function($rootScope,BaseVariablePropertyFactory,Utils,ViewService,$window,DialogService,$timeout){"use strict";function showAncestors(element){var elemScope,ancestorSearchQuery="[wm-navigable-element='true']";element.parents(ancestorSearchQuery).toArray().reverse().forEach(function(parent){switch(elemScope=WM.element(parent).isolateScope(),elemScope._widgettype){case"wm-view":ViewService.showView(elemScope.name);break;case"wm-accordionpane":elemScope.expand();break;case"wm-tabpane":elemScope.select();break;case"wm-segment-content":elemScope.navigate();break;case"wm-panel":elemScope.expanded=!0}})}function showAncestorDialog(viewName){var dialogId;return WM.element("#wm-app-content [dialogtype]").each(function(i,dialog){return dialog=WM.element(dialog),WM.element(dialog.html()).find("[name='"+viewName+"']").length?(dialogId=dialog.attr("name"),DialogService.closeAllDialogs(),DialogService.showDialog(dialogId),!1):void 0}),dialogId}function navigateToView(viewName){var parentDialog,viewElement=WM.element("[name='"+viewName+"']"),elemScope=viewElement.isolateScope();if(viewElement.length)switch(elemScope._widgettype){case"wm-view":showAncestors(viewElement),ViewService.showView(viewName);break;case"wm-accordionpane":showAncestors(viewElement),elemScope.expand();break;case"wm-tabpane":showAncestors(viewElement),elemScope.select();break;case"wm-segment-content":showAncestors(viewElement),elemScope.navigate();break;case"wm-panel":elemScope.expanded=!0}else parentDialog=showAncestorDialog(viewName),$timeout(function(){parentDialog&&navigateToView(viewName,!1)})}function getPathPrefix(pageName){var pathPrefix;return pathPrefix=$rootScope.isSecurityEnabled&&"Login"===pageName?"login.html":"index.html"===$window.location.pathname.split("/").pop()?"index.html":"./"}function partialWithNameExists(name){var partials=WM.element("[page-container][content='"+name+"']");return partials.length}var methods={navigate:function(variable,options){var pageName,viewName,operation,sourceScope,pathPrefix;if(!Utils.isEmptyObject(variable)){switch(operation=variable.operation,sourceScope=options.scope||$rootScope,pageName=variable.dataBinding&&variable.dataBinding.pageName||variable.pageName,operation){case"gotoPage":try{pathPrefix=getPathPrefix(pageName),$window.location=pathPrefix+"#/"+pageName,sourceScope.$root.$safeApply(sourceScope)}catch(ignore){}break;case"gotoView":viewName=variable.dataBinding&&variable.dataBinding.viewName||variable.viewName;break;case"gotoTab":viewName=variable.dataBinding&&variable.dataBinding.tabName||variable.tabName;break;case"gotoAccordion":viewName=variable.dataBinding&&variable.dataBinding.accordionName||variable.accordionName;break;case"gotoSegment":viewName=variable.dataBinding&&variable.dataBinding.segmentName||variable.segmentName}if(viewName){if(variable.pageName&&variable.pageName!==$rootScope.activePageName&&!partialWithNameExists(variable.pageName))return void($window.location=getPathPrefix(pageName)+"#/"+variable.pageName+"."+viewName);navigateToView(viewName)}}}},basicVariableObj={navigate:function(){methods.navigate(this,{scope:this.activeScope})}};return BaseVariablePropertyFactory.register("wm.NavigationVariable",basicVariableObj,[],methods),{navigateToView:navigateToView}},wm.variables.services.NotificationVariableService=function(BaseVariablePropertyFactory,DialogService,$rootScope,wmToaster){"use strict";var methods={notify:function(variable,options,success,error){var scope,variableName=variable.name,dialogId="notification"+variable.operation+"dialog",variableOwner=variable.owner,operation=variable.operation,toasterOptions=WM.element("[toaster-options]").scope()&&WM.element("[toaster-options]").scope().config||{};if("toast"===operation){var type=variable.dataBinding["class"].toLowerCase(),body=variable.dataBinding.text,timeout=parseInt(variable.dataBinding.duration),positionClass="toast-"+variable.dataBinding.toasterPosition.replace(" ","-");toasterOptions.position=positionClass||"toast-bottom-right",wmToaster.show(type,"",body,timeout)}else scope="Application"===variableOwner?$rootScope||{}:options.scope.$$childTail||{},DialogService.showDialog(dialogId,{resolve:{dialogParams:function(){return{notificationDetails:{text:variable.dataBinding.text,okButtonText:variable.dataBinding.okButtonText,cancelButtonText:variable.dataBinding.cancelButtonText,alerttype:variable.dataBinding.alerttype,onOk:variableName+"onOk",onCancel:variableName+"onCancel",onClose:variableName+"onClose"},onOk:function(){variable.onOk.trim()&&(WM.isFunction(scope[variableName+"onOk"])?scope[variableName+"onOk"](variable,null):$rootScope.$emit("invoke-service",variable.onOk,{scope:scope})),DialogService.hideDialog(dialogId)},onCancel:function(){variable.onCancel.trim()&&(WM.isFunction(scope[variableName+"onCancel"])?scope[variableName+"onCancel"](variable,null):$rootScope.$emit("invoke-service",variable.onCancel,{scope:scope})),DialogService.hideDialog(dialogId)},onClose:function(){variable.onClose.trim()&&(WM.isFunction(scope[variableName+"onClose"])?scope[variableName+"onClose"](variable,null):$rootScope.$emit("invoke-service",variable.onClose,{scope:scope})),DialogService.hideDialog(dialogId)}}}},scope:scope})},getOperation:function(variable){return variable.operation},getMessage:function(variable){return variable.dataBinding.text},setMessage:function(variable,text){return"string"==typeof text&&(variable.dataBinding.text=text),variable.dataBinding.text},getOkButtonText:function(variable){return variable.dataBinding.okButtonText},setOkButtonText:function(variable,text){return"string"==typeof text&&(variable.dataBinding.okButtonText=text),variable.dataBinding.okButtonText},getToasterDuration:function(variable){return variable.dataBinding.duration},setToasterDuration:function(variable,duration){return variable.dataBinding.duration=duration,variable.dataBinding.duration},getToasterClass:function(variable){return variable.dataBinding["class"]},setToasterClass:function(variable,type){return"string"==typeof type&&(variable.dataBinding["class"]=type),variable.dataBinding["class"]},getToasterPosition:function(variable){return variable.dataBinding["class"]},setToasterPosition:function(variable,position){return"string"==typeof position&&(variable.dataBinding.position=position),variable.dataBinding.position},getAlertType:function(variable){return variable.dataBinding.alerttype},setAlertType:function(variable,alerttype){return"string"==typeof alerttype&&(variable.dataBinding.alerttype=alerttype),variable.dataBinding.alerttype},getCancelButtonText:function(variable){return variable.dataBinding.cancelButtonText},setCancelButtonText:function(variable,text){return"string"==typeof text&&(variable.dataBinding.cancelButtonText=text),variable.dataBinding.cancelButtonText}},basicVariableObj={notify:function(){methods.notify(this,{scope:this.activeScope})},getOperation:function(){return methods.getOperation(this,{scope:this.activeScope})},getMessage:function(){return methods.getMessage(this)},setMessage:function(text){return methods.setMessage(this,text)},getOkButtonText:function(){return methods.getOkButtonText(this)},setOkButtonText:function(text){return methods.setOkButtonText(this,text)},getToasterDuration:function(){return methods.getToasterDuration(this)},setToasterDuration:function(duration){return methods.setToasterDuration(this,duration)},getToasterClass:function(){return methods.getToasterClass(this)},setToasterClass:function(type){return methods.setToasterClass(this,type)},getToasterPosition:function(){return methods.getToasterPosition(this)},setToasterPosition:function(position){return methods.setToasterPosition(this,position)},getAlertType:function(){return methods.getAlertType(this)},setAlertType:function(alerttype){return methods.setAlertType(this,alerttype)},getCancelButtonText:function(){return methods.getCancelButtonText(this)},setCancelButtonText:function(text){return methods.setCancelButtonText(this,text)}};return BaseVariablePropertyFactory.register("wm.NotificationVariable",basicVariableObj,[],methods),{}},WM.module("wm.layouts.containers").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/container/accordion.html",'<div class="app-accordion panel-group" wmtransclude init-widget data-ng-show="show" apply-styles="container"></div>'),$templateCache.put("template/layout/container/accordion-pane.html",'<div class="app-accordion-panel panel panel-default" init-widget wmtransclude data-ng-show="show" wm-navigable-element="true"></div>'),$templateCache.put("template/layout/container/accordion-header.html",'<div class="panel-heading" data-ng-click="pane.togglePane()" init-widget apply-styles="container"><h3 class="panel-title"><a href="javascript:void(0)" class="accordion-toggle" wmtransclude></a></h3><div class="panel-actions"><span class="label label-{{badgetype}}">{{badgevalue}}</span><button class="app-icon glyphicon panel-action" data-ng-class="pane.active ? \'glyphicon-minus\': \'glyphicon-plus\'"></button></div></div>'),$templateCache.put("template/layout/container/accordion-content.html",'<div class="panel-collapse collapse"  data-ng-class="pane.active ? \'collapse in\' : \'collapse\'" init-widget page-container apply-styles="container"><div class="panel-body" wmtransclude page-container-target></div></div>')}]).directive("wmAccordion",["$templateCache","WidgetUtilService","PropertiesFactory",function($templateCache,WidgetUtilService,PropertiesFactory){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.accordion",["wm.base","wm.containers"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:$templateCache.get("template/layout/container/accordion.html"),controller:function($scope){this.panes=[],this.register=function(paneScope){this.panes.push(paneScope)},this.closeOthers=function(){$scope.closeothers&&WM.forEach(this.panes,function(pane){pane.active&&pane.onCollapse(),pane.active=!1})}},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs,ctrl){var defaultPane;defaultPane=_.find(ctrl.panes,function(pane){return pane.isdefaultpane})||ctrl.panes[0],defaultPane.expand(),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmAccordionpane",["$templateCache","WidgetUtilService","PropertiesFactory","Utils",function($templateCache,WidgetUtilService,PropertiesFactory,Utils){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.accordionpane",["wm.base"]);return{restrict:"E",replace:!0,scope:{onExpand:"&",onCollapse:"&"},transclude:!0,template:$templateCache.get("template/layout/container/accordion-pane.html"),require:"^wmAccordion",controller:function($scope){this.getPaneScope=function(){return $scope}},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs,panesCtrl){panesCtrl.register(scope),scope.togglePane=function(){scope.active=!scope.active,scope.active?(element.find(".ng-isolate-scope").each(function(){Utils.triggerFn(WM.element(this).isolateScope().redraw)}),Utils.triggerFn(scope.accordionContent.$lazyLoad),scope.onExpand(),panesCtrl.closeOthers(scope),scope.active=!0):scope.onCollapse()},scope.expand=function(){scope.active||scope.togglePane()},scope.collapse=function(){scope.active&&scope.togglePane()},WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmAccordionheader",["$templateCache","WidgetUtilService","PropertiesFactory","$compile",function($templateCache,WidgetUtilService,PropertiesFactory,$compile){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.accordionheader",["wm.base","wm.layouts"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:$templateCache.get("template/layout/container/accordion-header.html"),require:"^wmAccordionpane",compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps,scope.widgetProps.show&&delete scope.widgetProps.show},post:function(scope,element,attrs,paneCtrl){var template,transcludeTarget=element.find("[wmtransclude]");0===transcludeTarget.children().length&&(template='<i class="app-icon panel-icon {{iconclass}}" data-ng-show="iconclass"></i><span class="heading" data-ng-bind-html="heading"></span><span class="description" data-ng-bind-html="description"></span>',transcludeTarget.append($compile(template)(scope))),scope.pane=paneCtrl.getPaneScope(),scope.pane.isdefaultpane=scope.isdefaultpane,WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmAccordioncontent",["$templateCache","WidgetUtilService","PropertiesFactory","CONSTANTS",function($templateCache,WidgetUtilService,PropertiesFactory,CONSTANTS){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.accordioncontent",["wm.base","wm.layouts","wm.containers"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:$templateCache.get("template/layout/container/accordion-content.html"),require:"^wmAccordionpane",compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?(iScope.widgetProps=WM.copy(widgetProps),delete iScope.widgetProps.show):iScope.widgetProps=widgetProps,iScope.$lazyLoad=WM.noop},post:function(iScope,element,attrs,paneCtrl){iScope.pane=paneCtrl.getPaneScope(),iScope.pane.accordionContent=iScope,Object.defineProperty(iScope,"isActive",{get:function(){return this.pane.active}}),WidgetUtilService.postWidgetCreate(iScope,element,attrs)}}}}}]),WM.module("wm.layouts.containers").run(["$templateCache",function($tc){"use strict";$tc.put("template/widget/medialist-design.html",'<div class="app-medialist" init-widget apply-styles="shell"><div wmtransclude></div></div>'),$tc.put("template/widget/medialist.html",'<div class="app-medialist" data-ng-class="{\'singlerow\' : layout == \'Single-row\'}" init-widget><ul class="list-unstyled list-inline" wmtransclude></ul><div class="app-media-fullscreen modal fade in" hm-swipe-left="showNext()" hm-swipe-right="showPrev()"><div class="image-container"><div class="image-container-cell"><img class="center-block" data-ng-src="{{fieldDefs[selectedMediaIndex][mediaurl]}}"></div></div><div class="app-media-fullscreen-info-panel"><span class="pagination-info">{{selectedMediaIndex+1 + "/" + fieldDefs.length}}</span><i class="back-btn fa fa-long-arrow-left pull-left" data-ng-click="exitFullScreen()"></i></div><a class="app-media-fullscreen-nav-control left" data-ng-show="selectedMediaIndex < fieldDefs.length-1" data-ng-click="showNext()"><i class="glyphicon glyphicon-menu-left"></i></a><a class="app-media-fullscreen-nav-control right" data-ng-show="selectedMediaIndex >= 1" data-ng-click="showPrev()"><i class="glyphicon glyphicon-menu-right"></i></a></div></div>'),$tc.put("template/widget/medialist-template.html",'<div init-widget data-ng-style="{\'width\': width, \'height\': height}" class="app-medialist-template thumbnail"><img class="thumbnail-image-template" data-ng-src="{{imagesource}}"><div class="thumbnail-details" wmtransclude></div></div>')}]).directive("wmMediaList",["$templateCache","$compile","PropertiesFactory","WidgetUtilService","CONSTANTS","Utils",function($templateCache,$compile,PropertiesFactory,WidgetUtilService,CONSTANTS,Utils){"use strict";function controllerFn(){var _map={};this.$set=function(key,value){_map[key]=value},this.$get=function(key){return _map[key]}}function templateFn(){return CONSTANTS.isStudioMode?$templateCache.get("template/widget/medialist-design.html"):$templateCache.get("template/widget/medialist.html")}function updatePropertyPanelOptions(dataset,propertiesMap,scope){var variableKeys=[],wp=scope.widgetProps;WM.isObject(dataset)&&(variableKeys=WidgetUtilService.extractDataSetFields(dataset,propertiesMap),variableKeys=variableKeys.filter(function(variableKey){return null!==dataset[variableKey]&&!WM.isObject(dataset[variableKey])})),wp.thumbnailurl.options=wp.mediaurl.options=[""].concat(variableKeys)}function updateFieldDefs($is,$el,data){$is.fieldDefs=data,CONSTANTS.isRunMode&&($is.$mediaScope.fieldDefs=data)}function getVariable($is,variableName){if(!variableName)return void 0;var variables=$is.Variables||{};return variables[variableName]}function onDataChange($is,$el,nv){if(nv){if(nv.data)nv=nv.data;else if(!_.includes($is.binddataset,"bind:Widgets.")){
var boundVariableName=Utils.getVariableName($is),variable=getVariable($is,boundVariableName);if(variable&&"wm.LiveVariable"===variable.category)return}WM.isObject(nv)&&Utils.isPageable(nv)&&(nv=nv.content),WM.isObject(nv)&&!WM.isArray(nv)&&(nv=[nv]),$is.binddataset||WM.isString(nv)&&(nv=nv.split(",")),WM.isArray(nv)&&updateFieldDefs($is,$el,nv)}else CONSTANTS.isRunMode&&updateFieldDefs($is,$el,[])}function propertyChangeHandler($is,$el,attrs,key,nv,ov){"dataset"===key&&(onDataChange($is,$el,nv),CONSTANTS.isStudioMode&&updatePropertyPanelOptions(nv,nv.propertiesMap,$is))}function updateTmplAttrs(parentDataSet,idx,node){var _parentDataSet=parentDataSet.replace("bind:",""),regex=new RegExp("("+_parentDataSet+")(\\[0\\])?(.data\\[\\$i\\])?(.content\\[\\$i\\])?(\\[\\$i\\])?","g");_.forEach(node.attributes,function(attr){var value=attr.value;_.startsWith(value,"bind:")&&_.includes(value,_parentDataSet)&&(value=value.replace("bind:",""),value=value.replace(regex,"item"),attr.value="{{"+value+"}}")})}function applyWrapper($tmplContent){var tmpl=WM.element(elementsMarkup);return tmpl.find("> div > .thumbnail-details").append($tmplContent),tmpl}function prepareMediaListTemplate(tmpl,attrs){var $tmpl=WM.element(tmpl),$div=WM.element("<div></div>").append($tmpl);return $div.find("*").each(updateTmplAttrs.bind(void 0,attrs.dataset)),$tmpl=applyWrapper($tmpl)}function preLinkFn($is){$is.widgetProps=CONSTANTS.isStudioMode?WM.copy(widgetProps):widgetProps}function createChildScope($is,$el,listCtrl){var _scope=$el.scope(),$liScope=_scope.$new(),thumbnailDim=listCtrl.$get("thumbnailDimensions");return WM.extend($liScope,{thumbnailURL:$is.thumbnailurl,thumbnailWidth:thumbnailDim.width,thumbnailHeight:thumbnailDim.height}),$liScope}function runMode_postLinkFn($is,$el,attrs,listCtrl){var $mediaTemplate,$mediaScope=createChildScope($is,$el,listCtrl);$is.$mediaScope=$mediaScope,$mediaTemplate=prepareMediaListTemplate(listCtrl.$get("mediaListTemplate"),attrs),$el.find("> ul").append($mediaTemplate),$compile($mediaTemplate)($mediaScope),$mediaScope.showFullScreen=function(index){index<$mediaScope.fieldDefs.length&&($is.selectedMediaIndex=index,$el.find(".app-media-fullscreen").show())},$is.exitFullScreen=function(){$el.find(".app-media-fullscreen").hide()},$is.showPrev=function(){$mediaScope.showFullScreen($is.selectedMediaIndex-1)},$is.showNext=function(){$mediaScope.showFullScreen($is.selectedMediaIndex+1)},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,$is,$el,attrs),$is,notifyFor),WidgetUtilService.postWidgetCreate($is,$el,attrs)}function studioMode_postLinkFn($is,$el,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,$is,$el,attrs),$is,notifyFor),WidgetUtilService.postWidgetCreate($is,$el,attrs)}var directiveDefn,widgetProps=PropertiesFactory.getPropertiesOf("wm.medialist",["wm.base","wm.base.editors"]),notifyFor={dataset:!0},elementsMarkup='<li data-ng-repeat="item in fieldDefs" class="app-media-item" data-ng-click="showFullScreen($index)"><div data-ng-style="{\'width\': thumbnailWidth, \'height\': thumbnailHeight}" class="thumbnail"><img class="thumbnail-image" data-ng-src="{{item[thumbnailURL]}}"><div class="thumbnail-details"></div></div></li>';return directiveDefn={restrict:"E",replace:!0,scope:{},template:templateFn,transclude:!0,link:{pre:preLinkFn}},CONSTANTS.isRunMode?(directiveDefn.link.post=runMode_postLinkFn,directiveDefn.controller=controllerFn):directiveDefn.link.post=studioMode_postLinkFn,directiveDefn}]).directive("wmMediaTemplate",["PropertiesFactory","WidgetUtilService","CONSTANTS","$templateCache","Utils",function(PropertiesFactory,WidgetUtilService,CONSTANTS,$tc,Utils){"use strict";function preLinkFn($is){$is.widgetProps=widgetProps}function studioMode_postLinkFn($is,$el,attrs){$is.imagesource=Utils.getImageUrl("resources/images/imagelists/default-image.png"),WidgetUtilService.postWidgetCreate($is,$el,attrs)}function runMode_preLinkFn($is,$el,attrs,listCtrl){listCtrl.$set("mediaListTemplate",$el.children()),listCtrl.$set("thumbnailDimensions",{width:attrs.width,height:attrs.height}),$el.remove()}var widgetProps,directiveDefn={restrict:"E",replace:!0};return CONSTANTS.isStudioMode&&(widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.mediatemplate")),CONSTANTS.isStudioMode?WM.extend(directiveDefn,{transclude:!0,scope:{},template:$tc.get("template/widget/medialist-template.html"),link:{pre:preLinkFn,post:studioMode_postLinkFn}}):WM.extend(directiveDefn,{terminal:!0,require:"^wmMediaList",link:{pre:runMode_preLinkFn}}),directiveDefn}]),WM.module("wm.layouts.containers").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/container/form.html",'<form role="form" data-ng-show="show" init-widget class="panel app-form" ng-class="[captionAlignClass, captionPositionClass, formClassName]" autocomplete="autocomplete" apply-styles="container" ><div class="panel-heading" data-ng-if="title"><h4 class="form-header panel-title">{{title}}</h4></div><div class="form-body panel-body" wmtransclude></div></form>')}]).directive("wmForm",["PropertiesFactory","WidgetUtilService","$compile",function(PropertiesFactory,WidgetUtilService,$compile){"use strict";function propertyChangeHandler(scope,element,attrs,key,newVal){var value,resetBtnTemplate;switch(key){case"captionsize":element.find(".form-group .app-label.ng-isolate-scope").each(function(){WM.element(this).isolateScope().width=newVal});break;case"captionalign":scope.captionAlignClass="align-"+newVal;break;case"captionposition":scope.captionPositionClass="position-"+newVal;break;case"novalidate":newVal===!0||"true"===newVal?element.attr("novalidate",""):element.removeAttr("novalidate");break;case"autocomplete":value=newVal===!0||"true"===newVal?"on":"off",element.attr(key,value);break;case"submitbutton":newVal===!0||"true"===newVal?element.append($compile(submitBtnTemplate)(scope)):element.find(".form-submit").remove();break;case"resetbutton":newVal===!0||"true"===newVal?(resetBtnTemplate=$compile('<wm-button class="reset-submit" type="reset" caption="reset" '+(scope.widgetid?"":'on-click="resetForm();"')+" ></wm-button>")(scope),element.append(resetBtnTemplate)):element.find(".reset-submit").remove();break;case"method":scope.widgetProps.enctype.show="post"===newVal;break;case"action":attrs.$set("action",newVal)}}function resetForm(element){element.find(".app-files-upload-status, .app-richtexteditor [ng-model]").empty()}function bindEvents(scope,element){element.on("submit",function(event){if(scope.onSubmit){var files,fileTypeInputs=element.find("[type=file]"),serializedArray=element.serializeArray();return fileTypeInputs.length>0&&WM.forEach(fileTypeInputs,function(input){files=input.files,serializedArray.push({name:input.name,value:files})}),scope.onSubmit({$event:event,$scope:scope,$formData:serializedArray})}})}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.form",["wm.base","wm.layouts","wm.base.events.touch"]),notifyFor={captionsize:!0,novalidate:!0,autocomplete:!0,submitbutton:!0,resetbutton:!0,captionalign:!0,captionposition:!0,method:!0,action:!0},submitBtnTemplate='<wm-button class="form-submit" type="submit" caption="submit"></wm-button>';return{restrict:"E",replace:!0,scope:{},transclude:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/layout/container/form.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){scope.layoutObj={"One Column":1,"Two Column":2,"Three Column":3,"Four Column":4},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element,attrs),scope,notifyFor),scope.widgetid||(bindEvents(scope,element),scope.resetForm=resetForm.bind(void 0,element)),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.containers").directive("wmLayoutgrid",["PropertiesFactory","WidgetUtilService","$rootScope",function(PropertiesFactory,WidgetUtilService,$rootScope){"use strict";function refactorClassName(element,newClass){var classArray=element.attr("class").split(" ");WM.forEach(classArray,function(classname){0===classname.indexOf("col-")&&element.removeClass(classname)}),element.addClass(newClass)}function setColumnWidth(columns,value){var className=($rootScope.isMobileApplicationType?"col-xs-":"col-sm-")+value;WM.forEach(columns,function(column){refactorClassName(WM.element(column),className)})}function setDefaultColumnWidth(gridColumns,totalColWidth){var defaultWidth,cols=[];WM.forEach(gridColumns,function(column){var col=WM.element(column),width=col.attr("columnwidth");width?totalColWidth-=width:cols.push(col)}),cols.length&&(defaultWidth=parseInt(totalColWidth/cols.length,10),setColumnWidth(cols,defaultWidth))}function propertyChangeHandler(scope,element,key,newVal,oldVal){var oldValue,columnElements,rowElements,i;switch(key){case"columns":oldValue=oldVal||scope.columns,scope.$root.$emit("construct-grid",key,element,oldValue,newVal),parseInt(oldValue,10)!==parseInt(newVal,10)&&(rowElements=element.children(".app-grid-row"),WM.forEach(rowElements,function(rowElement){columnElements=WM.element(rowElement).children(".app-grid-column"),setDefaultColumnWidth(columnElements,12)}));break;case"rows":if(oldValue=oldVal||scope.rows,oldValue=parseInt(oldValue,10),scope.$root.$emit("construct-grid",key,element,oldValue,newVal),rowElements=element.children(".app-grid-row"),newVal>oldValue)for(i=0;newVal-oldValue>i;i++)columnElements=rowElements.eq(oldValue+i).children(".app-grid-column"),setColumnWidth(columnElements,12/scope.columns);0===newVal&&(scope.columns=0)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.layoutgrid",["wm.layouts"]),notifyFor={columns:!0,rows:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:'<div init-widget class="app-grid-layout clearfix" apply-styles="container" wmtransclude></div>',compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){var totalColumnWidth=12,gridRows=element.children(".app-grid-row");WM.forEach(gridRows,function(row){var gridColumns=WM.element(row).children(".app-grid-column");setDefaultColumnWidth(gridColumns,totalColumnWidth)}),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmGridrow",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";function propertyChangeHandler(scope,key){switch(key){case"height":scope.overflow="auto"}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.gridrow",["wm.layouts"]),notifyFor={height:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:'<div init-widget data-ng-class="show" class="app-grid-row clearfix" apply-styles="container" wmtransclude></div>',compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmGridcolumn",["PropertiesFactory","WidgetUtilService","$rootScope",function(PropertiesFactory,WidgetUtilService,$rootScope){"use strict";function setColumnWidth(element,value){var classArray=element.attr("class").split(" ");WM.forEach(classArray,function(classname){0===classname.indexOf("col-")&&element.removeClass(classname)}),element.addClass(($rootScope.isMobileApplicationType?"col-xs-":"col-sm-")+value)}function propertyChangeHandler(element,key,newVal){switch(key){case"columnwidth":setColumnWidth(element,newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.gridcolumn",["wm.layouts"]),notifyFor={columnwidth:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:'<div init-widget data-ng-class="show" class="app-grid-column" apply-styles="container"><div class="app-ng-transclude" wmtransclude></div></div>',compile:function(){return{pre:function(scope,element,attrs){scope.widgetProps=widgetProps,attrs.columnwidth&&setColumnWidth(element,attrs.columnwidth)},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.containers").directive("wmList",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.list",["wm.layouts"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:'<ul class="app-list" ng-class="[layout]" data-ng-show="show" apply-styles="container" data-element-type="wmList" wmtransclude init-widget has-model ></ul>',compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmListItem",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.listitem",["wm.layouts"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:'<li init-widget class="app-list-item" apply-styles="container" wmtransclude></li>',compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.containers").directive("wmBreadcrumb",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";function getNodes(scope,newVal){var nodes=[];return WM.isString(newVal)?(newVal=newVal.trim(),newVal&&(nodes=newVal.split(",").map(function(item){return{label:item&&item.trim()}}))):WM.isArray(newVal)?WM.forEach(newVal,function(item){nodes.push({label:item[scope.itemlabel||"label"],icon:item[scope.itemicon||"icon"],link:item[scope.itemlink||"link"]})}):WM.isObject(newVal)&&(nodes=[{label:newVal[scope.itemlabel||"label"],icon:newVal[scope.itemicon||"icon"],link:newVal[scope.itemlink||"link"]}]),scope.widgetid&&(scope.keys=WM.isObject(nodes[0])?Object.keys(nodes[0]):[],scope.widgetProps.itemlabel.options=scope.widgetProps.itemicon.options=scope.widgetProps.itemlink.options=scope.keys),nodes}function propertyChangeHandler(scope,key){switch(key){case"dataset":case"scopedataset":case"itemicon":case"itemlabel":case"itemlink":scope.nodes=getNodes(scope,scope.dataset)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.breadcrumb",["wm.layouts"]),notifyFor={dataset:!0,scopedataset:!0,itemicon:!0,itemlabel:!0,itemlink:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:'<ol class="breadcrumb app-breadcrumb" data-ng-show="show" apply-styles data-element-type="wmBreadCrumb"  init-widget has-model ><li data-ng-repeat="item in nodes" data-ng-class="{\'active\':$last}"><i class="{{item.icon}}"></i> <a title="{{item.label}}" href="{{item.link}}" data-ng-if="!$last">{{item.label}}</a><label data-ng-if="$last">{{item.label}}</label></li></ol> ',compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){var onPropertyChange=propertyChangeHandler.bind(void 0,scope);WidgetUtilService.registerPropertyChangeListener(onPropertyChange,scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.containers").directive("wmNav",["Utils","PropertiesFactory","WidgetUtilService","$rootScope","$compile","$timeout","$routeParams",function(Utils,PropertiesFactory,WidgetUtilService,$rootScope,$compile,$timeout,$routeParams){"use strict";function getNodes(scope,newVal){var nodes=[];return WM.isString(newVal)?(newVal=newVal.trim(),newVal&&(nodes=newVal.split(",").map(function(item){return{label:item&&item.trim()}}))):WM.isArray(newVal)?nodes=newVal:WM.isObject(newVal)&&(nodes=[newVal]),scope.newcolumns&&(scope.newcolumns=!1,scope.itemlabel="",scope.itemchildren="",scope.itemicon="",scope.itemlink="",scope.$root.$emit("set-markup-attr",scope.widgetid,{itemlabel:scope.itemlabel,itemchildren:scope.itemchildren,itemicon:scope.itemicon,itemlink:scope.itemlink})),scope.widgetid&&(scope.keys=WM.isObject(nodes[0])?Object.keys(nodes[0]):[],scope.widgetProps.itemlabel.options=scope.widgetProps.itemchildren.options=scope.widgetProps.itemicon.options=scope.widgetProps.itemlink.options=scope.keys),nodes}function constructNav(element,scope){if(element.empty(),scope.nodes&&scope.nodes.length){var iconField=scope.itemicon||"icon",labelField=scope.itemlabel||"label",itemField=scope.itemlink||"link",childrenField=scope.itemchildren||"children";scope.nodes.forEach(function(node){var $innerAnchor,$innerList,$innericonNode,ulNode,$anchor=WM.element('<a class="app-anchor"></a>'),$list=WM.element('<li class="app-nav-item"></li>'),$iconNode=WM.element('<i class="app-nav-icon"></i>'),itemLabel=node[labelField],itemClass=node[iconField],itemLink=node[itemField],itemChildren=node[childrenField],$caret=WM.element('<span class="caret"></span>');$routeParams.name===(itemLink&&itemLink.substring(1))&&$anchor.addClass("active"),itemChildren&&WM.isArray(itemChildren)?($iconNode.addClass(itemClass),$anchor.html(itemLabel).attr("dropdown-toggle","").addClass("app-anchor dropdown-toggle").prepend($iconNode).append($caret),$list.append($anchor).attr("dropdown","").addClass("dropdown"),ulNode=WM.element('<ul class="dropdown-menu"></ul>'),itemChildren.forEach(function(child){$innerAnchor=WM.element('<a class="app-anchor"></a>'),$innerList=WM.element('<li class="app-nav-item"></li>'),$innericonNode=WM.element('<i class="app-nav-icon"></i>'),itemLabel=child[labelField],itemClass=child[iconField],itemLink=child[itemField],$innericonNode.addClass(itemClass),$innerAnchor.html(itemLabel).attr("href",itemLink).prepend($innericonNode),$innerList.append($innerAnchor),ulNode.append($innerList)}),$list.append(ulNode),element.append($list)):($iconNode.addClass(itemClass),$anchor.html(itemLabel).attr("href",itemLink).prepend($iconNode),$list.append($anchor),element.append($list)),$compile($list)(scope)})}}function propertyChangeHandler(scope,element,key,newVal){var variable,elScope=element.scope();switch(key){case"dataset":variable=elScope.Variables[Utils.getVariableName(scope,elScope)],variable&&"wm.LiveVariable"===variable.category&&(newVal=newVal.data);case"scopedataset":scope.nodes=getNodes(scope,newVal),constructNav(element,scope),scope.widgetid&&$rootScope.$emit("nav-dataset-modified",{widgetName:scope.name});break;case"itemicon":case"itemlabel":case"itemlink":case"itemchildren":constructNav(element,scope)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.nav",["wm.layouts"]),notifyFor={dataset:!0,scopedataset:!0,itemicon:!0,itemlabel:!0,itemlink:!0,itemchildren:!0};return{restrict:"E",replace:!0,scope:{scopedataset:"=?"},transclude:!0,template:'<ul class="nav app-nav" data-ng-show="show" apply-styles="container" data-element-type="wmNav" wmtransclude init-widget data-ng-class="{\'nav-pills\': type == \'pills\','+"'nav-tabs': type == 'tabs','navbar-nav': type == 'navbar','nav-stacked': layout == 'stacked','nav-justified': layout == 'justified'}\"></ul>",compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){var onPropertyChange=propertyChangeHandler.bind(void 0,scope,element);WidgetUtilService.registerPropertyChangeListener(onPropertyChange,scope,notifyFor),!scope.widgetid&&attrs.scopedataset&&$timeout(function(){scope.$watch("scopedataset",function(newVal){onPropertyChange("scopedataset",newVal)})},0,!0),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmNavItem",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.navitem",["wm.layouts"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:'<li init-widget class="app-nav-item" apply-styles="container" wmtransclude></li>',compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.containers").directive("wmNavbar",["PropertiesFactory","WidgetUtilService","Utils",function(PropertiesFactory,WidgetUtilService,Utils){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"imgsrc":scope.imagesrc=Utils.getImageUrl(newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.navbar",["wm.layouts"]),notifyFor={imgsrc:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:'<nav class="navbar navbar-default app-navbar" data-ng-show="show" apply-styles="container" data-element-type="wmNavbar"  init-widget has-model ><div class="container-fluid"><div class="navbar-header"> <button type="button" class="btn-transparent navbar-toggle collapsed" data-toggle="collapse" data-target="collapse-content" ng-click="navbarCollapsed = !navbarCollapsed"><span class="sr-only">Toggle navigation</span><i class="glyphicon glyphicon-option-vertical"></i></button><a class="navbar-brand" href="#" data-ng-if="title || imagesrc"><img data-identifier="img" class="brand-image" alt="{{title}}" width="20" height="20" data-ng-if="imgsrc" data-ng-src="{{imagesrc}}"/>{{title}}</a></div><div class="collapse navbar-collapse" id="collapse-content" wmtransclude ng-init="navbarCollapsed = true" collapse="navbarCollapsed"></div></div></nav> ',compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.containers").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/container/panel.html",'<div page-container init-widget class="app-panel panel" ng-class="[helpClass]" data-ng-show="show" apply-styles="shell" wm-navigable-element="true"><div class="panel-heading"><h3 class="panel-title"><a href="javascript:void(0)" class="panel-toggle" data-ng-click="togglePanel()"><i class="app-icon panel-icon {{iconclass}}" data-ng-show="iconclass"></i><span class="heading">{{title}}</span><span class="description">{{description}}</span></a><div class="panel-actions"><span data-ng-if="badgevalue" class="label label-{{badgetype}}">{{badgevalue}}</span><wm-menu scopedataset="actions" iconname="cog" data-ng-if="actions" title="{{::$root.appLocale.LABEL_ACTIONS}}" on-select="onActionsclick({$item:$item})" datafield="{{datafield}}" itemlabel="{{binditemlabel || itemlabel || displayfield}}" menuposition="down,left" itemicon="{{binditemicon || itemicon}}" itemlink="{{binditemlink || itemlink}}" itemchildren="{{binditemchildren || itemchildren}}"></wm-menu><button class="app-icon panel-action glyphicon glyphicon-question-sign" title="{{::$root.appLocale.LABEL_HELP}}" data-ng-if="helptext" data-ng-click="toggleHelp()"></button><button class="app-icon glyphicon panel-action" data-ng-if="collapsible" title="{{::$root.appLocale.LABEL_COLLAPSE}}/{{::$root.appLocale.LABEL_EXPAND}}" data-ng-class="expanded ? \'glyphicon-minus\': \'glyphicon-plus\'" data-ng-click="togglePanel($event);"></button><button class="app-icon glyphicon panel-action glyphicon-remove" title="{{::$root.appLocale.LABEL_CLOSE}}" data-ng-if="closable" data-ng-click="closePanel();onClose({$event: $event, $scope: this})"></button></div></h3></div><div class="panel-content" data-ng-show="expanded" ><div class="panel-body" wmtransclude page-container-target data-ng-style="{height: height, overflow: overflow,paddingTop: paddingtop + paddingunit,paddingRight: paddingright + paddingunit,paddingLeft: paddingleft + paddingunit,paddingBottom: paddingbottom + paddingunit}" ></div><aside class="panel-help-message"><h5 class="panel-help-header">{{::$root.appLocale.LABEL_HELP}}</h5><div class="panel-help-content" data-ng-bind-html="helptext"></div></aside></div></div>'),$templateCache.put("template/layout/container/panel-footer.html",'<div class="app-panel-footer panel-footer" data-ng-show="expanded" wmtransclude></div>')}]).directive("wmPanel",["PropertiesFactory","WidgetUtilService","Utils","CONSTANTS",function(PropertiesFactory,WidgetUtilService,Utils,CONSTANTS){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"height":newVal&&CONSTANTS.isStudioMode&&(scope.minheight=0);break;case"actions":CONSTANTS.isStudioMode&&(WidgetUtilService.updatePropertyPanelOptions(newVal.data||newVal,newVal.propertiesMap,scope),scope.itemlabel=scope.itemlabel||scope.displayfield)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.panel",["wm.layouts","wm.containers","wm.base.events.touch","wm.menu.dataProps"]),notifyFor={height:!0,actions:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:function(tElement,tAttrs){var isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),template=WM.element(WidgetUtilService.getPreparedTemplate("template/layout/container/panel.html",tElement,tAttrs));return isWidgetInsideCanvas||tAttrs.hasOwnProperty("onEnterkeypress")&&template.attr("data-ng-keypress","onKeypress({$event: $event, $scope: this})"),template[0].outerHTML},controller:function(){this.registerFooter=function(footer){this.footer=footer}},compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs,panelCtrl){void 0===scope.expanded&&(scope.expanded=!0),scope.togglePanel=function($event){scope.collapsible&&CONSTANTS.isRunMode&&(scope.expanded?scope.onCollapse&&scope.onCollapse({$event:$event,$scope:this}):scope.onExpand&&scope.onExpand({$event:$event,$scope:this}),scope.expanded=!scope.expanded,panelCtrl.footer&&(panelCtrl.footer.isolateScope().expanded=scope.expanded))},scope.toggleHelp=function(){scope.helptext&&CONSTANTS.isRunMode&&(scope.helpClass=scope.helpClass?null:"show-help")},scope.closePanel=function(){scope.show=!1},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs),scope.widgetid||(scope.onKeypress=function(args){var action=Utils.getActionFromKey(args.$event);"ENTER"===action&&scope.onEnterkeypress(args)}),panelCtrl.footer&&element.append(panelCtrl.footer)}}}}}]).directive("wmPanelFooter",["$templateCache",function($templateCache){"use strict";return{restrict:"E",replace:!0,scope:{},transclude:!0,require:"^wmPanel",template:$templateCache.get("template/layout/container/panel-footer.html"),link:function(scope,element,attrs,panelCtrl){scope.expanded=!0,panelCtrl.registerFooter(element)}}}]),WM.module("wm.layouts.containers").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/container/container.html",'<div page-container init-widget class="app-container" data-ng-show="show" apply-styles="container" wmtransclude page-container-target></div>')}]).directive("wmContainer",["PropertiesFactory","WidgetUtilService","Utils","CONSTANTS",function(PropertiesFactory,WidgetUtilService,Utils,CONSTANTS){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.container",["wm.layouts","wm.containers","wm.base.events.touch"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:function(tElement,tAttrs){var isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),$template=WM.element(WidgetUtilService.getPreparedTemplate("template/layout/container/container.html",tElement,tAttrs));return isWidgetInsideCanvas||tAttrs.hasOwnProperty("onEnterkeypress")&&$template.attr("data-ng-keypress","onKeypress({$event: $event, $scope: this})"),$template[0].outerHTML},compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs),scope.widgetid||(scope.onKeypress=function(args){var action=Utils.getActionFromKey(args.$event);"ENTER"===action&&scope.onEnterkeypress(args)})}}}}}]),WM.module("wm.layouts.containers").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/tile/tile.html",'<div init-widget class="app-tile panel" data-ng-show="show" apply-styles wm-navigable-element="true"><div class="app-tile-body panel-body" wmtransclude ></div></div>')}]).directive("wmTile",["PropertiesFactory","WidgetUtilService","Utils","CONSTANTS",function(PropertiesFactory,WidgetUtilService,Utils,CONSTANTS){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.tile",["wm.layouts","wm.containers","wm.base.events.touch"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:function(tElement,tAttrs){var isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),$template=WM.element(WidgetUtilService.getPreparedTemplate("template/layout/tile/tile.html",tElement,tAttrs));return isWidgetInsideCanvas||tAttrs.hasOwnProperty("onEnterkeypress")&&$template.attr("data-ng-keypress","onKeypress({$event: $event, $scope: this})"),$template[0].outerHTML},compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs),scope.widgetid||(scope.onKeypress=function(args){var action=Utils.getActionFromKey(args.$event);"ENTER"===action&&scope.onEnterkeypress(args)})}}}}}]),WM.module("wm.layouts.containers").run(["$rootScope","$templateCache",function($rootScope,$templateCache){"use strict";$templateCache.put("template/layout/container/tabs.html",'<div class="app-tabs clearfix" init-widget data-ng-show="show" apply-styles="container"><ul class="nav nav-tabs" data-ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}"></ul><div class="tab-content" data-ng-class="{\'tab-stacked\': vertical, \'tab-justified\': justified}" wmtransclude></div></div>'),$templateCache.put("template/layout/container/tab-pane.html",'<div class="tab-pane" wmtransclude init-widget data-ng-show="show" data-ng-class="{active: isActive, disabled:disabled}" wm-navigable-element="true"></div>'),$templateCache.put("template/layout/container/tab-header.html",'<li class="tab-header" data-ng-class="{active: tab.isActive, disabled: tab.disabled}" data-ng-show="tab.show" data-tab-id="{{tab.widgetid}}" data-ng-click="tab.select()" init-widget><a wmtransclude apply-styles="container"></a></li>'),$templateCache.put("template/layout/container/tab-content.html",'<div page-container wmtransclude page-container-target class="tab-body" data-tab-id="{{tab.widgetid}}" init-widget apply-styles></div>')}]).directive("wmTabs",["PropertiesFactory","$templateCache","WidgetUtilService","Utils",function(PropertiesFactory,$templateCache,WidgetUtilService,Utils){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"tabsposition":scope.setTabsPosition(newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.tabs",["wm.base","wm.layouts","wm.containers"]),notifyFor={tabsposition:!0};return{restrict:"E",scope:{},replace:!0,transclude:!0,template:$templateCache.get("template/layout/container/tabs.html"),controller:function($scope,$element){$scope.tabs=[],this.register=function(tabScope){$scope.tabs.push(tabScope)},this.unregister=function(tab){var i,len=$scope.tabs.length;for(i=0;len>i&&$scope.tabs[i].$id!==tab.$id;i++);$scope.tabs.splice(i,1),$element.find('[data-tab-id="'+tab.widgetid+'"]').remove()},this.selectTab=function(tab,skipOnSelect){var i,_tab=$scope.activeTab,tabs=$scope.tabs;for(_tab&&(_tab.onDeselect(),
_tab.isActive=!1),$scope.activeTab=tab,i=0;i<tabs.length;i++)if($scope.activeTab.$id===tabs[i].$id){$scope.activeTabIndex=i;break}skipOnSelect||tab.onSelect(),Utils.triggerFn(tab.tabContent.$lazyLoad)},$scope.selectTab=this.selectTab},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){function selectTab(tab,onBeforeSwitchTab){Utils.triggerFn(onBeforeSwitchTab),tab&&tab.select()}var activeTab,tab,tabs=scope.tabs;tabs.forEach(function(tab){activeTab?tab.isActive=!1:tab.isdefaulttab&&(activeTab=tab)}),activeTab=activeTab||tabs[0],activeTab&&(activeTab.isActive=!0,scope.selectTab(activeTab,!0)),scope.next=function(onBeforeSwitchTab){selectTab(tabs[scope.activeTabIndex+1],onBeforeSwitchTab)},scope.previous=function(onBeforeSwitchTab){selectTab(tabs[scope.activeTabIndex-1],onBeforeSwitchTab)},scope.goToTab=function(tabNum,onBeforeSwitchTab){WM.isNumber(tabNum)&&tabNum>0&&tabNum<=tabs.length&&(tab=tabs[tabNum-1],selectTab(tab,onBeforeSwitchTab))},scope.setTabsPosition=function(tabsposition){var _tabs=element.find(">ul.nav-tabs");element.removeClass("inverted"),"bottom"===tabsposition||"right"===tabsposition?(element.addClass("inverted"),element.append(_tabs)):element.prepend(_tabs),scope.vertical="left"===tabsposition||"right"===tabsposition},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs),scope.setTabsPosition(attrs.tabsposition||("true"===attrs.vertical?"left":"top"))}}}}}]).directive("wmTabpane",["PropertiesFactory","$templateCache","WidgetUtilService","Utils",function(PropertiesFactory,$templateCache,WidgetUtilService,Utils){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.tabpane",["wm.base"]);return{restrict:"E",scope:{onSelect:"&",onDeselect:"&",onClose:"&"},replace:!0,require:"^wmTabs",transclude:!0,template:$templateCache.get("template/layout/container/tab-pane.html"),controller:function($scope,$element){var tabsTarget=$element.closest(".app-tabs").children(".nav-tabs");this.registerHead=function(scope){return tabsTarget.append(scope._element),$scope.tabHead=scope,$scope},this.registerContent=function(scope){return $scope.tabContent=scope,$scope}},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs,ctrl){ctrl.register(scope),scope.$on("$destroy",function(){ctrl.unregister(scope)}),scope.select=function(){scope.isActive||scope.disabled||(element.find(".ng-isolate-scope").each(function(){Utils.triggerFn(WM.element(this).isolateScope().redraw)}),scope.isActive=!0,ctrl.selectTab(scope))},WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmTabheader",["$compile","PropertiesFactory","WidgetUtilService","$templateCache","Utils",function($compile,PropertiesFactory,WidgetUtilService,$templateCache,Utils){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"paneicon":scope.iconsource=Utils.getBackGroundImageUrl(newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.tabheader",["wm.base","wm.layouts"]),notifyFor={paneicon:!0};return{restrict:"E",scope:{},replace:!0,require:"^wmTabpane",transclude:!0,template:$templateCache.get("template/layout/container/tab-header.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps,scope.widgetProps.show&&delete scope.widgetProps.show},post:function(scope,element,attrs,ctrl){var template,transcludeTarget=element.children("[wmtransclude]");WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),0===transcludeTarget.children().length&&(template='<div class="tab-heading"><i class="app-icon" data-ng-show="iconsource" data-ng-style ="{backgroundImage:iconsource}">&nbsp;</i><span data-ng-bind-html="heading"></span><i data-ng-click="tab.onClose();" data-ng-if="tab.closable">&nbsp;</i></div>',template=WM.element(template),transcludeTarget.append(template),$compile(template)(scope)),scope._element=element,scope.tab=ctrl.registerHead(scope),scope.tab.isdefaulttab=scope.isdefaulttab,WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmTabcontent",["PropertiesFactory","WidgetUtilService","$templateCache","CONSTANTS",function(PropertiesFactory,WidgetUtilService,$templateCache,CONSTANTS){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.tabcontent",["wm.base","wm.layouts"]);return{restrict:"E",scope:{},replace:!0,require:"^wmTabpane",transclude:!0,template:$templateCache.get("template/layout/container/tab-content.html"),compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?(iScope.widgetProps=WM.copy(widgetProps),delete iScope.widgetProps.show):iScope.widgetProps=widgetProps,iScope.$lazyLoad=WM.noop},post:function(iScope,element,attrs,ctrl){iScope.tab=ctrl.registerContent(iScope),Object.defineProperty(iScope,"isActive",{get:function(){return this.tab.isActive}}),WidgetUtilService.postWidgetCreate(iScope,element,attrs)}}}}}]),WM.module("wm.layouts.device").service("MobileEventService",function(){"use strict";function swipe(direction,selector,callback){var startTime,ALLOWED_TIME=2e3,startPosition={},touchElement=WM.element(selector)[0];touchElement.addEventListener("touchstart",function(touchEvent){touchEvent.preventDefault(),startTime=(new Date).getTime();var touchObj=touchEvent.changedTouches[0];startPosition.x=touchObj.pageX,startPosition.y=touchObj.pageY},!1),touchElement.addEventListener("touchmove",function(touchEvent){touchEvent.preventDefault()},!1),touchElement.addEventListener("touchend",function(touchEvent){touchEvent.preventDefault();var actualSwipeDirection,swipeDuration=(new Date).getTime()-startTime,distance={},touchObj=touchEvent.changedTouches[0];ALLOWED_TIME>=swipeDuration&&(distance.x=touchObj.pageX-startPosition.x,distance.y=touchObj.pageY-startPosition.y,Math.abs(distance.x)>=0&&Math.abs(distance.x)>=Math.abs(distance.y)?actualSwipeDirection=distance.x<0?SWIPE_DIRECTION.LEFT:SWIPE_DIRECTION.RIGHT:Math.abs(distance.y)>=0&&Math.abs(distance.y)>=Math.abs(distance.x)&&(actualSwipeDirection=distance.y<0?SWIPE_DIRECTION.UP:SWIPE_DIRECTION.DOWN),actualSwipeDirection===direction&&callback())},!1)}var SWIPE_DIRECTION={LEFT:"LEFT",UP:"UP",DOWN:"DOWN",RIGHT:"RIGHT"};return{touch:function(selector,callback){var el=WM.element(selector)[0];el&&("ontouchend"in window?el.addEventListener("touchend",function(){callback()},!1):el.addEventListener("click",function(){callback()},!1))},swipeUp:function(selector,callback){swipe(SWIPE_DIRECTION.UP,selector,callback)},swipeDown:function(selector,callback){swipe(SWIPE_DIRECTION.DOWN,selector,callback)},swipeLeft:function(selector,callback){swipe(SWIPE_DIRECTION.LEFT,selector,callback)},swipeRight:function(selector,callback){swipe(SWIPE_DIRECTION.RIGHT,selector,callback)}}}),WM.module("wm.layouts.device").service("DeviceViewService",["MobileEventService","Utils","$rootScope",function(MobileEventService,Utils,$rootScope){"use strict";function roleSelector(roleName){return"[data-role='"+roleName+"']"}function classSelector(className){return"."+className}function getLeftPanelScope(){return WM.element(roleSelector(LEFT_PANEL_CLASS_NAME)).isolateScope()}function hidePageContainers(){var leftPanelScope=getLeftPanelScope();Utils.isMobile()?(leftPanelScope&&leftPanelScope.collapse(),WM.element(roleSelector(HEADER_CLASS_NAME)+" "+classSelector(SEARCH_CONTAINER_CLASS_NAME)).hide(),$rootScope.sidebarCollapsed=!0):(leftPanelScope&&leftPanelScope.expand(),WM.element(classSelector(SEARCH_CONTAINER_CLASS_NAME)).show().css("display","inline-table"))}function toggleSearchContainer(ele){var searchEle=WM.element(ele);"none"===searchEle.css("display")?(hidePageContainers(),searchEle.css("display","inline-table")):hidePageContainers()}function bindLeftPanelEvents(){MobileEventService.touch(roleSelector(SWIPE_ELEM_CLASS_NAME),function(){var leftPanel=getLeftPanelScope();leftPanel&&leftPanel.toggle()})}function bindSearchIconEvent(searchElements){WM.forEach(searchElements,function(ele){var searchEle=WM.element('<a class="visible-xs-inline-block app-header-action glyphicon glyphicon-search"></a>');WM.element(ele).before(searchEle),MobileEventService.touch(searchEle,function(){toggleSearchContainer(ele)})})}function bindContentEvents(){MobileEventService.touch(classSelector(CONTENT_CLASS_NAME),hidePageContainers)}function bindRightPanelEvents(){MobileEventService.touch(roleSelector(RIGHT_PANEL_CLASS_NAME),hidePageContainers)}var LEFT_PANEL_CLASS_NAME="page-left-panel",RIGHT_PANEL_CLASS_NAME="page-right-panel",SWIPE_ELEM_CLASS_NAME="page-left-panel-icon",SEARCH_CONTAINER_CLASS_NAME="app-search",CONTENT_CLASS_NAME="app-content-column",HEADER_CLASS_NAME="page-header";return{update:function(element,hasLeftNav,hasRightNav,searchElements){bindContentEvents(),hasLeftNav?bindLeftPanelEvents():element.find(roleSelector(SWIPE_ELEM_CLASS_NAME)).remove(),hasRightNav&&bindRightPanelEvents(),searchElements&&bindSearchIconEvent(searchElements)}}}]),WM.module("wm.layouts.page").service("ViewService",[function(){"use strict";var viewsScope=[],hideActiveView=function(viewGroup){var i;for(i=0;i<viewsScope.length;i+=1)viewsScope[i].show&&viewsScope[i].viewgroup===viewGroup&&(viewsScope[i].show=!1)},goToView=function(viewGroup,viewName){var i;for(i=0;i<viewsScope.length;i+=1)if(viewsScope[i].viewgroup===viewGroup&&viewsScope[i].name===viewName){hideActiveView(viewGroup),viewsScope[i].show=!0,viewsScope[i].initialize();break}},registerView=function(scope){viewsScope.push(scope)},unregisterView=function(scope){viewsScope.splice(viewsScope.indexOf(scope),1)},showView=function(name){var i,view=WM.element("[name="+name+"]"),parentViews=view.parents(".app-view");for(i=0;i<parentViews.length;i+=1)goToView(parentViews.attr("viewgroup")||"default",parentViews.attr("name"));view.length>0&&goToView(view.isolateScope().viewgroup,name)},hideView=function(name){hideActiveView(WM.element("[name="+name+"]").isolateScope().viewgroup)},getViews=function(){return viewsScope},clearViews=function(){viewsScope=[]};return{registerView:registerView,unregisterView:unregisterView,hideView:hideView,showView:showView,getViews:getViews,clearViews:clearViews}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/page/column.html",'<div init-widget class="app-column" apply-styles="container"><div class="app-ng-transclude" wmtransclude></div></div>')}]).directive("wmColumn",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";function propertyChangeHandler(element,key,newVal,oldVal){switch(key){case"columnwidth":element.removeClass("col-md-"+oldVal+" col-sm-"+oldVal).addClass("col-md-"+newVal+" col-sm-"+newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.column",["wm.layouts","wm.base.events.touch"]),notifyFor={columnwidth:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/layout/page/column.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){scope.columnwidth&&WM.element(element).addClass("col-md-"+scope.columnwidth+" col-sm-"+scope.columnwidth),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/page/pagecontent.html",'<div init-widget class="app-page-content app-content-column" apply-styles="container"><div class="app-ng-transclude" wmtransclude></div></div>')}]).directive("wmPageContent",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";function propertyChangeHandler(element,key,newVal,oldVal){switch(key){case"columnwidth":element.removeClass("col-md-"+oldVal+" col-sm-"+oldVal).addClass("col-md-"+newVal+" col-sm-"+newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.pagecontent",["wm.layouts","wm.base.events.touch"]),notifyFor={columnwidth:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/layout/page/pagecontent.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){scope.columnwidth&&WM.element(element).addClass("col-md-"+scope.columnwidth+" col-sm-"+scope.columnwidth),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/page/content.html",'<main  data-role="page-content" init-widget class="app-content clearfix" apply-styles><div class="row app-content-row clearfix" wmtransclude></div></main>')}]).directive("wmContent",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.content",["wm.layouts","wm.base.events.touch"]);return{restrict:"E",replace:!0,transclude:!0,scope:{},template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/layout/page/content.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/page/footer.html",'<footer data-role="page-footer" page-container page-container-target init-widget class="app-footer clearfix" apply-styles="container" wmtransclude></footer>')}]).directive("wmFooter",["PropertiesFactory","WidgetUtilService","CONSTANTS",function(PropertiesFactory,WidgetUtilService,CONSTANTS){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.footer",["wm.layouts","wm.base.events.touch"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/layout/page/footer.html"),compile:function(){return{pre:function(iScope,element){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):(iScope.widgetProps=widgetProps,element.scope().layout.footer=!0)},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/page/header.html",'<header data-role="page-header"  page-container init-widget class="app-header clearfix" apply-styles="container"><div class="visible-xs-block col-xs-1" data-role="page-left-panel-icon"><a class="app-header-action glyphicon glyphicon-menu-hamburger"></a></div><div class="col-sm-12 col-xs-11 app-header-container" wmtransclude page-container-target></div></header>')}]).directive("wmHeader",["PropertiesFactory","WidgetUtilService","CONSTANTS",function(PropertiesFactory,WidgetUtilService,CONSTANTS){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.header",["wm.layouts","wm.base.events.touch"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/layout/page/header.html"),compile:function(){return{pre:function(iScope,element){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):(iScope.widgetProps=widgetProps,element.scope().layout.header=!0)},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/page/leftpanel.html",'<aside data-role="page-left-panel" page-container init-widget class="app-left-panel" hm-swipe-left="collapse();" data-ng-class="animation" apply-styles="container"><div class="app-ng-transclude" wmtransclude page-container-target></div></aside>')}]).directive("wmLeftPanel",["PropertiesFactory","WidgetUtilService","$rootScope","$timeout","CONSTANTS",function(PropertiesFactory,WidgetUtilService,$rootScope,$timeout,CONSTANTS){"use strict";function propertyChangeHandler(element,key,newVal,oldVal){switch(key){case"columnwidth":element.removeClass("col-md-"+oldVal+" col-sm-"+oldVal).addClass("col-md-"+newVal+" col-sm-"+newVal);break;case"animation":var appPage=element.closest(".app-page");"slide-in"===newVal?appPage.addClass("slide-in-left-panel-container"):appPage.removeClass("slide-in-left-panel-container")}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.leftpanel",["wm.layouts","wm.base.events.touch"]),notifyFor={columnwidth:!0,animation:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:function(tElement,tAttrs){var isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),template=WM.element(WidgetUtilService.getPreparedTemplate("template/layout/page/leftpanel.html",tElement,tAttrs));return isWidgetInsideCanvas||tAttrs.columnwidth||template.attr("columnwidth","2"),template[0].outerHTML},compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){scope.columnwidth&&WM.element(element).addClass("col-md-"+scope.columnwidth+" col-sm-"+scope.columnwidth);var eventName="click.leftNavToggle";scope.toggle=function(){element.hasClass("visible")?scope.collapse():scope.expand()},scope.expand=function(){var appPage=element.closest(".app-page"),skipEvent=!0;element.addClass("visible"),"slide-in"===scope.animation&&appPage.addClass("slide-in-left-panel-container slide-left"),element.on(eventName,function(){skipEvent=!0}),appPage.on(eventName,function(){skipEvent||scope.collapse(),skipEvent=!1})},scope.collapse=function(){var appPage=element.closest(".app-page");element.removeClass("visible"),element.off(eventName),appPage.off(eventName),"slide-in"===scope.animation&&(appPage.removeClass("slide-left"),$timeout(function(){appPage.removeClass("slide-in-left-panel-container")},600))},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs),scope.collapse()}}}}}]),WM.module("wm.layouts.page").directive("wmPage",["DeviceViewService","CONSTANTS","$rootScope","$routeParams","Utils","$timeout","Variables","NavigationVariableService",function(DeviceViewService,CONSTANTS,$rootScope,$routeParams,Utils,$timeout,Variables,NavigationVariableService){"use strict";var extendVariables=function(scope,variables){WM.forEach(variables,function(variable,name){scope.Variables.hasOwnProperty(name)||Object.defineProperty(scope.Variables,name,{configurable:!0,get:function(){return variable}})})};return{restrict:"E",replace:!0,transclude:!0,template:'<div data-role="pageContainer" class="app-page container" data-ng-class="layoutClass" wmtransclude></div>',compile:function(){return{pre:function(scope,element,attrs){var containerScope,count,subView,pageName=!$rootScope.isPrefabTemplate&&scope.prefabname||$rootScope.isPrefabTemplate&&"Main"||attrs.ngController.replace("PageController",""),variableScope=!CONSTANTS.isStudioMode||scope.prefabname||scope.$parent.partialname?scope:$rootScope.domScope;CONSTANTS.isRunMode&&(scope.Variables={},scope.Widgets={},scope.$parent.partialname||scope.prefabname||($rootScope.Widgets=scope.Widgets),scope.$parent.partialname&&(containerScope=scope.$parent.Widgets&&scope.$parent.Widgets[scope.$parent.partialcontainername],containerScope&&(containerScope.Widgets=scope.Widgets))),CONSTANTS.isStudioMode&&(containerScope=scope.$parent.Widgets&&scope.$parent.Widgets[scope.$parent.partialcontainername],containerScope&&WM.isDefined(containerScope.Widgets)&&(scope.Widgets={},containerScope.Widgets=scope.Widgets)),!scope.registerPageContainer&&CONSTANTS.isRunMode&&(count=0,scope.layout={leftSection:!1,rightSection:!1,header:!1,footer:!1,search:!1},scope.onPageLoad=function(){count||(scope.hasOwnProperty("onPageReady")&&Utils.triggerFn(scope.onPageReady),$routeParams&&$routeParams.name&&(subView=$routeParams.name.split("."),subView.length>1&&NavigationVariableService.navigateToView(subView.pop())),scope.layout.search=element.find('[data-role="page-header"] .app-search'),scope.layout.leftSection=element.find('[data-role="page-left-panel"]').length>0,scope.layout.rightSection=element.find('[data-role="page-right-panel"]').length>0,$timeout(function(){DeviceViewService.update(element,scope.layout.leftSection,scope.layout.rightSection,scope.layout.search),$rootScope.$emit("page-ready")}))},scope.registerPagePart=function(){count++},scope.onPagePartLoad=function(){--count,scope.onPageLoad()},WM.isFunction(scope.handleRoute)&&scope.handleRoute.apply(void 0,_.values($routeParams).slice(1))),Variables.getPageVariables(pageName,function(variables){Variables.register(pageName,variables,!0,variableScope),CONSTANTS.isStudioMode&&!scope.prefabname&&$rootScope.$emit("update-variables-tree"),containerScope&&(containerScope.Variables=scope.Variables),$rootScope.Variables?(extendVariables(variableScope,$rootScope.Variables),Utils.triggerFn(scope.onPageVariablesReady)):element.on("$destroy",$rootScope.$on("on-app-variables-ready",function(event,appVariables){extendVariables(variableScope,$rootScope.Variables),Utils.triggerFn(scope.$root.onAppVariablesReady,appVariables),Utils.triggerFn(scope.onPageVariablesReady)}))})},post:function(scope,element,attrs){var handlers=[];CONSTANTS.isRunMode&&(Utils.triggerFn(scope.onPageLoad),element.on("$destroy",function(){Variables.unload(attrs.ngController.replace("PageController",""),scope),handlers.forEach(Utils.triggerFn)}))}}}}}]).directive("wmPartial",["CONSTANTS","$rootScope","Utils","Variables",function(CONSTANTS,$rootScope,Utils,Variables){"use strict";var extendVariables=function(scope,variables){WM.forEach(variables,function(variable,name){scope.Variables.hasOwnProperty(name)||Object.defineProperty(scope.Variables,name,{configurable:!0,get:function(){return variable}})})};return{restrict:"E",replace:!0,transclude:!0,template:'<section  data-role="partial" class="app-partial clearfix" wmtransclude></section>',compile:function(){return{pre:function(scope,element,attrs){var containerScope,pageName=attrs.ngController.replace("PageController",""),variableScope=!CONSTANTS.isStudioMode||scope.prefabname||scope.$parent.partialname?scope:$rootScope.domScope;CONSTANTS.isRunMode&&(scope.Widgets={},scope.Variables={},containerScope=scope.$parent.Widgets&&scope.$parent.Widgets[scope.$parent.partialcontainername],containerScope&&(containerScope.Widgets=scope.Widgets)),CONSTANTS.isStudioMode&&(containerScope=scope.$parent.Widgets&&scope.$parent.Widgets[scope.$parent.partialcontainername],containerScope&&WM.isDefined(containerScope.Widgets)&&(scope.Widgets={},containerScope.Widgets=scope.Widgets)),Variables.getPageVariables(pageName,function(variables){Variables.register(pageName,variables,!0,variableScope),CONSTANTS.isRunMode&&containerScope&&(containerScope.Variables=scope.Variables),$rootScope.Variables?(extendVariables(scope,$rootScope.Variables),CONSTANTS.isRunMode&&scope.hasOwnProperty("onPageVariablesReady")&&Utils.triggerFn(scope.onPageVariablesReady,scope.Variables)):element.on("$destroy",$rootScope.$on("on-app-variables-ready",function(event,appVariables){extendVariables(scope,$rootScope.Variables),Utils.triggerFn(scope.$root.onAppVariablesReady,appVariables),CONSTANTS.isRunMode&&scope.hasOwnProperty("onPageVariablesReady")&&(Utils.triggerFn(scope.$root.onAppVariablesReady,appVariables),Utils.triggerFn(scope.onPageVariablesReady))}))})},post:function(scope,element,attrs){var handlers=[];CONSTANTS.isRunMode&&scope.hasOwnProperty("onPageReady")&&Utils.triggerFn(scope.onPageReady),element.on("$destroy",function(){Variables.unload(attrs.ngController.replace("PageController",""),scope),handlers.forEach(Utils.triggerFn)})}}}}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/defaults/header.html","<h1>HEADER</h1>"),$templateCache.put("template/defaults/topnav.html",'<div class="navbar navbar-default"><div class="container-fluid"><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li class="active"><a href="#">ACTIVE</a></li><li><a href="#">LINK</a></li></ul></div></div></div>'),$templateCache.put("template/defaults/leftnav.html",'<ul class="nav app-nav nav-pills nav-stacked"><li class="active"><a href="#" class="active">Active</a></li><li><a href="#">Link</a></li></ul>'),$templateCache.put("template/defaults/rightnav.html",'<ul class="nav app-nav nav-pills nav-stacked"><li class="active"><a href="#" class="active">Active</a></li><li><a href="#">Link</a></li></ul>'),$templateCache.put("template/defaults/footer.html","<h3>FOOTER</h3>"),$templateCache.put("template/layouts/template.html",'<div data-role="template" class="app-template app-page container" init-widget><header data-role="page-header" class="app-header clearfix" wm-template-container="{{header}}"></header><section data-role="page-topnav" class="app-top-nav" wm-template-container="{{topnav}}"></section><main  data-role="page-content" class="app-content clearfix"><div class="row app-content-row clearfix"><aside data-role="page-left-panel" class="app-left-panel col-md-2 col-sm-2" wm-template-container="{{leftnav}}"></aside><div class="app-page-content app-content-column"><div class="app-ng-transclude" wmtransclude></div></div><aside data-role="page-right-panel" class="app-right-panel col-md-2 col-sm-2" wm-template-container="{{rightnav}}"></aside></div></main><footer data-role="page-footer" class="app-footer clearfix" wm-template-container="{{footer}}"></footer></div>')}]).directive("wmTemplate",["$templateCache","PropertiesFactory","WidgetUtilService","CONSTANTS","$compile",function($templateCache,PropertiesFactory,WidgetUtilService,CONSTANTS,$compile){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.template",[]),templateShowCaseRendered=!1;return{restrict:"E",replace:!0,transclude:!0,scope:{},template:$templateCache.get("template/layouts/template.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs),CONSTANTS.isRunMode&&!templateShowCaseRendered&&(templateShowCaseRendered=!0,$compile("<wm-template-showcase></wm-template-showcase>")(scope.$root))}}}}}]).directive("wmTemplateShowcase",["$location","Utils","$routeParams","$timeout",function($location,Utils,$routeParams,$timeout){"use strict";function postMessage(content){window.top.postMessage(content,"*")}var MSGS={HIDE_TEMPLATES_SHOW_CASE:"hide-templates-show-case",SHOW_TEMPLATES_SHOW_CASE:"show-templates-show-case",UPDATE_LOCATION:"update-location-path",SELECT_TEMPLATE:"select-template",TEMPLATEBUNDLE_CONFIG:"template-bundle-config",ON_LOAD:"on-load"};return{restrict:"E",scope:{},link:function(scope,element){var pageName=$routeParams.name;scope.showAll=!0,Utils.fetchContent("json",Utils.preventCachingOf("./config.json"),function(response){scope.templates=[],response.error||(scope.templates=response.templates,postMessage({key:MSGS.TEMPLATEBUNDLE_CONFIG,config:response}))},WM.noop,!0),scope.prev=function(){var i=--scope.activeTemplateIndex;i=0>i?0:i,scope.showTemplate(i)},scope.next=function(){var i=++scope.activeTemplateIndex,len=scope.templates.length;i=i>=len?len-1:i,scope.showTemplate(i)},scope.showTemplate=function(idx){var template=scope.templates[idx];scope.activeTemplateIndex=idx,$location.path(template.id)},scope.activeTemplateIndex=0,pageName&&scope.templates.some(function(template,idx){return pageName===template.id?(scope.activeTemplateIndex=idx,!0):void 0}),WM.element("html > body:first").append(element),window.onmessage=function(msg){if(WM.isObject(msg.data)){var key=msg.data.key;switch(key){case MSGS.HIDE_TEMPLATES_SHOW_CASE:scope.hideShowCase=!0;break;case MSGS.SELECT_TEMPLATE:scope.showTemplate(msg.data.templateIndex)}scope.$root.$safeApply(scope)}},scope.$root.$on("$routeChangeSuccess",function(){postMessage({key:MSGS.UPDATE_LOCATION,location:$location.absUrl()})}),$timeout(function(){postMessage({key:MSGS.ON_LOAD})})}}}]).directive("wmTemplateContainer",function(FileService,CONSTANTS,$rootScope,Utils,$compile,$templateCache){"use strict";function hideContent($el){$el.html("").hide()}function getTemplatePath(templateName){var templatePath="pages/"+templateName+"/page.min.html";return CONSTANTS.isStudioMode?"../../"+templatePath:templatePath}function displayDefaultContent(element){var key=element.attr("data-role"),url=ROLE_DEFAULTCONTENTURL_MAP[key],content=$templateCache.get(url);element.html(content).show()}function compileTemplate(scope,element,content){var $content=WM.element(content),_scope=scope.$new();$content=$content.contents(),_scope.Widgets={},$compile($content)(_scope),element.append($content).show()}function loadTemplate(scope,element,templateName){var pageContent;FileService.read({path:getTemplatePath(templateName),projectID:$rootScope.project.id},function(response){pageContent=Utils.parseCombinedPageContent(response,templateName),compileTemplate(scope,element,pageContent.html)},function(){element.html(ERROR_CONTENT)})}var ERROR_CONTENT='<div class="app-partial-info"><div class="partial-message">Content for the container is unavailable.</div></div>',ROLE_DEFAULTCONTENTURL_MAP={"page-header":"template/defaults/header.html","page-topnav":"template/defaults/topnav.html","page-left-panel":"template/defaults/leftnav.html","page-right-panel":"template/defaults/rightnav.html","page-footer":"template/defaults/footer.html"};return{link:function(scope,element,attrs){attrs.wmTemplateContainer&&attrs.$observe("wmTemplateContainer",function(nv){nv?"_nocontent"===nv?hideContent(element):"_defaultcontent"===nv?displayDefaultContent(element):loadTemplate(scope,element,nv):hideContent(element)})}}}),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/page/rightpanel.html",'<aside  data-role="page-right-panel" page-container init-widget class="app-right-panel" apply-styles="container"><div class="app-ng-transclude" wmtransclude page-container-target></div></aside>')}]).directive("wmRightPanel",["PropertiesFactory","WidgetUtilService","CONSTANTS",function(PropertiesFactory,WidgetUtilService,CONSTANTS){"use strict";function propertyChangeHandler(scope,element,key,newVal,oldVal){switch(key){case"columnwidth":element.removeClass("col-md-"+oldVal+" col-sm-"+oldVal).addClass("col-md-"+newVal+" col-sm-"+newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.rightpanel",["wm.layouts","wm.base.events.touch"]),notifyFor={columnwidth:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:function(tElement,tAttrs){var isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),template=WM.element(WidgetUtilService.getPreparedTemplate("template/layout/page/rightpanel.html",tElement,tAttrs));return isWidgetInsideCanvas||tAttrs.columnwidth||template.attr("columnwidth","2"),template[0].outerHTML},compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){scope.columnwidth&&WM.element(element).addClass("col-md-"+scope.columnwidth+" col-sm-"+scope.columnwidth),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){
"use strict";$templateCache.put("template/layout/page/row.html",'<div init-widget class="row app-row clearfix" data-ng-show="show" apply-styles wmtransclude></div>')}]).directive("wmRow",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.row",["wm.layouts","wm.base.events.touch"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/layout/page/row.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/page/topnav.html",'<section data-role="page-topnav" page-container init-widget class="app-top-nav" apply-styles wmtransclude page-container-target></section>')}]).directive("wmTopNav",["PropertiesFactory","WidgetUtilService","CONSTANTS",function(PropertiesFactory,WidgetUtilService,CONSTANTS){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.topnav",["wm.layouts","wm.base.events.touch"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/layout/page/topnav.html"),compile:function(){return{pre:function(iScope,element){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):(iScope.widgetProps=widgetProps,element.scope().layout.navigationBar=!0)},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.layouts.page").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/layout/page/view.html",'<div init-widget class="app-view" data-ng-show="show" apply-styles="container" wmtransclude wm-navigable-element="true"> </div>')}]).directive("wmView",["PropertiesFactory","WidgetUtilService","CONSTANTS","ViewService","Utils",function(PropertiesFactory,WidgetUtilService,CONSTANTS,ViewService,Utils){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.view",["wm.layouts","wm.base.events.touch"]);return{restrict:"E",replace:!0,scope:{},transclude:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/layout/page/view.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){ViewService.registerView(scope),scope.setActive=function(){ViewService.showView(scope.name)};var isDialogView=element.hasClass("dialog-view");isDialogView&&(CONSTANTS.isStudioMode&&element.attr("wm-droppable",!1),CONSTANTS.isRunMode&&(scope.show=!1)),scope.initialize=function(){element.find(".ng-isolate-scope").each(function(){Utils.triggerFn(WM.element(this).isolateScope().redraw)})},WidgetUtilService.postWidgetCreate(scope,element,attrs),element.on("$destroy",function(){ViewService.unregisterView(scope)})}}}}}]),WM.module("wm.widgets.base",[]).constant("WIDGET_CONSTANTS",{EVENTS_OPTIONS:["No Event","Javascript","New ServiceVariable","New LiveVariable","New NavigationCall","New NotificationCall"]}).factory("PropertiesFactory",["WIDGET_CONSTANTS","CONSTANTS",function(WIDGET_CONSTANTS,CONSTANTS){"use strict";function getPropertiesOf(widget,parents){var widgetProps,parentsArr;return parents?(parentsArr=WM.isArray(parents)?parents:[parents],parentsArr.push(widget),widgetProps={},parentsArr.forEach(function(parent){WM.isObject(properties[parent])&&_.keys(properties[parent]).forEach(function(propName){var propObj=properties[parent][propName];widgetProps[propName]||(widgetProps[propName]={}),Object.keys(propObj).forEach(function(key){widgetProps[propName][key]=propObj[key]})})})):widgetProps=WM.copy(properties[widget]),CONSTANTS.isStudioMode?_.keys(widgetProps).forEach(function(key){var property=widgetProps[key];property.hasOwnProperty("show")||(property.show=!0),property.disabled=property.disabled||!1}):_.keys(widgetProps).forEach(function(propName){var propDetails=widgetProps[propName];widgetProps[propName]=_.pick(propDetails,["type","value","bindable","displaytype"])}),widgetProps}function getPropertyGroups(){return propertyGroups}function getPrimaryPropertyGroups(){var primaryPropertyGroups=[];return propertyGroups.forEach(function(propertyGroup){propertyGroup.parent||primaryPropertyGroups.push(propertyGroup)}),primaryPropertyGroups}function getGroupProperties(group){var groupProperties=[];return propertyGroups.forEach(function(propertyGroup){propertyGroup.parent===group&&(groupProperties=groupProperties.concat(propertyGroup.properties))}),groupProperties}function getPropertyGroup(name){return _.find(propertyGroups,function(group){return group.name===name})}function setRoles(pRoles){roles.length=0,roles.push("Everyone"),WM.isArray(pRoles)&&pRoles.forEach(function(pRole){roles.push(pRole)})}function getRoles(){return roles||[]}var properties,propertyGroups,widgetEventOptions=WM.copy(WIDGET_CONSTANTS.EVENTS_OPTIONS),showInDeviceOptions=[{name:"All",value:"all"},{name:"Extra Small",value:"xs"},{name:"Small",value:"sm"},{name:"Medium",value:"md"},{name:"Large",value:"lg"}],nameRegex="^[a-zA-Z_][A-Za-z0-9_]+$",numberRegex="(^$|[0-9]+$)",classRegex="(^$|^-?[_a-zA-Z ]+[_a-zA-Z0-9- ]*)$",dimensionRegex="(^$|^(auto|0)$|^[+-]?[0-9]+.?([0-9]+)?(em|ex|%|px|cm|mm|in|pt|pc|ch|rem|vh|vw|vmin|vmax)?$)",zindexRegex="(^$|auto|initial|inherit|^[0-9]+$)",maxRatingRegex="^(?:10|[1-9])$|^bind.*$",roles=["Everyone"],dateOptions=[{name:"Date",groupOptions:{"%x":"Date(%m/%d/%Y)","%c":"Date and Time"}},{name:"Time",groupOptions:{"%X":"Time(%H:%M:%S)","%H":"In 24 hours","%I":"In 12 hours","%M":"Mintues","%S":"Seconds","%L":"MilliSeconds","%p":"AM or PM","%Z":"Time zone offset"}},{name:"Day",groupOptions:{"%d":"Zero padded day of month","%e":"Space padded day of month","%j":"Day of the year"}},{name:"Week",groupOptions:{"%a":"Abbreviated weekday name","%A":"Full weekday name","%U":"Week number of the year(Sunday first day)","%W":"Week number of the year(Monday first day)","%w":"Week day[0(Sunday),6]"}},{name:"Month",groupOptions:{"%b":"Abbreviated month name","%B":"Full month name","%m":"Month number"}},{name:"Year",groupOptions:{"%y":"without century","%Y":"with century"}}],animationOptions=[" ","bounce","bounceIn","bounceInDown","bounceInLeft","bounceInRight","bounceInUp","bounceOut","bounceOutDown","bounceOutLeft","bounceOutRight","bounceOutUp","fadeIn","fadeInDown","fadeInDownBig","fadeInLeft","fadeInLeftBig","fadeInRight","fadeInRightBig","fadeInUp","fadeInUpBig","fadeOut","fadeOutDown","fadeOutDownBig","fadeOutLeft","fadeOutLeftBig","fadeOutRight","fadeOutRightBig","fadeOutUp","fadeOutUpBig","flash","flipInX","flipInY","flipOutX","flipOutY","hinge","lightSpeedIn","lightSpeedOut","pulse","rollIn","rollOut","rotateIn","rotateInDownLeft","rotateInDownRight","rotateInUpLeft","rotateInUpRight","rotateOut","rotateOutDownLeft","rotateOutDownRight","rotateOutUpLeft","rotateOutUpRight","rubberBand","shake","slideInDown","slideInLeft","slideInRight","slideInUp","slideOutDown","slideOutLeft","slideOutRight","slideOutUp","swing","tada","wobble","zoomIn","zoomInDown","zoomInLeft","zoomInRight","zoomInUp","zoomOut","zoomOutDown","zoomOutLeft","zoomOutRight","zoomOutUp"],visibilityOptions=["collapse","hidden","initial","inherit","visible"],displayOptions=["block","flex","inherit","initial","inline","inline-block","inline-flex","inline-table","list-item","run-in","table","table-caption","table-cell","table-column","table-column-group","table-header-group","table-footer-group","table-row","table-row-group","none"],result={properties:{"wm.base":{name:{type:"string",pattern:nameRegex,maxlength:32},show:{type:"boolean",value:!0,bindable:"in-bound"},"class":{type:"string",pattern:classRegex},accessroles:{type:"accessrolesselect",options:roles,value:"Everyone"},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"block"}},"wm.base.editors":{width:{type:"string",pattern:dimensionRegex},height:{type:"string",pattern:dimensionRegex},minwidth:{type:"string",pattern:dimensionRegex},maxwidth:{type:"string",pattern:dimensionRegex},minheight:{type:"string",pattern:dimensionRegex},maxheight:{type:"string",pattern:dimensionRegex},border:{type:"string",widget:"box"},borderunit:{type:"string",options:["em","px"],value:"px",widget:"icons_radio"},bordertop:{type:"string",pattern:numberRegex},borderright:{type:"string",pattern:numberRegex},borderbottom:{type:"string",pattern:numberRegex},borderleft:{type:"string",pattern:numberRegex},borderwidth:{type:"string"},borderstyle:{type:"string",options:["dashed","dotted","none","solid"],widget:"borderstyle"},bordercolor:{type:"string",widget:"color"},padding:{type:"string",widget:"box"},paddingunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},paddingtop:{type:"string",pattern:numberRegex},paddingright:{type:"string",pattern:numberRegex},paddingbottom:{type:"string",pattern:numberRegex},paddingleft:{type:"string",pattern:numberRegex},margin:{type:"string",widget:"box"},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},backgroundcolor:{type:"string",widget:"color"},backgroundgradient:{type:"string"},backgroundimage:{type:"string",bindable:"in-bound"},backgroundrepeat:{type:"list",options:["no-repeat","repeat","repeat-x","repeat-y"]},backgroundsize:{type:"string",hint:"width, height"},backgroundposition:{type:"string",hint:"left, top"},backgroundattachment:{type:"list",options:["fixed","local","scroll"]},color:{type:"string",hidelabel:!0,widget:"color"},fontweight:{type:"string",options:["bold"],hidelabel:!0,widget:"icons_checkbox"},fontsize:{type:"number",hidelabel:!0,hint:"Font size",pattern:numberRegex},fontunit:{type:"string",options:["em","px"],value:"px",hidelabel:!0,widget:"icons_radio"},textalign:{type:"string",options:["left","center","right"],hidelabel:!0,widget:"icons_radio"},textdecoration:{type:"string",options:["underline"],hidelabel:!0,widget:"icons_checkbox"},fontstyle:{type:"string",options:["italic"],hidelabel:!0,widget:"icons_checkbox"},fontVariant:{type:"list",options:["normal","small-caps"]},fontfamily:{type:"string",hidelabel:!0,hint:"Arial, Geneva"},misc:{type:"string"},whitespace:{type:"list",options:[" ","normal","nowrap","pre","pre-line","pre-wrap"],value:" "},wordbreak:{type:"list",options:["break-word","normal"]},opacity:{type:"string",widget:"slider"},cursor:{type:"list",options:["crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","progress","s-resize","se-resize","sw-resize","text","wait","w-resize"]},zindex:{type:"string",pattern:zindexRegex},visibility:{type:"list",options:visibilityOptions},display:{type:"list",options:displayOptions}},"wm.base.editors.abstracteditors":{disabled:{type:"boolean",bindable:"in-bound"},hint:{type:"string",value:"",bindable:"in-out-bound"},required:{type:"boolean"},tabindex:{type:"string"},onClick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseenter:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseleave:{type:"event",options:widgetEventOptions,widget:"eventlist"},onFocus:{type:"event",options:widgetEventOptions,widget:"eventlist"},onBlur:{type:"event",options:widgetEventOptions,widget:"eventlist"},onChange:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.base.editors.captionproperties":{caption:{type:"string",value:"_unset_",bindable:"in-bound",maxlength:256},captionsize:{type:"string"},paddingtop:{value:"0"},paddingright:{value:"0"},paddingbottom:{value:"0"},paddingleft:{value:"0"},bordertop:{value:"0"},borderright:{value:"0"},borderbottom:{value:"0"},borderleft:{value:"0"}},"wm.base.editors.dataseteditors":{startupdate:{type:"boolean"},scopedataset:{type:"list",options:[]},datafield:{type:"list",options:["All Fields"]},displayfield:{type:"list",options:[""]},displayexpression:{type:"string",bindable:"in-bound",bindonly:"expression"},displaytype:{type:"list",options:["Currency","Date","Number","Text","Time"]}},"wm.base.events":{onClick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onDblclick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseenter:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseleave:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.base.events.touch":{onSwipeup:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSwipedown:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSwipeleft:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSwiperight:{type:"event",options:widgetEventOptions,widget:"eventlist"},onPinchin:{type:"event",options:widgetEventOptions,widget:"eventlist"},onPinchout:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.base.events.focus":{onFocus:{type:"event",options:widgetEventOptions,widget:"eventlist"},onBlur:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.base.events.change":{onChange:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.base.events.successerror":{onSuccess:{type:"event",options:widgetEventOptions,widget:"eventlist"},onError:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.abstractinput":{type:{type:"string",value:"text"}},"wm.html":{content:{type:"string",bindable:"in-out-bound",widget:"textarea"},hint:{type:"string",bindable:"in-out-bound"},autoscroll:{type:"boolean"},height:{type:"string",pattern:dimensionRegex}},"wm.icon":{title:{type:"string",bindable:"in-out-bound"},iconclass:{type:"string",value:"glyphicon glyphicon-star-empty",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},iconsize:{type:"string",pattern:dimensionRegex},animation:{type:"list",options:animationOptions},color:{type:"string",widget:"color"},opacity:{type:"string",widget:"slider"}},"wm.iframe":{iframesrc:{type:"string",bindable:"in-bound",widget:"string"},hint:{type:"string",bindable:"in-out-bound"},width:{type:"string",value:"300px",pattern:dimensionRegex},height:{type:"string",value:"150px",pattern:dimensionRegex},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all"}},"wm.button":{hint:{type:"string",bindable:"in-out-bound"},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},badgevalue:{type:"string",bindable:"in-out-bound"},caption:{type:"string",bindable:"in-out-bound",maxlength:256},iconurl:{type:"string",bindable:"in-bound"},iconwidth:{type:"string",pattern:dimensionRegex},iconheight:{type:"string",pattern:dimensionRegex},iconmargin:{type:"string",pattern:dimensionRegex},iconposition:{type:"list",options:["left","top","right"]},disabled:{type:"boolean",bindable:"in-bound"},type:{type:"list",options:["button","reset","submit"],value:"button"},tabindex:{type:"string"},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"inline-block"},animation:{type:"list",options:animationOptions}},"wm.rating":{maxvalue:{type:"number",value:5,pattern:maxRatingRegex,bindable:"in-bound"},readonly:{type:"boolean",value:!1},scopedatavalue:{type:"string"},datavalue:{type:"number",value:"",bindable:"in-out-bound"},iconsize:{type:"string",pattern:dimensionRegex},caption:{type:"string",bindable:"in-out-bound",maxlength:256},onChange:{type:"event",options:widgetEventOptions,widget:"eventlist"},width:{type:"string",pattern:dimensionRegex,show:!1},height:{type:"string",pattern:dimensionRegex,show:!1}},"wm.camera":{capturetype:{type:"list",options:["IMAGE","VIDEO"],value:"IMAGE"},datavalue:{type:"string",value:"",bindable:"in-out-bound"},title:{type:"string",bindable:"in-out-bound"},iconclass:{type:"string",value:"glyphicon glyphicon-camera",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},iconsize:{type:"string",pattern:dimensionRegex,value:"2em"},imagequality:{type:"number",value:80,show:!0},imageencodingtype:{type:"list",options:["JPEG","PNG"],value:"JPEG",show:!0},savetogallery:{type:"boolean",value:!1,show:!0},allowedit:{type:"boolean",value:!1,show:!0},onSuccess:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.barcodescanner":{datavalue:{type:"string",bindable:"in-out-bound"},caption:{type:"string",value:"",bindable:"in-bound",maxlength:256},iconclass:{type:"string",value:"glyphicon glyphicon-barcode",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},iconsize:{type:"string",pattern:dimensionRegex,value:"2em"},onSuccess:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.buttongroup":{hint:{type:"string",bindable:"in-out-bound"},vertical:{type:"boolean"}},"wm.switch":{hint:{type:"string",bindable:"in-out-bound"},width:{type:"string",pattern:dimensionRegex},height:{type:"string",pattern:dimensionRegex},datavalue:{type:"string, object",bindable:"in-out-bound",widget:"string"},scopedatavalue:{type:"string"},dataset:{type:"array, string",bindable:"in-bound",widget:"string",value:"on, off"},scopedataset:{type:"string"},datafield:{type:"list",options:["All Fields"],value:"All Fields"},displayfield:{type:"list",options:[""],value:""}},"wm.menu":{name:{type:"string",pattern:nameRegex,maxlength:32},show:{type:"boolean",value:!0,bindable:"in-bound"},accessroles:{type:"accessrolesselect",options:roles,value:"Everyone"},scopedataset:{type:"string"},dataset:{type:"array, object",bindable:"in-bound",widget:"string",value:"Menu Item 1, Menu Item 2, Menu Item 3"},caption:{type:"string",bindable:"in-out-bound",maxlength:256},menuclass:{type:"string",pattern:classRegex},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},menuposition:{type:"list",options:["","down,right","down,left","up,right","up,left","inline"],value:""},onSelect:{type:"event",options:widgetEventOptions,widget:"eventlist"},linktarget:{type:"list",options:["_blank","_parent","_self","_top"],value:"_blank",widget:"datalist"}},"wm.menu.dataProps":{itemlabel:{type:"string",widget:"list",options:[""],bindable:"in-bound",bindonly:"expression"},itemlink:{type:"string",widget:"list",options:[""],bindable:"in-bound",bindonly:"expression"},itemicon:{type:"string",widget:"list",options:[""],bindable:"in-bound",bindonly:"expression"},itemchildren:{type:"string",widget:"list",options:[""],bindable:"in-bound",bindonly:"expression"}},"wm.tree":{scopedataset:{type:"string"},dataset:{type:"object, array",bindable:"in-bound",widget:"string",value:"node1, node2, node3"},onSelect:{type:"event",options:widgetEventOptions,widget:"eventlist"},selecteditem:{type:"object",bindable:"in-out-bound",show:!1,widget:"string"},treeicons:{type:"list",options:["folder","plus-minus","circle-plus-minus","chevron","menu","triangle","expand-collapse"],value:"triangle"},nodelabel:{type:"list",widget:"list"},nodeicon:{type:"list",widget:"list"},nodechildren:{type:"list",widget:"list"}},"wm.text":{autofocus:{type:"boolean"},readonly:{type:"boolean"},updateon:{type:"list",value:"blur",widget:"updateon"},updatedelay:{type:"number",value:0},type:{type:"list",options:["date","email","number","password","text","url","file"],value:"text"},accept:{type:"datalist",options:["image/*","audio/*","video/*"],show:!1},datavalue:{type:"string",value:"",bindable:"in-out-bound"},scopedatavalue:{type:"string"},regexp:{type:"string",value:".*"},placeholder:{type:"string",value:"Enter text"},maxchars:{type:"number",bindable:"in-bound"},changeOnkey:{type:"boolean"},minvalue:{type:"number",bindable:"in-bound"},maxvalue:{type:"number",bindable:"in-bound"}},"wm.currency":{datavalue:{type:"number",bindable:"in-out-bound"},scopedatavalue:{type:"string"},minvalue:{type:"number"},maxvalue:{type:"number"},readonly:{type:"boolean"},currency:{type:"list",value:"USD",options:["AED","AFN","ALL","AMD","ARS","AUD","AZN","BAM","BDT","BGN","BHD","BIF","BND","BOB","BRL","BWP","BYR","BZD","CAD","CDF","CHF","CLP","CNY","COP","CRC","CVE","CZK","DJF","DKK","DOP","DZD","EEK","EGP","ERN","ETB","EUR","GBP","GEL","GHS","GNF","GTQ","HKD","HNL","HRK","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KHR","KMF","KRW","KWD","KZT","LBP","LKR","LTL","LVL","LYD","MAD","MDL","MGA","MKD","MMK","MOP","MUR","MXN","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SDG","SEK","SGD","SOS","SYP","THB","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","UYU","UZS","VEF","VND","XAF","XOF","YER","ZAR","ZMK"]},placeholder:{type:"string",value:"Enter value"},width:{type:"string",pattern:dimensionRegex},height:{type:"string",pattern:dimensionRegex},minwidth:{type:"string",pattern:dimensionRegex},maxwidth:{type:"string",pattern:dimensionRegex},minheight:{type:"string",pattern:dimensionRegex},maxheight:{type:"string",pattern:dimensionRegex},backgroundcolor:{type:"string",widget:"color"},backgroundgradient:{type:"string"},backgroundimage:{type:"string",bindable:"in-bound"},backgroundrepeat:{type:"list",options:["no-repeat","repeat","repeat-x","repeat-y"]},backgroundsize:{type:"string",hint:"width, height"},backgroundposition:{type:"string",hint:"top, left"},backgroundattachment:{type:"list",options:["fixed","local","scroll"]},color:{type:"string",hidelabel:!0,widget:"color"},fontweight:{type:"string",options:["bold"],hidelabel:!0,widget:"icons_checkbox"},fontsize:{type:"number",hidelabel:!0,hint:"Font size",pattern:numberRegex},fontunit:{type:"string",options:["em","px"],value:"px",hidelabel:!0,widget:"icons_radio"},textalign:{type:"string",options:["left","center","right"],hidelabel:!0,widget:"icons_radio"},textdecoration:{type:"string",options:["underline"],hidelabel:!0,widget:"icons_checkbox"},fontstyle:{type:"string",options:["italic"],hidelabel:!0,widget:"icons_checkbox"},fontfamily:{type:"string",hidelabel:!0,hint:"Arial, Geneva"},whitespace:{type:"list",options:[" ","normal","nowrap","pre","pre-line","pre-wrap"],value:" "},wordbreak:{type:"list",options:["break-word","normal"]},misc:{type:"string"},opacity:{type:"string",widget:"slider"},cursor:{type:"list",options:["crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","progress","s-resize","se-resize","sw-resize","text","wait","w-resize"]},zindex:{type:"string",pattern:zindexRegex}},"wm.base.datetime":{datavalue:{type:"string",bindable:"in-out-bound"},scopedatavalue:{type:"string"},tabindex:{type:"string"},border:{type:"string",widget:"box"},borderunit:{type:"string",options:["em","px"],value:"px",widget:"icons_radio"},bordertop:{type:"string",pattern:numberRegex},borderright:{type:"string",pattern:numberRegex},borderbottom:{type:"string",pattern:numberRegex},borderleft:{type:"string",pattern:numberRegex},borderwidth:{type:"string"},borderstyle:{type:"string",options:["dashed","dotted","none","solid"],widget:"borderstyle"},bordercolor:{type:"string",widget:"color"},padding:{type:"string",widget:"box"},paddingunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},paddingtop:{type:"string",pattern:numberRegex},paddingright:{type:"string",pattern:numberRegex},paddingbottom:{type:"string",pattern:numberRegex},paddingleft:{type:"string",pattern:numberRegex},margin:{type:"string",widget:"box"},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},color:{type:"string",hidelabel:!0,widget:"color"},fontweight:{type:"string",options:["bold"],hidelabel:!0,widget:"icons_checkbox"},fontsize:{type:"number",hidelabel:!0,hint:"Font size",pattern:numberRegex},fontunit:{type:"string",options:["em","px"],value:"px",hidelabel:!0,widget:"icons_radio"},textalign:{type:"string",options:["left","center","right"],hidelabel:!0,widget:"icons_radio"},textdecoration:{type:"string",options:["underline"],hidelabel:!0,widget:"icons_checkbox"},fontstyle:{type:"string",options:["italic"],hidelabel:!0,widget:"icons_checkbox"},fontVariant:{type:"list",options:["normal","small-caps"]},fontfamily:{type:"string",hidelabel:!0,hint:"Arial, Geneva"},opacity:{type:"string",widget:"slider"},cursor:{type:"list",options:["crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","progress","s-resize","se-resize","sw-resize","text","wait","w-resize"]},zindex:{type:"string",pattern:zindexRegex}},"wm.date":{placeholder:{type:"string",value:"Select date"},width:{type:"string",pattern:dimensionRegex},autofocus:{type:"boolean"},readonly:{type:"boolean"},disabled:{type:"boolean"},mindate:{type:"string",hint:"yyyy-MM-dd"},maxdate:{type:"string",hint:"yyyy-MM-dd"},datepattern:{value:"yyyy-MM-dd",type:"list",options:[],widget:"datetimepatterns"},outputformat:{value:"yyyy-MM-dd",type:"list",options:[],widget:"datetimepatterns"},datavalue:{type:"date, string, number",widget:"string",bindable:"in-out-bound",hint:"yyyy-MM-dd"}},"wm.calendar":{placeholder:{type:"string",value:"Select date"},backgroundcolor:{type:"string",widget:"color"},width:{type:"string",pattern:dimensionRegex},height:{type:"string",pattern:dimensionRegex},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},scopedataset:{type:"string"},datavalue:{type:"date, string, number",widget:"string",bindable:"in-out-bound"},calendartype:{type:"list",options:["basic","agenda"],value:"basic"},view:{type:"list",options:["month","week","day"],value:"month"},controls:{type:"list",options:["navigation","today","month","week","day"],value:"navigation, today, month, week, day",widget:"selectall"},onDayclick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onEventdrop:{type:"event",options:widgetEventOptions,widget:"eventlist"},onEventresize:{type:"event",options:widgetEventOptions,widget:"eventlist"},onEventclick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onEventrender:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.time":{placeholder:{type:"string",value:"Select time"},autofocus:{type:"boolean"},readonly:{type:"boolean"},disabled:{type:"boolean"},hourstep:{type:"number",value:1},minutestep:{type:"number",value:15},outputformat:{value:"HH:mm:ss",type:"list",options:[],widget:"timepatterns"},ismeridian:{type:"boolean",value:!0},hint:{type:"string",value:"",bindable:"in-out-bound"},required:{type:"boolean"},datavalue:{type:"time, date, string, number",widget:"string",bindable:"in-out-bound",hint:"HH:mm"}},"wm.datetime":{placeholder:{type:"string",value:"Select date time"},width:{type:"string",pattern:dimensionRegex},autofocus:{type:"boolean"},readonly:{type:"boolean"},disabled:{type:"boolean"},hourstep:{type:"number",value:1},minutestep:{type:"number",value:15},ismeridian:{type:"boolean",value:!0},mindate:{type:"string",hint:"yyyy-MM-dd"},maxdate:{type:"string",hint:"yyyy-MM-dd"},datepattern:{value:"yyyy-MM-dd HH:mm",type:"list",options:[],widget:"datetimepatterns"},outputformat:{value:"timestamp",type:"list",options:[],widget:"datetimepatterns"},datavalue:{type:"timestamp, date, time, datetime, string, number",widget:"string",bindable:"in-out-bound",hint:"yyyy-MM-dd HH:mm"}},"wm.message":{type:{type:"string",options:["error","info","loading","success","warning"],value:"success",bindable:"in-out-bound",widget:"list"},caption:{type:"string",value:"Message",bindable:"in-out-bound",maxlength:256},onClose:{type:"event",options:widgetEventOptions,widget:"eventlist"},animation:{type:"list",options:animationOptions}},"wm.composite":{hint:{type:"string",value:"",bindable:"in-out-bound"},captionposition:{type:"list",options:["left","right","top"]},required:{type:"boolean"},margin:{type:"string",widget:"box"},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex}},"wm.booleaneditors":{width:{type:"string",pattern:dimensionRegex},height:{type:"string",pattern:dimensionRegex},minwidth:{type:"string",pattern:dimensionRegex},maxwidth:{type:"string",pattern:dimensionRegex},minheight:{type:"string",pattern:dimensionRegex},maxheight:{type:"string",pattern:dimensionRegex},padding:{type:"string",widget:"box"},paddingunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},paddingtop:{type:"string",pattern:numberRegex},paddingright:{type:"string",pattern:numberRegex},paddingbottom:{type:"string",pattern:numberRegex},paddingleft:{type:"string",pattern:numberRegex},margin:{type:"string",widget:"box"},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},opacity:{type:"string",widget:"slider"},cursor:{type:"list",options:["crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","progress","s-resize","se-resize","sw-resize","text","wait","w-resize"]},zindex:{type:"string",pattern:zindexRegex}},"wm.radio":{autofocus:{type:"boolean"},disabled:{value:!1},scopedatavalue:{type:"string"},datavalue:{type:"string",bindable:"in-out-bound"},checkedvalue:{type:"string"},radiogroup:{type:"string"},caption:{type:"string",bindable:"in-out-bound",maxlength:256}},"wm.radioset":{hint:{type:"string",value:"",bindable:"in-out-bound"},tabindex:{type:"string"},disabled:{type:"boolean",value:!1},readonly:{type:"boolean",value:!1},layout:{type:"list",options:["","inline","stacked"]},onClick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseenter:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseleave:{type:"event",options:widgetEventOptions,widget:"eventlist"},onFocus:{type:"event",options:widgetEventOptions,widget:"eventlist"},onBlur:{type:"event",options:widgetEventOptions,widget:"eventlist"},onChange:{type:"event",options:widgetEventOptions,widget:"eventlist"},datavalue:{type:"string",bindable:"in-out-bound",show:!1},scopedatavalue:{type:"string"},dataset:{type:"array, object",bindable:"in-bound",widget:"string",value:"Option 1, Option 2, Option 3"},scopedataset:{type:"string"},datafield:{type:"list",options:["All Fields"],value:"All Fields"},displayfield:{type:"list",options:[""],value:""},displayexpression:{type:"string"},usekeys:{type:"boolean"},selectedvalue:{type:"string, object",widget:"string",value:"",bindable:"in-bound"},itemclass:{type:"string",pattern:classRegex}},"wm.colorpicker":{readonly:{type:"boolean",value:!1},disabled:{type:"boolean",value:!1},datavalue:{type:"string",bindable:"in-out-bound"},scopedatavalue:{type:"string"},placeholder:{type:"string",value:"Select Color"},tabindex:{type:"string"}},"wm.inputcolorpicker":{defaultcolor:{value:"#fff"}},"wm.inputslider":{caption:{value:"slider",maxlength:256}},"wm.slider":{hint:{type:"string",bindable:"in-out-bound"},readonly:{type:"boolean",value:!1},disabled:{type:"boolean",value:!1},minvalue:{type:"number",bindable:"in-out-bound"},maxvalue:{type:"number",bindable:"in-out-bound"},step:{type:"number"},datavalue:{type:"string",bindable:"in-out-bound"},scopedatavalue:{type:"string"}},"wm.checkbox":{datavalue:{type:"boolean, string",bindable:"in-out-bound",widget:"string"},checkedvalue:{type:"string"},uncheckedvalue:{type:"string"},scopedatavalue:{type:"string"},startchecked:{type:"boolean"},caption:{type:"string",bindable:"in-out-bound",maxlength:256}},"wm.checkboxset":{hint:{type:"string",value:"",bindable:"in-out-bound"},tabindex:{type:"string"},disabled:{type:"boolean",value:!1},readonly:{type:"boolean",value:!1},layout:{type:"list",options:["","inline","stacked"]
},onClick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseenter:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseleave:{type:"event",options:widgetEventOptions,widget:"eventlist"},onFocus:{type:"event",options:widgetEventOptions,widget:"eventlist"},onBlur:{type:"event",options:widgetEventOptions,widget:"eventlist"},onChange:{type:"event",options:widgetEventOptions,widget:"eventlist"},datavalue:{type:"string, array",bindable:"in-out-bound",show:!1,widget:"string"},scopedatavalue:{type:"string"},dataset:{type:"array, object",bindable:"in-bound",widget:"string",value:"Option 1, Option 2, Option 3"},scopedataset:{type:"string"},usekeys:{type:"boolean"},datafield:{type:"list",options:["All Fields"],value:"All Fields"},displayfield:{type:"list",options:[""],value:""},displayexpression:{type:"string"},selectedvalues:{type:"string, object",bindable:"in-bound",widget:"string"},onReady:{type:"event",options:widgetEventOptions,widget:"eventlist"},itemclass:{type:"string",pattern:classRegex}},"wm.select":{autofocus:{type:"boolean"},readonly:{type:"boolean",value:!1},scopedatavalue:{type:"string"},datavalue:{type:"string",bindable:"in-out-bound"},scopedataset:{type:"string"},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},allownone:{type:"boolean"},hasdownarrow:{type:"boolean",value:!0},restrictvalues:{type:"boolean",value:!0},disabled:{value:!1},multiple:{type:"boolean",value:!1},placeholder:{type:"string",value:""}},"wm.label":{hint:{type:"string",value:"",bindable:"in-out-bound"},caption:{type:"date, string, number",widget:"string",value:"Label",bindable:"in-out-bound",maxlength:256},required:{type:"boolean"},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"inline-block"},animation:{type:"list",options:animationOptions}},"wm.picture":{hint:{type:"string",value:"",bindable:"in-out-bound"},picturesource:{type:"string",value:"resources/images/imagelists/default-image.png",bindable:"in-out-bound"},pictureaspect:{type:"list",options:["Both","H","None","V"],value:"None"},disabled:{type:"boolean",bindable:"in-bound"},tabindex:{type:"string"},shape:{type:"list",options:["","rounded","circle","thumbnail"]},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"inline-block"},animation:{type:"list",options:animationOptions}},"wm.textarea":{autofocus:{type:"boolean"},readonly:{type:"boolean"},datavalue:{type:"string",bindable:"in-out-bound"},scopedatavalue:{type:"string"},placeholder:{type:"string",value:"Place your text"},maxchars:{type:"number"},updateon:{type:"list",value:"blur",widget:"updateon"},updatedelay:{type:"number",value:0}},"wm.basicdialog":{show:{type:"boolean",show:!1},height:{type:"string",pattern:dimensionRegex},width:{type:"string",pattern:dimensionRegex},onClose:{type:"event",options:widgetEventOptions,widget:"eventlist"},onOpened:{type:"event",options:widgetEventOptions,widget:"eventlist"},animation:{type:"list",options:animationOptions},hint:{type:"string",bindable:"in-bound"}},"wm.dialog.dialogheader":{caption:{type:"string",maxlength:256},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},iconwidth:{type:"string",pattern:dimensionRegex},iconheight:{type:"string",pattern:dimensionRegex},iconmargin:{type:"string",pattern:dimensionRegex},closable:{type:"boolean",show:!1}},"wm.dialog.onOk":{onOk:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.alertdialog":{title:{type:"string",value:"Alert",bindable:"in-bound"},oktext:{type:"string",value:"OK",bindable:"in-bound"},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",value:"glyphicon glyphicon-warning-sign",pattern:classRegex},message:{type:"string",value:"I am an alert box!",bindable:"in-bound"},alerttype:{type:"list",options:["error","information","success","warning"],value:"error"}},"wm.confirmdialog":{title:{type:"string",value:"Confirm",bindable:"in-bound"},canceltext:{type:"string",value:"CANCEL",bindable:"in-bound"},oktext:{type:"string",value:"OK",bindable:"in-bound"},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",value:"glyphicon glyphicon-ok",pattern:classRegex},message:{type:"string",value:"I am confirm box!",bindable:"in-bound"},onCancel:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.iframedialog":{title:{type:"string",value:"External Content",bindable:"in-bound"},url:{type:"string",value:"http://www.wavemaker.com",bindable:"in-out-bound"},height:{type:"string",value:"400",pattern:dimensionRegex},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",value:"glyphicon glyphicon-globe",pattern:classRegex},oktext:{type:"string",value:"OK",bindable:"in-bound"},closable:{type:"boolean",value:!0}},"wm.pagedialog":{title:{type:"string",value:"Page Content",bindable:"in-bound"},oktext:{type:"string",value:"OK",bindable:"in-bound"},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",value:"glyphicon glyphicon-file",pattern:classRegex},closable:{type:"boolean",value:!0}},"wm.logindialog":{height:{type:"string",show:!1,pattern:dimensionRegex},closable:{type:"boolean",value:!0},modal:{type:"boolean",value:!0}},"wm.designdialog":{modal:{type:"boolean",value:!1},closable:{type:"boolean",value:!0},title:{type:"string",show:!1}},"wm.spinner":{show:{type:"boolean",value:!1},caption:{type:"string",value:"Loading...",maxlength:256},servicevariabletotrack:{type:"list",options:[]},image:{type:"string",bindable:"in-bound"},imagewidth:{type:"string"},imageheight:{type:"string"},backgroundcolor:{type:"string",widget:"color"},backgroundgradient:{type:"string"},backgroundimage:{type:"string",bindable:"in-bound"},backgroundrepeat:{type:"list",options:["no-repeat","repeat","repeat-x","repeat-y"]},backgroundsize:{type:"string",hint:"width, height"},backgroundposition:{type:"string",hint:"top, left"},backgroundattachment:{type:"list",options:["fixed","local","scroll"]},color:{type:"string",hidelabel:!0,widget:"color"},fontweight:{type:"string",options:["bold"],hidelabel:!0,widget:"icons_checkbox"},fontsize:{type:"number",hidelabel:!0,hint:"Font size",pattern:numberRegex},fontunit:{type:"string",options:["em","px"],value:"px",hidelabel:!0,widget:"icons_radio"},textdecoration:{type:"string",options:["underline"],hidelabel:!0,widget:"icons_checkbox"},fontstyle:{type:"string",options:["italic"],hidelabel:!0,widget:"icons_checkbox"},fontVariant:{type:"list",options:["normal","small-caps"]},fontfamily:{type:"string",hidelabel:!0,hint:"Arial, Geneva"},misc:{type:"string"},opacity:{type:"string",widget:"slider"},zindex:{type:"string",pattern:zindexRegex}},"wm.layouts":{name:{type:"string",pattern:nameRegex,maxlength:32},"class":{type:"string",pattern:classRegex},border:{type:"string",widget:"box"},borderunit:{type:"string",options:["em","px"],value:"px",widget:"icons_radio"},bordertop:{type:"string",pattern:numberRegex},borderright:{type:"string",pattern:numberRegex},borderbottom:{type:"string",pattern:numberRegex},borderleft:{type:"string",pattern:numberRegex},borderwidth:{type:"string"},borderstyle:{type:"string",options:["dashed","dotted","none","solid"],widget:"borderstyle"},bordercolor:{type:"string",widget:"color"},padding:{type:"string",widget:"box"},paddingunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},paddingtop:{type:"string",pattern:numberRegex},paddingright:{type:"string",pattern:numberRegex},paddingbottom:{type:"string",pattern:numberRegex},paddingleft:{type:"string",pattern:numberRegex},backgroundcolor:{type:"string",widget:"color"},backgroundgradient:{type:"string"},backgroundimage:{type:"string",bindable:"in-bound"},backgroundrepeat:{type:"list",options:["no-repeat","repeat","repeat-x","repeat-y"]},backgroundsize:{type:"string",hint:"width, height"},backgroundposition:{type:"string",hint:"top, left"},backgroundattachment:{type:"list",options:["fixed","local","scroll"]},color:{type:"string",hidelabel:!0,widget:"color"},text:{type:"string"},fontweight:{type:"string",options:["bold"],hidelabel:!0,widget:"icons_checkbox"},fontsize:{type:"number",hidelabel:!0,hint:"Font size",pattern:numberRegex},fontunit:{type:"string",options:["em","px"],value:"px",hidelabel:!0,widget:"icons_radio"},horizontalalign:{type:"string",options:["left","center","right"],widget:"icons_radio"},textdecoration:{type:"string",options:["underline"],hidelabel:!0,widget:"icons_checkbox"},fontstyle:{type:"string",options:["italic"],hidelabel:!0,widget:"icons_checkbox"},fontVariant:{type:"list",options:["normal","small-caps"]},fontfamily:{type:"string",hidelabel:!0,hint:"Arial, Geneva"},misc:{type:"string"},whitespace:{type:"list",options:[" ","normal","nowrap","pre","pre-line","pre-wrap"],value:" "},wordbreak:{type:"list",options:["break-word","normal"]},opacity:{type:"string",widget:"slider"},overflow:{type:"list",options:["visible","hidden","scroll","auto","initial","inherit"]},cursor:{type:"list",options:["crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","progress","s-resize","se-resize","sw-resize","text","wait","w-resize"]},zindex:{type:"string",pattern:zindexRegex},accessroles:{type:"accessrolesselect",options:roles,value:"Everyone"}},"wm.containers":{"class":{type:"string",pattern:classRegex},show:{type:"boolean",value:!0,bindable:"in-bound"},height:{type:"string",pattern:dimensionRegex},width:{type:"string",pattern:dimensionRegex},accessroles:{type:"accessrolesselect",options:roles,value:"Everyone"},visibility:{type:"list",options:visibilityOptions},display:{type:"list",options:displayOptions},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"block"}},"wm.containers.lazy":{loadmode:{type:"list",options:["","after-select","after-delay"],value:""},loaddelay:{type:"number",min:"10",value:"10"},onReady:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.layouts.header":{height:{type:"string",pattern:dimensionRegex}},"wm.layouts.list":{height:{type:"string",pattern:dimensionRegex},show:{type:"boolean",value:!0,bindable:"in-out-bound"},layout:{type:"list",options:["inline","vertical"],value:"vertical"},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"block"}},"wm.layouts.breadcrumb":{height:{type:"string",pattern:dimensionRegex},show:{type:"boolean",value:!0,bindable:"in-out-bound"},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},scopedataset:{type:"string"},itemicon:{type:"list",options:[""]},itemlabel:{type:"list",options:[""]},itemlink:{type:"list",options:[""]}},"wm.layouts.nav":{height:{type:"string",pattern:dimensionRegex},show:{type:"boolean",value:!0,bindable:"in-out-bound"},layout:{type:"list",options:["","stacked","justified"]},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},scopedataset:{type:"string"},type:{type:"list",options:["navbar","pills","tabs"]},itemicon:{type:"list",options:[""]},itemlabel:{type:"list",options:[""]},itemlink:{type:"list",options:[""]},itemchildren:{type:"list",options:[""]}},"wm.layouts.navbar":{height:{type:"string",pattern:dimensionRegex},show:{type:"boolean",value:!0,bindable:"in-out-bound"},title:{type:"string",bindable:"in-bound"},imgsrc:{type:"string",bindable:"in-bound"}},"wm.layouts.mobile.navbar":{height:{type:"string",pattern:dimensionRegex},show:{type:"boolean",value:!0,bindable:"in-out-bound"},datavalue:{type:"string",bindable:"in-out-bound",show:!1},title:{type:"string",bindable:"in-bound"},leftnavpaneliconclass:{type:"string",widget:"selecticon",pattern:classRegex,value:"glyphicon glyphicon-menu-hamburger"},backbutton:{type:"boolean",value:!0},backbuttoniconclass:{type:"string",widget:"selecticon",pattern:classRegex,value:"glyphicon glyphicon-menu-left"},backbuttonlabel:{type:"string"},searchbutton:{type:"boolean",value:!1},searchbuttoniconclass:{type:"string",widget:"selecticon",pattern:classRegex,value:"glyphicon glyphicon-search"},searchbuttonlabel:{type:"string"},onSearch:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.layouts.listtemplate":{height:{type:"string",pattern:dimensionRegex},width:{type:"string",pattern:dimensionRegex},"class":{type:"string",show:!1,pattern:classRegex},layout:{type:"list",options:["blank","gridlayout","inline","media","panel","thumbnail"],value:"panel"}},"wm.layouts.mediatemplate":{width:{type:"string",pattern:dimensionRegex,value:100},height:{type:"string",pattern:dimensionRegex,value:100}},"wm.layouts.listitem":{height:{type:"string",pattern:dimensionRegex},width:{type:"string",pattern:dimensionRegex},margin:{type:"string",widget:"box"},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex}},"wm.layouts.topnav":{height:{type:"string",pattern:dimensionRegex}},"wm.layouts.leftpanel":{columnwidth:{type:"list",options:["1","2","3","4","5","6","7","8","9","10","11","12"],value:"2"},animation:{type:"list",options:["slide-in","slide-over"],value:"slide-in"}},"wm.layouts.rightpanel":{columnwidth:{type:"list",options:["1","2","3","4","5","6","7","8","9","10","11","12"],value:"2"}},"wm.layouts.content":{height:{type:"string",pattern:dimensionRegex}},"wm.layouts.panel":{title:{type:"string",value:"Title",bindable:"in-bound"},description:{type:"string",bindable:"in-bound",widget:"textarea"},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},collapsible:{type:"boolean"},expanded:{type:"boolean",value:!0},closable:{type:"boolean"},helptext:{type:"string",bindable:"in-out-bound",widget:"textarea"},actions:{type:"array, object",bindable:"in-bound",widget:"string"},badgevalue:{type:"string",bindable:"in-out-bound"},badgetype:{type:"list",options:["default","primary","success","info","warning","danger"],value:"default",bindable:"in-out-bound"},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margin:{type:"string",widget:"box"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},minheight:{type:"number"},onEnterkeypress:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseenter:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseleave:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseout:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseover:{type:"event",options:widgetEventOptions,widget:"eventlist"},onClose:{type:"event",options:widgetEventOptions,widget:"eventlist"},onExpand:{type:"event",options:widgetEventOptions,widget:"eventlist"},onCollapse:{type:"event",options:widgetEventOptions,widget:"eventlist"},onActionsclick:{type:"event",options:widgetEventOptions,widget:"eventlist"},animation:{type:"list",options:animationOptions}},"wm.layouts.container":{marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margin:{type:"string",widget:"box"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},minheight:{type:"number"},onEnterkeypress:{type:"event",options:widgetEventOptions,widget:"eventlist"},onClick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onDblclick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseenter:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseleave:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseout:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseover:{type:"event",options:widgetEventOptions,widget:"eventlist"},animation:{type:"list",options:animationOptions}},"wm.layouts.tile":{width:{type:"string",pattern:dimensionRegex},height:{type:"string",pattern:dimensionRegex},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margin:{type:"string",widget:"box"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},minheight:{type:"number"},onEnterkeypress:{type:"event",options:widgetEventOptions,widget:"eventlist"},onClick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onDblclick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseenter:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseleave:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseout:{type:"event",options:widgetEventOptions,widget:"eventlist"},onMouseover:{type:"event",options:widgetEventOptions,widget:"eventlist"},animation:{type:"list",options:animationOptions}},"wm.layouts.footer":{height:{type:"string",pattern:dimensionRegex}},"wm.layouts.layoutgrid":{name:{type:"string",pattern:nameRegex,maxlength:32},height:{type:"string",pattern:dimensionRegex},width:{type:"string",value:"100%",pattern:dimensionRegex},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margin:{type:"string",widget:"box"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},insert:{type:"toolbar",actions:[{action:"addrow",label:"LABEL_PROPERTY_ADDROW",icon:"add-row"}]}},"wm.layouts.gridcolumn":{height:{type:"string",pattern:dimensionRegex},columnwidth:{type:"list",options:["1","2","3","4","5","6","7","8","9","10","11","12"]},insert:{type:"toolbar",actions:[{action:"addcolumnleft",label:"LABEL_PROPERTY_ADDCOLUMNLEFT",icon:"add-column-left"},{action:"addcolumnright",label:"LABEL_PROPERTY_ADDCOLUMNRIGHT",icon:"add-column-right"}]}},"wm.layouts.gridrow":{height:{type:"string",pattern:dimensionRegex},insert:{type:"toolbar",actions:[{action:"addrowbelow",label:"LABEL_PROPERTY_ADDROWBELOW",icon:"add-row-below"},{action:"addrowabove",label:"LABEL_PROPERTY_ADDROWABOVE",icon:"add-row-above"},{action:"addcolumn",label:"LABEL_PROPERTY_ADDCOLUMN",icon:"add-column"}]}},"wm.layouts.column":{columnwidth:{type:"list",options:["1","2","3","4","5","6","7","8","9","10","11","12"]}},"wm.layouts.pagecontent":{columnwidth:{type:"list",options:["1","2","3","4","5","6","7","8","9","10","11","12"]}},"wm.layouts.row":{show:{type:"boolean",value:!0}},"wm.layouts.view":{show:{type:"boolean",value:!0},viewgroup:{type:"string",value:"default"},animation:{type:"list",options:animationOptions}},"wm.layouts.form":{title:{type:"string",bindable:"in-bound"},novalidate:{type:"boolean",value:!1},autocomplete:{type:"boolean",value:!0},action:{type:"string",bindable:"in-bound"},target:{type:"list",options:["_blank","_parent","_self","_top"],value:"",widget:"datalist"},margin:{type:"string",widget:"box"},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},method:{type:"list",options:["get","post"]},height:{type:"string",pattern:dimensionRegex},width:{type:"string",pattern:dimensionRegex},captionsize:{type:"string"},captionalign:{type:"list",options:["left","center","right"],value:"left"},enctype:{type:"list",options:["application/x-www-form-urlencoded","multipart/form-data","text/plain"]},captionposition:{type:"list",options:["left","right","top"],value:"left"},layout:{type:"list",options:["inline","One Column","Two Column","Three Column","Four Column"],value:"One Column"},onSubmit:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.layouts.liveform":{title:{type:"string"},formtype:{type:"string",value:"inline",show:!1},layout:{type:"list",options:["One Column","Two Column","Three Column","Four Column"],value:"One Column"},autocomplete:{type:"boolean",value:!0},captionsize:{type:"string",value:""},captionalign:{type:"list",options:["left","center","right"],value:"left"},captionposition:{type:"list",options:["left","right","top"],value:"left"},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},editfields:{type:"button",hidelabel:!0,disabled:!0},height:{type:"string",pattern:dimensionRegex},rowdata:{type:"string"},formdata:{type:"object",bindable:"in-bound",widget:"string"},dataoutput:{type:"object",bindable:"out-bound",widget:"string"},name:{type:"string",pattern:nameRegex,maxlength:32},novalidate:{type:"boolean",value:!0},show:{type:"boolean",value:!0},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},defaultmode:{type:"list",options:["View","Edit"],value:"View"},width:{type:"string",pattern:dimensionRegex},insertmessage:{type:"string",value:"Record added successfully",bindable:"in-out-bound"},updatemessage:{type:"string",value:"Record updated successfully",bindable:"in-out-bound"},deletemessage:{type:"string",value:"Record deleted successfully",bindable:"in-out-bound"},onBeforeservicecall:{type:"event",options:widgetEventOptions,widget:"eventlist"},onResult:{type:"event",options:widgetEventOptions,widget:"eventlist"},onError:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSuccess:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.layouts.segmentedcontrol":{onBeforeSegmentChange:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSegmentChange:{type:"event",options:widgetEventOptions,widget:"eventlist"},width:{show:!1},height:{pattern:dimensionRegex}},"wm.layouts.segmentcontent":{caption:{type:"string",bindable:"in-out-bound",maxlength:256},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex}},"wm.grid":{width:{value:"100%",pattern:dimensionRegex},height:{value:"200px",pattern:dimensionRegex},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},scopedataset:{type:"string"},pagesize:{type:"number"},editcolumn:{type:"button",hidelabel:!0},gridfirstrowselect:{type:"boolean"},confirmdelete:{type:"string",value:"Are you sure you want to delete this?",bindable:"in-out-bound",show:!1},deleterow:{type:"boolean",bindable:"in-out-bound"},updaterow:{type:"boolean",bindable:"in-out-bound"},showheader:{type:"boolean",value:!0},gridsearch:{type:"boolean"},searchlabel:{type:"string",value:"Search",bindable:"in-out-bound",show:!1},enablesort:{type:"boolean",value:!0},showrowindex:{type:"boolean"},multiselect:{type:"boolean"},radioselect:{type:"boolean"},insertrow:{type:"boolean",bindable:"in-out-bound"},readonlygrid:{type:"boolean",value:!0},showrecordcount:{type:"boolean",show:!1},shownavigation:{type:"boolean",value:!0},filternullrecords:{type:"boolean",value:!0},nodatamessage:{type:"string",value:"No data found.",bindable:"in-out-bound"},loadingdatamsg:{type:"string",value:"Loading...",bindable:"in-out-bound"},deletemessage:{type:"string",value:"Record deleted successfully",bindable:"in-out-bound"},selecteditem:{type:"object",bindable:"in-out-bound",show:!1,widget:"string"},title:{type:"string",bindable:"in-bound"},onClick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSelect:{type:"event",options:widgetEventOptions,widget:"eventlist"},onDeselect:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSort:{type:"event",options:widgetEventOptions,widget:"eventlist"},onHeaderclick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onShow:{type:"event",options:widgetEventOptions,widget:"eventlist"},onHide:{type:"event",options:widgetEventOptions,widget:"eventlist"},onRowdeleted:{type:"event",options:widgetEventOptions,widget:"eventlist"},onBeforerowinsert:{type:"event",options:widgetEventOptions,widget:"eventlist"},onRowinsert:{type:"event",options:widgetEventOptions,widget:"eventlist"},onRowclick:{type:"event",options:widgetEventOptions,widget:"eventlist"},onColumnselect:{type:"event",options:widgetEventOptions,widget:"eventlist"},onColumndeselect:{type:"event",options:widgetEventOptions,widget:"eventlist"},onEnterkeypress:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSetrecord:{type:"event",options:widgetEventOptions,widget:"eventlist"},gridclass:{type:"string",value:"table-bordered table-striped table-hover",pattern:classRegex},"class":{type:"string",pattern:classRegex}},"wm.livegrid":{formlayout:{type:"list",options:["inline","dialog"],value:"inline"}},"wm.fileupload":{service:{type:"list",widget:"list"},operation:{type:"list",widget:"list"},multiple:{type:"boolean",value:!1},contenttype:{type:"list",options:["all","audio","image","video"],value:"all"},fileuploadtitle:{type:"string",value:"Drop your files here to start uploading."},fileuploadmessage:{type:"string",value:"You can also browse for files"},tabindex:{type:"string"},uploadedFiles:{type:"array",bindable:"in-out-bound"},destination:{type:"string",widget:"fileupload-relativepath",bindable:"in-out-bound",value:""},caption:{type:"string",value:"Upload",bindable:"in-out-bound",maxlength:256},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",value:"glyphicon glyphicon-upload",pattern:classRegex},onSelect:{type:"event",options:widgetEventOptions,widget:"eventlist"},onProgress:{type:"event",options:widgetEventOptions,widget:"eventlist"},onAbort:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.youtube":{width:{value:"800px",pattern:dimensionRegex},height:{value:"125px",pattern:dimensionRegex},uploadpath:{type:"string"}},"wm.anchor":{iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},iconurl:{type:"string",bindable:"in-bound"},iconwidth:{type:"string",pattern:dimensionRegex},iconheight:{type:"string",pattern:dimensionRegex},iconmargin:{type:"string",pattern:dimensionRegex},iconposition:{type:"list",options:["left","top","right"]},caption:{type:"string",value:"Link",bindable:"in-out-bound",maxlength:256},badgevalue:{type:"string",bindable:"in-out-bound"},hyperlink:{type:"string",bindable:"in-out-bound"},hint:{type:"string",value:"",bindable:"in-out-bound"},target:{type:"list",options:["_blank","_parent","_self","_top"],value:"_self",widget:"datalist"},tabindex:{type:"string"},whitespace:{type:"list",options:[" ","normal","nowrap","pre","pre-line","pre-wrap"],value:" "},wordbreak:{type:"list",options:["break-word","normal"]},misc:{type:"string"},opacity:{type:"string",widget:"slider"},cursor:{type:"list",options:["crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","progress","s-resize","se-resize","sw-resize","text","wait","w-resize"]},zindex:{type:"string",pattern:zindexRegex},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"inline"},animation:{type:"list",options:animationOptions}},"wm.popover":{iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},iconurl:{type:"string",bindable:"in-bound"},iconwidth:{type:"string",pattern:dimensionRegex},iconheight:{type:"string",pattern:dimensionRegex},iconmargin:{type:"string",pattern:dimensionRegex},caption:{type:"string",value:"Link",bindable:"in-out-bound",maxlength:256},hint:{type:"string",value:"",bindable:"in-out-bound"},tabindex:{type:"string"},whitespace:{type:"list",options:[" ","normal","nowrap","pre","pre-line","pre-wrap"],value:" "},wordbreak:{type:"list",options:["break-word","normal"]},misc:{type:"string"},opacity:{type:"string",widget:"slider"},popoverwidth:{type:"string"},popoverheight:{type:"string"},popoverarrow:{type:"boolean",value:!0},popoverautoclose:{type:"boolean",value:!0},popoverplacement:{type:"list",options:["bottom","left","right","top"],value:"bottom"},cursor:{type:"list",options:["crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","progress","s-resize","se-resize","sw-resize","text","wait","w-resize"]},zindex:{type:"string",pattern:zindexRegex},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"inline"},animation:{type:"list",options:animationOptions}},"wm.prefabs":{margin:{type:"string",widget:"box"},debugurl:{type:"string",show:!1},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},width:{type:"string",pattern:dimensionRegex},height:{type:"string",pattern:dimensionRegex},onLoad:{type:"event",options:widgetEventOptions,widget:"eventlist"},onDestroy:{type:"event",options:widgetEventOptions,widget:"eventlist"},animation:{type:"list",options:animationOptions}},"wm.accordion":{addchild:{hidelabel:!0,widgettype:"wm-accordionpane",widget:"add-widget"},closeothers:{type:"boolean",value:!0},height:{type:"string",pattern:dimensionRegex},width:{type:"string",pattern:dimensionRegex},tabindex:{type:"string"}},"wm.accordionpane":{onExpand:{type:"event",options:widgetEventOptions,widget:"eventlist"},onCollapse:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.accordionheader":{heading:{type:"string",value:"Heading",bindable:"in-bound"},description:{type:"string",bindable:"in-bound",widget:"textarea"},iconclass:{type:"string",widget:"selecticon",bindable:"in-out-bound",pattern:classRegex},badgevalue:{type:"string",bindable:"in-out-bound"},badgetype:{type:"list",options:["default","primary","success","info","warning","danger"],value:"default",bindable:"in-out-bound"},tabindex:{type:"string"},isdefaultpane:{type:"boolean",bindable:"in-bound"}},"wm.richtexteditor":{show:{type:"boolean",value:!0},readonly:{type:"boolean"},overflow:{type:"list",options:["visible","hidden","scroll","auto","initial","inherit"]},datavalue:{type:"string",value:"",bindable:"in-out-bound"},showpreview:{type:"boolean",value:!1},placeholder:{type:"string"},tabindex:{type:"string"},scopedatavalue:{type:"string"},onChange:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.tabs":{addchild:{hidelabel:!0,widgettype:"wm-tabpane",widget:"add-widget"},tabsposition:{type:"list",options:["left","top","right","bottom"],value:"top"},taborder:{type:"list",widget:"tabordering",dataset:[]}},"wm.tab":{heading:{type:"string",bindable:"in-bound"}},"wm.tabpane":{onSelect:{type:"event",options:widgetEventOptions,widget:"eventlist"},onDeselect:{type:"event",options:widgetEventOptions,widget:"eventlist"},disabled:{type:"boolean",bindable:"in-bound"}},"wm.tabheader":{heading:{type:"string",value:"Tab Title",bindable:"in-bound"},paneicon:{type:"string",bindable:"in-bound"},isdefaulttab:{type:"boolean",bindable:"in-bound"},tabindex:{type:"string"}},"wm.carousel":{addchild:{hidelabel:!0,widgettype:"wm-carousel-content",widget:"add-widget"},animationinterval:{type:"number",value:"3"}},"wm.tabbar":{dataset:{type:"array, object",bindable:"in-bound",widget:"string"},dropposition:{type:"list",options:["down","up"],value:"up"},onSelect:{type:"event",options:widgetEventOptions,widget:"eventlist"},morebuttoniconclass:{type:"string",widget:"selecticon",pattern:classRegex,value:"glyphicon glyphicon-option-horizontal"},morebuttonlabel:{type:"string",value:"more"}},"wm.tabbar.dataProps":{itemlabel:{type:"string",widget:"list",options:[""],bindable:"in-bound",bindonly:"expression"},itemlink:{type:"string",widget:"list",options:[""],bindable:"in-bound",bindonly:"expression"},itemicon:{type:"string",widget:"list",options:[""],bindable:"in-bound",bindonly:"expression"}},"wm.livelist":{name:{type:"string",pattern:nameRegex,maxlength:32},title:{type:"string",bindable:"in-bound"},show:{type:"boolean",value:!0,bindable:"in-bound"},accessroles:{type:"accessrolesselect",options:roles,value:"Everyone"},pagesize:{type:"number"},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},scopedataset:{type:"string"},itemsperrow:{type:"list",options:["1","2","3","4","6","12"],value:"1"},selecteditem:{type:"object",bindable:"in-out-bound",show:!1,
widget:"string"},onEnterkeypress:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSetrecord:{type:"event",options:widgetEventOptions,widget:"eventlist"},itemclass:{type:"string",pattern:classRegex},listclass:{type:"string",pattern:classRegex},navigation:{type:"list",options:["None","Basic","Advanced","Scroll"],value:"None"},selectfirstitem:{type:"boolean",value:!1,bindable:"in-out-bound"}},"wm.medialist":{dataset:{type:"array, object",bindable:"in-bound",widget:"string"},thumbnailurl:{type:"list",options:["All Fields"],value:"All Fields"},mediaurl:{type:"list",options:["All Fields"],value:"All Fields"},layout:{type:"list",options:["Single-row","Multi-row"],value:"Single-row"}},"wm.livefilter":{dataset:{type:"array, object",bindable:"in-bound",widget:"string"},scopedataset:{type:"string"},editfilters:{type:"button",hidelabel:!0,disabled:!0},result:{type:"object",bindable:"out-bound",widget:"string",show:"false"},layout:{type:"list",options:["One Column","Two Column","Three Column","Four Column"],value:"One Column"},pagesize:{type:"number",value:20}},"wm.search":{scopedatavalue:{type:"string"},datavalue:{type:"string, object",widget:"string",bindable:"in-out-bound"},scopedataset:{type:"string"},query:{type:"string",bindable:"out-bound",show:"false"},searchkey:{type:"list",options:[""]},displaylabel:{type:"list",options:[""]},displayimagesrc:{type:"list",options:[""]},datafield:{type:"list",options:["All Fields"],value:"All Fields"},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},limit:{type:"number",value:5},placeholder:{type:"string",value:"Search"},onSubmit:{type:"event",options:widgetEventOptions,widget:"eventlist"},show:{type:"boolean",value:!0,bindable:"in-out-bound"},tabindex:{type:"string"},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"inline-block"}},"wm.chart":{height:{type:"string",value:"210px",pattern:dimensionRegex},width:{type:"string",pattern:dimensionRegex},type:{type:"string",widget:"list",options:["Column","Line","Area","Cumulative Line","Bar","Pie","Donut","Bubble"],bindable:"in-out-bound"},scopedataset:{type:"string"},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},xaxisdatakey:{type:"list",widget:"list"},xaxislabel:{type:"string"},xunits:{type:"string"},xnumberformat:{type:"list",show:!1,options:["Decimal Digits","Precision","Exponential","Percentage","Round","Round Percentage","Round to Thousand","Round to Million","Round to Billion"]},xdigits:{type:"number",show:!1,value:1},xdateformat:{type:"listGroup",show:!1,options:dateOptions,value:"%x"},yaxisdatakey:{type:"list",widget:"multiselect"},yaxislabel:{type:"string"},yunits:{type:"string"},ynumberformat:{type:"list",show:!1,options:["Decimal Digits","Precision","Exponential","Percentage","Round","Round Percentage","Round to Thousand","Round to Million","Round to Billion"]},ydigits:{type:"number",show:!1,value:1},ydateformat:{type:"listGroup",show:!1,options:dateOptions,value:"%x"},bubblesize:{type:"string",widget:"list"},shape:{type:"string",widget:"list",options:["circle","square","diamond","cross","triangle-up","triangle-down","random"],value:"circle"},show:{type:"boolean",value:!0,bindable:"in-out-bound"},highlightpoints:{type:"boolean"},linethickness:{type:"string"},tooltips:{type:"boolean",value:!0},showlegend:{type:"boolean",value:!0},captions:{type:"boolean",value:!0},showxaxis:{type:"boolean",value:!0},showyaxis:{type:"boolean",value:!0},legendposition:{type:"list",options:["Top","Bottom"],value:"Top",disabled:!1},legendtype:{type:"list",options:["furious","classic"],value:"furious",disabled:!1},showvalues:{type:"boolean",value:!1},showlabels:{type:"boolean",value:!0},showcontrols:{type:"boolean",value:!1},useinteractiveguideline:{type:"boolean",value:!1},staggerlabels:{type:"boolean",value:!1},reducexticks:{type:"boolean",value:!0},labeltype:{type:"list",options:["key","value","percent"],value:"percent"},offset:{type:"string",widget:"box"},offsettop:{type:"number",value:25,pattern:numberRegex},offsetbottom:{type:"number",value:55,pattern:numberRegex},offsetleft:{type:"number",value:75,pattern:numberRegex},offsetright:{type:"number",value:25,pattern:numberRegex},barspacing:{type:"number",value:.5,min:"0.1",max:"0.9",step:"0.1"},donutratio:{type:"number",value:.6,min:"0.1",max:"1",step:"0.1"},title:{type:"string",bindable:"in-out-bound"},showlabelsoutside:{type:"boolean",value:!0},xaxislabeldistance:{type:"number",value:12,show:!1},yaxislabeldistance:{type:"number",value:12,show:!1},showxdistance:{type:"boolean",value:!1},showydistance:{type:"boolean",value:!1},aggregation:{type:"list",options:["average","count","maximum","minimum","none","sum"],value:"none"},aggregationcolumn:{type:"list",widget:"list"},groupby:{type:"list",widget:"multiselect"},orderby:{type:"list",widget:"order-by"},theme:{type:"list",options:["Terrestrial","Annabelle","Azure","Retro","Mellow","Orient","GrayScale","Flyer","Luminosity"]},customcolors:{type:"array",bindable:"in-bound",widget:"string"},nodatamessage:{type:"string",value:"No Data Available.",bindable:"in-out-bound"},border:{type:"string",widget:"box"},borderunit:{type:"string",options:["em","px"],value:"px",widget:"icons_radio"},bordertop:{type:"string",pattern:numberRegex},borderright:{type:"string",pattern:numberRegex},borderbottom:{type:"string",pattern:numberRegex},borderleft:{type:"string",pattern:numberRegex},borderwidth:{type:"string"},borderstyle:{type:"string",options:["dashed","dotted","none","solid"],widget:"borderstyle"},bordercolor:{type:"string",widget:"color"},padding:{type:"string",widget:"box"},paddingunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},paddingtop:{type:"string",pattern:numberRegex},paddingright:{type:"string",pattern:numberRegex},paddingbottom:{type:"string",pattern:numberRegex},paddingleft:{type:"string",pattern:numberRegex},margin:{type:"string",widget:"box"},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},backgroundcolor:{type:"string",widget:"color"},backgroundimage:{type:"string",bindable:"in-bound"},color:{type:"string",hidelabel:!0,widget:"color"},fontweight:{type:"string",options:["bold"],hidelabel:!0,widget:"icons_checkbox"},fontsize:{type:"number",hidelabel:!0,hint:"Font size",value:12,pattern:numberRegex},fontunit:{type:"string",options:["em","px"],value:"px",hidelabel:!0,widget:"icons_radio"},textdecoration:{type:"string",options:["underline"],hidelabel:!0,widget:"icons_checkbox"},fontstyle:{type:"string",options:["italic"],hidelabel:!0,widget:"icons_checkbox"},fontfamily:{type:"string",hidelabel:!0,hint:"Arial, Geneva"},opacity:{type:"string",widget:"slider"},cursor:{type:"list",options:["crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","progress","s-resize","se-resize","sw-resize","text","wait","w-resize"]},zindex:{type:"string",pattern:zindexRegex},onTransform:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.datanavigator":{show:{type:"boolean",value:!0,bindable:"in-bound"},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},showrecordcount:{type:"boolean",value:!1},result:{type:"object",bindable:"out-bound",widget:"string",show:"false"},onEnterKeyPress:{type:"event",options:widgetEventOptions,widget:"eventlist"},onSetrecord:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.login":{show:{type:"boolean",value:!0,bindable:"in-bound"},errormessage:{type:"string"},onSubmit:{type:"event",options:widgetEventOptions,widget:"eventlist"}},"wm.pagecontainer":{content:{type:"list",options:[],widget:"pages-list",value:""}},"wm.video":{hint:{type:"string",value:"",bindable:"in-out-bound"},mp4format:{type:"string",value:"",bindable:"in-out-bound"},oggformat:{type:"string",value:"",bindable:"in-out-bound"},webmformat:{type:"string",value:"",bindable:"in-out-bound"},subtitlelang:{type:"string",value:"en",bindable:"in-out-bound"},subtitlesource:{type:"string",value:"",bindable:"in-out-bound"},videoposter:{type:"string",value:"resources/images/imagelists/default-image.png",bindable:"in-out-bound"},controls:{type:"boolean"},videosupportmessage:{type:"string",value:"Your browser does not support the video tag."},autoplay:{type:"boolean"},loop:{type:"boolean"},muted:{type:"boolean"},videopreload:{type:"list",options:["none","metadata","auto"],value:"none"},tabindex:{type:"string"},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"inline-block"}},"wm.audio":{hint:{type:"string",value:"",bindable:"in-out-bound"},mp3format:{type:"string",value:"",bindable:"in-out-bound"},controls:{type:"boolean"},audiosupportmessage:{type:"string",value:"Your browser does not support the audio tag."},autoplay:{type:"boolean"},loop:{type:"boolean"},muted:{type:"boolean",value:!1},audiopreload:{type:"list",options:["none","metadata","auto"],value:"none"},tabindex:{type:"string"},showindevice:{type:"selectall",options:showInDeviceOptions,value:"all",displaytype:"inline-block"}},"wm.progress":{hint:{type:"string",value:"",bindable:"in-out-bound"},minvalue:{type:"number",value:0,bindable:"in-bound"},maxvalue:{type:"number",value:100,bindable:"in-bound"},datavalue:{type:"number, string, array",value:30,bindable:"in-out-bound",widget:"string"},dataset:{type:"array, object",bindable:"in-bound",widget:"string"},pollinterval:{type:"number"},displayformat:{type:"list",options:["percentage","absolute"],value:"percentage"},type:{type:"list",options:["default","default-striped","success","success-striped","info","info-striped","warning","warning-striped","danger","danger-striped"],value:"default"},width:{type:"string",pattern:dimensionRegex},height:{type:"string",pattern:dimensionRegex},onStart:{type:"event",options:widgetEventOptions,widget:"eventlist"},onComplete:{type:"event",options:widgetEventOptions,widget:"eventlist"},onBeforeupdate:{type:"event",options:widgetEventOptions,widget:"eventlist"},padding:{type:"string",widget:"box"},paddingunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},paddingtop:{type:"string",pattern:numberRegex},paddingright:{type:"string",pattern:numberRegex},paddingbottom:{type:"string",pattern:numberRegex},paddingleft:{type:"string",pattern:numberRegex},margin:{type:"string",widget:"box"},marginunit:{type:"string",options:["%","em","px"],value:"px",widget:"icons_radio"},margintop:{type:"string",pattern:numberRegex},marginbottom:{type:"string",pattern:numberRegex},marginright:{type:"string",pattern:numberRegex},marginleft:{type:"string",pattern:numberRegex},opacity:{type:"string",widget:"slider"},cursor:{type:"list",options:["crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","progress","s-resize","se-resize","sw-resize","text","wait","w-resize"]},zindex:{type:"string",pattern:zindexRegex}},"wm.template":{header:{type:"list",options:[],widget:"templates-list",value:"_nocontent"},topnav:{type:"list",options:[],widget:"templates-list",value:"_nocontent"},leftnav:{type:"list",options:[],widget:"templates-list",value:"_nocontent"},rightnav:{type:"list",options:[],widget:"templates-list",value:"_nocontent"},footer:{type:"list",options:[],widget:"templates-list",value:"_nocontent"}}}};return CONSTANTS.isStudioMode&&(result.propertyGroups=[{name:"properties",parent:"",show:!0,feature:"project.editor.design.basic"},{name:"styles",parent:"",show:!0,feature:"project.editor.design.style"},{name:"events",parent:"",show:!0,feature:"project.editor.design.events"},{name:"mobile",parent:"",show:!0,feature:"project.editor.design.mobile"},{name:"security",parent:"",show:!0,feature:"project.editor.design.security"},{properties:["caption","gridcaption","title","heading","name","debugurl","type","accept","placeholder","currency","hint","tabindex","target","description","message","oktext","canceltext","servicevariabletotrack","valuetype","alerttype","iframesrc","insert","dropposition"],parent:"properties"},{name:"layout",properties:["width","height","treeicons","pictureaspect","shape","layoutkind","layout","navtype","stacked","justified","formlayout","itemsperrow","showheader","header","topnav","leftnav","rightnav","footer","offset","addrow","addcolumn","popoverwidth","popoverheight","tabsposition","addchild"],parent:"properties"},{name:"image",properties:["image","imagewidth","imageheight"],parent:"properties"},{name:"video",properties:["videoposter","mp4format","oggformat","webmformat","videopreload","videosupportmessage","subtitlesource","subtitlelang"],parent:"properties"},{name:"audio",properties:["mp3format","audiopreload","audiosupportmessage"],parent:"properties"},{name:"content",properties:["content","url"],parent:"properties"},{name:"display",properties:["picturesource","modal","vertical","fileuploadtitle","fileuploadmessage"],parent:"properties"},{name:"values",properties:["scopedatavalue","datavalue","minvalue","maxvalue","displayformat","updateon","updatedelay","formdata","selectedvalue","selectedvalues","discretevalues","integervalues","minimum","maximum","step","defaultvalue","defaultcolor","checkedvalue","uncheckedvalue"],parent:"properties"},{name:"valuedisplay",properties:["datepattern","ismeridian","hourstep","minutestep","limit"],parent:"properties"},{name:"output",properties:["outputformat"],parent:"properties"},{name:"dataset",properties:["service","operation","scopedataset","dataset","options","hyperlink","formfield","editcolumn","editfields","editfilters","method","action","enctype","searchkey","displaylabel","imgsrc","displayimagesrc","usekeys","actions","datafield","itemlabel","itemicon","itemlink","itemchildren","displayfield","displayexpression","groupby","aggregation","aggregationcolumn","orderby","orderbycolumn","nodelabel","nodeicon","nodechildren","badgevalue","badgetype","thumbnailurl","mediaurl"],parent:"properties"},{name:"xaxis",properties:["xaxisdatakey","xaxislabel","xunits","xnumberformat","xdigits","xdateformat","xaxislabeldistance"],parent:"properties"},{name:"yaxis",properties:["yaxisdatakey","yaxislabel","yunits","ynumberformat","ydigits","ydateformat","yaxislabeldistance"],parent:"properties"},{name:"zaxis",properties:["bubblesize"],parent:"properties"},{name:"validation",properties:["required","regexp","mindate","maxdate","novalidate","maxchars"],parent:"properties"},{name:"help",properties:["helptext"],parent:"properties"},{name:"behavior",properties:["navigation","pollinterval","radiogroup","viewgroup","startchecked","autofocus","readonly","insertmessage","updatemessage","deletemessage","ignoreparentreadonly","readonlygrid","multiple","show","calendartype","controls","view","disabled","pagesize","dynamicslider","selectionclick","closeothers","collapsible","lock","freeze","autoscroll","closable","expanded","destroyable","showDirtyFlag","link","linktarget","uploadpath","contenttype","destination","isdefaulttab","isdefaultpane","autocomplete","nodatamessage","confirmdelete","loadingdatamsg","showpreview","defaultmode","errormessage","tooltips","showlegend","legendposition","legendtype","captions","showxaxis","showyaxis","showvalues","showlabels","showcontrols","useinteractiveguideline","staggerlabels","highlightpoints","linethickness","reducexticks","barspacing","labeltype","autoplay","loop","muted","donutratio","showlabelsoutside","showxdistance","showydistance","xpadding","ypadding","popoverplacement","popoverarrow","popoverautoclose","animation","animationinterval","leftnavpaneliconclass","backbutton","backbuttoniconclass","backbuttonlabel","searchbutton","searchbuttoniconclass","searchbuttonlabel","morebuttoniconclass","morebuttonlabel","menuposition","capturetype","loadmode","loaddelay"],parent:"properties"},{name:"datagrid",properties:["insertrow","deleterow","updaterow","shownavigation","infscroll","showrecordcount","multiselect","radioselect","enablesort","gridsearch","searchlabel","showrowindex","gridfirstrowselect","selectfirstitem"],parent:"properties"},{name:"caption",properties:["captionalign","captionposition","captionsize","mineditorwidth"],parent:"properties"},{name:"graphics",properties:["imagelist","imageindex","paneicon","iconclass","iconsize","iconurl","iconwidth","iconheight","iconmargin","iconposition"],parent:"properties"},{name:"format",properties:["showtooltip","horizontalalign","verticalalign","rows","columns","columnwidth","taborder"],parent:"properties"},{name:"selection",properties:["selectionmode"],parent:"properties"},{name:"operations",properties:["submitbutton","resetbutton"],parent:"properties"},{properties:["class","menuclass","listclass","itemclass","gridclass","theme","customcolors"],parent:"styles"},{name:"textstyle",properties:["fontsize","fontunit","fontfamily","color","fontweight","fontstyle","textdecoration","textalign","whitespace"],parent:"styles"},{name:"backgroundstyle",properties:["backgroundcolor","backgroundimage","backgroundrepeat","backgroundposition","backgroundsize","backgroundattachment"],parent:"styles"},{name:"border",properties:["bordercolor","borderstyle","border","borderunit"],parent:"styles"},{name:"displaystyle",properties:["padding","paddingunit","margin","marginunit","opacity","overflow","cursor","zindex","visibility","display"],parent:"styles"},{name:"prefablifecycleevents",properties:["onLoad","onDestroy"],parent:"events"},{name:"event",properties:["onChange","onFocus","onBlur"],parent:"events"},{name:"mouseevents",properties:["onReady","onClick","onDblclick","onDayclick","onEventdrop","onEventresize","onEventclick","onEventrender","onMousedown","onMouseup","onMouseover","onMouseout","onMousemove","onMouseenter","onMouseleave"],parent:"events"},{name:"keyboardevents",properties:["onKeydown","onKeypress","onKeyup","onEnterkeypress"],parent:"events"},{name:"touchevents",properties:["onSwipeup","onSwipedown","onSwipeleft","onSwiperight","onPinchin","onPinchout"],parent:"events"},{name:"callbackevents",properties:["onStart","onComplete","onBeforeupdate","onShow","onHide","onSuccess","onError","onOk","onSubmit","onCancel","onClose","onOpened","onExpand","onCollapse","onSelect","onDeselect","onProgress","onTransform","onAbort","onSort","onGridbuttonclick","onHeaderclick","onRowclick","onColumnselect","onColumndeselect","onRowdeleted","onBeforerowinsert","onRowinsert","onResult","onBeforeservicecall","onSetrecord","onActionsclick","onBeforeSegmentChange","onSegmentChange","onSearch"],parent:"events"},{name:"security",properties:["accessroles"],parent:"security"},{name:"devicesize",properties:["showindevice"],parent:"mobile"},{name:"imageproperties",properties:["imagequality","imageencodingtype","correctorientation","sourcetype","savetogallery","allowedit"],parent:"properties"}]),properties=result.properties,propertyGroups=result.propertyGroups,{getPropertiesOf:getPropertiesOf,getPropertyGroups:getPropertyGroups,getPrimaryPropertyGroups:getPrimaryPropertyGroups,getGroupProperties:getGroupProperties,getPropertyGroup:getPropertyGroup,getRoles:getRoles,setRoles:setRoles}}]).directive("ngController",function($rootScope,CONSTANTS){"use strict";return CONSTANTS.isRunMode&&($rootScope.Widgets={}),{restrict:"A",compile:function(){return{pre:function(scope){scope.ctrlScope=scope}}}}}).directive("onFileChange",function(){"use strict";return{link:function(scope,element,attrs){element[0].onchange=function(){scope[attrs.onFileChange](element[0])}}}}).directive("wmtransclude",["CONSTANTS","$timeout","Utils",function(CONSTANTS,$timeout,Utils){"use strict";return{restrict:"A",link:function(scope,element,attrs,nullCtrl,transcludeFn){scope.widgetid&&element.attr("data-droptarget-for",scope.widgettype);var eleScope=element.scope();eleScope.hasOwnProperty("$$isolateBindings")&&!eleScope.__compileWithIScope&&(eleScope=eleScope.$parent),scope.__load=WM.noop,CONSTANTS.isRunMode&&"after-select"===scope.loadmode?scope.__load=function(){transcludeFn(eleScope,function(clone){element.append(clone),scope.__load=WM.noop,Utils.triggerFn(scope.onReady)})}:CONSTANTS.isRunMode&&"after-delay"===scope.loadmode?$timeout(function(){transcludeFn(eleScope,function(clone){element.append(clone),Utils.triggerFn(scope.onReady)})},scope.loaddelay):transcludeFn(eleScope,function(clone){element.append(clone),Utils.triggerFn(scope.onReady)})}}}]).directive("accessroles",function(CONSTANTS,$rootScope,$compile){"use strict";var directive={};return CONSTANTS.isRunMode&&$rootScope.isSecurityEnabled&&(directive={restrict:"A",priority:1e4,terminal:!0,compile:function(){return{pre:function(scope,element,attrs){var clonedElement,userRoles=$rootScope.userRoles||[],widgetRoles=attrs.accessroles?attrs.accessroles.split(","):[],matchRoles=function(arr1,arr2){return arr1.some(function(item){return-1!==arr2.indexOf(item)})};widgetRoles.length&&-1===widgetRoles.indexOf("Everyone")&&!matchRoles(widgetRoles,userRoles)?element.remove():(clonedElement=element.clone(),clonedElement.removeAttr("accessroles"),element.replaceWith(clonedElement),$compile(clonedElement)(scope))}}}}),directive}).service("WidgetUtilService",["$parse","$rootScope","CONSTANTS","Utils","$templateCache",function($parse,$rootScope,CONSTANTS,Utils,$templateCache){"use strict";function cleanupMarkup(element){element.removeAttr(attrsToBeRemoved)}function updatePropertyPanelOptions(dataset,propertiesMap,scope){var variableKeys=[],wp=scope.widgetProps;wp.itemlabel.options=wp.itemicon.options=wp.itemlink.options=[],wp.itemchildren&&(wp.itemchildren.options=[]),scope.newcolumns&&(scope.newcolumns=!1,scope.itemlabel=scope.itemicon=scope.itemlink=scope.itemchildren="",$rootScope.$emit("set-markup-attr",scope.widgetid,{itemlabel:scope.itemlabel,itemicon:scope.itemicon,itemlink:scope.itemlink,itemchildren:scope.itemchildren})),WM.isString(dataset)||(WM.isArray(dataset)&&(dataset=dataset[0]||dataset,variableKeys=extractDataSetFields(dataset,propertiesMap)||[]),variableKeys=variableKeys.filter(function(variableKey){return null!==dataset[variableKey]&&!WM.isObject(dataset[variableKey])}),wp.itemlabel.options=wp.itemicon.options=wp.itemlink.options=[""].concat(variableKeys),wp.itemchildren&&(wp.itemchildren.options=[""].concat(variableKeys)))}function onScopeValueChangeProxy(scope,element,attrs,key,newVal,oldVal){if("placeholder"===key||"type"===key)element.is("input")||element.is("textarea")?attrs.$set(key,newVal):element.find("input").attr(key,newVal);else if("backgroundimage"===key)scope.picturesource=Utils.getBackGroundImageUrl(newVal);else if("backgroundcolor"===key)scope.picturesource||(scope.picturesource="none");else if("class"===key)element.removeClass(oldVal).addClass(newVal);else if("name"===key)attrs.$set("name",newVal);else if("showindevice"===key){if(CONSTANTS.isRunMode){var newValues=newVal?newVal.split(","):newVal;0===WM.element.inArray("all",newValues)?WM.forEach(deviceSizeArray.all.classToRemove,function(device){element.removeClass(device+scope.widgetProps.showindevice.displaytype||"block")}):WM.forEach(newValues,function(value){element.addClass(deviceSizeArray[value]["class"]+(scope.widgetProps.showindevice.displaytype||"block"))})}}else"animation"===key&&CONSTANTS.isRunMode&&element.addClass("animated "+newVal);triggerFn=Utils.triggerFn,scope.propertyManager.get(scope.propertyManager.ACTIONS.CHANGE).forEach(function(handler){var notifyFor=handler.notifyFor;(notifyFor&&notifyFor[key]||!notifyFor)&&triggerFn(handler,key,newVal,oldVal)})}function postWidgetCreate(scope,element,attrs){function triggerInitValueChange(){Object.keys(scope._initState).forEach(function(key){var value=scope[key];WM.isDefined(value)&&onScopeValueChangeProxy(scope,element,attrs,key,value)}),scope._isInitialized=!0,Utils.triggerFn(scope.onReady,scope,element,attrs)}cleanupMarkup(element),scope&&scope._initState&&triggerInitValueChange()}function findCtrlScope(scope){if(!scope.ctrlScope&&scope.$id!==$rootScope.$id){var tScope=scope;do if(tScope=tScope.$parent,tScope.ctrlScope){scope.ctrlScope=tScope.ctrlScope;break}while(tScope.$id!==$rootScope.$id)}}function injectModelUpdater(element,model){function updateModel(){_model&&ctrlScope&&_model.assign(ctrlScope,isolateScope._model_)}var _model,dotIdx,braceIdx,idx,name,isolateScope=element.isolateScope(),ctrlScope=element.scope();model&&(_model=$parse(model)),ctrlScope.ctrlScope||findCtrlScope(ctrlScope),ctrlScope.ctrlScope&&(model&&(dotIdx=model.indexOf("."),braceIdx=model.indexOf("["),-1===dotIdx&&-1===braceIdx?ctrlScope=ctrlScope.ctrlScope:(idx=-1===braceIdx?dotIdx:-1===dotIdx?braceIdx:Math.min(dotIdx,braceIdx),idx>0&&(name=model.substring(0,idx),WM.isDefined(ctrlScope.ctrlScope[name])||(ctrlScope.ctrlScope[name]={}),WM.isUndefined(ctrlScope[name])&&Object.defineProperty(ctrlScope,name,{get:function(){return ctrlScope.ctrlScope[name]}})))),isolateScope._onChange=function($event){updateModel(),$event&&isolateScope.onChange&&isolateScope.onChange({$event:$event,$scope:isolateScope})},model&&ctrlScope&&isolateScope.$on("$destroy",ctrlScope.$watch(model,function(newVal){isolateScope._model_!==newVal&&(isolateScope._model_=newVal)},!0)))}function extractDataSetFields(dataset,propertiesMap,sort){var columnDefs,properties,columns=[];return dataset&&propertiesMap?(columns=Utils.fetchPropertiesMapColumns(propertiesMap),properties=[Utils.resetObjectWithEmptyValues(columns)],columns=Object.keys(properties[0])):(columnDefs=Utils.prepareFieldDefs(dataset,null,!1,!0),columnDefs.forEach(function(columnDef){columns.push(columnDef.field)})),sort&&(columns=columns.sort()),columns}function addEventAttributes($template,tAttrs){return tAttrs.widgetid?void 0:(Object.keys(EventsMap).forEach(function(evtName){var evtDetails=EventsMap[evtName];tAttrs[evtName]&&$template.attr(evtDetails.name,evtDetails.value)}),$template)}function getPreparedTemplate(templateId,tElement,tAttrs){var template,$template,isInsideCanvs=tAttrs.widgetid;return template=$templateCache.get(templateId),isInsideCanvs?template:($template=WM.element(template),addEventAttributes($template,tAttrs),$template[0].outerHTML)}function registerPropertyChangeListener(listener,iScope,notifyFor){listener.notifyFor=notifyFor,iScope.propertyManager.add(iScope.propertyManager.ACTIONS.CHANGE,listener)}function getObjValueByKey(obj,strKey){if(strKey){var val;return strKey.replace(/\[(\w+)\]/g,".$1").split(".").forEach(function(key){val=val&&val[key]||obj[key]}),val}return obj}function getEvaluatedData(scope,dataObj,propertyObj,value){var expressionValue,boundExpressionName=propertyObj?"bind"+propertyObj.expressionName:void 0;return scope[boundExpressionName]?(expressionValue=scope[boundExpressionName].replace("bind:",""),scope.$eval(expressionValue.replace(/\$\[(\w)+(\w+(\[\$i\])?\.+\w+)*\]/g,function(expr){var val;return expr=expr.replace(/[\$\[\]]/gi,""),expr.split(".").forEach(function(key){val=val&&val[key]||dataObj[key],WM.isString(val)&&(val="'"+val+"'")}),val}))):propertyObj&&scope[propertyObj.expressionName]?Utils.getEvaluatedExprValue(dataObj,scope[propertyObj.expressionName],scope):value?getObjValueByKey(dataObj,value):propertyObj&&scope[propertyObj.fieldName]?getObjValueByKey(dataObj,scope[propertyObj.fieldName]):void 0}var triggerFn,attrsToBeRemoved,deviceSizeArray={all:{"class":"",classToRemove:["visible-xs-","visible-sm-","visible-md-","visible-lg-"]},xs:{"class":"visible-xs-"},sm:{"class":"visible-sm-"},md:{"class":"visible-md-"},lg:{"class":"visible-lg-"}},EventsMap={onClick:{name:"data-ng-click",value:"onClick({$event: $event, $scope: this})"},onDblclick:{name:"data-ng-dblclick",value:"onDblclick({$event: $event, $scope: this})"},onMouseenter:{name:"data-ng-mouseenter",value:"onMouseenter({$event: $event, $scope: this})"},onMouseleave:{name:"data-ng-mouseleave",value:"onMouseleave({$event: $event, $scope: this})"},onMouseover:{name:"data-ng-mouseover",value:"onMouseover({$event: $event, $scope: this})"},onMouseout:{name:"data-ng-mouseout",value:"onMouseout({$event: $event, $scope: this})"},onFocus:{name:"data-ng-focus",value:"onFocus({$event: $event, $scope: this})"},onBlur:{name:"data-ng-blur",value:"onBlur({$event: $event, $scope: this})"},onSwipeup:{name:"hm-swipe-up",value:"onSwipeup({$event: $event, $scope: this})"},onSwipedown:{name:"hm-swipe-down",value:"onSwipedown({$event: $event, $scope: this})"},onSwipeleft:{name:"hm-swipe-left",value:"onSwipeleft({$event: $event, $scope: this})"},onSwiperight:{name:"hm-swipe-right",value:"onSwiperight({$event: $event, $scope: this})"},onPinchin:{name:"hm-pinch-in",value:"onPinchin({$event: $event, $scope: this})"},onPinchout:{name:"hm-pinch-out",value:"onPinchout({$event: $event, $scope: this})"}};return attrsToBeRemoved=" data-ng-style data-ng-change data-ng-click data-ng-dblclick data-ng-mouseout data-ng-mouseover data-ng-blur data-ng-focus data-ng-show data-ng-hide data-ng-readonly data-ng-disabled data-ng-required data-ng-attr-placeholder ng-attr-name on-change on-focus on-blur on-click on-dblclick on-mouseover on-mouseout on-rowclick on-columnselect on-columndeselect  backgroundattachment backgroundcolor backgroundgradient backgroundposition backgroundrepeat backgroundsize bordercolor borderradius  borderstyle color cursor display fontfamily fontstyle fontvariant fontweight horizontalalign lineheight maxheight maxwidth minheight  minwidth opacity overflow paddingbottom paddingleft paddingright paddingtop picturesource textalign textdecoration verticalalign visibility  whitespace wordbreak zindex bordertop borderright borderbottom borderleft borderunit paddingtop paddingright paddingbottom paddingleft paddingunit margintop marginright marginbottom marginleft marginunit fontsize fontunit show hint caption animation backgroundimage iconposition iconclass",{postWidgetCreate:postWidgetCreate,injectModelUpdater:injectModelUpdater,onScopeValueChangeProxy:onScopeValueChangeProxy,updatePropertyPanelOptions:updatePropertyPanelOptions,extractDataSetFields:extractDataSetFields,getPreparedTemplate:getPreparedTemplate,registerPropertyChangeListener:registerPropertyChangeListener,getObjValueByKey:getObjValueByKey,getEvaluatedData:getEvaluatedData}}]).directive("applyStyles",["WidgetUtilService",function(WidgetUtilService){"use strict";function isDimensionProp(key){return _.includes(DIMENSION_PROPS,key)}function setDimensionProp($is,cssObj,key){var prefix,suffix,unit;prefix=prefix||_.startsWith(key,"border")&&"border",suffix=prefix?"Width":"",prefix=prefix||_.startsWith(key,"margin")&&"margin",prefix=prefix||_.startsWith(key,"padding")&&"padding",prefix&&(unit=$is[prefix+"unit"],cssObj[prefix+"Top"+suffix]=$is[prefix+"top"]+unit,cssObj[prefix+"Right"+suffix]=$is[prefix+"right"]+unit,cssObj[prefix+"Bottom"+suffix]=$is[prefix+"bottom"]+unit,cssObj[prefix+"Left"+suffix]=$is[prefix+"left"]+unit)}function applyCSS($is,$el,applyType,key,nv){var keys,resetObj,obj={},cssName=propNameCSSKeyMap[key];"shell"===applyType&&_.includes(SHELL_TYPE_IGNORE_LIST,key)||"container"===applyType&&_.includes(CONTAINER_TYPE_IGNORE_LIST,key)||(isDimensionProp(key)?setDimensionProp($is,obj,key):cssName?obj[cssName]=nv:"fontsize"===key||"fontunit"===key?obj.fontSize=""===$is.fontsize?"":$is.fontsize+$is.fontunit:"backgroundimage"===key&&(obj.backgroundImage=$is.picturesource),keys=_.keys(obj),keys.length&&(resetObj=_.object(keys,_.range(keys.length).map(function(){return""})),$el.css(resetObj),$el.css(obj)))}function onCSSPropertyChange($is,$el,attrs,key,nv){applyCSS($is,$el,attrs.applyStyles,key,nv)}var DIMENSION_PROPS,notifyFor={},propNameCSSKeyMap={backgroundattachment:"backgroundAttachment",backgroundcolor:"backgroundColor",backgroundgradient:"backgroundGradient",backgroundposition:"backgroundPosition",backgroundrepeat:"backgroundRepeat",backgroundsize:"backgroundSize",bordercolor:"borderColor",borderradius:"borderRadius",borderstyle:"borderStyle",color:"color",cursor:"cursor",display:"display",fontfamily:"fontFamily",fontstyle:"fontStyle",fontvariant:"fontVariant",
fontweight:"fontWeight",height:"height",horizontalalign:"textAlign",lineheight:"lineHeight",maxheight:"maxHeight",maxwidth:"maxWidth",minheight:"minHeight",minwidth:"minWidth",opacity:"opacity",overflow:"overflow",picturesource:"backgroundImage",textalign:"textAlign",textdecoration:"textDecoration",verticalalign:"verticalAlign",visibility:"visibility",whitespace:"whiteSpace",width:"width",wordbreak:"wordbreak",zindex:"zIndex"},SHELL_TYPE_IGNORE_LIST="height minheight maxheight overflow paddingunit paddingtop paddingright paddingbottom paddingleft",CONTAINER_TYPE_IGNORE_LIST="textalign";return _.keys(propNameCSSKeyMap).concat(SHELL_TYPE_IGNORE_LIST.split(" ")).concat(CONTAINER_TYPE_IGNORE_LIST.split(" ")).forEach(function(propName){notifyFor[propName]=!0}),DIMENSION_PROPS=_.flatten(_.map(["padding","border","margin"],function(prop){return[prop+"top",prop+"right",prop+"bottom",prop+"left",prop+"unit"]})),_.forEach(DIMENSION_PROPS,function(prop){notifyFor[prop]=!0}),notifyFor.fontsize=!0,notifyFor.fontunit=!0,notifyFor.backgroundimage=!0,{link:function($is,$el,attrs){WidgetUtilService.registerPropertyChangeListener(onCSSPropertyChange.bind(void 0,$is,$el,attrs),$is,notifyFor)}}}]).service("Widgets",["$rootScope","wmToaster","CONSTANTS",function($rootScope,wmToaster,CONSTANTS){"use strict";function byId(widgetId){return registry[widgetId]}function byName(name){return byId(nameIdMap[name])}function byType(types){if(!types)return registry;"string"==typeof types&&(types="form-widgets"===types?["wm-label","wm-text","wm-checkbox","wm-checkboxset","wm-radio","wm-radioset","wm-textarea","wm-select","wm-button","wm-picture","wm-anchor","wm-date","wm-calendar","wm-time","wm-datetime","wm-currency","wm-colorpicker","wm-slider","wm-fileupload","wm-grid","wm-livefilter","wm-livelist","wm-datanavigator","wm-html","wm-prefab","wm-richtexteditor","wm-search","wm-menu","wm-switch","wm-nav","wm-tree","wm-liveform","wm-rating","wm-camera","wm-barcodescanner","wm-mobile-navbar "]:"page-container-widgets"===types?["wm-accordionpane","wm-container","wm-panel","wm-tabcontent","wm-footer","wm-header","wm-left-panel","wm-right-panel","wm-top-nav"]:types.split(","));var collection={};return WM.forEach(types,function(type){type=type.trim(),WM.forEach(registry,function(widget){widget.widgettype===type&&(collection[widget.name]=widget)})}),collection}function isValidName(name){var errMsgTitle,errMsgDesc,isValid=!0;return name?nameIdMap[name]&&(isValid=!1,errMsgTitle="MESSAGE_ERROR_DUPLICATE_WIDGETNAME_TITLE",errMsgDesc="MESSAGE_ERROR_DUPLICATE_WIDGETNAME_DESC"):(isValid=!1,errMsgTitle="MESSAGE_ERROR_INVALID_WIDGETNAME_TITLE",errMsgDesc="MESSAGE_ERROR_INVALID_WIDGETNAME_DESC"),isValid||wmToaster.show("error",$rootScope.locale[errMsgTitle],$rootScope.locale[errMsgDesc]),isValid}function isExists(name){var _isExists=!1;return nameIdMap[name]&&(_isExists=!0),_isExists}function unregister(name){var widgetId=nameIdMap[name];delete registry[widgetId],delete nameIdMap[name]}var registry={},nameIdMap={},returnObj={};return returnObj.byId=byId,returnObj.byName=byName,returnObj.isValidName=isValidName,returnObj.isExists=isExists,returnObj.byType=byType,$rootScope.$on("name-change",function(evt,widgetId,newName,oldName,scope){(!CONSTANTS.isStudioMode||widgetId)&&(delete nameIdMap[oldName],delete returnObj[oldName],widgetId=widgetId||newName,nameIdMap[newName]=widgetId,registry[widgetId]=scope,Object.defineProperty(returnObj,newName,{configurable:!0,get:function(){return byName(newName)}}),scope.$on("$destroy",function(){unregister(scope.name)}))}),returnObj}]),WM.module("wm.widgets.base").directive("initWidget",["$rootScope","WidgetUtilService","DialogService","Utils","CONSTANTS","$parse","$timeout","DataFormatService","$animate","$routeParams","BindingManager",function($rs,WidgetUtilService,DialogService,Utils,CONSTANTS,$parse,$timeout,DataFormatService,$animate,$routeParams,BindingManager){"use strict";function isBooleanAttr(key){_.includes(booleanAttrs,key)}function PropertyManager(){var handlers={change:[]};this.ACTIONS={CHANGE:"change"},this.add=function(action,handler){handlers[action].push(handler)},this.get=function(action){return handlers[action]}}function handleDialogShowHideActions($s,dialogName,show){show?DialogService.showDialog(dialogName,{scope:$s.ctrlScope||$s}):DialogService.hideDialog(dialogName)}function handleAppCustomEvent($s,isAnchor,$evt,customEvtName){var parts;if(isAnchor&&$evt.preventDefault(),parts=customEvtName.split("."),2===parts.length){if(parts[1]===DLG_ACTIONS.SHOW)return void handleDialogShowHideActions($s,parts[0],!0);if(parts[1]===DLG_ACTIONS.HIDE)return void DialogService.hideDialog($s,parts[0],!1)}$timeout(function(){$rs.$emit("invoke-service",customEvtName,{scope:$s})})}function overrideEventHandlers($is,$s,$el,attrs){var wp=$is.widgetProps;_.keys(attrs).filter(function(attrName){return wp[attrName]&&wp[attrName].type===EVENT}).forEach(function(evtName){var fn,getParentMethod,$parent,overrideFlg=!1,evtValue=attrs[evtName],isAnchor=$el.is("a");evtValue&&((evtValue==="goToPage-"+$routeParams.name||evtValue==="goToPage_"+$routeParams.name)&&($el.addClass("active"),isAnchor&&($parent=$el.parent(),$parent.hasClass("app-nav-item")&&$parent.addClass("active"))),fn=evtValue.split(";").map(function(fnName){var trimmedFnName=fnName.trim();return _.includes(trimmedFnName,"(")||_.includes(trimmedFnName,"=")?trimmedFnName:(overrideFlg=!0,"$root._handleAppCustomEvent($s, "+isAnchor+', $event, "'+trimmedFnName+'")')}).join(";"),overrideFlg&&(getParentMethod=$parse(fn),$is[evtName]=function(locals){return locals=locals||{},locals.iScope=$is,locals.$s=$s,getParentMethod($s,locals)}))})}function onWatchExprValueChange($is,$s,key,watchExpr,newVal){$is[key+"__updateFromWatcher"]=!0,WM.isDefined(newVal)&&null!==newVal&&""!==newVal?WM.isObject(newVal)&&Utils.isPageable(newVal)?$is.allowPageable?$is[key]=newVal:$is[key]=newVal.content:$is[key]=newVal:(CONSTANTS.isStudioMode&&(watchExpr=watchExpr.replace(".data[$i]","")),$is[key]=$is.widgetid||CONSTANTS.isStudioMode&&($s.partialcontainername||$s.prefabname)?watchExpr:"")}function processEventAttr($is,attrName,attrValue){var onEvtName=_.camelCase(attrName);$is["__"+onEvtName]=attrValue}function isInterpolated(val){return _.includes(val,"{{")&&_.includes(val,"}}")}function watchProperty($is,attrs,attrName){attrs.$observe(attrName,function(nv){$is[attrName]=nv})}function setInitProp($is,propName,value){WM.isDefined(value)&&($is._initState[propName]=value)}function processAttr($is,$s,attrs,widgetProps,attrName,attrValue){var propValue=attrValue;widgetProps.hasOwnProperty(attrName)?"class"===attrName?setInitProp($is,attrName,propValue):$s.prefabname&&_.startsWith(propValue,"resources/")?(propValue=CONSTANTS.isRunMode?"./app/prefabs/"+$s.prefabname+"/"+propValue:"services/prefabs/"+$s.prefabid+"/files/webapp/"+propValue,setInitProp($is,attrName,propValue)):isInterpolated(propValue)?watchProperty($is,attrs,attrName):setInitProp($is,attrName,attrValue):isInterpolated(propValue)?watchProperty($is,attrs,attrName):$is[attrName]=attrs[attrName]}function processAttrs($is,$s,$tEl,attrs){var widgetProps=$is.widgetProps;_.forEach($tEl.context.attributes,function(attr){var attrNameInCamelCase,fn,attrName=attr.name,attrValue=attr.value.trim();_.startsWith(attrName,"on-")?attrs.widgetid?processEventAttr($is,attrName,attrValue):(attrNameInCamelCase=_.camelCase(attrName),fn=$parse(attrs[attrNameInCamelCase]),$is[attrNameInCamelCase]=function(locals){return fn($s,locals)}):attrs.hasOwnProperty(attrName)&&!$is.$$isolateBindings[attrName]&&processAttr($is,$s,attrs,widgetProps,attrName,attrValue)})}function deregisterWatchersOniScope($is){_.values($is._watchers).forEach(Utils.triggerFn),$is._watchers={}}function toBoolean(val,identity){return val===!0||"true"===val||(identity?val===identity:!1)}function defineBindPropertyGetterSetters($is,$s,propDetails,key,value){var bindKey="bind"+key,acceptedTypes=propDetails.type,acceptsArray=_.includes(acceptedTypes,"array"),_watchers=$is._watchers;Object.defineProperty($is,bindKey,{get:function(){return value},set:function(nv){var watchExpr,listenerFn,fn=_watchers[key];Utils.triggerFn(fn),nv?(watchExpr=nv.replace("bind:",""),listenerFn=onWatchExprValueChange.bind(void 0,$is,$s,key,watchExpr),_watchers[key]=BindingManager.register($s,watchExpr,listenerFn,{deepWatch:!0,allowPageable:$is.allowPageable,acceptsArray:acceptsArray})):_watchers[key]=void 0,value=nv}})}function defineDataValueGetterSetters($is,$el,attrs){function parseDataValue(val){var temp,modifiedVal=val;return isSelect&&attrs.multiple?modifiedVal=val.split(",").map(function(opt){return(""+opt).trim()}):isNumberType?(temp=+val,isNaN(temp)&&(temp=0),modifiedVal=temp):isCheckbox?$is.checkedvalue||(modifiedVal=toBoolean(val)):isDate&&(modifiedVal=new Date(val)),modifiedVal}var flg,key="datavalue",bindKey="bind"+key,_watchers=$is._watchers,UPDATE_FROM_WATCHER=key+"__updateFromWatcher",isSelect=flg=$el.is("select"),isNumberType=flg=!flg&&$el.is("input[type=number], .app-currency, .app-slider, .app-ratings"),isCheckbox=flg=!flg&&$el.is(".app-checkbox"),isDate=!flg&&$el.is("input[type=date]");Object.defineProperty($is,key,{get:function(){return $is._model_},set:function(nv){return $is[UPDATE_FROM_WATCHER]?$is[UPDATE_FROM_WATCHER]=!1:(Utils.triggerFn(_watchers[key]),_watchers[key]=void 0),_.startsWith(nv,"bind:")?void($is[bindKey]=nv):($is._model_=parseDataValue(nv),void Utils.triggerFn($is._onChange))}})}function definePropertyGetterSetters($is,$s,$el,attrs,propDetails,isBindableProperty,key,value){function parseValue(val){var numVal,modifiedValue=val;return isBooleanType?modifiedValue=toBoolean(val,_isBooleanAttr&&key):isNumberType&&(numVal=+val,isFontSize?WM.isString(val)&&val.trim().length&&(modifiedValue=numVal):modifiedValue=+val),modifiedValue}function hasValueChanged(nv,ov){return nv!==ov||WM.isObject(nv)||WM.isObject(ov)}var flg,bindKey="bind"+key,UPDATE_FROM_WATCHER=key+"__updateFromWatcher",_watchers=$is._watchers,type=propDetails.type,isBooleanType=flg="boolean"===type,isNumberType=!flg&&"number"===type,_isBooleanAttr=isBooleanAttr(key),isFontSize="fontsize"===key,isName="name"===key;setInitProp($is,key,value),Object.defineProperty($is,key,{get:function(){return value},set:function(nv){var _nv,ov=value;return isBindableProperty&&($is[UPDATE_FROM_WATCHER]?$is[UPDATE_FROM_WATCHER]=!1:(Utils.triggerFn(_watchers[key]),_watchers[key]=void 0),_.startsWith(nv,"bind:"))?void($is[bindKey]=nv):(_nv=parseValue(nv),void(hasValueChanged(_nv,ov)&&(isName&&(attrs.widgetid?$rs.$emit("name-change",attrs.widgetid,nv,ov,$is):$s.Widgets&&($s.Widgets[attrs.name]=$is)),value=_nv,WidgetUtilService.onScopeValueChangeProxy($is,$el,attrs,key,_nv,ov))))}})}function isBindableProperty(propDetails){return"in-bound"===propDetails.bindable||"in-out-bound"===propDetails.bindable}function defineGetterSettersForProp($is,$s,$el,attrs,hasModel,propName,propDetails){"datavalue"===propName&&hasModel?(defineBindPropertyGetterSetters($is,$s,propDetails,propName),defineDataValueGetterSetters($is,$el,attrs)):(isBindableProperty(propDetails)&&defineBindPropertyGetterSetters($is,$s,propDetails,propName),definePropertyGetterSetters($is,$s,$el,attrs,propDetails,isBindableProperty,propName,propDetails.value))}function defineGetterSettersForProps($is,$s,$el,attrs){var wp=$is.widgetProps,hasModel=attrs.hasOwnProperty("hasModel");_.keys(wp).filter(function(propName){var propDetails=wp[propName];return!($is.$$isolateBindings[propName]||propDetails.type===EVENT)}).forEach(function(propName){var propDetails=wp[propName];defineGetterSettersForProp($is,$s,$el,attrs,hasModel,propName,propDetails)})}var booleanAttrs=["readonly","autofocus","disabled","startchecked","multiple","selected","required","controls","autoplay","loop","muted"],DLG_ACTIONS={SHOW:"show",HIDE:"hide"},EVENT="event";return CONSTANTS.isRunMode&&($rs._handleAppCustomEvent=handleAppCustomEvent),{restrict:"A",compile:function($tEl){return{pre:function($is,$el,attrs){var hasDataValue,datavalue_value,scopeVarName,$s=$el.scope();$is&&$is.widgetProps&&($is.propertyManager=new PropertyManager,$is._watchers={},$is.$on("$destroy",deregisterWatchersOniScope.bind(void 0,$is)),attrs.widgetid?$el.on("$destroy",$is.$destroy.bind($is)):$is._widgettype=$tEl.context.tagName.toLowerCase(),$is._initState={},attrs.hasOwnProperty("hasModel")&&!attrs.widgetid&&(scopeVarName=$tEl.context.attributes.scopedatavalue,scopeVarName=scopeVarName&&scopeVarName.value,scopeVarName&&isInterpolated(scopeVarName)?attrs.$observe("scopedatavalue",function(newValue){WidgetUtilService.injectModelUpdater($el,newValue)}):WidgetUtilService.injectModelUpdater($el,scopeVarName)),CONSTANTS.isStudioMode&&WM.extend($is.widgetProps,{active:{}}),defineGetterSettersForProps($is,$s,$el,attrs),processAttrs($is,$s,$tEl,attrs),$is._initState.hasOwnProperty("datavalue")&&(hasDataValue=!0,datavalue_value=$is._initState.datavalue,delete $is._initState.datavalue),_.keys($is._initState).forEach(function(key){$is[key]=$is._initState[key]}),hasDataValue&&($is.datavalue=datavalue_value),CONSTANTS.isRunMode&&overrideEventHandlers($is,$s,$el,attrs))}}}}}]).service("BindingManager",["Utils","CONSTANTS",function(Utils,CONSTANTS){"use strict";function isArrayTypeExpr(expr){var matchers=expr.match(regex);return matchers&&matchers.length}function arrayConsumer(listenerFn,allowPageable,restExpr,newVal,oldVal){var formattedData,data=newVal;WM.isObject(data)&&Utils.isPageable(data)&&!allowPageable&&(data=data.content),WM.isArray(data)&&(formattedData=data.map(function(datum){return Utils.findValueOf(datum,restExpr)}),listenerFn(formattedData,oldVal))}function getUpdatedWatchExpr(expr,acceptsArray,allowPageable,listener){if(!acceptsArray)return{expr:expr.replace(regex,$0),listener:listener};var index=expr.lastIndexOf($I),_expr=expr.substr(0,index).replace($I,$0),restExpr=expr.substr(index+5),arrayConsumerFn=listener;return restExpr&&(arrayConsumerFn=arrayConsumer.bind(void 0,listener,allowPageable,restExpr)),{expr:_expr,listener:arrayConsumerFn}}function register(scope,watchExpr,listenerFn,config){var watchInfo,_config=config||{},deepWatch=_config.deepWatch,allowPageable=_config.allowPageable,acceptsArray=_config.acceptsArray,variableName=watchExpr.split(".")[1],variableObject=variableName&&scope.Variables&&scope.Variables[variableName];if(isArrayTypeExpr(watchExpr)){if(CONSTANTS.isStudioMode)return void listenerFn();variableObject&&"procedure"!==variableObject.operationType&&(watchExpr=watchExpr.replace(".dataSet[$i]",".dataSet.content[$i]")),watchInfo=getUpdatedWatchExpr(watchExpr,acceptsArray,allowPageable,listenerFn)}else watchInfo={expr:watchExpr,listener:listenerFn};return scope.$watch(watchInfo.expr,watchInfo.listener,deepWatch)}var regex=/\[\$i\]/g,$I="[$i]",$0="[0]";this.register=register}]),WM.module("wm.widgets.base").directive("pageContainer",["$compile","$rootScope","$routeParams","PropertiesFactory","Variables","FileService","CONSTANTS","Utils","WidgetUtilService",function($compile,$rootScope,$routeParams,PropertiesFactory,Variables,FileService,CONSTANTS,Utils,WidgetUtilService){"use strict";function evtHandler(e){e.stopPropagation(),e.preventDefault()}function bindEvtHandler(element){element.on("drop",evtHandler)}function unbindEvtHandler(element){element.off("drop",evtHandler)}function preCompilePartial(partialElement){partialElement.find('[on-click^="goToPage-"][on-click^="goToPage_"]').removeClass("active"),partialElement.find('[on-click="goToPage-'+(CONSTANTS.isRunMode?$routeParams.name:$rootScope.activePageName)+'"][on-click="goToPage_'+(CONSTANTS.isRunMode?$routeParams.name:$rootScope.activePageName)+'"]').addClass("active")}function compilePartialAndUpdateVariables(iScope,element,partialName,partialMarkup){var scope,target=iScope.target;Variables.setPageVariables(partialName,loadedPartials[partialName].variables),partialMarkup=partialMarkup+'<div class="app-included-page">'+(loadedPartials[partialName].html||"")+"</div>",CONSTANTS.isRunMode?partialMarkup=WM.element(Utils.processMarkup(partialMarkup)):(partialMarkup+='<div class="content-overlay"></div>',partialMarkup=WM.element(partialMarkup),partialMarkup.find("wm-livelist, wm-login").removeAttr("data-ng-controller")),scope=element.scope(),scope=scope.$new(),scope&&(preCompilePartial(partialMarkup),scope.partialname=partialName,scope.partialcontainername=iScope.name,target.html($compile(partialMarkup)(scope)),CONSTANTS.isStudioMode?(loadedPartials[partialName]=void 0,iScope.toolbar=target.find("button.wm-included-page-heading").first(),$rootScope.$safeApply(iScope)):CONSTANTS.isRunMode&&iScope.isPagePartRegistered&&(iScope.isPagePartRegistered=void 0,Utils.triggerFn(scope.onPagePartLoad)))}function onPageIncludeChange(iScope,element,attrs,newVal){var addToolBar,target=iScope.target,el="",page="pages/"+newVal+"/";target||(iScope.target=target=WM.isDefined(attrs.pageContainerTarget)?element:element.find("[page-container-target]").eq(0)),element.attr("content",newVal),CONSTANTS.isStudioMode&&target.find(".app-included-page, .app-included-page + .content-overlay, .wm-included-page-heading").remove(),newVal&&newVal.trim().length?loadedPartials[newVal]?compilePartialAndUpdateVariables(iScope,element,newVal,el):(CONSTANTS.isStudioMode&&(iScope.Widgets={},bindEvtHandler(element),addToolBar=WM.isDefined(attrs.widgetid),addToolBar&&(el='<button class="wm-included-page-heading button-primary" data-ng-click=openWorkspace("'+newVal+'"); title="edit '+newVal+'"><i class="wm-icon edit"></i></button>')),FileService.read({path:CONSTANTS.isStudioMode?"../../"+page+"page.min.html":page+"page.min.html",projectID:$rootScope.project.id},function(pageContent){loadedPartials[newVal]=Utils.parseCombinedPageContent(pageContent,newVal),compilePartialAndUpdateVariables(iScope,element,newVal,el)},function(){target=element[0].hasAttribute("page-container-target")?element:element.find("[page-container-target]").first(),target.html('<div class="app-partial-info"><div class="partial-message">Content for the container is unavailable.</div></div>')})):CONSTANTS.isStudioMode&&(iScope.Widgets=void 0,"wm-top-nav"!==iScope.widgettype||element.children().length||$rootScope.$emit("canvas-add-widget",{widgetType:"wm-list",parentName:iScope.name},!0),unbindEvtHandler(element))}function propertyChangeHandler(iScope,element,attrs,key,newVal){switch(key){case"content":newVal&&iScope.$lazyLoad&&!iScope.isActive?iScope.$lazyLoad=function(){onPageIncludeChange(iScope,element,attrs,newVal),iScope.$lazyLoad=WM.noop}:onPageIncludeChange(iScope,element,attrs,newVal);break;case"active":if(!CONSTANTS.isStudioMode||!iScope.toolbar)return;newVal?iScope.toolbar.addClass("active"):iScope.toolbar.removeClass("active")}}var props=PropertiesFactory.getPropertiesOf("wm.pagecontainer"),notifyFor={content:!0,active:!0},loadedPartials={};return{priority:"1000",compile:function(){return{pre:function(iScope,element,attrs){var partialName=attrs.page||attrs.content;WM.extend(iScope.widgetProps||{},WM.copy(props)),iScope["page-container"]=!0,CONSTANTS.isRunMode&&partialName&&!loadedPartials[partialName]&&!iScope.$lazyLoad&&(iScope.isPagePartRegistered=!0,Utils.triggerFn(element.scope().registerPagePart))},post:function(iScope,element,attrs){CONSTANTS.isStudioMode&&"wm-pagedialog"===iScope.widgettype&&(iScope.widgetProps.content.widget="pagedialog-pages-list"),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,iScope,element,attrs),iScope,notifyFor),iScope.hasOwnProperty("page")&&!iScope.content&&(iScope.content=iScope.page)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/anchor.html",'<a data-identifier="anchor" class="app-anchor" init-widget data-ng-show="show" title="{{hint}}" apply-styles><img data-identifier="img" class="anchor-image-icon" data-ng-src="{{iconsrc}}" data-ng-if="showimage" data-ng-style="{width:iconwidth ,height:iconheight, margin:iconmargin}"/><i class="{{iconclass}}" data-ng-style="{width:iconwidth, height:iconheight, margin:iconmargin}" data-ng-if="showicon"></i> <span class="anchor-caption"></span><span data-ng-if="badgevalue" class="badge pull-right">{{badgevalue}}</span></a>')}]).directive("wmAnchor",["PropertiesFactory","WidgetUtilService","$sce","Utils","CONSTANTS",function(PropertiesFactory,WidgetUtilService,$sce,Utils,CONSTANTS){"use strict";function propertyChangeHandler(scope,element,attrs,key,newVal){switch(key){case"target":attrs.$set("target",newVal);break;case"iconposition":element.attr("icon-position",newVal);break;case"hyperlink":attrs.$set("href",newVal),CONSTANTS.isRunMode&&Utils.stringStartsWith(newVal,"www.")&&(scope.hyperlink="http://"+newVal);break;case"iconclass":scope.showicon="_none_"!==scope.iconclass&&""!==newVal&&!scope.iconurl;break;case"iconurl":var showIcon=""===newVal;scope.showicon=showIcon,scope.showimage=!showIcon,scope.iconsrc=Utils.getImageUrl(newVal);break;case"caption":WM.isObject(newVal)?element.children(".anchor-caption").text(JSON.stringify(newVal)):element.children(".anchor-caption").html($sce.trustAs($sce.HTML,newVal.toString()).toString())}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.anchor",["wm.base","wm.base.editors","wm.base.events","wm.base.events.focus"]),notifyFor={iconname:!0,iconurl:!0,target:!0,hyperlink:!0,caption:!0,iconposition:!0};return{restrict:"E",replace:!0,scope:{},template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/anchor.html"),compile:function(tElement){return{pre:function(scope,element,attrs){!attrs.iconclass&&attrs.iconname&&(WM.element(tElement.context).attr("iconclass","glyphicon glyphicon-"+attrs.iconname),attrs.iconclass="glyphicon glyphicon-"+attrs.iconname),scope.showicon=!scope.iconurl,scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element,attrs),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/icon.html",'<i init-widget class="app-icon"  data-ng-class="iconclass" data-ng-show="show"  data-ng-style="{\'font-size\' : iconsize, \'color\' : color, \'opacity\' : opacity}"></i>')}]).directive("wmIcon",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.icon",["wm.base"]);return{restrict:"E",scope:{},replace:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/icon.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/htmlTemplate.html",'<div class="app-html-container" init-widget title="{{hint}}" data-ng-show="show" apply-styles><div class="html-content"></div> </div>')}]).directive("wmHtml",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";function propertyChangeHandler(element,targetEl,key,newVal){switch(key){case"content":targetEl.html(newVal);break;case"autoscroll":newVal=newVal===!0||"true"===newVal,element.css("overflow",newVal?"auto":"hidden")}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.html",["wm.base","wm.base.editors","wm.base.events"]),notifyFor={content:!0,autoscroll:!0};return{restrict:"E",replace:!0,scope:{},template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/htmlTemplate.html"),compile:function(tElement){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){var targetElement=element.children().first(),content=tElement.context.innerHTML;scope.content=attrs.content||content,targetElement.html(scope.content),element.css("overflow","hidden"),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,element,targetElement),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/iframe.html",'<div class="embed-responsive app-iframe" init-widget data-ng-show="show" data-ng-style="{width: width,height: height}"><iframe class="embed-responsive-item iframe-content" scrolling="auto" marginheight="0" marginwidth="0" frameborder="0" hint="{{title}}" seamless="seamless"></iframe><div class="wm-content-info {{class}} readonly-wrapper" data-ng-show="showContentLoadError"><p class="wm-message" title="{{hintMsg}}">{{errMsg}}</p></div></div>')}]).directive("wmIframe",["PropertiesFactory","$rootScope","WidgetUtilService","$sce","CONSTANTS","Utils","$location",function(PropertiesFactory,$rootScope,WidgetUtilService,$sce,CONSTANTS,Utils,$location){"use strict";function propertyChangeHandler(scope,element,key,newVal){switch(key){case"iframesrc":newVal&&WM.isString(newVal)&&-1===newVal.indexOf("Variables")&&(scope._iframesrc=$sce.trustAsResourceUrl(newVal),Utils.stringStartsWith(newVal,"http://")&&Utils.stringStartsWith($location.$$absUrl,"https://")?(scope.showContentLoadError=!0,scope.errMsg=$rootScope.locale.MESSAGE_ERROR_CONTENT_DISPLAY+newVal,scope.hintMsg=$rootScope.locale.MESSAGE_ERROR_CONTENT_DISPLAY+newVal):scope.showContentLoadError=!1,element.children("iframe").attr("src",scope._iframesrc))}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.iframe",["wm.base"]),notifyFor={iframesrc:!0};return{restrict:"E",scope:{},replace:!0,template:function(tElement,tAttrs){var template=WM.element(WidgetUtilService.getPreparedTemplate("template/widget/iframe.html",tElement,tAttrs));return template.find(".iframe-content").attr("name",tAttrs.name),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/label.html",'<label class="control-label app-label" data-ng-show="show" title="{{hint}}" init-widget apply-styles data-ng-class="{required:required}"></label>')}]).directive("wmLabel",["PropertiesFactory","WidgetUtilService","$sce",function(PropertiesFactory,WidgetUtilService,$sce){"use strict";function propertyChangeHandler(element,key,newVal){switch(key){case"caption":WM.isObject(newVal)?element.text(JSON.stringify(newVal)):element.html($sce.trustAs($sce.HTML,newVal.toString()).toString())}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.label",["wm.base","wm.base.editors","wm.base.events"]),notifyFor={caption:!0};return{restrict:"E",scope:{},replace:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/label.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/message.html",'<p class="alert app-message" data-ng-show="show" init-widget apply-styles data-ng-class=\'{"alert-success":messageType.isSuccess, "alert-danger":messageType.isError, "alert-warning":messageType.isWarning, "alert-info":messageType.isInfo, "alert-info alert-loading":messageType.isLoading}\' ><i class="icon"></i><span ng-bind-html="caption"></span><i class="close" data-ng-hide="hideClose">&times;</i></p>')}]).directive("wmMessage",["PropertiesFactory","$templateCache","WidgetUtilService",function(PropertiesFactory,$templateCache,WidgetUtilService){"use strict";function setDataSet(dataset,scope){!WM.isArray(dataset)&&WM.isObject(dataset)?(scope.caption=dataset.caption,scope.type=dataset.type,scope.show=dataset.show=!0):scope.show=!1}function propertyChangeHandler(scope,attrs,key,newVal){switch(key){case"type":"success"===newVal?scope.messageType={isSuccess:!0}:"error"===newVal?scope.messageType={isError:!0}:"warning"===newVal?scope.messageType={isWarning:!0}:"warn"===newVal?scope.type="warning":"info"===newVal?scope.messageType={isInfo:!0}:"loading"===newVal&&(scope.messageType={isLoading:!0});break;case"dataset":attrs.dataset&&setDataSet(newVal,scope)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.message",["wm.base"]),notifyFor={type:!0,dataset:!0};return{restrict:"E",replace:!0,scope:{scopedataset:"=?",onClose:"&"},template:function(tElement,tAttrs){var isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),template=WM.element($templateCache.get("template/widget/message.html"));return isWidgetInsideCanvas||template.children().last().attr("data-ng-click","dismiss({$event: $event, $scope: this})"),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){scope.hideClose=attrs.hideClose||!1,scope.dismiss=function(eventObject){scope.onClose({$event:eventObject.$event,$scope:eventObject.$scope}),scope.dataset?(scope.dataset.show=!1,setDataSet(null,scope)):scope.scopedataset?(scope.scopedataset.show=!1,setDataSet(null,scope)):scope.show=!1},scope.toggle=function(showHide,caption,type){WM.isUndefined(showHide)?scope.show=!scope.show:(scope.show="show"===showHide?!0:"hide"===showHide?!1:showHide,scope.caption=caption||scope.caption,scope.type=type||scope.type)},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,attrs),scope,notifyFor),scope.widgetid||attrs.scopedataset&&scope.$watch("scopedataset",function(newVal){setDataSet(newVal,scope)}),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/picture.html",'<img init-widget alt="{{hint}}" title="{{hint}}" ng-class="[imgClass]" class="app-picture" data-ng-src="{{imagesource}}" apply-styles data-ng-show="show">')}]).directive("wmPicture",["PropertiesFactory","WidgetUtilService","Utils",function(PropertiesFactory,WidgetUtilService,Utils){"use strict";function propertyChangeHandler(scope,element,key,newVal){switch(key){case"pictureaspect":switch(newVal){case"None":element.css({width:"",height:""});break;case"H":element.css({width:"100%",height:""});break;case"V":element.css({width:"",height:"100%"});break;case"Both":element.css({width:"100%",height:"100%"})}break;case"picturesource":scope.imagesource=Utils.getImageUrl(newVal);break;case"shape":scope.imgClass="img-"+newVal}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.picture",["wm.base","wm.base.editors","wm.base.events"]),notifyFor={pictureaspect:!0,picturesource:!0,shape:!0};return{restrict:"E",replace:!0,scope:{},template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/picture.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/basic/popover.html",'<div init-widget page-container class="app-popover {{showPopover ? \'open\' : \'\'}}" ><a data-identifier="popover" class="app-popover-link" data-ng-show="show" title="{{hint}}" data-ng-click="showPopover = !showPopover; handlePopoverToggle();" apply-styles="shell"><img data-identifier="img" class="anchor-image-icon" data-ng-src="{{iconsrc}}"  data-ng-show="showimage" data-ng-style="{width:iconwidth ,height:iconheight, margin:iconmargin}"/><i class="{{iconclass}}" data-ng-style="{width:iconwidth, height:iconheight, margin:iconmargin}" data-ng-show="showicon"></i> <span class="anchor-caption"></span></a><div class="popover {{popoverplacement}}" data-ng-style="{\'width\' : popoverwidth, \'height\' : popoverheight}"><div class="arrow" data-ng-show="{{popoverarrow}}"></div><div class="popover-content" page-container-target data-ng-show="show"></div></div></div>');
}]).directive("wmPopover",["PropertiesFactory","WidgetUtilService","$sce","Utils","CONSTANTS",function(PropertiesFactory,WidgetUtilService,$sce,Utils,CONSTANTS){"use strict";function propertyChangeHandler(scope,element,key,newVal){switch(key){case"iconclass":scope.showicon="_none_"!==scope.iconclass&&""!==newVal&&!scope.iconurl;break;case"iconurl":var showIcon=""===newVal;scope.showicon=showIcon,scope.showimage=!showIcon,scope.iconsrc=Utils.getImageUrl(newVal);break;case"caption":WM.isObject(newVal)?element.find("a span.anchor-caption").text(JSON.stringify(newVal)):element.find("a span.anchor-caption").html($sce.trustAs($sce.HTML,newVal.toString()).toString())}}function buildPopoverToggleHandler(scope,element,config){var AutoClose=function(target){var self=this;this.enable=!1,this.eventName="click.autoclose"+(new Date).getTime(),this.target=target,this.start=function(onClose){this.target.on(this.eventName,function(){self.enable=!1}),WM.element("body").on(this.eventName,function(){self.enable&&onClose&&(self.stop(),onClose()),self.enable=!0})},this.stop=function(){target.off(self.eventName),WM.element("body").off(self.eventName)}},toggleHandler=new function(){this.popover=element.find(">.popover:first"),this.config=config,this.element=element,this.autoclose=this.config.enableAutoClose?new AutoClose(this.popover):!1,this.handle=function(){var self=this;scope.showPopover&&this.setPopoverPosition(),this.popover.toggle(),this.autoclose&&(scope.showPopover?(this.autoclose.enable=!1,this.autoclose.start(function(){self.popover.hide(),scope.showPopover=!1})):this.autoclose.stop())},this.getDimensions=function(ele){return{width:Math.abs(ele.width()),height:Math.abs(ele.height())}},this.setPopoverPosition=function(){var popoverDims=this.getDimensions(this.popover),arrow=this.element.find(".arrow"),placement=this.config.placement,arrowDims={width:0,height:0},documentDims=this.getDimensions(WM.element(document)),targetDims=this.getDimensions(this.element),targetPosition=this.element.position(),tipOffset={width:-arrowDims.width/2,height:-arrowDims.height/2},popoverPosition={left:targetPosition.left+tipOffset.width,top:targetPosition.top+tipOffset.height};arrow.removeClass("top bottom left right"),"left"===placement||"right"===placement?("left"===placement?popoverPosition.left+=-1*(popoverDims.width+arrowDims.width):popoverPosition.left+=targetDims.width+arrowDims.width,this.element.offset().top+popoverDims.height<=documentDims.height?arrow.addClass("top"):(popoverPosition.top=targetPosition.top+targetDims.height-popoverDims.height,arrow.addClass("bottom"))):("top"===placement||"bottom"===placement)&&("top"===placement?popoverPosition.top+=-1*popoverDims.height:popoverPosition.top+=targetDims.height+arrowDims.height,this.element.offset().left+popoverDims.width<=documentDims.width?arrow.addClass("left"):(popoverPosition.left=targetPosition.left+targetDims.width-popoverDims.width,arrow.addClass("right"))),this.popover.css(popoverPosition)}};return function(){toggleHandler.handle()}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.popover",["wm.base","wm.base.editors"]),notifyFor={iconclass:!0,iconurl:!0,caption:!0};return{restrict:"E",replace:!0,scope:{},transclude:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/basic/popover.html"),compile:function(){return{pre:function(scope){scope.showicon=!scope.iconurl,scope.showPopover=!1,scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs);var popoverConfig={enableAutoClose:scope.popoverautoclose,showArrow:scope.popoverarrow,placement:scope.popoverplacement};CONSTANTS.isRunMode?scope.handlePopoverToggle=buildPopoverToggleHandler(scope,element,popoverConfig):scope.handlePopoverToggle=WM.noop}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/video.html",'<video init-widget alt="{{hint}}" title="{{hint}}" class="app-video" preload="{{videopreload}}" data-ng-attr-poster="{{postersource}}" data-ng-src="{{mp4videoUrl}}" apply-styles data-ng-show="show" ><source type="video/mp4" data-ng-src="{{mp4videoUrl}}" data-ng-if="mp4videoUrl"><source type="video/webm" data-ng-src="{{webmvideoUrl}}" data-ng-if="webmvideoUrl"><source type="video/ogg" data-ng-src="{{oggvideoUrl}}" data-ng-if="oggvideoUrl"><track kind="subtitles" label="{{subtitlelang}}" data-ng-if="tracksource" data-ng-src="{{tracksource}}" srclang="{{subtitlelang}}" default>{{videosupportmessage}}</video>')}]).directive("wmVideo",["PropertiesFactory","$templateCache","WidgetUtilService","Utils","$sce","CONSTANTS",function(PropertiesFactory,$templateCache,WidgetUtilService,Utils,$sce,CONSTANTS){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"videoposter":scope.postersource=Utils.getImageUrl(newVal);break;case"mp4format":WM.isString(newVal)&&-1===newVal.indexOf("Variables")&&(scope.mp4videoUrl=$sce.trustAsResourceUrl(newVal));break;case"oggformat":WM.isString(newVal)&&-1===newVal.indexOf("Variables")&&(scope.oggvideoUrl=$sce.trustAsResourceUrl(newVal));break;case"webmformat":WM.isString(newVal)&&-1===newVal.indexOf("Variables")&&(scope.webmvideoUrl=$sce.trustAsResourceUrl(newVal));break;case"subtitlesource":WM.isString(newVal)&&-1===newVal.indexOf("Variables")&&(scope.tracksource=Utils.getResourceUrl(newVal))}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.video",["wm.base","wm.containers"]),notifyFor={videoposter:!0,mp4format:!0,oggformat:!0,webmformat:!0,subtitlesource:!0};return{restrict:"E",replace:!0,scope:{},template:$templateCache.get("template/widget/video.html"),compile:function(tElement){return CONSTANTS.isStudioMode&&tElement.removeAttr("autoplay"),{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),element.removeAttr("muted"),element[0].muted=attrs.hasOwnProperty("muted")&&"false"!==attrs.muted,WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/audio.html",'<audio init-widget alt="{{hint}}" title="{{hint}}" class="app-audio" preload="{{audiopreload}}" data-ng-src="{{mp3audioUrl}}" apply-styles data-ng-show="show" ><source type="audio/mp3" ng-src="{{mp3audioUrl}}">{{audiosupportmessage}}</audio>')}]).directive("wmAudio",["PropertiesFactory","$templateCache","WidgetUtilService","$sce","CONSTANTS",function(PropertiesFactory,$templateCache,WidgetUtilService,$sce,CONSTANTS){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"mp3format":WM.isString(newVal)&&-1===newVal.indexOf("Variables")&&(scope.mp3audioUrl=$sce.trustAsResourceUrl(newVal))}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.audio",["wm.base","wm.containers"]),notifyFor={mp3format:!0};return{restrict:"E",replace:!0,scope:{},template:$templateCache.get("template/widget/audio.html"),compile:function(tElement){return CONSTANTS.isStudioMode&&tElement.removeAttr("autoplay"),{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),element.removeAttr("muted"),element[0].muted=attrs.hasOwnProperty("muted")&&"false"!==attrs.muted,WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/searchlist.html",'<a><img data-ng-src="{{match.model.wmImgSrc}}" data-ng-if="match.model.wmImgSrc" width="16"><span bind-html-unsafe="match.label | typeaheadHighlight:query"></span></a>'),$templateCache.put("template/widget/form/search.html",'<div class="app-search input-group" init-widget has-model data-ng-show="show" data-ng-style="{ color: color,  height: height,  width: width,  cursor: cursor,  fontFamily: fontfamily,  fontSize: fontsize,  fontWeight: fontweight,  fontStyle: fontstyle,  opacity: opacity,  textDecoration: textdecoration,  whiteSpace: whitespace,  wordBreak: wordbreak,  zIndex: zindex }"><input data-ng-if="dataSetType === \'listOfObjects\'" type="text" class="app-textbox form-control" placeholder="{{placeholder}}" data-ng-model="query"typeahead="item[displaylabel] for item in itemList | filter:{\'{{searchkey}}\':$viewValue} | limitTo:limit" typeahead-on-select="onTypeAheadSelect($event, $item, $model, $label)"typeahead-template-url="template/widget/form/searchlist.html"><input data-ng-if="dataSetType === \'listOfStrings\'" type="text" class="app-textbox form-control" placeholder="{{placeholder}}"data-ng-model="query"typeahead="item for item in itemList | filter:$viewValue | limitTo:limit" typeahead-on-select="onTypeAheadSelect($event, $item, $model, $label)"typeahead-template-url="template/widget/form/searchlist.html"><span class="input-group-addon" data-ng-if="dataSetType === \'listOfObjects\' || dataSetType === \'listOfStrings\'" ><form data-ng-submit="onSubmit({$event: $event, $scope: this})" ><button class="app-search-button glyphicon glyphicon-search" type="submit" data-ng-click="onTypeAheadSelect($event, $item, $model, $label)"></button></form></span></div>')}]).directive("wmSearch",["PropertiesFactory","$templateCache","WidgetUtilService","CONSTANTS",function(PropertiesFactory,$templateCache,WidgetUtilService,CONSTANTS){"use strict";function setDataSet(data,scope){if(!data)return scope.dataSetType||scope.binddataset?scope.binddataset&&(scope.dataSetType="listOfObjects"):scope.dataSetType="listOfStrings",void(scope.itemList||(scope.itemList=[]));if(CONSTANTS.isRunMode){data=data&&data.data||data;var dataSet=WM.copy(data);WM.isArray(dataSet)?(WM.isObject(dataSet[0])?(scope.dataSetType="listOfObjects",WM.forEach(dataSet,function(eachItem,index){dataSet[index][scope.displaylabel]=eachItem[scope.displaylabel]&&eachItem[scope.displaylabel].toString(),dataSet[index].wmImgSrc=eachItem[scope.displayimagesrc]})):(scope.dataSetType="listOfStrings",WM.forEach(dataSet,function(val,index){dataSet[index]=val.toString()})),scope.itemList=dataSet):WM.isString(dataSet)&&dataSet.trim()?setDataSet(dataSet.split(","),scope):WM.isObject(dataSet)&&setDataSet(Object.keys(dataSet).join(","),scope)}}function updatePropertyPanelOptions(dataset,scope){var variableKeys=[];dataset&&(dataset=dataset[0]||dataset,variableKeys=WM.isObject(dataset)&&!WM.isArray(dataset)?Object.keys(dataset||{}):[]),scope.newcolumns&&(scope.newcolumns=!1,scope.searchkey="",scope.displaylabel="",scope.datafield="",scope.$root.$emit("set-markup-attr",scope.widgetid,{searchkey:scope.searchkey,datafield:scope.datafield,displaylabel:scope.displaylabel})),scope.widgetProps.searchkey.options=scope.widgetProps.displaylabel.options=scope.widgetProps.displayimagesrc.options=[""].concat(variableKeys),scope.widgetProps.datafield.options=["All Fields"].concat(variableKeys)}function propertyChangeHandler(scope,key,newVal){switch(key){case"searchkey":scope.searchkey=newVal&&newVal.replace(dataSetRegEx,"");break;case"displaylabel":scope.displaylabel=newVal&&newVal.replace(dataSetRegEx,"");break;case"dataset":scope.widgetid&&updatePropertyPanelOptions(newVal&&newVal.data||newVal,scope),setDataSet(newVal,scope);break;case"displayimagesrc":scope.displayimagesrc=newVal;break;case"active":scope.widgetid&&newVal&&updatePropertyPanelOptions(scope.dataset&&scope.dataset.data||scope.dataset,scope)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.search",["wm.base"]),dataSetRegEx=new RegExp(/scopedataset\./gi),notifyFor={searchkey:!0,displaylabel:!0,dataset:!0,displayimagesrc:!0,active:!0};return{restrict:"E",replace:!0,scope:{scopedataset:"=?",onSubmit:"&"},template:$templateCache.get("template/widget/form/search.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){CONSTANTS.isStudioMode&&(scope.dataSetType="listOfStrings"),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),scope.onTypeAheadSelect=function($event,$item,$model,$label){$event=$event||{},$item&&$item.wmImgSrc&&($item=WM.copy($item),delete $item.wmImgSrc),$event.data={item:$item,model:$model,label:$label,query:element.find("input").val()},scope.datavalue=scope.datafield&&"All Fields"!==scope.datafield?$item[scope.datafield]:$item,scope.onSubmit({$event:$event,$scope:scope})},scope.$watch("scopedataset",function(newVal){setDataSet(newVal,scope)}),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/spinner.html",'<div class="app-spinner {{size}}" data-ng-show="show" init-widget title="{{hint}}" apply-styles><div class="spinner-message"><span class="spinner-image" data-ng-style="{backgroundImage:picture, width: imagewidth, height: imageheight}"></span><span class="spinner-text" data-ng-bind="caption"></span></div></div>')}]).directive("wmSpinner",["PropertiesFactory","$rootScope","$templateCache","WidgetUtilService","Utils",function(PropertiesFactory,$rootScope,$templateCache,WidgetUtilService,Utils){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"image":scope.picture=Utils.getBackGroundImageUrl(newVal);break;case"backgroundimage":scope.backgroundimgsource=Utils.getBackGroundImageUrl(newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.spinner",["wm.base"]),notifyFor={image:!0,backgroundimage:!0};return{restrict:"E",scope:{},replace:!0,template:$templateCache.get("template/widget/spinner.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs),scope.widgetid||scope.$on("$destroy",$rootScope.$on("toggle-variable-state",function(event,variableName,show){variableName===scope.servicevariabletotrack&&(scope.show=show)}))}}}}}]),WM.module("wm.widgets.basic").directive("wmTree",["PropertiesFactory","$rootScope","WidgetUtilService","$timeout","Utils","CONSTANTS",function(PropertiesFactory,$rootScope,WidgetUtilService,$timeout,Utils,CONSTANTS){"use strict";function constructNodes(scope,nodes,parent){var iconField=scope.nodeicon||"icon",labelField=scope.nodelabel||"label",childrenField=scope.nodechildren||"children",$ul=WM.element("<ul></ul>"),collapsedIconClass=ICON_CLASSES[scope.treeicons||defaultTreeIconClass].collapsed;parent.append($ul),nodes.forEach(function(node){var expandCollapseIcon,$li=WM.element("<li></li>"),$iconNode=WM.element("<i></i>"),nodeLabel=node[labelField],nodeIcon=node[iconField],nodeChildren=node[childrenField];$li.data("nodedata",node).append($iconNode).append('<span class="title">'+nodeLabel+"</span>").appendTo($ul),nodeIcon&&$iconNode.addClass(nodeIcon),nodeChildren&&nodeChildren.length?($li.addClass("parent-node collapsed"),expandCollapseIcon=WM.element('<i class="glyphicon collapsed '+collapsedIconClass+'"></i>'),nodeIcon&&$iconNode.addClass(nodeIcon),$li.prepend(expandCollapseIcon),scope.widgetid||constructNodes(scope,nodeChildren,$li)):(nodeIcon||$iconNode.addClass("leaf-node"),$li.addClass("leaf-node"))})}function getNodes(scope,newVal){var nodes=[];return WM.isString(newVal)?(newVal=newVal.trim(),newVal&&(nodes=newVal.split(",").map(function(item){return{label:item&&item.trim()}}))):WM.isArray(newVal)?nodes=newVal:WM.isObject(newVal)&&(nodes=[newVal]),scope.widgetid&&(scope.keys=WM.isObject(nodes[0])?Object.keys(nodes[0]):[],scope.widgetProps.nodelabel.options=scope.widgetProps.nodechildren.options=scope.widgetProps.nodeicon.options=[""].concat(scope.keys)),nodes}function changeTreeIcons(element,newVal,oldVal){newVal=newVal||defaultTreeIconClass,oldVal=oldVal||defaultTreeIconClass,element.find("i.expanded").switchClass(ICON_CLASSES[oldVal].expanded,ICON_CLASSES[newVal].expanded),element.find("i.collapsed").switchClass(ICON_CLASSES[oldVal].collapsed,ICON_CLASSES[newVal].collapsed)}function renderTree(element,scope){if(element.empty(),scope.nodes.length){var docFrag=document.createDocumentFragment();constructNodes(scope,scope.nodes,WM.element(docFrag)),element.append(docFrag)}}function propertyChangeHandler(scope,element,key,newVal,oldVal){switch(key){case"scopedataset":case"dataset":scope.nodes=getNodes(scope,newVal.data||newVal),renderTree(element,scope);break;case"nodeicon":case"nodelabel":case"nodechildren":renderTree(element,scope);break;case"treeicons":changeTreeIcons(element,newVal,oldVal)}}function bindEvents(scope,element){element.on("click",function(evt){var fn,data,target=WM.element(evt.target),li=target.closest("li"),path="",treeIcons=ICON_CLASSES[scope.treeicons||defaultTreeIconClass];scope.selecteditem={},evt.stopPropagation(),target.is("i")?target.hasClass("collapsed")?(target.switchClass("collapsed "+treeIcons.collapsed,"expanded "+treeIcons.expanded),li.switchClass("collapsed").addClass("expanded")):target.hasClass("expanded")&&(target.switchClass("expanded "+treeIcons.expanded,"collapsed "+treeIcons.collapsed),li.removeClass("expanded").addClass("collapsed")):target.is("span.title")&&(element.find(".selected").removeClass("selected"),li.addClass("selected"),data=li.data("nodedata"),target.parents(".app-tree li").each(function(){var current=WM.element(this).children(".title").text();path="/"+current+path}),scope.selecteditem=WM.copy(data),scope.selecteditem.path=path,fn=scope.onSelect({$event:evt,$scope:scope,$item:data,$path:path}),Utils.triggerFn(fn),$rootScope.$safeApply(scope))})}var widgetProps=PropertiesFactory.getPropertiesOf("wm.tree",["wm.base","wm.base.editors"]),notifyFor={scopedataset:!0,dataset:!0,treeicons:!0,nodelabel:!0,nodeicon:!0,nodechildren:!0},defaultTreeIconClass="plus-minus",ICON_CLASSES={folder:{expanded:"glyphicon-folder-open",collapsed:"glyphicon-folder-close"},"circle-plus-minus":{expanded:"glyphicon-minus-sign",collapsed:"glyphicon-plus-sign"},chevron:{expanded:"glyphicon-chevron-down",collapsed:"glyphicon-chevron-right"},menu:{expanded:"glyphicon-menu-down",collapsed:"glyphicon-menu-right"},triangle:{expanded:"glyphicon-triangle-bottom",collapsed:"glyphicon-triangle-right"},"expand-collapse":{expanded:"glyphicon-collapse-down",collapsed:"glyphicon-expand"},"plus-minus":{expanded:"glyphicon-minus",collapsed:"glyphicon-plus"}};return{restrict:"E",scope:{scopedataset:"=?",onSelect:"&"},template:'<div class="app-tree" init-widget apply-styles="container" data-ng-show="show"></div>',replace:!0,compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){scope.widgetid||bindEvents(scope,element),renderTree=_.debounce(renderTree,20);var onPropertyChange=propertyChangeHandler.bind(void 0,scope,element);WidgetUtilService.registerPropertyChangeListener(onPropertyChange,scope,notifyFor),!scope.widgetid&&attrs.scopedataset&&$timeout(function(){scope.$watch("scopedataset",function(newVal){onPropertyChange("scopedataset",newVal)},!0)},0),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/chart.html",'<div init-widget class="app-chart" title="{{hint}}" data-ng-show="show" apply-styles><div class="app-chart-inner"><svg></svg><div class="wm-content-info readonly-wrapper {{class}}" data-ng-show="showContentLoadError"><p class="wm-message" title="{{hintMsg}}">{{errMsg}}</p></div></div></div>')}]).directive("wmChart",function(PropertiesFactory,$templateCache,$rootScope,WidgetUtilService,CONSTANTS,QueryBuilder,Utils,$timeout){"use strict";function isPieChart(type){return"Pie"===type}function isBarChart(type){return"Bar"===type}function isDonutChart(type){return"Donut"===type}function isBubbleChart(type){return"Bubble"===type}function isPieType(type){return isPieChart(type)||isDonutChart(type)}function isChartDataJSON(type){return dataTypeJSON.indexOf(type)>-1||-1===chartTypes.indexOf(type)}function isChartDataArray(type){return dataTypeArray.indexOf(type)>-1}function isLineTypeChart(type){return lineTypeCharts.indexOf(type)>-1}function formatData(scope,d,dataType,options){var formattedData,divider,prefix,datakey=options.isXaxis&&options.xDataKeyArr&&options.xDataKeyArr.length?options.xDataKeyArr[d]:d;switch(dataType){case"date":return isLineTypeChart(scope.type)?datakey:d3.time.format(options.dateFormat)(new Date(d));case"string":case"year":return datakey;default:return formattedData=d3.format(options.format)(d),options.numberFormat&&dataType?(divider=tickformats[options.numberFormat]&&tickformats[options.numberFormat].divider||0,prefix=tickformats[options.numberFormat]&&tickformats[options.numberFormat].prefix,prefix&&0!==divider&&(formattedData=d3.format(".2f")(d/divider)+prefix)):options.numberFormat||(formattedData=d3.format(".3s")(d)),formattedData}}function constructSampleData(scope){var i,dataPoint,jsonFormatData=[],pieChartData=[],arrayFormatData=[],pieName="Group";for(i=1;5>i;i+=1)dataPoint={},pieChartData.push({x:pieName+i,y:i}),dataPoint.x=i,dataPoint.y=i,isBubbleChart(scope.type)&&(dataPoint.size=2*(i+1),dataPoint.shape=scope.shape||"circle"),jsonFormatData.push(dataPoint),arrayFormatData.push([i,i]);sampleData.jsonFormat=jsonFormatData,sampleData.arrayFormat=arrayFormatData,sampleData.pieChartFormat=pieChartData}function getSampleData(scope){var dataType;return(Utils.isEmptyObject(sampleData)||isBubbleChart(scope.type))&&constructSampleData(scope),isPieType(scope.type)?sampleData.pieChartFormat:(dataType=isChartDataJSON(scope.type)?"jsonFormat":"arrayFormat",[{values:sampleData[dataType],key:"Default"}])}function getDataType(key,data){var value,keys=key.split("."),newKey=key;return data?(value=data[key],void 0===value&&keys.length>1?(data=data[keys[0]],keys.shift(),newKey=keys.join("."),getDataType(newKey,data)):typeof value):null}function getColumnType(key,columns){var newKey,i,type,keys=key.split(".");if(columns)for(i=0;i<columns.length;i+=1)if(keys.length>0&&key.indexOf(".")>-1){if(Utils.initCaps(keys[0])===columns[i].relatedEntityName)return columns=columns[i].columns,keys.shift(),newKey=keys.join("."),getColumnType(newKey,columns)}else columns[i].fieldName===key&&(type=columns[i].type);return type||null}function hideOrShowProperties(properties,scope,show){show=WM.isDefined(show)?show:!1;var _widgetProps=scope.widgetProps;properties.forEach(function(prop){_widgetProps[prop].show=show})}function togglePropertiesByChartType(scope){hideOrShowProperties(allOptions,scope,!1),hideOrShowProperties(-1===chartTypes.indexOf(scope.type)?options.Column:options[scope.type],scope,!0),isPieType(scope.type)?(scope.widgetProps.xaxisdatakey.displayKey="LABEL_PROPERTY_LABEL",scope.widgetProps.yaxisdatakey.displayKey="LABEL_PROPERTY_VALUES",PropertiesFactory.getPropertyGroup("xaxis").displayKey="LABEL_PROPERTY_LABEL_DATA",PropertiesFactory.getPropertyGroup("yaxis").displayKey="LABEL_PROPERTY_VALUE_DATA",scope.widgetProps.yaxisdatakey.widget="list",scope.dataset&&(scope.widgetProps.yaxisdatakey.options=scope.axisoptions)):(scope.widgetProps.xaxisdatakey.displayKey=void 0,scope.widgetProps.yaxisdatakey.displayKey=void 0,PropertiesFactory.getPropertyGroup("xaxis").displayKey=void 0,PropertiesFactory.getPropertyGroup("yaxis").displayKey=void 0,scope.widgetProps.yaxisdatakey.widget="multiselect",$timeout(function(){scope.widgetDataset.yaxisdatakey=scope.axisoptions?scope.axisoptions.join(","):""},5))}function displayFormatOptions(scope,axis){var type,key=axis+"axisdatakey",numFormat=axis+"numberformat",digits=axis+"digits",dateFormat=axis+"dateformat";if(!isPieType(scope.type)||"x"!==axis)switch(scope.dataset&&scope.dataset.propertiesMap&&(type=scope[key]?getColumnType(scope[key].split(",")[0],scope.dataset.propertiesMap.columns):null),type){case"integer":case"float":hideOrShowProperties([numFormat,digits],scope,!0),hideOrShowProperties([dateFormat],scope,!1);break;case"string":hideOrShowProperties([numFormat,digits,dateFormat],scope,!1);break;case"date":hideOrShowProperties([numFormat,digits],scope,!1),hideOrShowProperties([dateFormat],scope,!0)}}function isSingleYAxis(type){return isPieType(type)?!0:!1}function setYAxisDataKey(scope,options,dataSet){isSingleYAxis(scope.type)?(scope.widgetProps.yaxisdatakey.widget="list",scope.widgetProps.yaxisdatakey.options=options):scope.widgetDataset.yaxisdatakey=dataSet||options?options.join(","):""}function isGroupByEnabled(groupby){return groupby&&"none"!==groupby}function toggleAggregationColumnState(scope){scope.widgetProps.aggregationcolumn.disabled=!(isGroupByEnabled(scope.groupby)&&scope.aggregation&&"none"!==scope.aggregation)}function toggleAggregationState(scope){scope.widgetProps.aggregation.disabled=!isGroupByEnabled(scope.groupby),toggleAggregationColumnState(scope)}function modifyAxesOptions(scope){var options,xAxisOptions=[],yAxisOptions=[],isAggregationApplied=isGroupByEnabled(scope.groupby)&&scope.aggregation&&"none"!==scope.aggregation;scope.binddataset&&WM.isObject(scope.dataset)?(options=scope.axisoptions,isAggregationApplied?(scope.groupby?(xAxisOptions=scope.groupby.split(","),scope.xaxisdatakey=xAxisOptions[0]):xAxisOptions=options,isAggregationApplied&&scope.aggregationcolumn?(yAxisOptions.push(scope.aggregationcolumn),scope.yaxisdatakey=yAxisOptions[0]):yAxisOptions=options,scope.widgetProps.xaxisdatakey.options=xAxisOptions,setYAxisDataKey(scope,yAxisOptions,""),setYAxisDataKey(scope,yAxisOptions,yAxisOptions),isBubbleChart(scope.type)&&(scope.widgetProps.bubblesize.options=options)):(scope.widgetProps.xaxisdatakey.options=options,setYAxisDataKey(scope,options,""),isBubbleChart(scope.type)&&(scope.widgetProps.bubblesize.options=options)),displayFormatOptions(scope,"x"),displayFormatOptions(scope,"y")):scope.binddataset||(scope.widgetProps.xaxisdatakey.options=[],setYAxisDataKey(scope,[],""),scope.widgetProps.aggregationcolumn.options=[],scope.xaxisdatakey=scope.yaxisdatakey="",scope.xaxislabel=scope.yaxislabel="",scope.xunits=scope.yunits="",scope.bubblesize="",scope.widgetProps.bubblesize.options=[],scope.widgetProps.aggregationcolumn.disabled=!0,scope.widgetProps.aggregation.disabled=!0,scope.active&&($rootScope.$emit("update-widget-property","aggregation",""),$rootScope.$emit("update-widget-property","aggregationcolumn",""),$rootScope.$emit("update-widget-property","groupby",""),$rootScope.$emit("update-widget-property","orderby",""))),scope.$root.$emit("set-markup-attr",scope.widgetid,{xaxisdatakey:scope.xaxisdatakey,yaxisdatakey:scope.yaxisdatakey})}function isValidAxis(scope){return scope.binddataset?scope.xaxisdatakey&&scope.yaxisdatakey:!0}function isAggregationEnabled(scope){return isGroupByEnabled(scope.groupby)&&"none"!==scope.aggregation&&scope.aggregationcolumn||isGroupByEnabled(scope.groupby)||scope.orderby}function isNumberType(dataType){var numberTypes=["integer","float","number","big_decimal","big_integer","double","short"];return-1!==numberTypes.indexOf(dataType)}function getLeafNodeVal(key,dataObj){var i,keys=key.split("."),data=dataObj;for(i=0;i<keys.length;i+=1){if(!data){data=dataObj[key];break}data=data[keys[i]]}return data}function getxAxisVal(scope,dataObj,xKey,index){var value=getLeafNodeVal(xKey,dataObj);return isLineTypeChart(scope.type)&&!isNumberType(scope.xAxisDataType)?(scope.xDataKeyArr.push(value),index):value}function valueFinder(scope,dataObj,xKey,yKey,index,shape){var xVal=getxAxisVal(scope,dataObj,xKey,index),value=getLeafNodeVal(yKey,dataObj),yVal=parseFloat(value)||value,dataPoint={},size=parseFloat(dataObj[scope.bubblesize])||2,type=scope.type;return isChartDataJSON(type)?(dataPoint.x=xVal,dataPoint.y=yVal,isBubbleChart(type)&&(dataPoint.size=size,dataPoint.shape=shape||"circle")):isChartDataArray(type)&&(dataPoint=[xVal,yVal]),dataPoint}function getChartData(scope){var shapes=[];if(scope.sampleData=getSampleData(scope),scope.xDataKeyArr=[],!scope.binddataset)return scope.sampleData;if(CONSTANTS.isStudioMode){if(scope.showContentLoadError=!1,scope.binddataset&&!scope.chartData)return[];if(scope.isServiceVariable)return scope.showContentLoadError=!0,scope.errMsg=$rootScope.locale.MESSAGE_INFO_SAMPLE_DATA,scope.hintMsg=$rootScope.locale.MESSAGE_ERROR_DATA_DISPLAY+scope.name,scope.sampleData;if(!scope.chartData)return scope.sampleData}else{if(!isValidAxis(scope)&&isAggregationEnabled(scope))return scope.sampleData;if(!scope.chartData)return[]}var yAxisKey,datum=[],xAxisKey=scope.xaxisdatakey,yAxisKeys=scope.yaxisdatakey?scope.yaxisdatakey.split(","):[],dataSet=scope.chartData;return scope.isLiveVariable?(scope.xAxisDataType=getColumnType(xAxisKey,scope.dataset.propertiesMap.columns),scope.yAxisDataType=getColumnType(yAxisKeys[0],scope.dataset.propertiesMap.columns)):scope.chartData&&scope.chartData[0]&&(scope.xAxisDataType=getDataType(xAxisKey,scope.chartData[0]),scope.yAxisDataType=getDataType(yAxisKeys[0],scope.chartData[0])),WM.isArray(dataSet)&&(isPieType(scope.type)?(yAxisKey=yAxisKeys[0],datum=_.map(dataSet,function(dataObj){return valueFinder(scope,dataObj,xAxisKey,yAxisKey)})):(isBubbleChart(scope.type)&&(shapes="random"===scope.shape?allShapes:scope.shape),yAxisKeys.forEach(function(yAxisKey,series){datum.push({values:_.map(dataSet,function(dataObj,index){return valueFinder(scope,dataObj,xAxisKey,yAxisKey,index,WM.isArray(shapes)&&shapes[series]||scope.shape)}),key:yAxisKey})}))),datum}function getAggregationFunction(option){switch(option){case"average":return"AVG";case"count":return"COUNT";case"maximum":return"MAX";case"minimum":return"MIN";case"sum":return"SUM";default:return""}}function getGroupedData(scope,queryResponse,groupingColumn){var groupKey,i,chartData=[],groupData={},groupValues=[],index=0;for(scope.xAxisDataType=getColumnType(scope.xaxisdatakey,scope.dataset.propertiesMap.columns),scope.yAxisDataType=getColumnType(scope.yaxisdatakey,scope.dataset.propertiesMap.columns);0!==queryResponse.length;){for(groupKey=queryResponse[queryResponse.length-1][groupingColumn],groupValues.unshift(valueFinder(scope,queryResponse[queryResponse.length-1],scope.xaxisdatakey,scope.yaxisdatakey,0)),queryResponse.splice(queryResponse.length-1,1),i=queryResponse.length-1;i>=0;i-=1)groupKey===queryResponse[i][groupingColumn]&&(index+=1,groupValues.unshift(valueFinder(scope,queryResponse[i],scope.xaxisdatakey,scope.yaxisdatakey,index)),queryResponse.splice(i,1));groupData={key:groupKey,values:groupValues},chartData.push(groupData),groupValues=[],index=0}return chartData}function getOrderbyExpression(orderby){var orderbyCols=(orderby?orderby.replace(/:/g," "):"").split(","),trimmedCols="";return orderbyCols=orderbyCols.map(function(col){return col.trim()}),trimmedCols=orderbyCols.join()}function getValidAliasName(aliasName){return aliasName?aliasName.replace(/\./g,"_"):null}function getQueryColumns(scope){var expr,columns=[],groupbyColumns=scope.groupby?scope.groupby.split(","):[],yAxisKeys=scope.yaxisdatakey?scope.yaxisdatakey.split(","):[];return groupbyColumns.forEach(function(columnName){columnName!==scope.aggregationcolumn&&columns.push(columnName+" AS "+getValidAliasName(columnName))}),"none"!==scope.aggregation&&scope.aggregationcolumn&&columns.push(getAggregationFunction(scope.aggregation)+"("+scope.aggregationcolumn+") AS "+getValidAliasName(scope.aggregationcolumn)),scope.aggregationcolumn!==scope.xaxisdatakey&&(expr=scope.xaxisdatakey+" AS "+getValidAliasName(scope.xaxisdatakey),-1===columns.indexOf(expr)&&columns.push(expr)),yAxisKeys.forEach(function(yAxisKey){yAxisKey!==scope.aggregationcolumn&&(expr=yAxisKey+" AS "+getValidAliasName(yAxisKey),
-1===columns.indexOf(expr)&&columns.push(expr))}),columns}function getGroupingDetails(scope){var groupingColumnIndex,isVisuallyGrouped=!1,visualGroupingColumn="",groupingExpression="",groupbyColumns=scope.groupby?scope.groupby.split(","):[],yAxisKeys=scope.yaxisdatakey?scope.yaxisdatakey.split(","):[];return scope.groupby&&(groupbyColumns.every(function(column,index){return scope.xaxisdatakey!==column&&-1===WM.element.inArray(column,yAxisKeys)?(isVisuallyGrouped=!0,visualGroupingColumn=column,groupingColumnIndex=index,groupbyColumns.splice(groupingColumnIndex,1),!1):!0}),visualGroupingColumn&&(groupingExpression=visualGroupingColumn,groupbyColumns.length&&(groupingExpression+=",")),groupbyColumns.length&&(groupingExpression+=groupbyColumns.join())),scope.isVisuallyGrouped=isVisuallyGrouped,{expression:groupingExpression,isVisuallyGrouped:isVisuallyGrouped,visualGroupingColumn:visualGroupingColumn}}function getAggregatedData(scope,element,callback){var query,variableName,variable,columns,yAxisKeys=scope.yaxisdatakey?scope.yaxisdatakey.split(","):[],orderbyexpression=getOrderbyExpression(scope.orderby),groupingDetails=getGroupingDetails(scope),groupbyExpression=groupingDetails.expression,elScope=element.scope();scope.chartData&&(-1!==scope.binddataset.indexOf("bind:Variables.")?(variableName=scope.binddataset.replace("bind:Variables.",""),variableName=variableName.substr(0,variableName.indexOf("."))):variableName=scope.dataset.variableName,variable=elScope.Variables&&elScope.Variables[variableName],variable&&(columns=getQueryColumns(scope),query=QueryBuilder.getQuery({tableName:variable.type,columns:columns,filterFields:scope.filterFields||variable.filterFields,groupby:groupbyExpression,orderby:orderbyexpression}),QueryBuilder.executeQuery({databaseName:variable.liveSource,query:query,page:1,size:500,nativeSql:!1},function(response){var chartData=[],aggregationAlias=getValidAliasName(scope.aggregationcolumn),visualGroupingColumnAlias=groupingDetails.visualGroupingColumn?getValidAliasName(groupingDetails.visualGroupingColumn):"",xAxisAliasKey=getValidAliasName(scope.xaxisdatakey),yAxisAliasKeys=[];yAxisKeys.forEach(function(yAxisKey){yAxisAliasKeys.push(getValidAliasName(yAxisKey))}),WM.forEach(response.content,function(data){var obj={};"none"!==scope.aggregation&&(obj[scope.aggregationcolumn]=data[aggregationAlias]),visualGroupingColumnAlias&&(obj[groupingDetails.visualGroupingColumn]=data[visualGroupingColumnAlias]),obj[scope.xaxisdatakey]=data[xAxisAliasKey],yAxisKeys.forEach(function(yAxisKey){yAxisAliasKeys.push(getValidAliasName(yAxisKey))}),yAxisKeys.forEach(function(yAxisKey,index){obj[yAxisKey]=data[yAxisAliasKeys[index]]}),chartData.push(obj)}),scope.chartData=groupingDetails.isVisuallyGrouped?getGroupedData(scope,chartData,groupingDetails.visualGroupingColumn):chartData,Utils.triggerFn(callback)})))}function setTextStyle(properties,id){var charttext=d3.select("#wmChart"+id+" svg").selectAll("text");charttext.style(properties)}function modifyLegendPosition(scope){var legendWrapHeight,legendWrapTransform,coordinates,y,chartId="wmChart"+scope.$id,legendWrap=d3.select("#"+chartId+" .nv-legendWrap"),getChartHeight=function(){var chartHeight=$("#"+chartId+" svg>.nvd3.nv-wrap")[0].getBoundingClientRect().height;return 0===chartHeight&&(chartHeight=$("#"+chartId+" svg")[0].getBoundingClientRect().height-(legendWrapHeight+15)),chartHeight},getAxisLabelHeight=function(axis){var axisLabel=d3.select("#"+chartId+" .nv-"+axis+".nv-axis .nv-axislabel")[0][0];return axisLabel?axisLabel.getBoundingClientRect().height:0};if(legendWrap[0][0]){switch(legendWrapHeight=legendWrap[0][0].getBoundingClientRect().height,legendWrapTransform=legendWrap&&legendWrap.attr("transform")?legendWrap.attr("transform").replace(/, /g,","):"",coordinates=/translate\(\s*([^\s,)]+)[ ,]([^\s,)]+)/.exec(legendWrapTransform),scope.legendposition){case"Top":y=-(legendWrapHeight+15);break;case"Bottom":scope.offsetbottom>legendWrapHeight&&(y=getChartHeight()-(legendWrapHeight+15),"Bar"!==scope.type?y-=getAxisLabelHeight("x"):"Bar"===scope.type&&(y-=getAxisLabelHeight("y")));break;default:y=+coordinates[2]}legendWrap.attr("transform","translate("+coordinates[1]+", "+y+")")}}function angle(d){var a=90*(d.startAngle+d.endAngle)/Math.PI-90;return a>90?a-180:a}function setLabelsMaxWidth(scope){var xTicks,tickWidth,maxLength,xDist,yDist,totalHeight,maxNoLabels,nthElement,labelsAvailableWidth,barWrapper,yAxisWrapper,svgWrapper,fontsize=parseInt(scope.fontsize,10)||12,isBarchart=isBarChart(scope.type);xTicks=WM.element("#wmChart"+scope.$id+" svg").find("g.nv-x").find("g.tick").find("text"),xTicks.each(function(){var xTransform,tickDist,xTick=WM.element(this);return xTick.text()&&"1"===xTick.css("opacity")?(xTransform=xTick.parent().attr("transform").split(","),xDist=parseFloat(xTransform[0].substr(10)),yDist=parseFloat(xTransform[1]||"0"),!isBarchart&&xDist>0?tickDist=xDist:yDist>0&&(tickDist=yDist),tickWidth?(tickWidth=tickDist-tickWidth,!1):(tickWidth=tickDist,!0)):void 0}),isBarchart?(barWrapper=WM.element("#wmChart"+scope.$id+" svg>g.nv-wrap>g>g.nv-barsWrap")[0],yAxisWrapper=WM.element("#wmChart"+scope.$id+" svg>g.nv-wrap>g>g.nv-y")[0],svgWrapper=WM.element("#wmChart"+scope.$id+" svg")[0],totalHeight=barWrapper?barWrapper.getBoundingClientRect().height:0,labelsAvailableWidth=yAxisWrapper?svgWrapper.getBoundingClientRect().width-yAxisWrapper.getBoundingClientRect().width:svgWrapper.getBoundingClientRect().width,maxLength=Math.round(labelsAvailableWidth/fontsize),fontsize>tickWidth&&(maxNoLabels=totalHeight/fontsize,nthElement=Math.ceil(scope.chartData.length/maxNoLabels),d3.select("#wmChart"+scope.$id+" svg").select("g.nv-x").selectAll("g.tick").select("text").each(function(text,i){i%nthElement!==0&&d3.select(this).attr("opacity",0)}))):maxLength=Math.round(tickWidth/fontsize),xTicks.each(function(){this.textContent.length>maxLength&&(this.textContent=this.textContent.substr(0,maxLength)+"...")})}function getDefaultColumns(scope){var type,stringColumn,i,temp,defaultColumns=[],columns=scope.isLiveVariable?scope.dataset.propertiesMap.columns:[];for(i=0;i<columns.length&&defaultColumns.length<=2;i+=1)type=columns[i].type,!columns[i].isRelated&&isNumberType(type)?defaultColumns.push(columns[i].fieldName):"string"!==type||stringColumn||(stringColumn=columns[i].fieldName);return stringColumn&&defaultColumns.length>0&&!isBubbleChart(scope.type)&&(temp=defaultColumns[0],defaultColumns[0]=stringColumn,defaultColumns[1]=temp),defaultColumns}function getFormatOptions(numberformat,digits){var formater,nodigits=WM.isDefined(digits)?digits.toString():"";switch(numberformat){case"Display Digits":formater=nodigits+"f";break;case"Decimal Digits":formater="."+nodigits+"f";break;case"Precision":formater="."+nodigits+"g";break;case"Exponential":formater="."+nodigits+"e";break;case"Percentage":formater="."+nodigits+"%";break;case"Round":formater=","+nodigits+"r";break;case"Round Percentage":formater="."+nodigits+"p"}return formater}function initChart(scope){var chart,theme;switch(scope.type){case"Column":chart=nv.models.multiBarChart().x(function(d){return d.x}).y(function(d){return d.y}).staggerLabels(scope.staggerlabels).reduceXTicks(scope.reducexticks).rotateLabels(0).showControls(scope.showcontrols).groupSpacing(scope.barspacing);break;case"Cumulative Line":chart=nv.models.cumulativeLineChart().x(function(d){return d[0]}).y(function(d){return d[1]/100}).useInteractiveGuideline(!0).showControls(scope.showcontrols);break;case"Line":chart=nv.models.lineChart().useInteractiveGuideline(!0);break;case"Area":chart=nv.models.stackedAreaChart().x(function(d){return d[0]}).y(function(d){return d[1]}).clipEdge(!0).showControls(scope.showcontrols).useInteractiveGuideline(!0);break;case"Bar":chart=nv.models.multiBarHorizontalChart().x(function(d){return d.x}).y(function(d){return d.y}).showControls(scope.showcontrols).showValues(scope.showvalues).groupSpacing(scope.barspacing);break;case"Pie":case"Donut":chart=nv.models.pieChart().x(function(d){return d.x}).y(function(d){return d.y}).showLabels(scope.showlabels).labelType(scope.labeltype).valueFormat(d3.format("%")).title(scope.title).labelThreshold(.04).labelsOutside(scope.showlabelsoutside),isDonutChart(scope.type)&&chart.donut(!0).donutRatio(scope.donutratio);break;case"Bubble":chart=nv.models.scatterChart().x(function(d){return d.x}).y(function(d){return d.y}).showDistX(scope.showxdistance).showDistY(scope.showydistance)}return chart.legend.vers(scope.legendtype&&scope.legendtype.toLowerCase()||"furious"),-1===chartTypes.indexOf(scope.type)&&(chart=nv.models.multiBarChart().x(function(d){return d.x}).y(function(d){return d.y})),isPieType(scope.type)?theme=scope.theme||"Azure":(theme=scope.theme||"Terrestrial",chart.showXAxis(scope.showxaxis).showYAxis(scope.showyaxis)),CONSTANTS.isStudioMode&&(scope.theme=theme,scope.$root.$emit("set-markup-attr",scope.widgetid,{theme:theme})),chart.showLegend(scope.showlegend).margin({top:scope.offsettop,right:scope.offsetright,bottom:scope.offsetbottom,left:scope.offsetleft}).color(scope.customcolors||themes[theme].colors),chart.tooltip.enabled(scope.tooltips),chart.noData(scope.message),chart}function highlightPoints(id,highlightpoints){var chartSvg=d3.select("#wmChart"+id+" svg");highlightpoints?chartSvg.selectAll(".nv-point").style({"stroke-width":"6px","fill-opacity":".95","stroke-opacity":".95"}):chartSvg.selectAll(".nv-point").style({"stroke-width":"0px","fill-opacity":"0"})}function setLineThickness(id,thickness){var chartSvg=d3.select("#wmChart"+id+" svg");thickness&&chartSvg.selectAll(".nv-line").style({"stroke-width":thickness})}function postPlotProcess(scope,element,chart){var chartSvg,pieLabels,pieGroups,angleArray,styleObj={};isLineTypeChart(scope.type)&&(setLineThickness(scope.$id,scope.linethickness),highlightPoints(scope.$id,scope.highlightpoints)),isPieType(scope.type)?scope.showlabelsoutside||(chartSvg=d3.select("#wmChart"+scope.$id+" svg"),pieLabels=chartSvg.select(".nv-pieLabels").selectAll(".nv-label"),pieGroups=chartSvg.select(".nv-pie").selectAll(".nv-slice"),angleArray=[],pieGroups&&pieGroups.length&&(pieGroups.each(function(){d3.select(this).attr("transform",function(d){angleArray.push(angle(d))})}),pieLabels.each(function(d,i){var group=d3.select(this);WM.element(group[0][0]).find("text").attr("transform","rotate("+angleArray[i]+")")}))):setLabelsMaxWidth(scope),WM.forEach(styleProps,function(value,key){"fontsize"===key||"fontunit"===key?styleObj[value]=scope.fontsize+scope.fontunit:styleObj[value]=scope[key]}),setTextStyle(styleObj,scope.$id),scope.showlegend&&modifyLegendPosition(scope),CONSTANTS.isRunMode&&nv.utils.windowResize(function(){if(element[0].getBoundingClientRect().height)chart.update(),isPieType(scope.type)||setLabelsMaxWidth(scope);else{var parent=element.closest(".app-accordion-panel, .tab-pane").isolateScope();parent&&(parent.initialized=!1)}})}function configureChart(scope,element,datum){var chartData=datum;if(!isPieType(scope.type)||scope.binddataset&&scope.scopedataset||(chartData=WM.copy(scope.scopedataset||datum)),element[0].getBoundingClientRect().height){var chart,xFormat,yFormat,xaxislabel,yaxislabel,xnumberformat=scope.xnumberformat,ynumberformat=scope.ynumberformat;return scope.xnumberformat&&scope.xdigits&&(xFormat=getFormatOptions(scope.xnumberformat,scope.xdigits)),scope.ynumberformat&&scope.ydigits?yFormat=getFormatOptions(scope.ynumberformat,scope.ydigits):"Cumulative Line"===scope.type&&(yFormat=getFormatOptions("Percentage","2")),element.find("svg").empty(),chart=initChart(scope),isPieType(scope.type)?"percent"===scope.labeltype?chart.valueFormat(d3.format("%")):chart.valueFormat(function(d){return formatData(scope,d,scope.yAxisDataType,{dateFormat:scope.ydateformat,numberFormat:ynumberformat,format:yFormat,isXaxis:!1,xDataKeyArr:scope.xDataKeyArr})}):(xaxislabel=scope.xaxislabel||scope.xaxisdatakey||"x caption",yaxislabel=scope.yaxislabel||scope.yaxisdatakey||"y caption",xaxislabel+=scope.xunits?"("+scope.xunits+")":"",yaxislabel+=scope.yunits?"("+scope.yunits+")":"",scope.captions&&(chart.xAxis.axisLabel(xaxislabel),chart.yAxis.axisLabel(yaxislabel)),chart.xAxis.axisLabelDistance(scope.xaxislabeldistance).tickFormat(function(d){return formatData(scope,d,scope.xAxisDataType,{dateFormat:scope.xdateformat,numberFormat:xnumberformat,format:xFormat,isXaxis:!0,xDataKeyArr:scope.xDataKeyArr})}),chart.yAxis.axisLabelDistance(scope.yaxislabeldistance).tickFormat(function(d){return formatData(scope,d,scope.yAxisDataType,{dateFormat:scope.ydateformat,numberFormat:ynumberformat,format:yFormat,isXaxis:!1,xDataKeyArr:scope.xDataKeyArr})})),isPieType(scope.type)&&chart.tooltip.contentGenerator(function(key){var yValue;return"percent"===scope.labeltype?yValue=d3.format(".3s")(key.data.y):"value"===scope.labeltype&&(yValue=formatData(scope,key.data.y,scope.yAxisDataType,{dateFormat:scope.ydateformat,numberFormat:ynumberformat,format:yFormat,isXaxis:!1,xDataKeyArr:scope.xDataKeyArr})),"<div class='nvtooltip xy-tooltip nv-pointer-events-none'><table><tbody><tr><td class='legend-color-guide'><div style='background-color:"+key.color+";'></div></td><td class='key'>"+key.data.x+"</td><td class='value'>"+yValue+"</td></tr></tbody></table></div>"}),d3.select("#wmChart"+scope.$id+" svg").datum(chartData).call(chart),postPlotProcess(scope,element,chart),chart}}function plotChart(scope,element){var datum;(isValidAxis(scope)||CONSTANTS.isRunMode&&isAggregationEnabled(scope))&&(scope.chartData=scope.onTransform&&scope.onTransform({$scope:scope})||scope.chartData,datum=scope.isVisuallyGrouped&&!isPieType(scope.type)?scope.chartData:getChartData(scope),scope.variableInflight===!1&&datum&&0===datum.length&&(scope.message=scope.nodatamessage||"No data found"),nv.addGraph(function(){configureChart(scope,element,datum)}))}function plotChartProxy(scope,element){scope.binddataset&&scope.isLiveVariable&&(scope.filterFields||isAggregationEnabled(scope))?getAggregatedData(scope,element,function(){plotChart(scope,element)}):(scope.dataset&&scope.dataset.data&&scope.isLiveVariable&&(scope.chartData=scope.dataset.data),plotChart(scope,element))}function setDefaultAxisOptions(scope){var defaultColumns=getDefaultColumns(scope);scope.xaxisdatakey=defaultColumns[0]||null,scope.yaxisdatakey=defaultColumns[1]||null,scope.$root.$emit("set-markup-attr",scope.widgetid,{xaxisdatakey:scope.xaxisdatakey,yaxisdatakey:scope.yaxisdatakey})}function setNumericandNonPrimaryColumns(scope){var columns,type;scope.numericColumns=[],scope.nonPrimaryColumns=[],scope.dataset&&scope.dataset.propertiesMap&&(columns=Utils.fetchPropertiesMapColumns(scope.dataset.propertiesMap)),columns&&(WM.forEach(Object.keys(columns),function(key){type=columns[key].type,isNumberType(type)&&scope.numericColumns.push(key),columns[key].isPrimaryKey||scope.nonPrimaryColumns.push(key)}),scope.numericColumns=scope.numericColumns.sort(),scope.nonPrimaryColumns=scope.nonPrimaryColumns.sort())}function setAggregationColumns(scope){scope.axisoptions&&(scope.widgetProps.aggregationcolumn.options="count"===scope.aggregation?scope.axisoptions:scope.numericColumns)}function setGroupByColumns(scope){var index,columns=WM.copy(scope.nonPrimaryColumns),choosenColumn=scope.widgetProps.groupby&&scope.widgetProps.groupby.selectedvalues?scope.widgetProps.groupby.selectedvalues.split(",")[0]:"";scope.nonPrimaryColumns&&scope.aggregationcolumn&&(index=scope.nonPrimaryColumns.indexOf(scope.aggregationcolumn),index>=0&&columns.splice(index,1)),isPieType(scope.type)?(scope.widgetProps.groupby.widget="list",columns&&columns.length>0&&-1===columns.indexOf("none")&&columns.push("none"),scope.widgetProps.groupby.options=columns,$rootScope.$emit("update-widget-property","groupby",choosenColumn)):(scope.widgetProps.groupby.widget="multiselect",scope.widgetDataset.groupby=columns?columns.join(","):"")}function propertyChangeHandler(scope,element,key,newVal,oldVal){var variableName,variableObj,elScope,styleObj={};switch(key){case"dataset":elScope=element.scope(),scope.binddataset&&-1!==scope.binddataset.indexOf("bind:Variables.")?(variableName=scope.binddataset.replace("bind:Variables.",""),variableName=variableName.substr(0,variableName.indexOf("."))):variableName=scope.dataset.variableName,newVal||scope.binddataset||(scope.isVisuallyGrouped=!1),variableObj=elScope.Variables&&elScope.Variables[variableName],scope.isLiveVariable=variableObj&&"wm.LiveVariable"===variableObj.category,scope.axisoptions=WidgetUtilService.extractDataSetFields(scope.dataset,scope.dataset.propertiesMap,!0),scope.isLiveVariable&&CONSTANTS.isStudioMode&&(setNumericandNonPrimaryColumns(scope),setAggregationColumns(scope),setGroupByColumns(scope)),scope.isServiceVariable=variableObj&&"wm.ServiceVariable"===variableObj.category,scope.chartData=scope.isLiveVariable?newVal&&(newVal.data||""):newVal,!WM.isArray(scope.chartData)&&WM.isObject(scope.chartData)&&(scope.chartData=[scope.chartData]),CONSTANTS.isStudioMode&&(scope.newcolumns&&(setDefaultAxisOptions(scope),scope.newcolumns=!1),hideOrShowProperties(advanceDataProps,scope,scope.isLiveVariable),modifyAxesOptions(scope)),newVal.filterFields&&(scope.filterFields=newVal.filterFields),scope.chartData.length&&!scope.variableInflight&&plotChartProxy(scope,element);break;case"xaxisdatakey":scope.chartReady&&(CONSTANTS.isStudioMode&&displayFormatOptions(scope,"x"),plotChartProxy(scope,element));break;case"yaxisdatakey":scope.chartReady&&(CONSTANTS.isStudioMode&&displayFormatOptions(scope,"y"),plotChartProxy(scope,element));break;case"type":setGroupByColumns(scope),isPieType(newVal)?(scope.offsettop=0,scope.offsetright=0,scope.offsetbottom=0,scope.offsetleft=0):isPieType(oldVal)&&(scope.offsettop=25,scope.offsetright=25,scope.offsetbottom=55,scope.offsetleft=75),CONSTANTS.isStudioMode&&togglePropertiesByChartType(scope),scope.chartReady&&plotChartProxy(scope,element);break;case"showlegend":scope.widgetProps.legendposition.disabled=!newVal,scope.widgetProps.legendtype.disabled=!newVal,scope.chartReady&&plotChartProxy(scope,element);break;case"height":case"width":case"show":case"xaxislabel":case"yaxislabel":case"xunits":case"yunits":case"xnumberformat":case"xdigits":case"xdateformat":case"ynumberformat":case"ydigits":case"ydateformat":case"showvalues":case"showlabels":case"showcontrols":case"staggerlabels":case"reducexticks":case"offsettop":case"offsetbottom":case"offsetright":case"offsetleft":case"barspacing":case"xaxislabeldistance":case"yaxislabeldistance":case"theme":case"labeltype":case"donutratio":case"showlabelsoutside":case"showxdistance":case"showydistance":case"bubblesize":case"shape":case"orderby":case"nodatamessage":case"captions":case"showxaxis":case"showyaxis":case"title":case"customcolors":case"legendtype":scope.chartReady&&plotChartProxy(scope,element);break;case"aggregation":CONSTANTS.isStudioMode&&(toggleAggregationColumnState(scope),modifyAxesOptions(scope),"none"!==scope.aggregation&&setAggregationColumns(scope)),"none"!==scope.aggregation&&scope.aggregationcolumn&&scope.groupby&&plotChartProxy(scope,element);break;case"aggregationcolumn":scope.chartReady&&(CONSTANTS.isStudioMode&&(modifyAxesOptions(scope),setGroupByColumns(scope)),"none"!==scope.aggregation&&scope.groupby&&plotChartProxy(scope,element));break;case"groupby":scope.chartReady&&(CONSTANTS.isStudioMode&&(toggleAggregationState(scope),scope.widgetProps.groupby.selectedvalues=newVal,modifyAxesOptions(scope)),plotChartProxy(scope,element));break;case"fontsize":case"fontunit":case"color":case"fontfamily":case"fontweight":case"fontstyle":case"textdecoration":scope.chartReady&&(styleObj[styleProps[key]]="fontsize"===key||"fontunit"===key?scope.fontsize+scope.fontunit:newVal,setTextStyle(styleObj,scope.$id));break;case"legendposition":scope.chartReady&&scope.showlegend&&modifyLegendPosition(scope);break;case"linethickness":scope.chartReady&&setLineThickness(scope.$id,scope.linethickness);break;case"highlightpoints":scope.chartReady&&highlightPoints(scope.$id,scope.highlightpoints)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.chart",["wm.base"]),themes={Terrestrial:{colors:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],tooltip:{backgroundColor:"#de7d28",textColor:"#FFFFFF"}},Annabelle:{colors:["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],tooltip:{backgroundColor:"#2e306f",textColor:"#FFFFFF"}},Azure:{colors:["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"],tooltip:{backgroundColor:"#3182bd",textColor:"#FFFFFF"}},Retro:{colors:["#0ca7a1","#ffa615","#334957","#acc5c2","#988f90","#8accc9","#515151","#f27861","#36c9fd","#794668","#0f709d","#0d2738","#44be78","#4a1839","#6a393f","#557d8b","#6c331c","#1c1c1c","#861500","#09562a"],tooltip:{backgroundColor:"#80513a",textColor:"#FFFFFF"}},Mellow:{colors:["#f0dcbf","#88c877","#aeb918","#2e2c23","#ddddd2","#dfe956","#4c963b","#5d3801","#e1eec3","#cd8472","#fcfab3","#9a4635","#9295ad","#2e3f12","#565677","#557d8b","#4f4d02","#0c0c1b","#833324","#24120e"],tooltip:{backgroundColor:"#7c9e73",textColor:"#FFFFFF"}},Orient:{colors:["#a80000","#cc6c3c","#f0e400","#000084","#fccc6c","#009c6c","#cc309c","#78cc00","#fc84e4","#48e4fc","#4878d8","#186c0c","#606060","#a8a8a8","#000000","#d7d7d7","#75a06e","#190d0b","#888888","#694b84"],tooltip:{backgroundColor:"#c14242",textColor:"#FFFFFF"}},GrayScale:{colors:["#141414","#353535","#5b5b5b","#848484","#a8a8a8","#c3c3c3","#e0e0e0","#c8c8c8","#a5a5a5","#878787","#656565","#4e4e4e","#303030","#1c1c1c","#4f4f4f","#3b3b3b","#757575","#606060","#868686","#c1c1c1"],tooltip:{backgroundColor:"#575757",textColor:"#FFFFFF"}},Flyer:{colors:["#3f454c","#5a646e","#848778","#cededf","#74c4dd","#0946ed","#380bb1","#000ff0","#f54a23","#1db262","#bca3aa","#ffa500","#a86b32","#63a18c","#56795e","#934343","#b75f5f","#752d2d","#4e1111","#920606"],tooltip:{backgroundColor:"#47637c",textColor:"#FFFFFF"}},Luminosity:{colors:["#FFFFFF","#e4e4e4","#00bcd4","#f0dd2f","#00aabf","#018376","#e91e63","#39e5d4","#ff6d6d","#00ff76","#ff9800","#969696","#ff4200","#e00000","#95cbe5","#5331ff","#fff4a7","#e7a800","#0061e4","#d5e7ff"],tooltip:{backgroundColor:"#47637c",textColor:"#FFFFFF"}}},options={Column:["showcontrols","staggerlabels","reducexticks","barspacing","xaxislabel","yaxislabel","xunits","yunits","yaxislabeldistance","captions","showxaxis","showyaxis"],Line:["xaxislabel","yaxislabel","xunits","yunits","yaxislabeldistance","captions","showxaxis","showyaxis","highlightpoints","linethickness"],Area:["showcontrols","xaxislabel","yaxislabel","xunits","yunits","yaxislabeldistance","captions","showxaxis","showyaxis","highlightpoints"],"Cumulative Line":["showcontrols","xaxislabel","yaxislabel","xunits","yunits","yaxislabeldistance","captions","showxaxis","showyaxis","highlightpoints","linethickness"],Bar:["barspacing","showvalues","showcontrols","xaxislabel","yaxislabel","xunits","yunits","xaxislabeldistance","captions","showxaxis","showyaxis"],Pie:["showlabels","labeltype","showlabelsoutside"],Donut:["showlabels","labeltype","donutratio","showlabelsoutside","title"],Bubble:["showxdistance","showydistance","bubblesize","shape"]},allOptions=["showvalues","showlabels","showcontrols","useinteractiveguideline","staggerlabels","reducexticks","barspacing","labeltype","donutratio","showlabelsoutside","xaxislabel","yaxislabel","xunits","yunits","xaxislabeldistance","yaxislabeldistance","showxdistance","showydistance","bubblesize","shape","captions","showxaxis","showyaxis","title","highlightpoints","linethickness"],advanceDataProps=["aggregation","aggregationcolumn","groupby","orderby"],chartTypes=["Column","Line","Area","Cumulative Line","Bar","Pie","Donut","Bubble"],styleProps={fontunit:"font-size",fontsize:"font-size",color:"fill",fontfamily:"font-family",fontweight:"font-weight",fontstyle:"font-style",textdecoration:"text-decoration"},tickformats={"Round to Thousand":{prefix:"K",divider:1e3},"Round to Million":{prefix:"M",divider:1e6},"Round to Billion":{prefix:"B",divider:1e9}},dataTypeJSON=["Column","Line","Pie","Bar","Donut","Bubble"],dataTypeArray=["Cumulative Line","Area"],lineTypeCharts=["Line","Area","Cumulative Line"],allShapes=["circle","square","diamond","cross","triangle-up","triangle-down"],sampleData={},notifyFor={dataset:!0,xaxisdatakey:!0,yaxisdatakey:!0,type:!0,height:!0,width:!0,show:!0,xaxislabel:!0,yaxislabel:!0,xunits:!0,yunits:!0,xnumberformat:!0,xdigits:!0,xdateformat:!0,ynumberformat:!0,ydigits:!0,ydateformat:!0,showlegend:!0,showvalues:!0,showlabels:!0,showcontrols:!0,staggerlabels:!0,reducexticks:!0,offsettop:!0,offsetbottom:!0,offsetright:!0,offsetleft:!0,barspacing:!0,xaxislabeldistance:!0,yaxislabeldistance:!0,theme:!0,labeltype:!0,donutratio:!0,showlabelsoutside:!0,aggregation:!0,aggregationcolumn:!0,groupby:!0,orderby:!0,fontsize:!0,fontunit:!0,color:!0,fontfamily:!0,fontweight:!0,fontstyle:!0,textdecoration:!0,legendposition:!0,shape:!0,nodatamessage:!0,captions:!0,showxaxis:!0,showyaxis:!0,title:!0,customcolors:!0,legendtype:!0,highlightpoints:!0,linethickness:!0};return{restrict:"E",replace:!0,scope:{scopedataset:"=?",onTransform:"&"},template:$templateCache.get("template/widget/form/chart.html"),compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){var boundVariableName,handlers=[];scope.chartReady=!1,element.attr("id","wmChart"+scope.$id),scope.widgetDataset={},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs),scope.chartReady=!0,scope.binddataset||attrs.scopedataset||plotChartProxy(scope,element),CONSTANTS.isRunMode?attrs.scopedataset&&scope.$watch("scopedataset",function(newVal){scope.chartData=newVal||scope.chartData,plotChartProxy(scope,element)}):scope.$on("$destroy",scope.$root.$on("canvas-resize",function(){plotChartProxy(scope,element)})),scope.binddataset&&-1!==scope.binddataset.indexOf("bind:Variables.")&&(boundVariableName=scope.binddataset.replace("bind:Variables.",""),boundVariableName=boundVariableName.split(".")[0],handlers.push($rootScope.$on("toggle-variable-state",function(event,variableName,active){boundVariableName===variableName&&(scope.variableInflight=active,scope.message=active?"Loading Data...":"")}))),scope.redraw=plotChartProxy.bind(void 0,scope,element)}}}}}),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/datanavigator.html",'<nav data-identifier="datanavigator" class="app-datanavigator clearfix" data-ng-show="show" init-widget apply-styles><ul class="pagination pagination-sm" data-ng-if="navcontrols === \'Advanced\'"><li data-ng-class="{\'disabled\':isDisableFirst}"><a name="first" href="javascript:void(0);" aria-label="First" data-ng-click="navigatePage(\'first\', $event)"><i class="glyphicon glyphicon-fast-backward"></i></a></li><li data-ng-class="{\'disabled\':isDisablePrevious}"><a name="prev" href="javascript:void(0);" aria-label="Previous" data-ng-click="navigatePage(\'prev\', $event)"><i class="glyphicon glyphicon-step-backward"></i></a></li><li class="pagecount disabled"><span class="input-group input-group-sm"><input type="number" data-ng-disabled="isDisableCurrent" data-ng-model="currentPage" data-ng-keydown="navigatePage(\'index\', $event)" class="form-control" /><span class="input-group-addon" data-ng-hide="isDisableCount"> of {{pageCount}}</span></span></li><li data-ng-class="{\'disabled\':isDisableNext}"><a name="next" href="javascript:void(0);" aria-label="Next" data-ng-click="navigatePage(\'next\', $event)"><i class="glyphicon glyphicon-step-forward"></i></a></li><li data-ng-class="{\'disabled\':isDisableLast}"><a name="last" href="javascript:void(0);" aria-label="Last" data-ng-click="navigatePage(\'last\', $event)"><i class="glyphicon glyphicon-fast-forward"></i></a></li><li data-ng-if="showrecordcount" class="totalcount disabled"><span>Total Records: {{dataSize}}</span></li></ul><ul class="pager" data-ng-if="navcontrols === \'Basic\'"><li class="previous" data-ng-class="{\'disabled\':isDisablePrevious}"><a href="javascript:void(0);" data-ng-click="navigatePage(\'prev\', $event)"><span aria-hidden="true">&larr;</span> Previous</a></li><li class="next" data-ng-class="{\'disabled\':isDisableNext}"><a href="javascript:void(0);" data-ng-click="navigatePage(\'next\', $event)">Next <span aria-hidden="true">&rarr;</span></a></li></ul></nav>')}]).directive("wmDatanavigator",["PropertiesFactory","$templateCache","WidgetUtilService","Utils","Variables","$rootScope","wmToaster","CONSTANTS",function(PropertiesFactory,$templateCache,WidgetUtilService,Utils,Variables,$rootScope,wmToaster,CONSTANTS){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"dataset":if(CONSTANTS.isStudioMode&&!newVal)return;scope.setPagingValues(newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.datanavigator",["wm.base","wm.base.editors"]),notifyFor={dataset:!0};return{restrict:"E",scope:{onEnterKeyPress:"&",onSetrecord:"&"},replace:!0,controller:function($scope){$scope.pageCount=0,$scope.resetPageNavigation=function(){$scope.pageCount=0,$scope.currentPage=1,$scope.dataSize=0},$scope.calculatePagingValues=function(pageCount){$scope.pageCount=WM.isDefined(pageCount)?pageCount:$scope.dataSize>$scope.maxResults?Math.ceil($scope.dataSize/$scope.maxResults):$scope.dataSize<0?0:1,$scope.currentPage=$scope.currentPage||1},$scope.isPagingValuesComputed=function(){return WM.isDefined($scope.maxResults)&&WM.isDefined($scope.dataSize)&&WM.isDefined($scope.currentPage)&&WM.isDefined($scope.pageCount)},$scope.setDefaultPagingValues=function(dataSize,maxResults,currentPage,pageCount){dataSize||maxResults?($scope.maxResults=maxResults||$scope.maxResults,$scope.dataSize=WM.isDefined(dataSize)?dataSize:$scope.dataSize,$scope.currentPage=currentPage||$scope.currentPage,$scope.calculatePagingValues(pageCount)):($scope.pageCount=1,$scope.currentPage=1,$scope.maxResults=dataSize,$scope.dataSize=dataSize)},$scope.checkDataSize=function(dataSize){-1===dataSize?($scope.prevshowrecordcount=$scope.showrecordcount,$scope.isDisableLast=!0,$scope.isDisableCount=!0,$scope.showrecordcount=!1):($scope.isDisableCount=!1,$scope.showrecordcount=$scope.prevshowrecordcount||$scope.showrecordcount)},$scope.disableNavigation=function(){var isCurrentPageFirst=1===$scope.currentPage,isCurrentPageLast=$scope.currentPage===$scope.pageCount;$scope.isDisableFirst=$scope.isDisablePrevious=isCurrentPageFirst,$scope.isDisableNext=$scope.isDisableLast=isCurrentPageLast,$scope.isDisableCurrent=isCurrentPageFirst&&isCurrentPageLast},$scope.isVariableHasPaging=function(){var dataSet=$scope.dataset;return WM.isObject(dataSet)&&(dataSet.pagingOptions||Utils.isPageable(dataSet))},$scope.setPagingValues=function(newVal){var dataSize,maxResults,currentPage,pageCount,startIndex,data;$scope.result=newVal,$scope.isBoundToFilter=void 0,$scope.binddataset&&(-1!==$scope.binddataset.indexOf("bind:Variables.")?($scope.variableName=$scope.binddataset.replace("bind:Variables.",""),$scope.variableName=$scope.variableName.substr(0,$scope.variableName.indexOf("."))):newVal.isBoundToFilter&&newVal.widgetName?($scope.isBoundToFilter=!0,$scope.widgetName=newVal.widgetName):$scope.variableName=newVal.variableName,newVal?($scope.isVariableHasPaging()?($scope.filterFields=newVal.filterFields||{},$scope.sortOptions=newVal.sortOptions||"",WM.isObject(newVal)&&Utils.isPageable(newVal)&&(dataSize=newVal.totalElements,
$scope.checkDataSize(dataSize),maxResults=newVal.size,currentPage=newVal.numberOfElements>0?$scope.currentPage||1:1,$scope.setDefaultPagingValues(dataSize,maxResults,currentPage,pageCount),$scope.disableNavigation()),(!$scope.isPagingValuesComputed()||newVal.pagingOptions)&&(dataSize=newVal.pagingOptions.dataSize,maxResults=newVal.pagingOptions.maxResults,currentPage=newVal.pagingOptions.currentPage,$scope.setDefaultPagingValues(dataSize,maxResults,currentPage),$scope.disableNavigation(),$scope.checkDataSize(dataSize))):WM.isString(newVal)||(dataSize=WM.isArray(newVal)?newVal.length:1,maxResults=$scope.pagingOptions&&$scope.pagingOptions.maxResults||dataSize,currentPage=1,$scope.setDefaultPagingValues(dataSize,maxResults,currentPage),$scope.disableNavigation(),startIndex=($scope.currentPage-1)*$scope.maxResults,data=WM.isArray(newVal)?newVal.slice(startIndex,startIndex+$scope.maxResults):newVal,$scope.result=data),$rootScope.$safeApply($scope)):$scope.resetPageNavigation())},$scope.isFirstPage=function(){return 1===$scope.currentPage||!$scope.currentPage},$scope.isLastPage=function(){return $scope.currentPage===$scope.pageCount},$scope.goToLastPage=function(isRefresh,event,callback){$scope.isLastPage()?isRefresh&&$scope.goToPage(event,callback):($scope.currentPage=$scope.pageCount,$scope.goToPage(event,callback))},$scope.goToFirstPage=function(isRefresh,event,callback){$scope.isFirstPage()?isRefresh&&$scope.goToPage(event,callback):($scope.currentPage=1,$scope.goToPage(event,callback))},$scope.goToPage=function(event,callback){$scope.firstRow=($scope.currentPage-1)*$scope.maxResults,$scope.getPageData(event,callback)},$scope.onPageDataReady=function(event,data,callback){$scope.disableNavigation(),$scope.invokeSetRecord(event,data),Utils.triggerFn(callback)},$scope.getPageData=function(event,callback){var data,startIndex,widgetScope,widgets,variable=$scope.navigatorElement.scope().Variables[$scope.variableName];return CONSTANTS.isRunMode&&$scope.isBoundToFilter&&$scope.widgetName?(widgets=$scope.navigatorElement.scope().Widgets||{},widgetScope=widgets[$scope.widgetName],void widgetScope.applyFilter({page:$scope.currentPage})):void($scope.isVariableHasPaging()?variable&&"wm.LiveVariable"===variable.category?variable.update({page:$scope.currentPage,isNotTriggerForRelated:!0,filterFields:$scope.filterFields,orderBy:$scope.sortOptions,matchMode:"anywhere",scope:$scope.navigatorElement.scope()},function(data,propertiesMap,relatedData,pagingOptions){$scope.result={data:data,propertiesMap:propertiesMap,relatedData:relatedData,pagingOptions:pagingOptions,filterFields:$scope.filterFields,orderBy:$scope.sortOptions,variableName:$scope.variableName},$scope.dataSize=pagingOptions.dataSize,$scope.maxResults=pagingOptions.maxResults,$scope.calculatePagingValues(),$scope.onPageDataReady(event,data,callback)},function(error){wmToaster.show("error","ERROR","Unable to get data of page -"+$scope.currentPage+":"+error)}):Utils.isPageable($scope.dataset)&&variable.update({page:$scope.currentPage,isNotTriggerForRelated:!0,filterFields:$scope.filterFields,orderBy:$scope.sortOptions,matchMode:"anywhere",scope:$scope.navigatorElement.scope()},function(data){$scope.result=data,$scope.onPageDataReady(event,data,callback)},WM.noop):(startIndex=($scope.currentPage-1)*$scope.maxResults,data=WM.isArray($scope.dataset)?$scope.dataset.slice(startIndex,startIndex+$scope.maxResults):$scope.dataset,$scope.result=data,$scope.onPageDataReady(event,data,callback)))},$scope.invokeSetRecord=function(event,data){$scope.onSetrecord?$scope.onSetrecord({$event:event,$scope:this,$data:data,$index:$scope.currentPage}):$scope.$parent.onSetrecord&&$scope.$parent.onSetrecord({$event:event,$scope:this,$data:data,$index:$scope.currentPage})},$scope.validateCurrentPage=function(event,callback){return isNaN($scope.currentPage)?($scope.goToFirstPage(void 0,event,callback),!1):$scope.currentPage<0?($scope.goToFirstPage(void 0,event,callback),!1):$scope.pageCount&&$scope.currentPage>$scope.pageCount?($scope.goToLastPage(void 0,event,callback),!1):!0},$scope.navigatePage=function(index,event,isRefresh,callback){switch($scope.currentPage=parseInt($scope.currentPage,10),index){case"first":return void $scope.goToFirstPage(isRefresh,event,callback);case"prev":if($scope.isFirstPage()||!$scope.validateCurrentPage(event,callback))return;$scope.currentPage-=1;break;case"next":if($scope.isLastPage()||!$scope.validateCurrentPage(event,callback))return;$scope.currentPage+=1;break;case"last":return void $scope.goToLastPage(isRefresh,event,callback);case"index":var _action=Utils.getActionFromKey(event);if("ENTER"!==_action)return;if($scope.onEnterkeypress?$scope.onEnterkeypress():$scope.$parent.onEnterkeypress&&$scope.$parent.onEnterkeypress(),!$scope.validateCurrentPage(event,callback))return}$scope.goToPage(event,callback)}},template:$templateCache.get("template/widget/datanavigator.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps,scope.allowPageable=!0,scope.navcontrols="Advanced"},post:function(scope,element,attrs){scope.navigatorElement=element,WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.basic").service("wmToaster",["toaster",function(toaster){"use strict";var _showToaster=function(type,title,desc,timeout){(title||desc)&&(WM.element(".toast").hide(),timeout||(timeout=0,"success"===type&&(timeout=5e3)),toaster.pop(type,title,desc,timeout))};return{success:function(title,desc){_showToaster("success",title,desc,5e3)},error:function(title,desc){_showToaster("error",title,desc,0)},info:function(title,desc){_showToaster("info",title,desc,0)},warn:function(title,desc){_showToaster("warning",title,desc,0)},show:function(type,title,desc,timeout){_showToaster(type,title,desc,timeout)},hide:function(){WM.element(".toast").hide()}}}]),WM.module("wm.widgets.basic").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/progress.html",'<div class="progress app-progress" data-ng-show="show" title="{{hint}}" init-widget apply-styles><div class="progress-bar" role="progressbar" aria-valuenow={{datavalue}} aria-valuemin={{minvalue}} aria-valuemax={{maxvalue}} data-ng-hide="isMultipleBar"></div></div>')}]).directive("wmProgress",["PropertiesFactory","WidgetUtilService","$interval","Utils","CONSTANTS",function(PropertiesFactory,WidgetUtilService,$interval,Utils,CONSTANTS){"use strict";function areValuesValid(max,min){return!max||!min&&0!==min||min>=max?!1:!0}function isPercentageValue(value){return WM.isString(value)?(value=value.trim(),"%"===value.charAt(value.length-1)):void 0}function triggerCallbackFns(scope,oldDatavalue,newDatavalue,isValueAPercentage){var onStart=!1,onEnd=!1;isValueAPercentage?0>=oldDatavalue&&newDatavalue>0?onStart=!0:newDatavalue>=100&&(onEnd=!0):oldDatavalue<=scope.minvalue&&newDatavalue>scope.minvalue?onStart=!0:newDatavalue>=scope.maxvalue&&(onEnd=!0),onStart?Utils.triggerFn(scope.onStart,{$scope:scope}):onEnd&&(endPolling(scope),Utils.triggerFn(scope.onComplete,{$scope:scope}))}function updateProgressBar(scope,progressBarEl,oldDatavalue,newDatavalue){var isValueAPercentage,progressBarWidth,displayValue=0;if(!scope.isMultipleBar){if(isValueAPercentage=isPercentageValue(scope.datavalue))oldDatavalue=parseInt(oldDatavalue||0,10),newDatavalue=parseInt(newDatavalue||0,10);else if(!areValuesValid(scope.maxvalue,scope.minvalue))return void endPolling(scope);triggerCallbackFns(scope,oldDatavalue,newDatavalue,isValueAPercentage),isValueAPercentage?progressBarWidth=displayValue=scope.datavalue||"0%":WM.isDefined(scope.datavalue)?(displayValue=100*scope.datavalue/(scope.maxvalue-scope.minvalue),progressBarWidth=displayValue+"%",scope.displayformat===DISPLAY_FORMAT.PERCENTAGE&&(displayValue=progressBarWidth)):displayValue=progressBarWidth=0,progressBarEl.css("width",progressBarWidth).text(displayValue)}}function updateMultipleProgressBar(element,data){data.forEach(function(barInfo){var cls=CLASSES[barInfo.type],val=barInfo.value+"%";WM.element('<div class="multi-bar progress-bar"></div>').appendTo(element).addClass(cls).css("width",val).text(val)})}function successHandler(scope,response){scope.binddatavalue||Utils.triggerFn(scope.onBeforeupdate,{$response:response,$scope:scope})}function setupPolling(scope){$interval.cancel(scope.invokeInterval),CONSTANTS.isRunMode&&scope.binddataset&&scope.pollinterval&&(scope.invokeInterval=$interval(function(){scope.$root.$emit("invoke-service",scope.boundServiceName,{},successHandler.bind(void 0,scope))},scope.pollinterval))}function endPolling(scope){$interval.cancel(scope.invokeInterval)}function defineProperties(scope){Object.defineProperty(scope,"binddataset",{get:function(){return this._binddataset},set:function(value){if(this._binddataset!==value&&(this._binddataset=value,endPolling(scope),WM.isString(value))){var _value=value.replace("bind:Variables.","");scope.boundServiceName=_value.substr(0,_value.indexOf(".")),setupPolling(scope)}}})}function propertyChangeHandler(scope,element,progressBarEl,key,newVal,oldVal){switch(key){case"minvalue":case"maxvalue":updateProgressBar(scope,progressBarEl);break;case"datavalue":scope.isMultipleBar=!1,element.children(".multi-bar").remove(),WM.isNumber(newVal)||WM.isString(newVal)?updateProgressBar(scope,progressBarEl,oldVal,newVal):WM.isArray(newVal)&&(scope.isMultipleBar=!0,updateMultipleProgressBar(element,newVal));break;case"type":progressBarEl.removeClass(CLASSES[oldVal]).addClass(CLASSES[newVal]);break;case"pollinterval":endPolling(scope),WM.isNumber(newVal)&&setupPolling(scope)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.progress",["wm.base","wm.base.events"]),notifyFor={datavalue:!0,minvalue:!0,maxvalue:!0,type:!0,pollinterval:!0},CLASSES={"default":"","default-striped":"progress-bar-striped",success:"progress-bar-success","success-striped":"progress-bar-success progress-bar-striped",info:"progress-bar-info","info-striped":"progress-bar-info progress-bar-striped",warning:"progress-bar-warning","warning-striped":"progress-bar-warning progress-bar-striped",danger:"progress-bar-danger","danger-striped":"progress-bar-danger progress-bar-striped"},DISPLAY_FORMAT={PERCENTAGE:"percentage",ABSOLUTE:"ABSOLUTE"};return{restrict:"E",scope:{},replace:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/progress.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps,Object.defineProperty(scope,"binddataset",{configurable:!0})},post:function(scope,element,attrs){var progressBarEl=element.children().first();defineProperties(scope),attrs.dataset&&Utils.stringStartsWith(attrs.dataset,"bind:")&&(scope.binddataset=attrs.dataset),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element,progressBarEl),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),$.widget("wm.datagrid",{options:{data:[],statusMsg:"",colDefs:[],sortInfo:{field:"",direction:""},enableSort:!0,enableSearch:!1,height:100,showHeader:!1,selectFirstRow:!1,allowAddNewRow:!0,allowDeleteRow:!0,allowInlineEditing:!0,showRowIndex:!1,enableRowSelection:!0,enableColumnSelection:!0,multiselect:!1,filterNullRecords:!0,cssClassNames:{tableRow:"app-datagrid-row",headerCell:"app-datagrid-header-cell",tableCell:"app-datagrid-cell",grid:"",gridDefault:"table table-condensed",gridBody:"app-datagrid-body",deleteRow:"danger"},dataStates:{loading:"Loading...",ready:"",error:"An error occurred in loading the data.",nodata:"No data found."},startRowIndex:1,searchHandler:function(searchObj){var searchTextRegEx,searchText=searchObj.value,field=searchObj.field,hasField=field.length,$rows=this.gridElement.find("tbody tr"),self=this;return searchText?(searchTextRegEx=new RegExp(searchText,"i"),void $rows.each(function(){var $row=$(this),rowId=$row.attr("data-row-id"),text=hasField?self.preparedData[rowId][field]:$row.text();-1===text.toString().search(searchTextRegEx)?$row.hide():$row.show()})):void $rows.show()},sortHandler:function(sortInfo,e){e.stopPropagation();var sortFn=this.Utils.sortFn,sorter=sortFn(sortInfo.field,sortInfo.direction),data=$.extend(!0,[],this.options.data);this._setOption("data",data.sort(sorter)),$.isFunction(this.options.afterSort)&&this.options.afterSort()}},customColumnDefs:{checkbox:{field:"checkbox",type:"custom",displayName:"",sortable:!1,searchable:!1,resizable:!1,selectable:!1,readonly:!0,style:"text-align: center;"},radio:{field:"radio",type:"custom",displayName:"",sortable:!1,searchable:!1,resizable:!1,selectable:!1,readonly:!0,style:"text-align: center;"},rowIndex:{field:"rowIndex",type:"custom",displayName:"S. No.",sortable:!1,searchable:!1,selectable:!1,readonly:!0,style:"text-align: left;"}},Utils:{random:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},sortFn:function(key,direction){return function(a,b){var strA=a[key]||"",strB=b[key]||"",dir="asc"===direction?-1:1;return a[key]&&"string"==typeof a[key]&&(strA=a[key].toLowerCase()),b[key]&&"string"==typeof b[key]&&(strB=b[key].toLowerCase()),strA===strB?0:strB>strA?dir:-dir}},isDefined:function(value){return void 0!==value},isUndefined:function(value){return void 0===value},isObject:function(value){return null!==value&&"object"==typeof value},getObjectIndex:function(data,obj){var matchIndex=-1;return Array.isArray(data)?(data.some(function(data,index){return angular.equals(data,obj)?(matchIndex=index,!0):void 0}),matchIndex):-1},generateGuid:function(){var random=this.random;return random()+random()+"-"+random()+"-"+random()+"-"+random()+"-"+random()+random()+random()},isValidHtml:function(htm){var validHtmlRegex=/<[a-z][\s\S]*>/i;return validHtmlRegex.test(htm)}},_getColumnSortDirection:function(field){var sortInfo=this.options.sortInfo;return field===sortInfo.field?sortInfo.direction:""},_getHeaderTemplate:function(){var cols="<colgroup>",htm="<thead><tr>",isDefined=this.Utils.isDefined,isUndefined=this.Utils.isUndefined;return this.preparedHeaderData.forEach(function(value,index){var sortInfo,sortField,asc_active,desc_active,id=index,type=value.type,field=value.field,headerLabel=WM.isDefined(value.displayName)?value.displayName:field,headerClasses=this.options.cssClassNames.headerCell;cols+="<col",value.style&&(cols+=' style="'+value.style+'"'),cols+="/>","custom"===type&&isDefined(value["class"])&&(headerClasses+=" "+value["class"]),value.selected&&(headerClasses+=" info"),htm+='<th data-col-id="'+id+'" data-col-field="'+field+'" class="'+headerClasses+'" title="'+headerLabel+'" style="text-align: '+value.textAlignment+';"',(isUndefined(value.resizable)||value.resizable)&&(htm+=" data-col-resizable"),(isUndefined(value.selectable)||value.selectable)&&(htm+=" data-col-selectable"),htm+=">","checkbox"===field&&(htm+='<input type="checkbox" />'),"radio"===field&&(htm+=""),htm+='<div class="header-data">'+headerLabel+"</div>",this.options.enableSort&&(isUndefined(value.sortable)||value.sortable)&&!value.widgetType&&(htm+='<span class="sort-buttons-container">',sortInfo=this.options.sortInfo,sortField=sortInfo.field,asc_active="asc"===sortInfo.direction?" active":"",desc_active="desc"===sortInfo.direction?" active":"",sortField&&sortField===value.field?(htm+='<button class="sort-button" title="Sort Ascending"><i class="sort-icon up'+asc_active+'"></i></button>',htm+='<button type="button" class="sort-button" title="Sort Descending"><i class="sort-icon down'+desc_active+'"></i></button>'):(htm+='<button type="button" class="sort-button"><i class="sort-icon up" title="Sort Ascending"></i></button>',htm+='<button type="button" class="sort-button"><i class="sort-icon down" title="Sort Descending"></i></button>'),htm+="</span>"),htm+="</th>"},this),htm+="</tr></thead>",cols+="</colgroup>",cols+htm},_getSearchTemplate:function(){var htm,sel='<select name="wm-datagrid" data-element="dgFilterValue" class="form-control app-select input-sm"><option value="" selected>Select Column</option>',searchLabel=this.Utils.isDefined(this.options.searchLabel)&&this.options.searchLabel.length?this.options.searchLabel:"Search:";return this.options.colDefs.forEach(function(colDef,index){"none"!==colDef.field&&"rowOperations"!==colDef.field&&colDef.searchable&&(sel+='<option value="'+colDef.field+'" data-coldef-index="'+index+'">'+(colDef.displayName||colDef.field)+"</option>")}),sel+="</select>",htm='<form class="form-search form-inline" onsubmit="return false;"><div class="form-group"><label class="control-label app-label" data-element="dgSearchLabel">'+searchLabel+" </label>"+sel+'</div><div class="input-append input-group input-group-sm"><input type="text" data-element="dgSearchText" class="form-control app-textbox" value="" placeholder="Search" style="display: inline-block;"/><span class="input-group-addon"><button type="button" data-element="dgSearchButton" class="app-search-button" title="Search"><i class="glyphicon glyphicon-search"></i></button></span></div></div></form>'},_getGridTemplate:function(){var htm,self=this;return htm=this.preparedData.reduce(function(prev,current){return prev+self._getRowTemplate(current)},'<tbody class="'+this.options.cssClassNames.gridBody+'">'),htm+="</tbody>"},_getRowTemplate:function(row){var htm,self=this;return htm=this.preparedHeaderData.reduce(function(prev,current,colIndex){return prev+self._getColumnTemplate(row,colIndex,current)},'<tr class="'+this.options.cssClassNames.tableRow+'" data-row-id="'+row.pk+'">'),htm+="</tr>"},_getRowActionsColumnDefIndex:function(){var i,len=this.preparedHeaderData.length;for(i=0;len>i;i+=1)if("rowOperations"===this.preparedHeaderData[i].field)return i;return-1},_getRowActionsColumnDef:function(){var index=this._getRowActionsColumnDefIndex();return-1!==index?this.preparedHeaderData[index]:null},_getRowActionsTemplate:function(colDef){var htm="";return-1!==colDef.operations.indexOf("update")&&(htm+='<button type="button" class="row-action-button edit edit-row-button" title="Edit Row"><i class="glyphicon glyphicon-pencil"></i></button><button type="button" class="row-action-button save save-edit-row-button hidden" title="Save"><i class="glyphicon glyphicon-ok"></i></button><button type="button" class="row-action-button cancel cancel-edit-row-button hidden" title="Cancel"><i class="glyphicon glyphicon-remove"></i></button>'),-1!==colDef.operations.indexOf("delete")&&(htm+='<button type="button" class="row-action-button delete delete-row-button" title="Delete Record"><i class="glyphicon glyphicon-trash"></i></button>'),htm},_getCheckboxTemplate:function(row){var checked=row.checked?" checked":"",disabled=row.disabed?" disabled":"";return'<input type="checkbox"'+checked+disabled+"/>"},_getRadioTemplate:function(row){var checked=row.checked?" checked":"",disabled=row.disabed?" disabled":"";return'<input type="radio" name="" value=""'+checked+disabled+"/>"},_getColumnValue:function(colDef,row){var columnValue,f,k;if(colDef.field&&!(colDef.field in row)&&colDef.field.split(".").length>1){for(f=colDef.field.split("."),columnValue=row[f[0]],k=1;k<f.length;k++)if(this.Utils.isDefined(columnValue)&&f[k]in columnValue){columnValue=columnValue[f[k]];break}return columnValue}},_getColumnTemplate:function(row,colId,colDef){var value,columnValue,classes=this.options.cssClassNames.tableCell+" "+colDef["class"],ngClass=colDef.ngClass||"",htm='<td class="'+classes+'" data-col-id="'+colId+'" style="text-align: '+colDef.textAlignment+';"',colExpression=colDef.customExpression,ctId=row.pk+"-"+colId,isCellCompiled=!1;if(colDef.field&&(columnValue=row[colDef.field]),value=this._getColumnValue(colDef,row),value&&(columnValue=value),ngClass&&(htm+='data-ng-class="'+ngClass+'" data-compiled-template="'+ctId+'" ',isCellCompiled=!0),colDef.formatpattern&&"None"!==colDef.formatpattern&&!colExpression){switch(colDef.formatpattern){case"toDate":colDef.datepattern&&("datetime"===colDef.type&&(columnValue=columnValue?moment(columnValue).valueOf():void 0),colExpression="{{'"+columnValue+"' | toDate:'"+colDef.datepattern+"'}}");break;case"toCurrency":colDef.currencypattern&&(colExpression="{{'"+columnValue+"' | toCurrency:'"+colDef.currencypattern,colExpression+=colDef.fractionsize?"':'"+colDef.fractionsize+"'}}":"'}}");break;case"toNumber":colDef.fractionsize&&(colExpression="{{'"+columnValue+"' | toNumber:'"+colDef.fractionsize+"'}}");break;case"prefix":colDef.prefix&&(colExpression="{{'"+columnValue+"' | prefix:'"+colDef.prefix+"'}}");break;case"suffix":colDef.suffix&&(colExpression="{{'"+columnValue+"' | suffix:'"+colDef.suffix+"'}}")}htm+='title="'+colExpression+'"'}if(colExpression)isCellCompiled?htm+=">":(htm+='data-compiled-template="'+ctId+'">',isCellCompiled=!0),htm+=colExpression;else if("custom"!==colDef.type)columnValue=row[colDef.field],(this.options.filterNullRecords&&null===columnValue||this.Utils.isUndefined(columnValue))&&(columnValue=""),htm+='title="'+columnValue+'">',htm+=columnValue;else switch(htm+=">",colDef.field){case"checkbox":htm+=this._getCheckboxTemplate(row);break;case"radio":htm+=this._getRadioTemplate(row);break;case"rowOperations":htm+=this._getRowActionsTemplate(colDef);break;case"rowIndex":htm+=row.index;break;case"none":htm+="";break;default:htm+=this.Utils.isUndefined(columnValue)||null===columnValue?"":columnValue}return htm+="</td>",isCellCompiled&&(this.compiledCellTemplates[ctId]=this.options.getCompiledTemplate(htm,row,colDef)||""),htm},_getEditableTemplate:function(colDef){var textboxTemplate='<input class="editable form-control app-textbox" type="text" value=""/>';return this.Utils.isDefined(colDef.customExpression)?colDef.customExpression:textboxTemplate},_prepareHeaderData:function(){this.preparedHeaderData=[],$.extend(this.preparedHeaderData,this.options.colDefs),this.options.showRowIndex&&this.preparedHeaderData.unshift(this.customColumnDefs.rowIndex),this.options.multiselect&&this.preparedHeaderData.unshift(this.customColumnDefs.checkbox),!this.options.multiselect&&this.options.showRadioColumn&&this.preparedHeaderData.unshift(this.customColumnDefs.radio)},_generateCustomColDefs:function(){function generateColumnDef(key){if(!generatedColDefs[key]){var colDef={type:"string",field:key};colDefs.push(colDef),generatedColDefs[key]=!0}}var colDefs=[],generatedColDefs={},isObject=this.Utils.isObject;this.options.data.forEach(function(item){isObject(item)&&Object.keys(item).forEach(generateColumnDef)}),this.options.colDefs=colDefs,this._prepareHeaderData()},_prepareData:function(){var data=[],colDefs=this.options.colDefs,self=this,isObject=this.Utils.isObject,isDefined=this.Utils.isDefined;!this.options.colDefs.length&&this.options.data.length&&this._generateCustomColDefs(),this.options.data.forEach(function(item,i){var rowData=$.extend(!0,{},item);colDefs.forEach(function(colDef){if(colDef.field){var j,fields=colDef.field.split("."),text=item,len=fields.length;for(j=0;len>j;j++){var key=fields[j],isArray=void 0;if(-1!==key.indexOf("[0]")&&(key=key.replace("[0]",""),isArray=!0),isObject(text)&&!isArray)text=text[key];else{if(!isArray){text=void 0;break}text=text[key][0]}}isDefined(text)&&colDef.field in item?rowData[colDef.field]=text:colDef.field in item?fields.length>1&&colDef.field in item&&(rowData[colDef.field]=item[colDef.field]):rowData[colDef.field]=text}}),rowData.index=self.options.startRowIndex+i,rowData.pk=i,data.push(rowData)}),this.preparedData=data},_reselectColumns:function(){var selectedColumns=[];this.gridHeader&&(selectedColumns=this.gridHeader.find("th.info"),selectedColumns.length&&selectedColumns.trigger("click"))},_create:function(){$.extend(this,{dataStatus:{message:"",state:""},preparedData:[],preparedHeaderData:[],dataStatusContainer:null,gridContainer:null,gridElement:null,gridHeader:null,gridBody:null,gridSearch:null,tableId:null,searchObj:{field:"",value:"",event:null},compiledCellTemplates:{}}),this._prepareHeaderData(),this._prepareData(),this._render()},removeSort:function(){this.gridHeader.find(".sort-button").off("click"),this.gridHeader.find(".sort-buttons-container").remove()},_refreshGrid:function(){this._prepareHeaderData(),this._prepareData(),this._render()},refreshGrid:function(){window.clearTimeout(this.refreshGridTimeout),this.refreshGridTimeout=window.setTimeout(this._refreshGrid.bind(this),50)},refreshGridData:function(){this._prepareData(),this.gridBody.remove(),this._renderGrid(),this._reselectColumns()},addNewRow:function(){var $row,rowId=this.gridBody.find("tr:visible").length,rowData={};rowData.index=this.options.startRowIndex+rowId,rowData.pk=rowId,this.options.allowAddNewRow&&($row=$(this._getRowTemplate(rowData)),this.preparedData.length||this.setStatus("ready",this.dataStatus.ready),this.gridElement.find("tbody").append($row),this.attachEventHandlers($row),$row.find(".edit-row-button").trigger("click",{action:"edit"}),this.updateSelectAllCheckboxState())},getSelectedRows:function(){this.getSelectedColumns();var selectedRowsData=[],self=this;return this.preparedData.forEach(function(data,i){data.selected&&selectedRowsData.push(self.options.data[i])}),selectedRowsData},getSelectedColumns:function(){var multiSelectColIndex,radioColIndex,colIndex,selectedColsData={},headerData=[],self=this;return $.extend(headerData,this.preparedHeaderData),this.options.multiselect?(headerData.some(function(item,i){return"checkbox"===item.field?(multiSelectColIndex=i,!0):void 0}),headerData.splice(multiSelectColIndex,1)):this.options.showRadioColumn&&(headerData.some(function(item,i){return"radio"===item.field?(radioColIndex=i,!0):void 0}),headerData.splice(radioColIndex,1)),this.options.showRowIndex&&(headerData.some(function(item,i){return"rowIndex"===item.field?(colIndex=i,!0):void 0}),headerData.splice(colIndex,1)),headerData.forEach(function(colDef){var field=colDef.field;colDef.selected&&(selectedColsData[field]={colDef:colDef,colData:self.options.data.map(function(data){return data[field]})})}),selectedColsData},_setOption:function(key,value){switch(this._super(key,value),key){case"showHeader":this._toggleHeader();break;case"enableSearch":this._toggleSearch();break;case"searchLabel":this.gridSearch&&this.gridSearch.find('[data-element="dgSearchLabel"]').text(value);break;case"selectFirstRow":this.selectFirstRow(value);break;case"data":this.refreshGridData();break;case"enableSort":this.options.enableSort?this.refreshGrid():this.gridHeader&&this.removeSort();break;case"dataStates":"nodata"===this.dataStatus.state&&this.setStatus("nodata",this.dataStatus.nodata);break;case"multiselect":case"showRadioColumn":case"colDefs":case"filterNullRecords":case"showRowIndex":this.refreshGrid();break;case"cssClassNames":var gridClass=this.options.cssClassNames.gridDefault+" "+this.options.cssClassNames.grid;this.gridElement.attr("class",gridClass)}},getOptions:function(){return this.options},_toggleHeader:function(){this.gridElement.find("thead").length||this._renderHeader(),this.options.showHeader?this.gridHeader.show():this.gridHeader.hide()},_toggleSearch:function(){this.gridSearch||this._renderSearch(),this.options.enableSearch?this.gridSearch.removeClass("hidden"):this.gridSearch.addClass("hidden")},_isCustomExpressionNonEditable:function(customTag){var $input=$(customTag);return customTag?"checkbox"===$input.attr("type")?!1:!0:!1},selectFirstRow:function(value){var $row=this.gridElement.find("tBody tr:first"),id=$row.attr("data-row-id");$row.length&&this.preparedData.length&&(this.preparedData[id].selected=!value,$row.trigger("click"))},selectRow:function(row,value){var selector,$row,rowIndex=angular.isNumber(row)?row:this.Utils.getObjectIndex(this.options.data,row);-1!==rowIndex&&(selector="tr[data-row-id="+rowIndex+"]",$row=this.gridBody.find(selector),$row.length&&(this.preparedData[rowIndex].selected=!value),$row.trigger("click"))},toggleRowSelection:function($row,selected){if($row.length){var $checkbox,$radio,rowId=$row.attr("data-row-id");this.preparedData[rowId].selected=selected,selected?$row.addClass("active"):$row.removeClass("active"),this.options.showRadioColumn&&($radio=$row.find("td input:radio:not(:disabled)"),$radio.prop("checked",selected),this.preparedData[rowId].checked=selected),this.options.multiselect?($checkbox=$row.find("td input:checkbox:not(:disabled)"),$checkbox.prop("checked",selected),this.preparedData[rowId].checked=selected,this.updateSelectAllCheckboxState()):this._deselectPreviousSelection($row)}},updateSelectAllCheckboxState:function(){var $headerCheckbox=this.gridHeader.find("th input:checkbox"),$tbody=this.gridElement.find("tbody"),checkedItemsLength=$tbody.find("tr:visible input:checkbox:checked").length,visibleRowsLength=$tbody.find("tr:visible").length;return visibleRowsLength?void(checkedItemsLength===visibleRowsLength?$headerCheckbox.prop("checked",!0):$headerCheckbox.prop("checked",!1)):void $headerCheckbox.prop("checked",!1)},rowSelectionHandler:function(e,$row){e.stopPropagation();var rowId,rowData,selected;$row=$row||$(e.target).closest("tr"),rowId=$row.attr("data-row-id"),rowData=this.preparedData[rowId],rowData&&(selected=rowData.selected||!1,selected=!selected,this.toggleRowSelection($row,selected),selected&&$.isFunction(this.options.onRowSelect)&&this.options.onRowSelect(rowData,e),!selected&&$.isFunction(this.options.onRowDeselect)&&this.options.onRowDeselect(rowData,e))},rowDblClickHandler:function(e,$row){e.stopPropagation(),$row=$row||$(e.target).closest("tr");var rowData,rowId=$row.attr("data-row-id");rowData=this.preparedData[rowId],rowData&&$.isFunction(this.options.beforeRowUpdate)&&this.options.beforeRowUpdate(rowData,e,"dblclick")},columnSelectionHandler:function(e){e.stopImmediatePropagation();var $th=$(e.target).closest("th"),id=$th.attr("data-col-id"),colDef=this.preparedHeaderData[id],field=colDef.field,selector='td[data-col-id="'+id+'"]',$column=this.gridElement.find(selector),selected=$column.data("selected")||!1,colInfo={colDef:colDef,data:this.options.data.map(function(data){return data[field]}),sortDirection:this._getColumnSortDirection(colDef)};selected=!selected,colDef.selected=selected,$column.data("selected",selected),selected?($column.addClass("info"),$th.addClass("info"),$.isFunction(this.options.onColumnSelect)&&this.options.onColumnSelect(colInfo,e)):($column.removeClass("info"),$th.removeClass("info"),$.isFunction(this.options.onColumnDeselect)&&this.options.onColumnDeselect(colInfo,e))},_getValue:function($el,fields){var text,type=$el.attr("type");return"checkbox"===type?text=$el.prop("checked").toString():(text=$el.val(),$el.text(text)),text},isDataModified:function($editableElements,rowData){var isDataChanged=!1,self=this;return $editableElements.each(function(){var $el=$(this),colId=$el.attr("data-col-id"),colDef=self.preparedHeaderData[colId],fields=colDef.field.split("."),$ie=$el.find("input"),text=self._getValue($ie,fields);if(1===fields.length)isDataChanged=text||null!==rowData[colDef.field]?!(rowData[colDef.field]==text):!1;else{for(var d=rowData[fields[0]],k=1;k<fields.length-1;k++)this.Utils.isDefined(d)&&fields[k]in d&&(d=d[fields[k]]);isDataChanged=text||null!==d[fields[k]]?!(d[fields[k]]==text):!1}return isDataChanged?!isDataChanged:void 0}),isDataChanged},toggleEditRow:function(e){e.stopPropagation();var isNewRow,$editableElements,$row=$(e.target).closest("tr"),$originalElements=$row.find("td"),$editButton=$row.find(".edit-row-button"),$cancelButton=$row.find(".cancel-edit-row-button"),$saveButton=$row.find(".save-edit-row-button"),rowData=this.options.data[$row.attr("data-row-id")]||{},self=this,rowId=parseInt($row.attr("data-row-id"),10),isDataChanged=!1;if("edit"===e.data.action){if($.isFunction(this.options.beforeRowUpdate)&&this.options.beforeRowUpdate(rowData,e),$.isFunction(this.options.setGridEditMode)&&this.options.setGridEditMode(!0),!this.options.allowInlineEditing)return;$originalElements.each(function(){var editableTemplate,customExp,originalTemplate,compiledTemplate,$el=$(this),cellText=$el.text(),id=$el.attr("data-col-id"),colDef=self.preparedHeaderData[id];
colDef.readonly||self._isCustomExpressionNonEditable(colDef.customExpression)||colDef.disableInlineEditing||(editableTemplate=self._getEditableTemplate(colDef),colDef.customExpression||colDef.formatpattern?colDef.formatpattern?($el.addClass("cell-editing editable-expression").html(editableTemplate).data("originalText",cellText),$el.find("input").val(rowData[colDef.field]||self._getColumnValue(colDef,rowData))):colDef.customExpression&&(customExp=colDef.customExpression,originalTemplate=customExp,compiledTemplate=self.options.getCompiledTemplate(customExp,rowData,colDef),$el.addClass("cell-editing editable-expression").html(compiledTemplate).data("originalValue",{template:originalTemplate,rowData:angular.copy(rowData),colDef:colDef})):($el.addClass("cell-editing").html(editableTemplate).data("originalText",cellText),$el.find("input").val(cellText)))}),$editButton.addClass("hidden"),$cancelButton.removeClass("hidden"),$saveButton.removeClass("hidden"),$editableElements=$row.find("td.cell-editing"),$editableElements.on("click",function(e){e.stopPropagation()})}else if($editableElements=$row.find("td.cell-editing"),isNewRow=rowId>=this.preparedData.length,"save"===e.data.action)$.isFunction(this.options.onSetRecord)&&this.options.onSetRecord(rowData,e),isDataChanged=isNewRow?!0:this.isDataModified($editableElements,rowData),isDataChanged?($editableElements.each(function(){var $el=$(this),colId=$el.attr("data-col-id"),colDef=self.preparedHeaderData[colId],fields=colDef.field.split("."),$ie=$el.find("input"),text=self._getValue($ie,fields);if("timestamp"===colDef.type&&(text=parseInt(text)),1===fields.length)rowData[colDef.field]=text;else if(!isNewRow&&fields[0]in rowData){for(var d=rowData[fields[0]],k=1;k<fields.length-1;k++)this.Utils.isDefined(d)&&fields[k]in d&&(d=d[fields[k]]);d[fields[k]]=text}else if(isNewRow&&fields.length>1){fields[0]in rowData||(rowData[fields[0]]={});for(var x=rowData[fields[0]],k=1;k<fields.length-1;k++)!this.Utils.isDefined(x)||fields[k]in x||(x[fields[k]]={});x[fields[k]]=text}}),isNewRow?this.options.onRowInsert(rowData,e):this.options.afterRowUpdate(rowData,e)):(this.cancelEdit($editableElements),$editButton.removeClass("hidden"),$cancelButton.addClass("hidden"),$saveButton.addClass("hidden"),this.options.noChangesDetected());else{if(isNewRow)return $row.remove(),void(this.preparedData.length||this.setStatus("nodata",this.dataStatus.nodata));$.isFunction(this.options.setGridEditMode)&&this.options.setGridEditMode(!1),this.cancelEdit($editableElements),$editButton.removeClass("hidden"),$cancelButton.addClass("hidden"),$saveButton.addClass("hidden")}},cancelEdit:function($editableElements){$editableElements.each(function(){var originalValue,template,$el=$(this),value=$el.data("originalValue");value?(originalValue=value,originalValue.template?(template=self.options.getCompiledTemplate(originalValue.template,originalValue.rowData,originalValue.colDef),$el.html(template)):$el.html(originalValue)):$el.text($el.data("originalText"))})},hideRowEditMode:function($row){var $editableElements=$row.find("td.cell-editing"),$editButton=$row.find(".edit-row-button"),$cancelButton=$row.find(".cancel-edit-row-button"),$saveButton=$row.find(".save-edit-row-button");$editableElements.each(function(){var originalValue,template,$el=$(this),value=$el.data("originalValue");value?(originalValue=value,originalValue.template?(template=self.options.getCompiledTemplate(originalValue.template,originalValue.rowData,originalValue.colDef),$el.html(template)):$el.html(originalValue)):$el.text($el.find("input").val())}),$.isFunction(this.options.setGridEditMode)&&this.options.setGridEditMode(!1),$editButton.removeClass("hidden"),$cancelButton.addClass("hidden"),$saveButton.addClass("hidden")},deleteRow:function(e){e.stopPropagation();var $row=$(e.target).closest("tr"),rowId=$row.attr("data-row-id"),rowData=this.options.data[rowId],isNewRow=rowId>=this.preparedData.length;if(isNewRow)return void $row.remove();if($.isFunction(this.options.onRowDelete)){var className=this.options.cssClassNames.deleteRow,isActiveRow=-1!==$row.attr("class").indexOf("active");isActiveRow&&$row.removeClass("active"),$row.addClass(className),this.options.onRowDelete(rowData,function(){isActiveRow&&$row.addClass("active"),$row.removeClass(className)},e)}},deleteRowAndUpdateSelectAll:function(e){this.deleteRow(e),this.updateSelectAllCheckboxState()},_deselectPreviousSelection:function($row){var selectedRows=this.gridBody.find("tr.active"),rowId=$row.attr("data-row-id"),self=this;selectedRows.each(function(index,el){var id=$(this).attr("data-row-id"),preparedData=self.preparedData[id];id!==rowId&&preparedData&&($(this).find("input:radio").prop("checked",!1),preparedData.selected=preparedData.checked=!1,$(this).removeClass("active"))})},sortHandler:function(e){e.stopImmediatePropagation();var $previousSortedColumn,colId,colDef,$sortButton=$(e.target).closest(".sort-button"),$th=$sortButton.closest("th"),id=$th.attr("data-col-id"),$sortIcon=$sortButton.find("i"),direction=$sortIcon.hasClass("up")?"asc":"desc",sortInfo=this.options.sortInfo,$previousSortMarker=this.gridHeader.find(".active"),field=$th.attr("data-col-field");sortInfo.field&&sortInfo.field===field&&sortInfo.direction===direction||($sortIcon.addClass("active"),$previousSortMarker.length&&($previousSortedColumn=$previousSortMarker.closest("th"),colId=$previousSortedColumn.attr("data-col-id"),colDef=this.preparedHeaderData[colId],$previousSortMarker.removeClass("active"),colDef.sortInfo={sorted:!1,direction:""}),sortInfo.direction=direction,sortInfo.field=field,this.preparedHeaderData[id].sortInfo={sorted:!0,direction:direction},this.options.sortHandler.call(this,this.options.sortInfo,e))},attachEventHandlers:function($htm){var deleteRowHandler,rowOperationsCol=this._getRowActionsColumnDef();this.options.enableRowSelection&&($htm.on("click",this.rowSelectionHandler.bind(this)),$htm.on("dblclick",this.rowDblClickHandler.bind(this)),this.options.selectFirstRow&&this.selectFirstRow(!0)),this.gridHeader&&(this.options.enableColumnSelection&&this.gridHeader.find("th[data-col-selectable]").on("click",this.columnSelectionHandler.bind(this)),this.options.enableSort&&this.gridHeader.find(".sort-button").on("click",this.sortHandler.bind(this))),(this.options.allowInlineEditing||rowOperationsCol&&-1!==rowOperationsCol.operations.indexOf("update"))&&($htm.find(".edit-row-button").on("click",{action:"edit"},this.toggleEditRow.bind(this)),$htm.find(".cancel-edit-row-button").on("click",{action:"cancel"},this.toggleEditRow.bind(this)),$htm.find(".save-edit-row-button").on("click",{action:"save"},this.toggleEditRow.bind(this))),(this.options.allowDeleteRow||rowOperationsCol&&-1!==rowOperationsCol.operations.indexOf("delete"))&&(deleteRowHandler=this.deleteRowAndUpdateSelectAll,this.options.multiselect||(deleteRowHandler=this.deleteRow),$htm.find("td .delete-row-button").on("click",deleteRowHandler.bind(this)))},_findAndReplaceCompiledTemplates:function(){if(this.gridBody){var $compiledCells=this.gridBody.find("td[data-compiled-template]"),self=this;$compiledCells.each(function(){var $cell=$(this),id=$cell.attr("data-compiled-template");$cell.replaceWith(self.compiledCellTemplates[id])})}},_renderSearch:function(){function search(e){e.stopPropagation();var searchText=$htm.find('[data-element="dgSearchText"]')[0].value,$filterField=$htm.find('[data-element="dgFilterValue"]'),field=$filterField[0].value,colDefIndex=$htm.find("option:selected").attr("data-coldef-index"),colDef=self.options.colDefs[colDefIndex],type=colDef&&colDef.type?colDef.type:"";self.searchObj={field:field,value:searchText,type:type,event:e},self.options.searchHandler.call(self,self.searchObj)}var $searchBox,$htm=$(this._getSearchTemplate()),self=this;this.element.find(".form-search").remove(),$htm.insertBefore(this.gridContainer),this.gridSearch=this.element.find(".form-search"),$searchBox=this.gridSearch.find('[data-element="dgSearchText"]'),this.gridSearch.find(".app-search-button").on("click",search),this.gridSearch.find('[data-element="dgFilterValue"]').on("change",function(e){var colDefIndex=$htm.find("option:selected").attr("data-coldef-index"),colDef=self.options.colDefs[colDefIndex];if(colDef){var placeholder=colDef.searchPlaceholder||"Search";$htm.find('[data-element="dgSearchText"]').attr("placeholder",placeholder)}$searchBox.val(""),self.dataStatusContainer.find(".status").text()===self.options.dataStates.nodata&&search(e)}),$searchBox.on("keyup",function(e){e.stopPropagation(),$(this).val()||self.searchObj.value&&(self.searchObj.value="",search(e)),13===e.which&&search(e)})},_renderHeader:function(){function toggleSelectAll(e){var $table=$(e.target).closest("table"),$checkboxes=$("tbody tr:visible td input:checkbox:not(:disabled)",$table),checked=this.checked;$checkboxes.prop("checked",checked),$checkboxes.each(function(){var $row=$(this).closest("tr"),rowId=$row.attr("data-row-id"),rowData=self.preparedData[rowId];self.toggleRowSelection($row,checked),checked&&$.isFunction(self.options.onRowSelect)&&self.options.onRowSelect(rowData,e),!checked&&$.isFunction(self.options.onRowDeselect)&&self.options.onRowDeselect(rowData,e)})}var $htm=$(this._getHeaderTemplate()),self=this;this.gridElement.append($htm),this.gridHeader=this.gridElement.find("thead"),$htm.on("click","input:checkbox",toggleSelectAll),$.isFunction(this.options.onHeaderClick)&&this.gridHeader.on("click",{col:this.options.colDefs},this.options.onHeaderClick),this.gridElement.length&&this.gridElement.find("th[data-col-resizable]").resizable({handles:"e",minWidth:50,resize:function(evt,ui){var $colElement,$cellElements,colIndex=ui.helper.index()+1;$colElement=self.gridElement.find("colgroup > col:nth-child("+colIndex+")"),$cellElements=self.gridElement.find("tr > td:nth-child("+colIndex+") > div"),$colElement.width(ui.size.width),$cellElements.width(ui.size.width),$(this).css("height","auto")}})},_renderGrid:function(){var $htm=$(this._getGridTemplate());this.gridElement.append($htm),this.options.data.length||this.dataStatus.state.length?this.setStatus(this.dataStatus.state,this.dataStatus.message):this.setStatus("nodata"),this.gridBody=this.gridElement.find("tbody"),this._findAndReplaceCompiledTemplates(),this.attachEventHandlers($htm)},_render:function(){this.tableId||(this.tableId=this.Utils.generateGuid());var statusContainer='<div class="overlay" style="display: none;"><div class="loading"></div><div class="status"></div></div>',table='<div class="table-container table-responsive" style="height:'+this.options.height+';"><table class="'+this.options.cssClassNames.gridDefault+" "+this.options.cssClassNames.grid+'" id="table_'+this.tableId+'"></table></div>';this.gridContainer=$(table),this.gridElement=this.gridContainer.find("table"),this.element.find(".table-container").remove(),this.element.append(this.gridContainer),this.dataStatusContainer=$(statusContainer),this.gridContainer.append(this.dataStatusContainer),this.options.showHeader&&this._renderHeader(),this.options.enableSearch&&this._renderSearch(),this._renderGrid()},setStatus:function(state,message){var loadingIndicator=this.dataStatusContainer.find(".loading");this.dataStatus.state=state,this.dataStatus.message=message||this.options.dataStates[state],this.dataStatusContainer.find(".status").text(this.dataStatus.message),"loading"===state?loadingIndicator.show():loadingIndicator.hide(),"ready"===state?this.dataStatusContainer.hide():this.dataStatusContainer.show(),"nodata"===state?this.dataStatusContainer.addClass("bg-none"):this.dataStatusContainer.removeClass("bg-none")},setGridDimensions:function(key,value){-1===value.indexOf("px")&&-1===value.indexOf("%")&&-1===value.indexOf("em")&&"auto"!=value&&(value+="px"),this.options[key]=value,this.gridContainer.css(key,this.options[key])},_destroy:function(){this.element.text(""),window.clearTimeout(this.refreshGridTimeout)}}),WM.module("wm.widgets.dialog").constant("LOCAL_CONSTANTS",{DEFAULT_DIALOG_HEADER_ICON_SIZE:"21px"}).run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/dialog/dialog-template.html",'<div tabindex="-1" role="dialog"  class="modal default" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)" modal-transclude ></div>'),$templateCache.put("template/widget/dialog/dialog.html",'<div class="modal-dialog app-dialog" init-widget data-ng-show="show" data-ng-style="{width: dialogWidth}" ><div class="modal-content" wmtransclude></div></div>'),$templateCache.put("template/widget/dialog/dialog-header.html",'<div data-ng-show="show" data-identifier="dialog-header" class="app-dialog-header modal-header" init-widget title="{{hint}}"><button data-ng-if="closable" aria-label="Close" class="app-dialog-close close" data-ng-click="hideDialog()" title="Close"><span aria-hidden="true">&times;</span></button><h4 class="app-dialog-title modal-title"><i class="{{iconclass}}" data-ng-style="{width:iconwidth, height:iconheight, margin:iconmargin}"></i> <span>{{caption}}</span></h4><div class="dialog-header-action" wmtransclude></div></div>'),$templateCache.put("template/widget/dialog/design.html",'<div class="app-dialog-body modal-body" data-ng-style="{height: height}" data-identifier="dialog-content" init-widget wmtransclude></div>'),$templateCache.put("template/widget/dialog/dialog-footer.html",'<div data-ng-show="show" class="app-dialog-footer modal-footer" data-identifier="actions" init-widget wmtransclude></div>')}]).directive("wmDialog",["PropertiesFactory","WidgetUtilService","DialogService","$templateCache","$compile","CONSTANTS","$window",function(PropertiesFactory,WidgetUtilService,DialogService,$templateCache,$compile,CONSTANTS,$window){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"height":scope.content&&(newVal.indexOf("%")>0?scope.content[key]=$window.innerHeight*(window.parseInt(newVal)/100)-132:scope.content[key]=window.parseInt(newVal-122));break;case"width":CONSTANTS.isStudioMode&&(scope.dialogWidth=newVal);break;case"iconwidth":case"iconheight":case"iconmargin":case"iconclass":case"closable":scope.header[key]=newVal;break;case"title":scope.header.caption=newVal}}var id,transcludedContent="",widgetProps=PropertiesFactory.getPropertiesOf("wm.designdialog",["wm.basicdialog","wm.base"]),notifyFor={width:!0,height:!0,iconname:!0,iconwidth:!0,iconheight:!0,iconmargin:!0,iconclass:!0,closable:!0,title:!0};return{restrict:"E",transclude:CONSTANTS.isStudioMode,controller:function($scope){this.dialogtype=$scope.dialogtype},scope:{dialogtype:"@",dialogid:"@"},template:function(template,attrs){if(transcludedContent=template.html(),CONSTANTS.isRunMode){var dialog=template[0].outerHTML.replace("<wm-dialog ","<wm-dialog-container ");return dialog=dialog.replace("</wm-dialog>","</wm-dialog-container>"),transcludedContent=dialog,id=attrs.name,'<script type="text/ng-template" id="'+id+'">'+transcludedContent+"</script>"}return $templateCache.get("template/widget/dialog/dialog.html")},replace:!0,compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){CONSTANTS.isStudioMode&&element.append($compile(transcludedContent)(scope)),scope=scope||element.isolateScope(),scope.header=element.find("[data-identifier=dialog-header]").isolateScope()||{},scope.content=element.find("[data-identifier=dialog-content]").isolateScope()||{},scope.propertyManager&&WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmDialogContainer",["$templateCache","PropertiesFactory","WidgetUtilService","CONSTANTS","$window",function($templateCache,PropertiesFactory,WidgetUtilService,CONSTANTS,$window){"use strict";function propertyChangeHandler(scope,element,key,newVal){switch(key){case"height":scope.content&&(newVal.indexOf("%")>0?scope.content[key]=$window.innerHeight*(window.parseInt(newVal)/100)-112:scope.content[key]=window.parseInt(newVal-112));break;case"width":scope.width&&CONSTANTS.isRunMode&&element.closest(".modal-dialog").css("width",newVal);break;case"iconwidth":case"iconheight":case"iconmargin":case"iconclass":scope.header[key]=newVal;break;case"title":scope.header.caption=newVal}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.designdialog",["wm.basicdialog","wm.base"]),notifyFor={width:!0,height:!0,iconwidth:!0,iconheight:!0,iconmargin:!0,iconclass:!0,title:!0};return{restrict:"E",transclude:!0,controller:function($scope,$element){this.dialogtype=$scope.dialogtype,this.onDialogOk=$scope.onOk,this.onDialogCancel=$scope.onCancel,this.onDialogClose=$scope.onClose,$element.scope().onClose=$scope.onClose,$element.scope().onOpened=$scope.onOpened},scope:{dialogid:"@",onOk:"&",onClose:"&",onCancel:"&",onOpened:"&"},template:$templateCache.get("template/widget/dialog/dialog.html"),replace:!0,compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){scope=scope||element.isolateScope(),scope.header=element.find("[data-identifier=dialog-header]").isolateScope()||{},scope.content=element.find("[data-identifier=dialog-content]").isolateScope()||{},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmDialogheader",["PropertiesFactory","DialogService","WidgetUtilService","LOCAL_CONSTANTS","$templateCache",function(PropertiesFactory,DialogService,WidgetUtilService,LOCAL_CONSTANTS,$templateCache){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"iconclass":scope.iconurl&&""!==newVal&&"_none_"!==newVal?(scope.iconurl="",scope.iconwidth=scope.iconheight=LOCAL_CONSTANTS.DEFAULT_DIALOG_HEADER_ICON_SIZE):scope.iconurl||""===newVal||"_none_"===newVal?scope.iconwidth=scope.iconheight="":scope.iconwidth=scope.iconheight=LOCAL_CONSTANTS.DEFAULT_DIALOG_HEADER_ICON_SIZE}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.dialog.dialogheader",["wm.base"]),notifyFor={iconclass:!0};return{restrict:"E",replace:!0,transclude:!0,controller:"DialogController",scope:{},template:$templateCache.get("template/widget/dialog/dialog-header.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs,dialogCtrl){var parentEl,onCloseEventName,onOpenedEventName,parentElScope;parentEl=element.closest(".app-dialog"),parentElScope=parentEl.isolateScope(),scope.onClose=parentElScope.onClose,scope.onOpened=parentElScope.onOpened,scope.dialogid=parentEl.attr("dialogid"),element.scope().dialogid=scope.dialogid,onCloseEventName=parentEl.attr("on-close"),onOpenedEventName=parentEl.attr("on-opened"),scope.hideDialog=function(){dialogCtrl&&dialogCtrl._CloseButtonHandler(onCloseEventName)},onOpenedEventName&&dialogCtrl&&!scope.widgetid&&dialogCtrl._OnOpenedHandler(onOpenedEventName),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmDialogcontent",["$templateCache","PropertiesFactory","WidgetUtilService",function($templateCache,PropertiesFactory,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.dialog.dialogcontent",["wm.base"]);return{restrict:"E",replace:!0,require:"?^wmDialog",scope:{},transclude:!0,template:$templateCache.get("template/widget/dialog/design.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmDialogactions",["PropertiesFactory","WidgetUtilService","$templateCache","DialogService",function(PropertiesFactory,WidgetUtilService,$templateCache,DialogService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.dialog.dialogactions",["wm.base"]);return{restrict:"E",replace:!0,transclude:!0,scope:{},template:$templateCache.get("template/widget/dialog/dialog-footer.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(iScope,element,attrs){var scope=element.scope();scope.closeDialog=function(){DialogService.hideDialog(scope.dialogid)},WidgetUtilService.postWidgetCreate(iScope,element,attrs)}}}}}]),WM.module("wm.widgets.dialog").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/dialog/alertdialog.html",'<div class="app-dialog modal-dialog app-alert-dialog" ng-class="{type:type}" dialogclass init-widget data-ng-show="show" data-ng-style="{width: dialogWidth}"><div class="modal-content"><wm-dialogheader iconclass={{iconclass}} iconwidth={{iconwidth}} iconheight={{iconheight}} iconmargin={{iconmargin}} caption={{title}}></wm-dialogheader><div class="app-dialog-body modal-body" data-ng-style="{height:bodyHeight}"><p class="app-dialog-message text-{{alerttype}}"> {{message}}</p></div><div class="app-dialog-footer modal-footer"><wm-button  class="btn-primary"  caption={{oktext}} on-click="okButtonHandler()"></wm-button></div></div></div>')}]).directive("wmAlertdialog",["$templateCache","PropertiesFactory","WidgetUtilService","CONSTANTS","$window",function($templateCache,PropertiesFactory,WidgetUtilService,CONSTANTS,$window){"use strict";function propertyChangeHandler(scope,element,attrs,key,newVal){switch(key){case"height":scope.height&&(newVal.indexOf("%")>0?scope.bodyHeight=$window.innerHeight*(parseInt(newVal,10)/100)-112:scope.bodyHeight=parseInt(newVal-112,10));break;case"message":attrs.notificationdialog&&!CONSTANTS.isRunMode&&(scope.message="Alert Notification Message");break;case"oktext":attrs.notificationdialog&&!CONSTANTS.isRunMode&&(scope.oktext="OK");break;case"width":scope.width&&CONSTANTS.isRunMode?element.closest(".modal-dialog").css("width",newVal):CONSTANTS.isStudioMode&&(scope.dialogWidth=newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.alertdialog",["wm.basicdialog","wm.base","wm.dialog.onOk"]),notifyFor={message:!0,oktext:!0,height:!0,width:!0,type:!0};return{restrict:"E",controller:"DialogController",scope:{dialogid:"@",onOk:"&",onClose:"&"},replace:!0,template:function(template,attrs){if(void 0===template.attr("inscript")&&template.attr("inscript",!1),CONSTANTS.isRunMode&&"false"===template.attr("inscript")){template.attr("inscript",!0);var transcludedContent=template[0].outerHTML,id=attrs.name;return'<script backdrop="static" type="text/ng-template" id="'+id+'">'+transcludedContent+"</script>"}return $templateCache.get("template/widget/dialog/alertdialog.html")},compile:function(){return{pre:function(iScope,element,attrs){if(CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps,attrs.widgetid&&attrs.notificationdialog){var wp=iScope.widgetProps;_.keys(wp).forEach(function(propName){"class"!==propName&&(wp[propName].disabled=!0)})}},post:function(scope,element,attrs,dialogCtrl){scope.okButtonHandler||(scope.okButtonHandler=function(){dialogCtrl._OkButtonHandler(attrs.onOk)}),scope.propertyManager&&WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element,attrs),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.dialog").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/dialog/confirmdialog.html",'<div class="app-dialog modal-dialog app-confirm-dialog" dialogclass init-widget data-ng-show="show" data-ng-style="{width: dialogWidth}"><div class="modal-content"><wm-dialogheader caption={{title}} iconclass="{{iconclass}}" iconwidth={{iconwidth}} iconheight={{iconheight}} iconmargin={{iconmargin}}></wm-dialogheader><div class="app-dialog-body modal-body" data-ng-style="{height:bodyHeight}"><p class="app-dialog-message {{messageclass}}"> {{message}}</p></div><div class="app-dialog-footer modal-footer"><wm-button class="btn-secondary" caption={{canceltext}} on-click="cancelButtonHandler()"></wm-button><wm-button class="btn-primary" caption={{oktext}} on-click="okButtonHandler()"></wm-button></div></div></div>')}]).directive("wmConfirmdialog",["$templateCache","PropertiesFactory","WidgetUtilService","CONSTANTS","$window",function($templateCache,PropertiesFactory,WidgetUtilService,CONSTANTS,$window){"use strict";function propertyChangeHandler(scope,element,attrs,key,newVal){switch(key){case"height":scope.height&&(newVal.indexOf("%")>0?scope.bodyHeight=$window.innerHeight*(parseInt(newVal,10)/100)-112:scope.bodyHeight=parseInt(newVal-112,10));break;case"message":attrs.notificationdialog&&!CONSTANTS.isRunMode&&(scope.message="Confirm Notification Message");break;case"oktext":attrs.notificationdialog&&!CONSTANTS.isRunMode&&(scope.oktext="OK");break;case"canceltext":attrs.notificationdialog&&!CONSTANTS.isRunMode&&(scope.canceltext="CANCEL");break;case"width":scope.width&&CONSTANTS.isRunMode?element.closest(".modal-dialog").css("width",newVal):CONSTANTS.isStudioMode&&(scope.dialogWidth=newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.confirmdialog",["wm.basicdialog","wm.base","wm.dialog.onOk"]),notifyFor={message:!0,oktext:!0,canceltext:!0,height:!0,width:!0};return{restrict:"E",controller:"DialogController",scope:{dialogid:"@",onOk:"&",onClose:"&",onCancel:"&",okParams:"@"},replace:!0,template:function(template,attrs){if(void 0===template.attr("inscript")&&template.attr("inscript",!1),CONSTANTS.isRunMode&&"false"===template.attr("inscript")){template.attr("inscript",!0);var transcludedContent=template[0].outerHTML,id=attrs.name;return'<script backdrop="static" type="text/ng-template" id="'+id+'" modal="true" keyboard="false">'+transcludedContent+"</script>"}return $templateCache.get("template/widget/dialog/confirmdialog.html")},compile:function(){return{pre:function(iScope,element,attrs){if(CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps,attrs.widgetid&&attrs.notificationdialog){var wp=iScope.widgetProps;_.keys(wp).forEach(function(propName){"class"!==propName&&(wp[propName].disabled=!0)})}},post:function(scope,element,attrs,dialogCtrl){scope.cancelButtonHandler||(scope.cancelButtonHandler=function(){dialogCtrl._CancelButtonHandler(attrs.onCancel)}),scope.okButtonHandler||(scope.okButtonHandler=function(){dialogCtrl._OkButtonHandler(attrs.onOk)}),scope.okbuttonclass&&WM.element(element.find("button")[1]).addClass(scope.okbuttonclass),scope.cancelbuttonclass&&WM.element(element.find("button")[0]).addClass(scope.cancelbuttonclass),scope.propertyManager&&WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element,attrs),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.dialog").controller("DialogController",function($scope,DialogService,Utils,$rootScope){"use strict";var handleEvent=function(eventName,hideDialog,callBack,callbackParams){return eventName&&-1!==eventName.indexOf("(")?void Utils.triggerFn(callBack,callbackParams):(callBack&&WM.isFunction(callBack())?Utils.triggerFn(callBack(),callbackParams):eventName.indexOf(".show")>-1?DialogService.showDialog(eventName.slice(0,eventName.indexOf(".show"))):eventName.indexOf(".hide")>-1?DialogService.hideDialog(eventName.slice(0,eventName.indexOf(".hide"))):eventName.trim()&&$rootScope.$emit("invoke-service",eventName),void(hideDialog&&DialogService.hideDialog($scope.dialogid)))};this._OkButtonHandler=function(eventName){var eventParams;eventParams=$scope.okParams&&$scope.okParams.indexOf("{")>-1?Utils.getValidJSON($scope.okParams):$scope.okParams,eventName=eventName||"",handleEvent(eventName,!0,$scope.onOk,eventParams)},this._CancelButtonHandler=function(eventName){var eventParams;eventParams=$scope.cancelParams&&$scope.cancelParams.indexOf("{")>-1?Utils.getValidJSON($scope.cancelParams):$scope.cancelParams,eventName=eventName||"",handleEvent(eventName,!0,$scope.onCancel,eventParams)},this._CloseButtonHandler=function(eventName){eventName=eventName||"",handleEvent(eventName,!0,$scope.onClose)},this._OnOpenedHandler=function(eventName){eventName=eventName||"",handleEvent(eventName,!1,$scope.onOpened)}}),WM.module("wm.widgets.dialog").controller("NotificationDialogController",["$scope","dialogParams","Utils",function($scope,dialogParams,Utils){"use strict";$scope.notification={},dialogParams.notificationDetails&&($scope.notification.text=dialogParams.notificationDetails.text,$scope.notification.okButtonText=dialogParams.notificationDetails.okButtonText||"OK",$scope.notification.cancelButtonText=dialogParams.notificationDetails.cancelButtonText||"CANCEL",$scope.notification.alerttype=dialogParams.notificationDetails.alerttype||"information"),$scope.variableOnOk=function(){Utils.triggerFn(dialogParams.onOk)},$scope.variableOnClose=function(){Utils.triggerFn(dialogParams.onClose)},$scope.variableOnCancel=function(){Utils.triggerFn(dialogParams.onCancel)}}]),WM.module("wm.widgets.dialog").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/dialog/iframedialog.html",'<div class="app-dialog modal-dialog app-iframe-dialog" dialogclass init-widget data-ng-show="show" data-ng-style="{width: dialogWidth}"><div class="modal-content"><wm-dialogheader iconclass="{{iconclass}}" closable="{{closable}}"  iconwidth="{{iconwidth}}" iconheight="{{iconheight}}" iconmargin="{{iconmargin}}" caption="{{title}}"></wm-dialogheader><div class="app-dialog-body modal-body" data-ng-style="{height:bodyHeight}"><wm-iframe iframesrc="{{iframeurl}}" wm-widget-overlay height="100%" width="100%"></wm-iframe></div><div class="app-dialog-footer modal-footer"><wm-button class="btn-primary" caption={{oktext}} on-click="okButtonHandler()"></wm-button></div></div></div>')}]).directive("wmIframedialog",["$templateCache","PropertiesFactory","WidgetUtilService","CONSTANTS","$sce","$window",function($templateCache,PropertiesFactory,WidgetUtilService,CONSTANTS,$sce,$window){"use strict";function propertyChangeHandler(scope,element,key,newVal){switch(key){case"url":scope.iframeurl=$sce.trustAsResourceUrl(newVal);break;case"width":scope.width&&CONSTANTS.isRunMode?element.closest(".modal-dialog").css("width",newVal):CONSTANTS.isStudioMode&&(scope.dialogWidth=newVal);break;case"height":scope.height&&(newVal.indexOf("%")>0?scope.bodyHeight=$window.innerHeight*(parseInt(newVal,10)/100)-112:scope.bodyHeight=parseInt(newVal-112,10))}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.iframedialog",["wm.basicdialog","wm.base","wm.dialog.onOk"]),notifyFor={url:!0,height:!0,width:!0,closable:!0};return{restrict:"E",controller:"DialogController",scope:{dialogid:"@",onOk:"&",onClose:"&"},replace:!0,template:function(template,attrs){if(void 0===template.attr("inscript")&&template.attr("inscript",!1),CONSTANTS.isRunMode&&"false"===template.attr("inscript")){template.attr("inscript",!0);var transcludedContent=template[0].outerHTML,id=attrs.name;return'<script backdrop="static" type="text/ng-template" id="'+id+'">'+transcludedContent+"</script>"}return $templateCache.get("template/widget/dialog/iframedialog.html")},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs,dialogCtrl){scope.okButtonHandler||(scope.okButtonHandler=function(){dialogCtrl._OkButtonHandler(attrs.onOk)}),scope.propertyManager&&WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.dialog").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/dialog/pagedialog.html",'<div class="app-dialog modal-dialog app-page-dialog" dialogclass init-widget data-ng-show="show" page-container  data-ng-style="{width: dialogWidth}"><div class="modal-content"><wm-dialogheader iconclass={{iconclass}}  closable="{{closable}}" caption={{title}}  iconwidth={{iconwidth}} iconheight={{iconheight}} iconmargin={{iconmargin}}></wm-dialogheader><div class="app-dialog-body modal-body" data-ng-style="{height:bodyHeight}" page-container-target></div><div class="app-dialog-footer modal-footer"><wm-button  class="btn-primary" caption={{oktext}} on-click="okButtonHandler()"></wm-button></div></div></div>');
}]).directive("wmPagedialog",["$templateCache","PropertiesFactory","WidgetUtilService","CONSTANTS","$window",function($templateCache,PropertiesFactory,WidgetUtilService,CONSTANTS,$window){"use strict";function propertyChangeHandler(scope,element,key,newVal){switch(key){case"height":scope.height&&(newVal.indexOf("%")>0?scope.bodyHeight=$window.innerHeight*(parseInt(newVal,10)/100)-112:scope.bodyHeight=parseInt(newVal-112,10));break;case"width":scope.width&&CONSTANTS.isRunMode?element.closest(".modal-dialog").css("width",newVal):CONSTANTS.isStudioMode&&(scope.dialogWidth=newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.pagedialog",["wm.basicdialog","wm.base","wm.dialog.onOk"]),notifyFor={height:!0,width:!0,closable:!0};return{restrict:"E",controller:"DialogController",scope:{dialogid:"@",onOk:"&",onClose:"&"},replace:!0,template:function(template,attrs){if(void 0===template.attr("inscript")&&template.attr("inscript",!1),CONSTANTS.isRunMode&&"false"===template.attr("inscript")){template.attr("inscript",!0);var transcludedContent=template[0].outerHTML,id=attrs.name;return'<script backdrop="static" type="text/ng-template" id="'+id+'">'+transcludedContent+"</script>"}return $templateCache.get("template/widget/dialog/pagedialog.html")},compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs,dialogCtrl){scope.okButtonHandler||(scope.okButtonHandler=function(){dialogCtrl._OkButtonHandler(attrs.onOk)}),scope.propertyManager&&WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.dialog").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/dialog/logindialog.html",'<div class="app-dialog modal-dialog app-login-dialog"  data-ng-style="{width: width}" init-widget data-ng-show="show"><div class="modal-content" wmtransclude></div></div>'),$templateCache.put("template/widget/dialog/logindialogcontainer.html","<div wmtransclude></div>")}]).directive("wmLogindialog",["PropertiesFactory","WidgetUtilService","$templateCache","$compile","CONSTANTS",function(PropertiesFactory,WidgetUtilService,$templateCache,$compile,CONSTANTS){"use strict";var id,transcludedContent="",widgetProps=PropertiesFactory.getPropertiesOf("wm.logindialog",["wm.basicdialog","wm.base","wm.base.events.successerror"]);return{restrict:"E",transclude:CONSTANTS.isStudioMode,scope:{dialogid:"@"},template:function(template,attrs){if(transcludedContent=template.html(),CONSTANTS.isRunMode){var dialogEle=WM.element(template[0].outerHTML),onsuccess=dialogEle.attr("on-success")||"",onerror=dialogEle.attr("on-error")||"",dialog=template[0].outerHTML.replace("<wm-logindialog ","<wm-dialog-container class='app-login-dialog' ");return dialog=dialog.replace("</wm-logindialog>","</wm-dialog-container>"),dialog='<wm-logindialog-container on-success="'+onsuccess+'" on-error="'+onerror+'">'+dialog+"</wm-logindialog-container>",transcludedContent=dialog,id=attrs.name,'<script type="text/ng-template" id="'+id+'">'+transcludedContent+"</script>"}return $templateCache.get("template/widget/dialog/logindialog.html")},replace:!0,compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){CONSTANTS.isStudioMode&&element.append($compile(transcludedContent)(scope)),scope=scope||element.isolateScope(),scope.header=element.find("[data-identifier=dialog-header]").isolateScope()||{},scope.content=element.find("[data-identifier=dialog-content]").isolateScope()||{},attrs.title&&!scope.header.caption&&(scope.header.caption=attrs.title),attrs.iconclass&&!scope.header.iconclass&&(scope.header.iconclass=attrs.iconclass),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmLogindialogContainer",["$templateCache","PropertiesFactory","WidgetUtilService","SecurityService","BaseService","Utils","CONSTANTS",function($templateCache,PropertiesFactory,WidgetUtilService,SecurityService,BaseService,Utils,CONSTANTS){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.logindialog",["wm.base"]);return{restrict:"E",transclude:!0,scope:{dialogid:"@",onSuccess:"&",onError:"&"},template:$templateCache.get("template/widget/dialog/logindialogcontainer.html"),replace:!0,compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){if(CONSTANTS.isRunMode){scope.doLogin=function(event){scope.loginMessage=scope.$parent.loginMessage=null,SecurityService.appLogin({username:element.find('[name="usernametext"]').val(),password:element.find('[name="passwordtext"]').val()},function(response){scope.$root.isUserAuthenticated=!0,element.trigger("success"),scope.redirectUrl=response&&response.url?response.url:"index.html",scope.onSuccess({$event:event,$scope:scope}),scope.$root.$emit("update-loggedin-user"),BaseService.executeErrorCallStack()},function(error){scope.loginMessage=scope.$parent.loginMessage={type:"error",caption:scope.errormessage||error},element.trigger("error"),scope.onError({$event:event,$scope:scope})})};var loginbutton=element.find('.app-button[name="loginbutton"]');loginbutton.unbind("click"),loginbutton.click(scope.doLogin.bind(null)),element.find(".app-textbox").keypress(function(evt){evt.stopPropagation(),"ENTER"===Utils.getActionFromKey(evt)&&scope.doLogin(evt)})}WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("ui.bootstrap.popover").provider("$wmPopup",function(){"use strict";var defaultOptions={placement:"bottom",animation:!0,popupDelay:0,autoClose:!0,arrow:!1,isText:!1},triggerMap={mouseenter:"mouseleave",click:"click",focus:"blur"},globalOptions={},popupRegistry=[];this.options=function(value){WM.extend(globalOptions,value)},this.setTriggers=function(triggers){WM.extend(triggerMap,triggers)},this.$get=["$compile","$timeout","$parse","$document","$position","$interpolate","Utils",function($compile,$timeout,$parse,$document,$position,$interpolate,Utils){return function(type,prefix,defaultTriggerShow){function setTriggers(trigger){var show,hide;return show=trigger||options.trigger||defaultTriggerShow,hide=options.trigger?triggerMap[options.trigger]||show:triggerMap[show]||show,{show:show,hide:hide}}function hideAllPopups(){var i,currPopup,currPopupScope,popupCount=popupRegistry.length;for(i=0;popupCount>i;i+=1)currPopup=popupRegistry[i],currPopupScope=currPopup.isolateScope(),currPopupScope.isOpen&&"false"!==currPopupScope.autoClose&&currPopupScope.hidePopup()}var directiveName,triggers,startSym,endSym,directiveTemplate,options=WM.extend({},defaultOptions,globalOptions);return $document.find("body").on("click",function(event){hideAllPopups()}),directiveName=Utils.hyphenate(type),triggers=setTriggers(void 0),startSym=$interpolate.startSymbol(),endSym=$interpolate.endSymbol(),directiveTemplate="<"+directiveName+'-window content="'+startSym+"popup_content"+endSym+'" style-class="'+startSym+"popup_style_class"+endSym+'"placement="'+startSym+"popup_placement"+endSym+'" auto-close="popup_autoClose" identifier="'+startSym+"popup_identifier"+endSym+'" animation="popup_animation()" arrow="popup_arrow()" is-text="popup_isText()" is-open="popup_isOpen"></'+directiveName+"-window>",{restrict:"EA",scope:!0,link:function(scope,element,attrs){function show(){var position,popupWidth,popupHeight,popupPosition,mousePos,tooltipScope;if(hideAllPopups(),scope.popup_content){switch(transitionTimeout&&$timeout.cancel(transitionTimeout),tooltip.css({top:0,left:0,display:"block"}),isTooltipExist||(appendToBody?($body=$body||$document.find("body"),$body.append(tooltip)):element.after(tooltip)),position=options.appendToBody?$position.offset(element):$position.position(element),popupWidth=tooltip.prop("offsetWidth"),popupHeight=tooltip.prop("offsetHeight"),scope.popup_placement){case"mouse":mousePos=$position.mouse(),popupPosition={top:mousePos.y,left:mousePos.x};break;case"right":popupPosition={top:position.top+position.height/2-popupHeight/2,left:position.left+position.width};break;case"bottom":popupPosition={top:position.top+position.height,left:position.left+position.width/2-popupWidth/2};break;case"left":popupPosition={top:position.top+position.height/2-popupHeight/2,left:position.left-popupWidth};break;default:popupPosition={top:position.top-popupHeight,left:position.left+position.width/2-popupWidth/2}}popupPosition.top+="px",popupPosition.left+="px",tooltip.css(popupPosition),scope.popup_isOpen=!0,tooltipScope=tooltip.isolateScope(),tooltipScope&&WM.isFunction(tooltipScope.showCallBack)&&tooltipScope.showCallBack()}}function hide(){scope.popup_isOpen=!1,tooltip.css("display","none"),$timeout.cancel(popupTimeout);var tooltipScope=tooltip.isolateScope();tooltipScope&&WM.isFunction(tooltipScope.hideCallBack)&&tooltipScope.hideCallBack()}function showTooltipBind(event){scope.popup_popupDelay?popupTimeout=$timeout(show,scope.popup_popupDelay):scope.$apply(show),event.stopPropagation()}function hideTooltipBind(event){scope.$apply(function(){hide()}),event.stopPropagation()}function toggleTooltipBind(event){scope.popup_isOpen?hideTooltipBind(event):showTooltipBind(event)}function default_animation(){return options.animation}function default_arrow(){return options.arrow}function default_isText(){return options.isText}function update_triggers(val){triggers=setTriggers(val),triggers.show===triggers.hide?element.bind(triggers.show,function(event){toggleTooltipBind(event)}):(element.bind(triggers.show,function(event){showTooltipBind(event)}),element.bind(triggers.hide,function(event){hideTooltipBind(event)}))}var transitionTimeout,popupTimeout,$body,tooltip=$compile(directiveTemplate)(scope),isTooltipExist=!1,appendToBody=options.appendToBody||!1;scope.hide=function(){scope.$apply(function(){hide()})},tooltip.isolateScope().hidePopup=function(){hide()},scope.popup_isOpen=!1,attrs.$observe(type,function(val){scope.popup_content=val}),scope.popup_placement=options.placement,attrs.$observe(prefix+"Placement",function(val){scope.popup_placement=val?val.trim():options.placement}),scope.popup_style_class=options.styleClass,attrs.$observe(prefix+"StyleClass",function(val){scope.popup_style_class=val?val.trim():options.styleClass}),scope.popup_autoClose=options.autoClose,attrs.$observe(prefix+"AutoClose",function(val){scope.popup_autoClose=val?val.trim():options.autoClose}),scope.popup_identifier="popup"+scope.$id,attrs.$observe(prefix+"Identifier",function(val){scope.popup_identifier=val?val.trim():"popup"+scope.$id}),scope.popup_animation=default_animation,attrs.$observe(prefix+"Animation",function(val){scope.popup_animation=val?$parse(val):default_animation}),scope.popup_arrow=default_arrow,attrs.$observe(prefix+"Arrow",function(val){scope.popup_arrow=val?$parse(val):default_arrow}),scope.popup_isText=default_isText,attrs.$observe(prefix+"IsText",function(val){scope.popup_isText=val?$parse(val):default_isText}),scope.popup_popupDelay=options.popupDelay,attrs.$observe(prefix+"PopupDelay",function(val){var delay=parseInt(val,10);scope.popup_popupDelay=isNaN(delay)?options.popupDelay:delay}),attrs.hasOwnProperty("wmPopupTrigger")?attrs.$observe(prefix+"Trigger",function(val){update_triggers(val)}):update_triggers(),attrs.$observe(prefix+"AppendToBody",function(val){appendToBody=val?$parse(val)(scope):appendToBody}),appendToBody&&scope.$on("$locationChangeSuccess",function(){scope.popup_isOpen&&hide()}),scope.$on("$destroy",function(){scope.popup_isOpen?hide():tooltip.remove()}),scope.$on("$routeChangeStart",function(){popupRegistry.length=0}),popupRegistry.push(tooltip)}}}}]}).directive("wmPopupWindow",function(){"use strict";var getPopupTemplate=function(){return'<div class="popover {{placement}} {{styleClass}}" data-ng-class="{ in: isOpen, fade: animation() }"><div data-ng-class="{ arrow: arrow() }"></div><div class="alert {{alertClass}}" data-ng-show="showAlert">{{statusMsg}}</div><div class="popover-inner"> <div ng-switch on="isText()">  <div ng-switch-when="true">   <div class="popover-content" data-ng-bind="content"></div>  </div>  <div ng-switch-default>   <div class="popover-content" data-ng-include="content"></div>  </div> </div></div></div></div>'};return{restrict:"E",replace:!0,controller:"PopupController",scope:{content:"@",styleClass:"@",placement:"@",animation:"&",isOpen:"=",arrow:"&",autoClose:"=",identifier:"@",isText:"&"},template:getPopupTemplate(),link:function(scope,element){element.bind("click",function(event){event.stopPropagation()})}}}).directive("wmPopup",["$wmPopup",function($wmPopup){"use strict";return $wmPopup("wmPopup","wmPopup","click")}]),WM.module("wm.widgets.dialog").service("DialogService",["$rootScope","$modal","CONSTANTS","$modalStack",function($rootScope,$modal,CONSTANTS,$modalStack){"use strict";function showDialog(dialogId,params){if(!(!dialogId||$modalInstances&&$modalInstances[dialogId])){var backdrop,keyboard,windowClass,modal,template=WM.element("script[id="+dialogId+"]"),controller=template.attr("controller"),content=template.html(),dialogContainer=WM.element("<div></div>").html(content);modal=template.attr("modal"),backdrop="true"===modal?"static":!0,keyboard=template.attr("keyboard"),keyboard="false"!==keyboard,params||(params={}),windowClass=dialogContainer.find("wm-dialog, wm-alertdialog, wm-confirmdialog, wm-pagedialog, wm-iframedialog, wm-logindialog").attr("dialogclass"),windowClass||(windowClass=(dialogContainer.find("wm-dialog-container").attr("dialogclass")||"")+(template.parent().attr("theme")||"")+" default"),dialogContainer.find("wm-dialog, wm-dialog-container, wm-alertdialog, wm-confirmdialog, wm-pagedialog, wm-iframedialog, wm-logindialog").attr({controller:controller,dialogid:dialogId}),content=dialogContainer.html(),dialogContainer=null,$modalInstances[dialogId]=$modal.open({template:content,controller:controller||dialogId+"Controller",backdrop:backdrop,keyboard:keyboard,windowTemplateUrl:"template/widget/dialog/dialog-template.html",resolve:params.resolve||null,scope:params.scope||(CONSTANTS.isStudioMode?$rootScope:WM.element("[data-ng-controller='AppController']").scope()),windowClass:windowClass||params.windowClass||""}),$modalInstances[dialogId].result.then(null,function(){$modalInstances[dialogId].scope&&$modalInstances[dialogId].scope.$destroy(),$modalInstances[dialogId]=null}),$modalInstances[dialogId].opened.then(function(){var dialogCtrlScope=$modalStack.getTop().value.modalScope;params._props&&WM.extend(dialogCtrlScope,params._props),$modalInstances[dialogId].scope=dialogCtrlScope,WM.isFunction(params.onOpen)&&params.onOpen($modalInstances[dialogId].scope)}),openDialogIds.push(dialogId)}}function _closeDialog(dialogId){var dialogRef=openDialogIds.indexOf(dialogId);-1!==dialogRef&&openDialogIds.splice(dialogRef,1)}function hideDialog(dialogId){!dialogId||$modalInstances&&!$modalInstances[dialogId]||($modalInstances[dialogId].close(),$modalInstances[dialogId].scope&&$modalInstances[dialogId].scope.$destroy(),$modalInstances[dialogId]=null,_closeDialog(dialogId))}function showConfirmDialog(params){var template,controller,content,backdrop,keyboard,windowClass,dialogCaption,dialogContainer,dialogId="global-confirm-dialog";$modalInstances&&$modalInstances[dialogId]||(template=WM.element("script[id="+dialogId+"]"),controller=params.controller,content=template.html(),dialogContainer=WM.element("<div></div>").html(content),dialogCaption=$rootScope.locale[params.caption]||params.caption,backdrop=params.backdrop||template.attr("backdrop"),"static"!==backdrop&&("false"===backdrop?backdrop=!1:("true"===backdrop||"undefined"===backdrop)&&(backdrop=!0)),keyboard=params.keyboard||template.attr("keyboard"),"false"===keyboard?keyboard=!1:("true"===keyboard||"undefined"===keyboard)&&(keyboard=!0),params||(params={}),windowClass=dialogContainer.find("wm-confirmdialog").attr("dialogclass"),windowClass||(windowClass=(dialogContainer.find("wm-dialog-container").attr("dialogclass")||"")+(template.parent().attr("theme")||"")+" default"),dialogContainer.find("wm-confirmdialog").attr({controller:controller,dialogid:dialogId,title:dialogCaption,message:$rootScope.locale[params.content]||params.content,messageclass:params.contentClass||"",iconname:params.iconName||"",iconclass:params.iconClass||"",oktext:params.oktext||$rootScope.locale.LABEL_OK,canceltext:params.canceltext||$rootScope.locale.LABEL_CANCEL}),params.onOk&&dialogContainer.find("wm-confirmdialog").attr("on-ok",params.onOk),params.onCancel&&dialogContainer.find("wm-confirmdialog").attr("on-cancel",params.onCancel),params.onClose&&dialogContainer.find("wm-confirmdialog").attr("on-close",params.onClose),params.okParams&&dialogContainer.find("wm-confirmdialog").attr("ok-params",params.okParams),params.cancelParams&&dialogContainer.find("wm-confirmdialog").attr("cancel-params",params.cancelParams),content=dialogContainer.html(),dialogContainer=null,$modalInstances[dialogId]=$modal.open({template:content,controller:controller||dialogId+"Controller",backdrop:backdrop,keyboard:keyboard,resolve:params.resolve||null,scope:params.scope||$rootScope,windowClass:windowClass||params.windowClass||"",windowTemplateUrl:"template/widget/dialog/dialog-template.html"}),$modalInstances[dialogId].result.then(null,function(){$modalInstances[dialogId]=null}),$modalInstances[dialogId].opened.then(function(){$modalInstances[dialogId].scope=$modalStack.getTop().value.modalScope}),openDialogIds.push(dialogId))}function closeAllDialogs(){var index;for(index=0;index<openDialogIds.length;index+=1)hideDialog(openDialogIds[index])}function open(dialogId,parentScope,properties){var obj={scope:parentScope,_props:properties};showDialog(dialogId,obj)}var $modalInstances={},openDialogIds=[];this.open=open,this.close=hideDialog,this.hideDialog=hideDialog,this.showDialog=showDialog,this.showConfirmDialog=showConfirmDialog,this.closeAllDialogs=closeAllDialogs}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/button.html",'<button class="btn app-button" init-widget title="{{hint}}" apply-styles data-ng-disabled="disabled" data-ng-show="show"><img data-identifier="img" class="button-image-icon" data-ng-src="{{iconsrc}}"  data-ng-if="showimage" data-ng-style="{width:iconwidth ,height:iconheight, margin:iconmargin}"/><i class="{{iconclass}}" data-ng-style="{width:iconwidth, height:iconheight, margin:iconmargin, fontSize:iconwidth}" data-ng-if="showicon"></i> <span class="btn-caption"></span><span data-ng-if="badgevalue" class="badge pull-right">{{badgevalue}}</span></button>')}]).directive("wmButton",["PropertiesFactory","WidgetUtilService","$sce","Utils",function(PropertiesFactory,WidgetUtilService,$sce,Utils){"use strict";function propertyChangeHandler(scope,element,key,newVal){switch(key){case"iconposition":element.attr("icon-position",newVal);break;case"iconclass":scope.showicon="_none_"!==scope.iconclass&&""!==newVal&&!scope.iconurl;break;case"iconurl":var showIcon=""===newVal;scope.showicon=showIcon,scope.showimage=!showIcon,scope.iconsrc=Utils.getImageUrl(newVal);break;case"caption":WM.isObject(newVal)?element.children(".btn-caption").text(JSON.stringify(newVal)):element.children(".btn-caption").html($sce.trustAs($sce.HTML,newVal.toString()).toString())}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.button",["wm.base","wm.base.editors","wm.base.events","wm.base.events.focus"]),notifyFor={iconclass:!0,iconurl:!0,caption:!0,iconposition:!0};return{restrict:"E",replace:!0,scope:{},template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/form/button.html"),compile:function(tElement){return{pre:function(scope,element,attrs){!attrs.iconclass&&attrs.iconname&&(WM.element(tElement.context).attr("iconclass","glyphicon glyphicon-"+attrs.iconname),attrs.iconclass="glyphicon glyphicon-"+attrs.iconname),scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/button-group.html",'<div class="btn-group app-button-group" wmtransclude init-widget data-ng-class=\'{"btn-group-vertical": vertical}\' apply-styles="container" title="{{hint}}" data-ng-show="show"></div>')}]).directive("wmButtongroup",["$templateCache","PropertiesFactory","WidgetUtilService",function($templateCache,PropertiesFactory,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.buttongroup",["wm.base","wm.base.editors"]);return{restrict:"E",replace:!0,scope:{},template:$templateCache.get("template/widget/form/button-group.html"),transclude:!0,compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/switch.html",'<div data-ng-show="show" class="app-switch" init-widget has-model apply-styles><div class="btn-group"><button class="btn btn-default" data-ng-disabled="disabled"  data-ng-style="{\'width\': btnwidth + \'%\'}" data-ng-repeat="opt in options track by $index" data-ng-class="{\'selected\': selected.index === $index}" data-ng-click="selectOpt($event, $index)">{{opt[displayfield || "label"]}}</button></div><span class="btn btn-primary app-switch-overlay switch-handle" data-ng-style="{\'width\': btnwidth + \'%\'}"><b>{{_model_}}</b></span><input type="hidden" class="ng-hide model-holder" data-ng-disabled="disabled" value="{{_model_}}"></div>')}]).directive("wmSwitch",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";function updatePropertyPanelOptions(dataset,propertiesMap,scope){var variableKeys=[];dataset&&WM.isObject(dataset)&&(dataset=dataset[0]||dataset,variableKeys=WidgetUtilService.extractDataSetFields(dataset,propertiesMap)||[]),WM.forEach(variableKeys,function(variableKey,index){(null===dataset[variableKey]||WM.isObject(dataset[variableKey]))&&variableKeys.splice(index,1)}),scope.newcolumns&&(scope.newcolumns=!1,scope.datafield="",scope.displayfield="",scope.$root.$emit("set-markup-attr",scope.widgetid,{datafield:scope.datafield,displayfield:scope.displayfield})),scope.widgetProps.datafield.options=["","All Fields"].concat(variableKeys),scope.widgetProps.displayfield.options=[""].concat(variableKeys)}function trim(str){return WM.isString(str)?str.trim():str}function toOptionsObjFromString(str){return{value:str,label:str}}function setSelectedValue(scope){var options=scope.options;void 0!==scope._model_&&null!==scope._model_&&options.some(function(opt,index){return scope._model_===opt||scope._model_===opt[scope.datafield]||scope._model_===opt.value?(scope.selected.index=index,!0):void 0})}function updateHighlighter(scope,element){var left,handler=element.find("span.app-switch-overlay"),index=scope.selected.index;(void 0===index||null===index)&&(index=-1),left=index*scope.btnwidth,handler.animate({left:left+"%"},300)}function updateSwitchOptions(scope,element,dataset){var options=[];scope.selected.index=-1,scope.datasetType=NONE,dataset=dataset?dataset.data||dataset:[],WM.isString(dataset)?(options=dataset.split(",").map(trim).map(toOptionsObjFromString),scope.datasetType=COMMA_SEP_STRING):WM.isObject(dataset)&&WM.isArray(dataset)&&(WM.isString(dataset[0])?(options=dataset.map(trim).map(toOptionsObjFromString),scope.datasetType=ARRAY_STRINGS):WM.isObject(dataset[0])&&!WM.isArray(dataset[0])&&(options=dataset,scope.datasetType=ARRAY_OBJECTS)),options.length&&(scope.btnwidth=100/options.length),scope.options=options,setSelectedValue(scope),updateHighlighter(scope,element)}function propertyChangeHandler(scope,element,key,newVal){switch(key){case"dataset":scope.widgetid&&WM.isDefined(newVal)&&null!==newVal&&updatePropertyPanelOptions(newVal.data||newVal,newVal.propertiesMap,scope),updateSwitchOptions(scope,element,newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.switch",["wm.base","wm.base.editors","wm.base.editors.abstracteditors"]),notifyFor={dataset:!0},COMMA_SEP_STRING=1,ARRAY_STRINGS=2,ARRAY_OBJECTS=3,NONE=0;return{restrict:"E",replace:!0,scope:{scopedataset:"=?"},template:function(tElement,tAttrs){var template=WM.element(WidgetUtilService.getPreparedTemplate("template/widget/form/switch.html",tElement,tAttrs));return template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){scope.options=[],!scope.widgetid&&attrs.scopedataset&&scope.$watch("scopedataset",function(newVal){updateSwitchOptions(scope,element,newVal)}),scope.selectOptAtIndex=function($index){var opt=scope.options[$index];scope.datasetType===ARRAY_OBJECTS?scope.datafield&&("All Fields"===scope.datafield?scope._model_=opt:scope._model_=opt[scope.datafield]):scope._model_=opt.value},scope.selectOpt=function($event,$index){if(!scope.disabled){if(scope.selected.index===$index){if(2!==scope.options.length)return;$index=1===$index?0:1}scope.selected.index=$index,scope.selectOptAtIndex($index),updateHighlighter(scope,element),scope._onChange($event)}},scope.$watch("_model_",function(){setSelectedValue(scope),updateHighlighter(scope,element)}),scope.selected={},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/menu.html",'<div class="dropdown app-menu" init-widget data-ng-show="show" dropdown ><button class="btn app-button dropdown-toggle {{menuclass}}" dropdown-toggle apply-styles><i class="{{iconclass}}"></i> {{caption}} <span wmtransclude></span><span class="caret"></span></button><wm-menu-dropdown items="menuItems" linktarget="linktarget" menualign="menualign"/></div>'),$templateCache.put("template/widget/form/anchormenu.html",'<div class="dropdown app-menu" init-widget data-ng-show="show" dropdown><a class="app-anchor dropdown-toggle {{menuclass}}" dropdown-toggle apply-styles><i class="{{iconclass}}"></i> {{caption}} <span wmtransclude></span><span class="caret"></span></a><wm-menu-dropdown items="menuItems" linktarget="linktarget" menualign="menualign"/></div>'),$templateCache.put("template/widget/form/menu/dropdown.html",'<ul class="dropdown-menu {{menualign}}"><wm-menu-dropdown-item data-ng-repeat="item in items" linktarget="linktarget" item="item" menualign="menualign"/></ul>'),$templateCache.put("template/widget/form/menu/dropdownItem.html",'<li data-ng-class="{\'disabled\': item.disabled, \'dropdown-submenu\' : item.children.length > 0}"><a title="{{item.label}}" ng-href="{{item.link}}" target="{{linktarget}}">'+"<span data-ng-if=\"item.children.length\" class=\"pull-right fa\" data-ng-class=\"{ 'fa-caret-left': {{menualign === 'pull-right'}}, 'fa-caret-right': {{menualign === 'pull-left' || menualign === undefined}}, 'fa-caret-down': {{menualign === 'dropinline-menu'}} }\"></span><i class=\"{{item.icon}}\"></i>{{item.label}}</a></li>")}]).directive("wmMenu",["$templateCache","PropertiesFactory","WidgetUtilService","$timeout","Utils","CONSTANTS",function($templateCache,PropertiesFactory,WidgetUtilService,$timeout,Utils,CONSTANTS){"use strict";function getMenuItems(newVal,scope){var transformFn,menuItems=[];return WM.isString(newVal)?menuItems=newVal.split(",").map(function(item){var _val=item&&item.trim();return{label:_val,value:_val}}):WM.isArray(newVal)&&(WM.isObject(newVal[0])?(transformFn=function(item){var children=WidgetUtilService.getEvaluatedData(scope,item,{expressionName:"itemchildren"})||item.children;return{label:WidgetUtilService.getEvaluatedData(scope,item,{expressionName:"itemlabel"})||item.label,icon:WidgetUtilService.getEvaluatedData(scope,item,{expressionName:"itemicon"})||item.icon,disabled:item.disabled,link:WidgetUtilService.getEvaluatedData(scope,item,{expressionName:"itemlink"})||item.link,value:scope.datafield?"All Fields"===scope.datafield?item:Utils.findValueOf(item,scope.datafield):item,children:(WM.isArray(children)?children:[]).map(transformFn)}},menuItems=newVal.map(transformFn)):menuItems=newVal.map(function(item){return{label:item,value:item}})),menuItems}function propertyChangeHandler(scope,element,key,newVal){switch(key){case"scopedataset":case"dataset":CONSTANTS.isStudioMode&&WM.isDefined(newVal)&&null!==newVal&&WidgetUtilService.updatePropertyPanelOptions(newVal.data||newVal,newVal.propertiesMap,scope),scope.itemlabel=scope.itemlabel||scope.displayfield,CONSTANTS.isRunMode&&newVal&&(scope.menuItems=getMenuItems(newVal.data||newVal,scope));break;case"linktarget":scope.linktarget=newVal;break;case"menuposition":switch(newVal){case POSITION.DOWN_RIGHT:element.removeClass("dropup"),scope.menualign="pull-left";break;case POSITION.DOWN_LEFT:element.removeClass("dropup"),scope.menualign="pull-right";break;case POSITION.UP_LEFT:element.addClass("dropup"),scope.menualign="pull-right";break;case POSITION.UP_RIGHT:element.addClass("dropup"),scope.menualign="pull-left";break;case POSITION.INLINE:scope.menualign="dropinline-menu"}}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.menu",["wm.base.editors","wm.menu.dataProps"]),notifyFor={iconname:!0,scopedataset:!0,dataset:!0,menuposition:!0,linktarget:!0},POSITION={DOWN_RIGHT:"down,right",DOWN_LEFT:"down,left",UP_RIGHT:"up,right",UP_LEFT:"up,left",INLINE:"inline"};return{restrict:"E",scope:{scopedataset:"=?",onSelect:"&"},template:function(tElement,tAttrs){var template="";return template=tAttrs.type&&"anchor"===tAttrs.type?WM.element($templateCache.get("template/widget/form/anchormenu.html")):WM.element($templateCache.get("template/widget/form/menu.html")),template[0].outerHTML},replace:!0,transclude:!0,compile:function(tElement){return{pre:function(iScope,element,attrs){!attrs.iconclass&&attrs.iconname&&(WM.element(tElement.context).attr("iconclass","glyphicon glyphicon-"+attrs.iconname),attrs.iconclass="glyphicon glyphicon-"+attrs.iconname),"up"===attrs.dropposition?attrs.menuposition===POSITION.DOWN_RIGHT?attrs.menuposition=POSITION.UP_RIGHT:attrs.menuposition===POSITION.DOWN_LEFT&&(attrs.menuposition=POSITION.UP_LEFT):"down"===attrs.dropposition&&(attrs.menuposition===POSITION.UP_RIGHT?attrs.menuposition=POSITION.DOWN_RIGHT:attrs.menuposition===POSITION.UP_LEFT&&(attrs.menuposition=POSITION.DOWN_LEFT)),CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){var onPropertyChange=propertyChangeHandler.bind(void 0,scope,element);WidgetUtilService.registerPropertyChangeListener(onPropertyChange,scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs),!scope.widgetid&&attrs.scopedataset&&$timeout(function(){scope.$watch("scopedataset",function(newVal){onPropertyChange("scopedataset",newVal)})},0,!0)}}}}}]).directive("wmMenuDropdown",["$templateCache",function($templateCache){"use strict";return{restrict:"E",replace:!0,scope:{items:"=",menualign:"=",linktarget:"="},template:$templateCache.get("template/widget/form/menu/dropdown.html"),compile:function(){return{post:function(scope){scope.onSelect=function(args){args.$scope.item.link||scope.$parent.onSelect(args)}}}}}}]).directive("wmMenuDropdownItem",["$templateCache","$compile","CONSTANTS",function($templateCache,$compile,CONSTANTS){"use strict";return{restrict:"E",replace:!0,scope:{item:"=",menualign:"=",linktarget:"="},template:function(){var template=WM.element($templateCache.get("template/widget/form/menu/dropdownItem.html"));return CONSTANTS.isStudioMode||template.attr("data-ng-click","onSelect({$event: $event, $scope: this, $item: item.value || item.label })"),
template[0].outerHTML},link:function(scope,element){scope.item.children&&scope.item.children.length>0&&(element.append('<wm-menu-dropdown items="item.children"  linktarget="linktarget" menualign="menualign"/>'),element.off("click"),$compile(element.contents())(scope)),scope.onSelect=function(args){args.$scope.item.link||scope.$parent.onSelect(args)}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/slider.html",'<div class="app-slider slider" init-widget has-model data-ng-show="show" title="{{hint}}" apply-styles><span class="app-slider-value">{{minvalue}}</span><span class="app-slider-value pull-right">{{maxvalue}}</span><input class="range-input" type="range" title="{{_model_}}" min="{{minvalue}}" max="{{maxvalue}}" step="{{step}}" data-ng-model="_model_" data-ng-disabled="disabled" data-ng-change="_onChange({$event: $event, $scope: this})" /><div data-ng-show="readonly || disabled" class="readonly-wrapper"></div></div>')}]).directive("wmSlider",["PropertiesFactory","$templateCache","WidgetUtilService",function(PropertiesFactory,$templateCache,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.slider",["wm.base","wm.base.editors","wm.base.events.change"]);return{restrict:"E",replace:!0,scope:{onChange:"&"},template:function(tElement,tAttrs){var template=WM.element($templateCache.get("template/widget/form/slider.html"));return template.find("input").attr("name",tAttrs.name),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/checkbox.html",'<div class="app-checkbox checkbox" data-ng-class="{\'app-toggle\' : (type === \'toggle\')}" init-widget has-model data-ng-show="show" title="{{hint}}"><label data-ng-class="{\'disabled\':disabled,\'unchecked\': (_model_=== uncheckedvalue || _model_ === false)}" apply-styles><input type="checkbox"  data-ng-model="_model_" data-ng-readonly="readonly"  data-ng-required="required" data-ng-disabled="disabled"  data-ng-change="_onChange({$event: $event, $scope: this})"></input><span class="caption">{{caption || "&nbsp;"}}</span><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="switch"/></label><input type="hidden" class="ng-hide model-holder" data-ng-disabled="disabled" value="{{_model_}}"></div>')}]).directive("wmCheckbox",["PropertiesFactory","WidgetUtilService","CONSTANTS","$templateCache",function(PropertiesFactory,WidgetUtilService,CONSTANTS,$templateCache){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"startchecked":newVal=newVal===!0||"true"===newVal,CONSTANTS.isStudioMode?scope.datavalue=newVal?scope.checkedvalue||!0:!1:scope.datavalue=newVal?scope.checkedvalue||!0:scope.datavalue;break;case"readonly":scope.disabled=newVal}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.checkbox",["wm.base","wm.base.editors","wm.base.editors.abstracteditors"]),notifyFor={startchecked:!0,readonly:!0};return{restrict:"E",scope:{},replace:!0,template:function(tElement,tAttrs){var checkbox,template=WM.element($templateCache.get("template/widget/form/checkbox.html")),isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid");return checkbox=template.find("input[type=checkbox]"),tAttrs.checkedvalue&&checkbox.attr("data-ng-true-value","'"+tAttrs.checkedvalue+"'"),tAttrs.uncheckedvalue&&checkbox.attr("data-ng-false-value","'"+tAttrs.uncheckedvalue+"'"),isWidgetInsideCanvas||(tAttrs.hasOwnProperty("onClick")&&template.attr("data-ng-click","onClick({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseenter")&&template.attr("data-ng-mouseenter","onMouseenter({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseleave")&&template.attr("data-ng-mouseleave","onMouseleave({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onFocus")&&checkbox.attr("data-ng-focus","onFocus({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onBlur")&&checkbox.attr("data-ng-blur","onBlur({$event: $event, $scope: this})")),template.find(".model-holder").attr("name",tAttrs.name),template[0].outerHTML},compile:function(){return{pre:function(scope,element,attrs){scope.widgetProps=widgetProps,attrs.datavalue||attrs.scopedatavalue||(scope._model_=attrs.uncheckedvalue||!1)},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/checkboxset.html",'<ul class="app-checkboxset list-group {{layout}}" init-widget has-model apply-styles title="{{hint}}"  data-ng-model="_model_" data-ng-show="show"  data-ng-change="_onChange({$event: $event, $scope: this})"></ul>')}]).directive("wmCheckboxset",["PropertiesFactory","WidgetUtilService","$compile","CONSTANTS","Utils",function(PropertiesFactory,WidgetUtilService,$compile,CONSTANTS,Utils){"use strict";function getDisplayField(dataSet,changedDisplayField){var displayField=changedDisplayField;return displayField&&"All Fields"!==displayField||(WM.isArray(dataSet)&&dataSet.length>0?displayField=WM.isObject(dataSet[0])?Object.keys(dataSet[0])[0]:"":WM.isObject(dataSet)&&(displayField="")),displayField}function parseDataSet(dataSet,scope,changedDisplayField,changedDataField,useKeys,element){var parsedData,data=dataSet,dataField=changedDataField,objectKeys=[],displayField=getDisplayField(dataSet,changedDisplayField),showAllKeys=CONSTANTS.isStudioMode&&"chart-columns"===element.attr("data-identifier");return scope.widgetProps.displayfield.value=displayField,WM.isArray(dataSet)?useKeys?(data={},objectKeys=showAllKeys&&Utils.isValidDataSet(dataSet)?WidgetUtilService.extractDataSetFields(dataSet,scope.dataset.propertiesMap):WM.isObject(dataSet[0])?Object.keys(dataSet[0]):[],WM.forEach(objectKeys,function(key){data[key]=key}),parsedData=data):(dataField&&(data={},"All Fields"!==dataField?WM.forEach(dataSet,function(option){data[WidgetUtilService.getEvaluatedData(scope,option,{fieldName:"displayfield",expressionName:"displayexpression"},displayField)]=option[dataField]}):WM.forEach(dataSet,function(option){data[WidgetUtilService.getEvaluatedData(scope,option,{fieldName:"displayfield",expressionName:"displayexpression"},displayField)]=option})),parsedData=data):WM.isObject(dataSet)&&(data={},objectKeys=showAllKeys&&Utils.isValidDataSet(dataSet)?WidgetUtilService.extractDataSetFields(dataSet,scope.dataset.propertiesMap):Object.keys(dataSet),WM.forEach(objectKeys,function(key){data[key]=key}),parsedData=data),parsedData}function updatePropertyPanelOptions(dataset,propertiesMap,scope){var variableKeys=[];dataset&&WM.isObject(dataset)&&(dataset=dataset[0]||dataset,variableKeys=WidgetUtilService.extractDataSetFields(dataset,propertiesMap)||[]),WM.forEach(variableKeys,function(variableKey,index){(null===dataset[variableKey]||WM.isObject(dataset[variableKey]))&&variableKeys.splice(index,1)}),scope.newcolumns&&(scope.newcolumns=!1,scope.datafield="All Fields",scope.displayfield="",scope.$root.$emit("set-markup-attr",scope.widgetid,{datafield:"",displayfield:""})),scope.widgetProps.datafield.options=["","All Fields"].concat(variableKeys),scope.widgetProps.displayfield.options=[""].concat(variableKeys)}function assignModelValue(scope,dataSet,checkboxValue){var selectedValues=[];checkboxValue?selectedValues.push(checkboxValue):scope.selectedvalues?(WM.isString(scope.selectedvalues)&&""!==scope.selectedvalues?selectedValues=scope.selectedvalues.split(","):WM.isArray(scope.selectedvalues)&&(selectedValues=scope.selectedvalues),scope._model_=[]):(selectedValues&&0!==selectedValues.length||WM.isDefined(scope._model_))&&WM.isDefined(scope._model_)?scope._model_=WM.isArray(scope._model_)?scope._model_:[scope._model_]:scope._model_=[],WM.forEach(selectedValues,function(value){value=WM.isString(value)?value.trim():value,WM.isString(dataSet)?scope._model_.push(value):WM.isArray(dataSet)?WM.isObject(dataSet[0])?scope._model_.push(scope.dataObject[value]):scope._model_.push(value):checkboxValue?scope._model_.push(scope.dataObject[value]):scope._model_.push(value)})}function createDataKeys(scope,dataSet){WM.isArray(dataSet)?WM.isObject(dataSet[0])?(WM.forEach(dataSet,function(data){scope.dataObject[data.name]="",scope.dataObject[data.name]=data.dataValue}),scope.dataKeys=Object.keys(scope.dataObject)):(scope.dataObject=dataSet,scope.dataKeys=dataSet):WM.isString(dataSet)?(scope.dataObject=dataSet,scope.dataKeys=scope.dataObject.split(",")):WM.isObject(dataSet)&&(scope.dataObject=dataSet,scope.dataKeys=Object.keys(scope.dataObject))}function createWidgetTemplate(scope){var template="";return WM.forEach(scope.dataKeys,function(dataKey){dataKey=WM.isString(dataKey)?dataKey.trim():dataKey,template=template+'<li class="checkbox app-checkbox"  data-ng-class="itemclass"><label class="app-checkboxset-label" data-ng-class="{\'disabled\':disabled, \'unchecked\': !valueInModel(_model_, dataObject[\''+dataKey+'\'])}" title="'+dataKey+'"><input type="checkbox" '+(scope.disabled?' disabled="disabled" ':"")+' value="'+dataKey+'" data-ng-checked="_model_.indexOf(\''+dataKey+"') !== -1 || _model_ === '"+dataKey+"' || valueInModel(_model_, dataObject['"+dataKey+'\'])"/><span class="caption">'+dataKey+'</span><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="switch"/></label></li>'}),template+='<input name="{{name}}" data-ng-disabled="disabled" data-ng-hide="true" class="model-holder" data-ng-model="_model_"><div data-ng-if="readonly || disabled" class="readonly-wrapper"></div>'}function constructCheckboxSet(scope,element,dataSet){var template,compiledTemplate,parseData,useKeys=scope.usekeys;scope.dataObject={},scope.dataKeys=[],dataSet=dataSet?dataSet.data||dataSet:[],parseData=WM.isString(scope.dataset||scope.scopedataset)||WM.isArray(scope.dataset)&&!WM.isObject(scope.dataset[0])||WM.isArray(scope.scopedataset)&&!WM.isObject(scope.scopedataset[0])?!1:!0,parseData&&(dataSet=parseDataSet(dataSet,scope,scope.displayfield,scope.datafield,useKeys,element)),createDataKeys(scope,dataSet),assignModelValue(scope,dataSet),template=createWidgetTemplate(scope),compiledTemplate=$compile(template)(scope),element.empty().append(compiledTemplate),element.find(".app-checkboxset-label").on("click",function(evt){var checkedOption,inputElements=element.find("input:checked");scope._model_=[],inputElements.each(function(){checkedOption=WM.element(this).val(),assignModelValue(scope,dataSet,checkedOption)}),CONSTANTS.isStudioMode&&(scope.selectedvalues=scope._model_.join(",")),Utils.triggerFn(scope._onChange,evt),scope.$root.$safeApply(scope)})}function propertyChangeHandler(scope,element,key,newVal){var dataSet,newDataset=Utils.getValidJSON(scope.dataset),validNewVal=Utils.getValidJSON(newVal);switch(newDataset&&(scope.dataset=newDataset),validNewVal&&(newVal=validNewVal),dataSet=scope.dataset||scope.scopedataset,key){case"dataset":scope.widgetid&&WM.isDefined(newVal)&&null!==newVal&&updatePropertyPanelOptions(newVal.data||newVal,newVal.propertiesMap,scope),constructCheckboxSet(scope,element,newVal);break;case"displayfield":case"datafield":case"usekeys":case"selectedvalues":constructCheckboxSet(scope,element,dataSet);break;case"disabled":element.find('input[type="checkbox"]').attr("disabled",newVal)}}function valueInModel(model,value){return value&&WM.isArray(model)&&model.some(function(el){return WM.equals(value,el)})}var widgetProps=PropertiesFactory.getPropertiesOf("wm.checkboxset",["wm.base","wm.booleaneditors"]),notifyFor={dataset:!0,displayfield:!0,datafield:!0,usekeys:!0,selectedvalues:!0,disabled:!0};return{restrict:"E",scope:{scopedataset:"=?"},replace:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/form/checkboxset.html"),compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),attrs.widgetid||scope.$watch("scopedataset",function(){if(scope.scopedataset){var newScopeDataset=Utils.getValidJSON(scope.scopedataset);newScopeDataset&&(scope.scopedataset=newScopeDataset),constructCheckboxSet(scope,element,scope.scopedataset)}},!0),scope.valueInModel=valueInModel,WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").requires=WM.module("wm.widgets.form").requires.concat(["colorpicker.module"]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/colorpicker.html",'<div class="input-group app-colorpicker" data-ng-show="show" init-widget has-model><input colorpicker colorpicker-parent="true" class="form-control app-textbox"  data-ng-disabled="readonly || disabled" data-ng-required="required" data-ng-model="_model_" data-ng-change="_onChange({$event: $event, $scope: this})"><span class="input-group-addon" data-ng-style="{backgroundColor:_model_}">&nbsp;</span></div>')}]).directive("wmColorpicker",["PropertiesFactory","$templateCache","WidgetUtilService",function(PropertiesFactory,$templateCache,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.colorpicker",["wm.base","wm.base.events","wm.base.events.focus","wm.base.events.change"]);return{restrict:"E",scope:{},replace:!0,template:function(tElement,tAttrs){var isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),template=WM.element($templateCache.get("template/widget/form/colorpicker.html")),target=template.children().first();return template.find("input").attr("name",tAttrs.name),isWidgetInsideCanvas||(tAttrs.hasOwnProperty("onClick")&&target.attr("data-ng-click","onClick({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseenter")&&target.attr("data-ng-mouseenter","onMouseenter({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseleave")&&target.attr("data-ng-mouseleave","onMouseleave({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onFocus")&&target.attr("data-ng-focus","onFocus({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onBlur")&&target.attr("data-ng-blur","onBlur({$event: $event, $scope: this})")),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/composite.html",'<div class="form-group app-composite-widget clearfix" init-widget apply-styles="container" '+" data-ng-class=\"{'caption-left': captionposition == 'left','caption-right': captionposition == 'right','caption-top': captionposition == 'top'}\" title=\"{{hint}}\" data-ng-disabled=\"disabled\" data-ng-show=\"show\" wmtransclude></div>")}]).directive("wmComposite",["PropertiesFactory","$templateCache","WidgetUtilService",function(PropertiesFactory,$templateCache,WidgetUtilService){"use strict";function propertyChangeHandler(element,key,newVal){switch(key){case"required":var labelEle=element.find(".control-label.ng-isolate-scope"),inputEle=element.find(".form-control.ng-isolate-scope");WM.element(labelEle).isolateScope().required=newVal,WM.element(inputEle).isolateScope().required=newVal}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.composite",["wm.base","wm.layouts"]),notifyFor={required:!0};return{restrict:"E",replace:!0,transclude:!0,scope:{},template:$templateCache.get("template/widget/form/composite.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){if(WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,element),scope,notifyFor),!scope.widgetid){var inputName,labelEl=element.find("label"),inputEl=element.find("input, select, textarea");1===labelEl.length&&1===inputEl.length&&(inputName=inputEl.attr("name"),inputEl.attr("id",inputName),labelEl.attr("for",inputName))}WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/currency.html",'<div init-widget has-model class="input-group app-currency" data-ng-show="show"><span class="input-group-addon">{{currencysymbol}}</span><input type="number" class="form-control app-textbox app-currency-input" title="{{hint}}" apply-styles data-ng-model="_model_" data-ng-readonly="readonly"  data-ng-required="required"  data-ng-disabled="disabled"  data-ng-change="_onChange({$event: $event, $scope: this})"></div>')}]).directive("wmCurrency",["PropertiesFactory","$templateCache","WidgetUtilService","$locale","CURRENCYCONSTANTS",function(PropertiesFactory,$templateCache,WidgetUtilService,$locale,CURRENCYCONSTANTS){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"currency":CURRENCYCONSTANTS[newVal]&&(scope.currencysymbol=CURRENCYCONSTANTS[newVal].symbol)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.currency",["wm.base","wm.base.editors.abstracteditors"]),notifyFor={currency:!0};return{restrict:"E",replace:!0,scope:{},template:function(tElement,tAttrs){var isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),template=WM.element($templateCache.get("template/widget/form/currency.html")),target=template.children().last();return target.attr("name",tAttrs.name),isWidgetInsideCanvas||(tAttrs.hasOwnProperty("minvalue")&&target.attr("min","{{minvalue}}"),tAttrs.hasOwnProperty("maxchars")&&target.attr("maxlength","{{maxchars}}"),tAttrs.hasOwnProperty("maxvalue")&&target.attr("max","{{maxvalue}}"),tAttrs.hasOwnProperty("onClick")&&target.attr("data-ng-click","onClick({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseenter")&&target.attr("data-ng-mouseenter","onMouseenter({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseleave")&&target.attr("data-ng-mouseleave","onMouseleave({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onFocus")&&target.attr("data-ng-focus","onFocus({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onBlur")&&target.attr("data-ng-blur","onBlur({$event: $event, $scope: this})")),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){scope.$locale=$locale,WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/date.html",'<div class="app-date input-group" init-widget has-model data-ng-show="show"><input class="form-control app-textbox app-dateinput" datepicker-popup={{datepattern}} apply-styles  title="{{hint}}"  min-date=mindate max-date=maxdate is-open=isOpen data-ng-model="_proxyModel"  data-ng-readonly="readonly"  data-ng-required="required"  data-ng-disabled="disabled"  data-ng-change="_onChange({$event: $event, $scope: this})"></input><input class="model-holder ng-hide" data-ng-disabled="disabled" data-ng-model="_model_"><span class="input-group-btn"><button type="button" class="btn btn-default btn-date"><i class="glyphicon glyphicon-calendar"></i></button></span></div>')}]).directive("wmDate",["PropertiesFactory","WidgetUtilService","$templateCache","$filter",function(PropertiesFactory,WidgetUtilService,$templateCache,$filter){"use strict";function propertyChangeHandler(scope,element,key,newVal){switch(key){case"readonly":case"disabled":element.css("pointer-events",newVal?"none":"all");break;case"mindate":case"maxdate":newVal&&!isNaN(newVal)&&WM.isString(newVal)&&(scope[key]=new Date(parseInt(newVal,10)))}}function getTimeStamp(val){var epoch;return val&&(WM.isDate(val)?epoch=val.getTime():(isNaN(val)||(val=parseInt(val,10)),epoch=new Date(val).getTime(),epoch=isNaN(epoch)?void 0:epoch)),epoch}function _onClick(scope,evt){evt.stopPropagation(),scope.isOpen=!scope.isOpen,scope.onClick&&scope.onClick({$event:evt,$scope:scope})}var widgetProps=PropertiesFactory.getPropertiesOf("wm.date",["wm.base","wm.base.editors.abstracteditors","wm.base.datetime"]),notifyFor={readonly:!0,disabled:!0,mindate:!0,maxdate:!0};return{restrict:"E",replace:!0,scope:{},template:function(tElement,tAttrs){var isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),template=WM.element($templateCache.get("template/widget/form/date.html")),target=template.children("input.form-control");return template.find(".model-holder").attr("name",tAttrs.name),isWidgetInsideCanvas||(template.find(".btn-date").attr("data-ng-click","_onClick($event)"),template.find(".app-dateinput").attr("data-ng-click","_onClick($event)"),tAttrs.hasOwnProperty("onMouseenter")&&template.attr("data-ng-mouseenter","onMouseenter({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseleave")&&template.attr("data-ng-mouseleave","onMouseleave({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onFocus")&&target.attr("data-ng-focus","onFocus({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onBlur")&&target.attr("data-ng-blur","onBlur({$event: $event, $scope: this})")),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),scope._onClick=_onClick.bind(void 0,scope),WidgetUtilService.postWidgetCreate(scope,element,attrs),Object.defineProperty(scope,"_model_",{get:function(){return"timestamp"===this.outputformat?this._proxyModel?this._proxyModel.valueOf():void 0:(this.outputformat||(this.outputformat="yyyy-MM-dd"),this._proxyModel?$filter("date")(this._proxyModel,this.outputformat):void 0)},set:function(val){this._proxyModel=getTimeStamp(val)}}),attrs.datavalue&&(scope._model_=attrs.datavalue),attrs.datavalue||attrs.scopedatavalue||(scope._model_=Date.now())}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/datetime.html",'<div class="app-datetime input-group" init-widget has-model apply-styles  title="{{hint}}" data-ng-show="show" data-ng-model="_proxyModel"><input class="form-control app-textbox display-input" data-ng-model="_displayModel"><input class="form-control app-textbox app-dateinput ng-hide" data-ng-change="selectDate($event)" data-ng-model="_dateModel" datepicker-popup min-date=mindate max-date=maxdate is-open="isDateOpen"><div dropdown is-open="isTimeOpen" class="dropdown"><div class="dropdown-menu"><timepicker data-ng-model="_timeModel" hour-step="hourstep" minute-step="minutestep" show-meridian="ismeridian" data-ng-change="selectTime($event)"></timepicker></div></div><input class="model-holder ng-hide" data-ng-disabled="disabled" data-ng-model="_model_"><span class="input-group-btn"><button type="button" class="btn btn-default btn-date"><i class="glyphicon glyphicon-calendar"></i></button><button type="button" class="btn btn-default btn-time dropdown-toggle"><i class="glyphicon glyphicon-time"></i></button></span></div>')}]).directive("wmDatetime",["PropertiesFactory","WidgetUtilService","$timeout","$templateCache","$filter",function(PropertiesFactory,WidgetUtilService,$timeout,$templateCache,$filter){"use strict";function propertyChangeHandler(element,key,newVal){var inputEl=element.find("input"),buttonEl=element.find("button");switch(key){case"readonly":case"disabled":inputEl.attr(key,newVal),buttonEl.attr("disabled",newVal),element.css("pointer-events",newVal?"none":"all");break;case"autofocus":inputEl.first().attr(key,newVal)}}function _onClick(scope,evt){evt.stopPropagation(),scope.onClick&&scope.onClick({$event:evt,$scope:scope})}function _onDateClick(scope,evt){evt.stopPropagation(),scope.isDateOpen=!scope.isDateOpen,scope.isTimeOpen=!1}function _onTimeClick(scope,evt){evt.stopPropagation(),scope.isTimeOpen=!scope.isTimeOpen,scope.isDateOpen=!1}var widgetProps=PropertiesFactory.getPropertiesOf("wm.datetime",["wm.base","wm.base.editors.abstracteditors","wm.base.datetime"]),notifyFor={readonly:!0,disabled:!0,autofocus:!0};return{restrict:"E",replace:!0,scope:{},template:function(tElement,tAttrs){var template=WM.element($templateCache.get("template/widget/form/datetime.html",tElement,tAttrs)),isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),target=template.children("input.form-control");return template.find(".model-holder").attr("name",tAttrs.name),isWidgetInsideCanvas||(template.attr("data-ng-click","_onClick($event)"),template.find(".btn-date").attr("data-ng-click","_onDateClick($event)"),template.find(".display-input").attr("data-ng-click","_onDateClick($event)"),template.find(".btn-time").attr("data-ng-click","_onTimeClick($event)"),tAttrs.hasOwnProperty("onMouseenter")&&template.attr("data-ng-mouseenter","onMouseenter({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseleave")&&template.attr("data-ng-mouseleave","onMouseleave({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onFocus")&&target.attr("data-ng-focus","onFocus({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onBlur")&&target.attr("data-ng-blur","onBlur({$event: $event, $scope: this})")),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){var onPropertyChange=propertyChangeHandler.bind(void 0,element);WidgetUtilService.registerPropertyChangeListener(onPropertyChange,scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs),scope.formatDateTime=function(){var date,time,dateString,timeString,value;scope._timeModel||scope._dateModel?(time=scope._timeModel?new Date(scope._timeModel):new Date,date=scope._dateModel?new Date(scope._dateModel):new Date,dateString=$filter("date")(date,"yyyy-MM-dd"),timeString=$filter("date")(time,"HH:mm"),value=moment(dateString+" "+timeString).valueOf(),scope.datepattern&&"timestamp"!==scope.datepattern?scope._displayModel=$filter("date")(value,scope.datepattern):scope._displayModel=value,scope.outputformat&&"timestamp"!==scope.outputformat?scope._proxyModel=$filter("date")(value,scope.outputformat):scope._proxyModel=value):(scope._displayModel=void 0,scope._proxyModel=void 0)},scope._onClick=_onClick.bind(void 0,scope),scope._onDateClick=_onDateClick.bind(void 0,scope),scope._onTimeClick=_onTimeClick.bind(void 0,scope),scope.selectDate=function(event){scope.isDateOpen&&(scope.isTimeOpen=!0),scope.formatDateTime(),scope._onChange({$event:event,$scope:scope})},scope.selectTime=function(event){scope.formatDateTime(),scope._onChange({$event:event,$scope:scope})},$timeout(function(){onPropertyChange("disabled",scope.disabled),onPropertyChange("readonly",scope.readonly)}),Object.defineProperty(scope,"_model_",{get:function(){return this._proxyModel},set:function(val){isNaN(val)||(val=parseInt(val,10));var dateTime=new Date(val);dateTime.getTime()?this._proxyModel=this._dateModel=this._timeModel=dateTime.getTime():this._proxyModel=this._dateModel=this._timeModel=void 0,scope.formatDateTime()}}),attrs.datavalue||attrs.scopedatavalue||(scope._model_=Date.now()),attrs.datavalue&&(scope._model_=attrs.datavalue)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/fileupload.html",'<div data-ng-show="show" class="app-fileupload" init-widget apply-styles="shell"><div data-ng-show="multiple" class="app-multi-file-upload"><div class="drop-box" drag-files="onFileSelect($event,$files)"><i class="{{iconclass}}"/><div class="message"><label data-ng-bind="fileuploadtitle"></label><form class="form-horizontal" name="{{multipleFileFormName}}"><input class="file-input" type="file" name="files" on-file-select="onFileSelect($event, $files)" data-ng-attr-accept="{{chooseFilter}}" multiple><a href="javascript:void(0);" class="app-anchor" data-ng-bind="fileuploadmessage"></a></form></div></div></div><div class="app-single-file-upload" data-ng-hide="multiple"><div class="app-button-wrapper"><form class="form-horizontal" name="{{singleFileFormName}}"><input class="file-input" type="file"  name="files" on-file-select="uploadSingleFile($event, $files)" data-ng-attr-accept="{{chooseFilter}}"><button class="app-button btn btn-default"><i class="{{iconclass}}"></i> <span>{{caption}}</span></button></form></div><div class="app-files-upload-status single"></div></div><div class="app-files-upload-status multiple" data-ng-style="{height: height, overflow: overflow}" ><div class="upload-status"><label title="{{status_messsage}}" data-ng-bind="status_messsage" data-ng-show="showStatusMessage"></label><div class="progress" data-ng-show="showProgress"><div class="progress-bar progress-bar-info progress-bar-striped" data-ng-style="{width:progressWidth}"></div></div></div><div class="status" data-ng-repeat="file in uploadedFiles" data-ng-show="isValidFiles()"><div class="action"><span class="badge" data-ng-bind="file.extension"></span></div><div class="name" title="{{file.fileName}}" data-ng-bind="file.fileName"></div><div class="size" title="{{file.length}}" data-ng-if="file.length !== 0" data-ng-bind="file.length | suffix: \' bytes\'"></div><span class="state glyphicon" data-ng-class="{\'glyphicon-ok\' : file.status === \'success\', \'glyphicon-remove\' : file.status === \'Fail\'}"></span><span data-ng-show="{{file.state === \'success\'}}" title="{{file.errorMessage}}">{{file.errorMessage}}</span></div><div class="action" data-ng-if="isAbortVisible"><button class="cancel glyphicon glyphicon-remove" title="Cancel" data-ng-click="abortUpload()"></button></div></div></div>')}]).directive("onFileSelect",["$parse","$timeout",function($parse,$timeout){"use strict";return function(scope,elem,attrs){var fn=$parse(attrs.onFileSelect);elem.bind("change",function(evt){var fileList,i,files=[];if(window.FormData){if(fileList=evt.target.files,null!==fileList.length)for(i=0;i<fileList.length;i+=1)files[i]=fileList.item(i)}else files=[this.value];$timeout(function(){fn(scope,{$files:files,$event:evt})})}),elem.bind("click",function(){this.value=null})}}]).directive("dropAvailable",["$parse","$timeout",function($parse,$timeout){"use strict";return function(scope,elem,attrs){if(document.createElement("span").hasOwnProperty("draggable")){var fn=$parse(attrs.dropAvailable);$timeout(function(){fn(scope)})}}}]).directive("dragFiles",["$parse","$timeout",function($parse,$timeout){"use strict";return function(scope,elem,attrs){var fn,div=document.createElement("div"),dragDropSupport="draggable"in div||"ondragstart"in div&&"ondrop"in div;dragDropSupport&&(fn=$parse(attrs.dragFiles),elem.bind("dragenter",function(evt){evt.preventDefault()}),elem.bind("dragover",function(evt){evt.stopPropagation(),evt.preventDefault(),elem.addClass("file-dragover")}),elem.bind("dragleave",function(){elem.removeClass("file-dragover")}),elem.bind("drop",function(evt){evt.stopPropagation(),evt.preventDefault(),elem.removeClass("file-dragover");var i,files=[],fileList=evt.originalEvent.dataTransfer.files;if(null!==fileList)for(i=0;i<fileList.length;i+=1)files.push(fileList.item(i));$timeout(function(){fn(scope,{$files:files,$event:evt})})}))}}]).directive("wmFileupload",["PropertiesFactory","$templateCache","WidgetUtilService","$compile","$timeout","wmToaster","Utils","Variables","ServiceFactory","$rootScope","VARIABLE_CONSTANTS","$servicevariable","CONSTANTS","DialogService",function(PropertiesFactory,$templateCache,WidgetUtilService,$compile,$timeout,wmToaster,Utils,Variables,ServiceFactory,$rootScope,VARIABLE_CONSTANTS,$servicevariable,CONSTANTS,DialogService){
"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.fileupload",["wm.base","wm.base.editors","wm.base.events.successerror"]),selectedUploadTypePath="resources",notifyFor={uploadpath:!0,contenttype:!0,service:!0,operation:!0};return{restrict:"E",replace:!0,scope:{onSelect:"&",onSuccess:"&",onError:"&",onProgress:"&",onAbort:"&"},template:$templateCache.get("template/widget/form/fileupload.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){function propertyChangeHandler(key,newVal){switch(key){case"uploadpath":scope.changeServerUploadPath(newVal);break;case"contenttype":changeFilter(newVal);break;case"service":CONSTANTS.isStudioMode&&!isPrefabInsideProject&&(operations=[],ServiceFactory.getServiceOperations(scope.service,function(response){WM.forEach(response,function(operation){operations.push(operation.name)}),scope.widgetProps.operation.options=operations,scope.service===CONSTANT_FILE_SERVICE?scope.operation="uploadFile":scope.operation=""}));break;case"operation":CONSTANTS.isStudioMode&&!isPrefabInsideProject&&scope.service&&scope.operation&&createVariable(scope.service,scope.operation)}}var handlers=[],services=[],isPrefabInsideProject=!1,fetchServices=function(serviceId){services=[],CONSTANTS.isStudioMode&&isPrefabInsideProject||ServiceFactory.getServicesWithType(function(response){WM.forEach(response,function(service){services.push(service.name)}),scope.widgetProps.service.options=services,scope.service=serviceId})};handlers.push($rootScope.$on("update-fileupload",function(event,widgetId,serviceId){scope.widgetid===widgetId&&fetchServices(serviceId)})),scope.uploadData={file:void 0,uploadPath:void 0},scope.chooseFilter="",scope.singleFileFormName=scope.name+"-single-fileupload",scope.multipleFileFormName=scope.name+"-multiple-fileupload",scope.showStatusMessage=!1,scope.progressWidth="0%",scope.showProgress=!1,scope.isAbortVisible=!1,scope.isAborted=!1,scope.fileNameSeperator=";",scope.uploadedFiles={fileName:"",path:"",length:"",status:""},scope.reset=function(){scope.uploadedFiles=[],scope.status_messsage=""},CONSTANTS.isStudioMode&&scope.service&&fetchServices(scope.service),function(){var prefabScope,prefabName,parentPrefab=element.closest(".app-prefab");CONSTANTS.isStudioMode&&!scope.widgetid&&(isPrefabInsideProject=!0),parentPrefab&&(prefabScope=parentPrefab.isolateScope(),prefabName=prefabScope?prefabScope.prefabname:null),scope.uploadUrl=prefabName?"prefabs/"+prefabName:"services"}();var xhr,FILESIZE_MB=1048576,FILESIZE_KB=1024,MAXFILEUPLOAD_SIZE=31457280,MAX_FILE_UPLOAD_FORMATTED_SIZE="30MB",CONSTANT_FILE_SERVICE="FileService",operations=[],changeFilter=function(choosen){if(choosen.indexOf("all")>-1)scope.chooseFilter="";else{var filters=[];choosen.indexOf("image")>-1&&filters.push("image/*"),choosen.indexOf("audio")>-1&&filters.push("audio/*"),choosen.indexOf("video")>-1&&filters.push("video/*"),filters.length>0&&(scope.chooseFilter=filters.join())}},getFileSize=function(fileSize){var size;return size=fileSize>FILESIZE_MB?(Math.round(100*fileSize/FILESIZE_MB)/100).toString()+"MB":(Math.round(100*fileSize/FILESIZE_KB)/100).toString()+"KB"},wholeUploadContent=[],onFileSelect=function($event,$files){$timeout(function(){scope.onSelect({$event:WM.extend($event.$files||{},$files),$scope:scope})})},handleEvent=function(event,eventName,eventCallback,callbackParams){if(-1!==eventName.indexOf("("))eventCallback({$event:event,$scope:callbackParams});else{if(eventName.indexOf(".show")>-1)return void DialogService.showDialog(eventName.slice(0,eventName.indexOf(".show")));if(eventName.indexOf(".hide")>-1)return void DialogService.hideDialog(eventName.slice(0,eventName.indexOf(".hide")));$rootScope.$emit("invoke-service",eventName,{scope:element.scope()})}},onFail=function(evt){scope.$apply(function(){handleEvent(evt,attrs.onError||"",scope.onError),scope.isAbortVisible=!1,scope.status_messsage="Failed",scope.showProgress=!1}),scope.multiple===!1&&wmToaster.show("error","File upload failed")},handleError=function(evt){onFail(evt)},onError=function($event,$file){scope.onError({$event:WM.extend($event.$files||{},$file),$scope:scope})},getExtensionName=function(name){return name&&(name.lastIndexOf(".")>-1?name.substring(name.lastIndexOf(".")+1):"file")},onSuccess=function(evt){if(scope.filename="",scope.filepath="",window.FormData){var response,fileObject,name="";if(200!==evt.target.status)return void handleError(evt);if(response=Utils.getValidJSON(evt.target.response),response||(response=null),response&&response.result&&response.result.error)return evt.target.status=500,void handleError(evt);scope.multiple?WM.forEach(response,function(file,index){name=file.fileName,scope.filename+=name+";",file.extension=getExtensionName(name),scope.filepath+=file.path,index!==response.length-1&&(scope.filepath+=";"),file.status=file.success?"success":"fail"}):(fileObject=response[0],name=fileObject.fileName,fileObject.extension=getExtensionName(name),scope.filename=fileObject.name,scope.filepath=fileObject.path,fileObject.status=fileObject.success?"success":"fail"),scope.uploadedFiles=response}scope.$apply(function(){scope.status_messsage="Complete",scope.showProgress=!1,scope.isAbortVisible=!1,handleEvent(evt,attrs.onSuccess||"",scope.onSuccess,scope)}),scope.multiple===!1&&wmToaster.show("success","File Uploaded")},onProgress=function(evt){scope.$apply(function(){handleEvent(evt,attrs.onProgress||"",scope.onProgress),scope.isAbortVisible===!1&&(scope.isAbortVisible=!0),scope.showStatusMessage=!0,scope.showProgress=!0,scope.progressWidth=Math.round(100*evt.loaded/evt.total)+"%",scope.status_messsage="Uploading.."})},safeAbort=function(evt){handleEvent(evt,attrs.onAbort||"",scope.onAbort),scope.isAbortVisible=!1,scope.showStatusMessage=!0,scope.showProgress=!1,scope.status_messsage="Aborted"},onAbort=function(evt){$rootScope.$$phase||scope.$$phase?safeAbort(evt):scope.$apply(function(){safeAbort(evt)})},uploadContent=function(newVal){var uploadConfig,fd,uploadUrl,variableObject,completeUrl,fileName;if(xhr=void 0,scope.uploadedFiles=[],variableObject=Variables.filterByVariableKeys({service:scope.service,operation:scope.operation,category:"wm.ServiceVariable"},!0)[0],uploadUrl=variableObject?variableObject.wmServiceOperationInfo.relativePath:"/file/uploadFile",completeUrl=scope.uploadUrl+uploadUrl,scope.destination&&(completeUrl+="?relativePath="+scope.destination),window.FormData){if(void 0!==xhr)return;fd=new FormData,WM.isArray(newVal)?WM.forEach(newVal,function(fileObject){fileObject.file&&fileObject.uploadPath&&fd.append("files",fileObject.file,fileObject.file.name)}):WM.isObject(newVal)&&newVal.file&&newVal.uploadPath&&fd.append("files",newVal.file,newVal.file.name),xhr=new XMLHttpRequest,xhr.upload.addEventListener("progress",onProgress),xhr.addEventListener("load",onSuccess,null),xhr.addEventListener("error",onFail,null),xhr.addEventListener("abort",onAbort,null),xhr.open("POST",completeUrl),xhr.send(fd)}else fileName=newVal[0].file.split("\\").pop(),scope.uploadedFiles.push({fileName:fileName,extension:getExtensionName(fileName),length:0}),uploadConfig={url:completeUrl,formName:scope.multiple?scope.multipleFileFormName:scope.singleFileFormName},Utils.fileUploadFallback(uploadConfig,onSuccess,onFail)},uploadFile=function($evt,$file,statusContainer,isLastFile){var fileSize,uploadData={};return scope.isValidFile($file.name)?(fileSize=$file.size?getFileSize($file.size):"",$file.size>MAXFILEUPLOAD_SIZE?(onError($evt,$file),void wmToaster.show("error","FILE SIZE EXCEEDED LIMIT. MAX UPLOAD SIZE IS "+MAX_FILE_UPLOAD_FORMATTED_SIZE)):($file.formattedSize=fileSize,uploadData={file:$file,uploadPath:selectedUploadTypePath},wholeUploadContent.push(uploadData),void(isLastFile&&(scope.uploadData=wholeUploadContent,uploadContent(wholeUploadContent))))):(onError($evt,$file),void wmToaster.show("error","Expected a "+scope.contenttype+" file"))},getServiceType=function(service){return ServiceFactory.getServiceObjectByName(service).type},createVariable=function(service,operation){scope.$root.$emit("create-service-variable",service,getServiceType(service),operation)};WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler,scope,notifyFor),scope.fileUploadHandlers={onSuccess:onSuccess,onProgress:onProgress,onError:onFail,onAbort:onAbort},scope.changeServerUploadPath=function(path){selectedUploadTypePath=path},scope.abortUpload=function(){xhr.abort()},scope.onFileSelect=function($event,$files){var index,statusEle,last=!1,filesCount=$files.length;for(onFileSelect($event,$files),statusEle=element.find(".app-files-upload-status.multiple"),wholeUploadContent=[],index=0;filesCount>index;index+=1)index===filesCount-1&&(last=!0),uploadFile($event,$files[index],statusEle,last)},scope.isValidFile=function(filename){var isValid;switch(scope.contenttype){case"image":isValid=Utils.isImageFile(filename);break;case"audio":isValid=Utils.isAudioFile(filename);break;case"video":isValid=Utils.isVideoFile(filename);break;case"all":isValid=!0}return isValid},scope.uploadSingleFile=function($evt,$file){if($file.length){onFileSelect($evt,$file);var statusEle=element.find(".app-files-upload-status.single");statusEle.html(""),wholeUploadContent=[],uploadFile($evt,$file[0],statusEle,!0)}},scope.isValidFiles=function(){return WM.isArray(scope.uploadedFiles)&&scope.uploadedFiles.length},WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/radio.html",'<div class="radio app-radio" init-widget has-model data-ng-show="show" title="{{hint}}"><label apply-styles><input type="radio" class="app-radiobutton" value="{{checkedvalue}}" data-ng-model="_model_" data-ng-readonly="readonly"  data-ng-required="required"  data-ng-disabled="disabled"  data-ng-change="_onChange({$event: $event, $scope: this})" /><span class="caption">{{caption || "&nbsp;"}}</span></label></div>')}]).directive("wmRadio",["PropertiesFactory","WidgetUtilService","$templateCache",function(PropertiesFactory,WidgetUtilService,$templateCache){"use strict";function propertyChangeHandler(radtioBtn,key,newVal){switch(key){case"radiogroup":radtioBtn.attr("name",newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.radio",["wm.base","wm.base.editors","wm.base.editors.abstracteditors"]),notifyFor={height:!0,radiogroup:!0};return{restrict:"E",scope:{},replace:!0,template:function(tElement,tAttrs){var radioBtn,template=WM.element($templateCache.get("template/widget/form/radio.html")),isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid");return radioBtn=template.find("input[type=radio]"),isWidgetInsideCanvas||(tAttrs.hasOwnProperty("onClick")&&template.attr("data-ng-click","onClick({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseenter")&&template.attr("data-ng-mouseenter","onMouseenter({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseleave")&&template.attr("data-ng-mouseleave","onMouseleave({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onFocus")&&radioBtn.attr("data-ng-focus","onFocus({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onBlur")&&radioBtn.attr("data-ng-blur","onBlur({$event: $event, $scope: this})")),radioBtn.attr("name",tAttrs.name),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){var radtioBtn=element.find("input[type=radio]");WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,radtioBtn),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/radioset.html",'<ul class="app-radioset list-group {{layout}}" init-widget has-model apply-styles  title="{{hint}}" data-ng-model="_model_" data-ng-show="show" data-ng-change="_onChange({$event: $event, $scope: this})"></ul>')}]).directive("wmRadioset",["PropertiesFactory","WidgetUtilService","$compile","CONSTANTS","Utils",function(PropertiesFactory,WidgetUtilService,$compile,CONSTANTS,Utils){"use strict";function getDisplayField(dataSet,changedDisplayField){var displayField=changedDisplayField;return displayField&&"All Fields"!==displayField||(WM.isArray(dataSet)&&dataSet.length>0?displayField=WM.isObject(dataSet[0])?Object.keys(dataSet[0])[0]:"":WM.isObject(dataSet)&&(displayField="")),displayField}function parseDataSet(dataSet,scope,changedDisplayField,changedDataField,useKeys){var parsedData,data=dataSet,objectKeys=[],dataField=changedDataField,displayField=getDisplayField(dataSet,changedDisplayField);return scope.widgetProps.displayfield.value=displayField,WM.isArray(dataSet)&&(useKeys?(data={},objectKeys=WM.isObject(dataSet[0])?Object.keys(dataSet[0]):[],WM.forEach(objectKeys,function(key){data[key]=key}),parsedData=data):(dataField&&(data={},"All Fields"!==dataField?WM.forEach(dataSet,function(option){data[WidgetUtilService.getEvaluatedData(scope,option,{fieldName:"displayfield",expressionName:"displayexpression"},displayField)]=option[dataField]}):WM.forEach(dataSet,function(option){data[WidgetUtilService.getEvaluatedData(scope,option,{fieldName:"displayfield",expressionName:"displayexpression"},displayField)]=option})),parsedData=data)),parsedData}function updatePropertyPanelOptions(dataset,propertiesMap,scope){var variableKeys=[];dataset&&WM.isObject(dataset)&&(dataset=dataset[0]||dataset,variableKeys=WidgetUtilService.extractDataSetFields(dataset,propertiesMap)||[]),WM.forEach(variableKeys,function(variableKey,index){(null===dataset[variableKey]||WM.isObject(dataset[variableKey]))&&variableKeys.splice(index,1)}),scope.newcolumns&&(scope.newcolumns=!1,scope.datafield="All Fields",scope.displayfield="",scope.$root.$emit("set-markup-attr",scope.widgetid,{datafield:"",displayfield:""})),scope.widgetProps.datafield.options=["","All Fields"].concat(variableKeys),scope.widgetProps.displayfield.options=[""].concat(variableKeys)}function assignModelValue(scope,dataSet,radioValue){var selectedValue;selectedValue=radioValue||radioValue===!1?radioValue:scope.selectedvalue||(WM.isDefined(scope._model_)?scope._model_:""),WM.isString(dataSet)?scope._model_=selectedValue:WM.isArray(dataSet)?WM.isObject(dataSet[0])?scope._model_=scope.dataObject[selectedValue]:scope._model_=selectedValue:radioValue?scope._model_=scope.dataObject[selectedValue]:scope._model_=selectedValue}function createDataKeys(scope,dataSet){WM.isArray(dataSet)?WM.isObject(dataSet[0])?(WM.forEach(dataSet,function(data){scope.dataObject[data.name]=data.dataValue}),scope.dataKeys=Object.keys(scope.dataObject)):(scope.dataObject=dataSet,scope.dataKeys=dataSet):WM.isString(dataSet)?(scope.dataObject=dataSet,scope.dataKeys=dataSet.split(",").map(function(option){return option.trim()})):WM.isObject(dataSet)&&(scope.dataObject=dataSet,scope.dataKeys=Object.keys(scope.dataObject))}function createWidgetTemplate(scope){var template="";return WM.forEach(scope.dataKeys,function(dataKey,index){dataKey=WM.isString(dataKey)?dataKey.trim():dataKey,template=template+'<li class="radio app-radio" data-ng-class="itemclass"><label class="app-radioset-label"><input type="radio" '+(scope.disabled?' disabled="disabled" ':"")+"data-attr-index="+index+' ng-checked="checkModel('+index+')"/><span class="caption">'+dataKey+"</span></label></li>"}),template+='<input name="{{name}}" data-ng-disabled="disabled" data-ng-hide="true" class="model-holder" data-ng-model="_model_"><div data-ng-if="readonly || disabled" class="readonly-wrapper"></div>'}function getParsedDataSet(dataSet,scope){var parseData,useKeys=scope.usekeys;return dataSet=dataSet?dataSet.data||dataSet:[],parseData=WM.isString(scope.dataset||scope.scopedataset)||WM.isArray(scope.dataset)&&!WM.isObject(scope.dataset[0])||WM.isArray(scope.scopedataset)&&!WM.isObject(scope.scopedataset[0])?!1:!0,parseData&&(dataSet=parseDataSet(dataSet,scope,scope.displayfield,scope.datafield,useKeys)),dataSet}function constructRadioSet(scope,element,dataSet){var template,compiledTemplate;scope.dataObject={},scope.dataKeys=[],dataSet=getParsedDataSet(dataSet,scope),createDataKeys(scope,dataSet),assignModelValue(scope,dataSet),template=createWidgetTemplate(scope),compiledTemplate=$compile(template)(scope),element.empty().append(compiledTemplate),element.find(".app-radioset-label").on("click",function(evt){if(!scope.disabled&&!scope.readonly){var radioOption;radioOption=WM.element(this).find("input").attr("data-attr-index"),radioOption=scope.dataKeys[radioOption],assignModelValue(scope,dataSet,radioOption),Utils.triggerFn(scope._onChange,evt),scope.$root.$safeApply(scope)}})}function propertyChangeHandler(scope,element,key,newVal){var dataSet=scope.dataset||scope.scopedataset;switch(key){case"dataset":scope.widgetid&&WM.isDefined(newVal)&&null!==newVal&&updatePropertyPanelOptions(newVal.data||newVal,newVal.propertiesMap,scope),constructRadioSet(scope,element,newVal);break;case"displayfield":case"datafield":case"usekeys":constructRadioSet(scope,element,dataSet);break;case"selectedvalue":dataSet=getParsedDataSet(dataSet,scope),assignModelValue(scope,dataSet);break;case"disabled":element.find('input[type="radio"]').attr("disabled",newVal)}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.radioset",["wm.base","wm.booleaneditors"]),notifyFor={dataset:!0,displayfield:!0,datafield:!0,usekeys:!0,selectedvalue:!0,disabled:!0};return{restrict:"E",scope:{scopedataset:"=?"},replace:!0,template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/form/radioset.html"),compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element),scope,notifyFor),scope.$watch("scopedataset",function(){scope.scopedataset&&constructRadioSet(scope,element,scope.scopedataset)}),scope.checkModel=function(index){return scope._model_===scope.dataKeys[index]||WM.equals(scope._model_,scope.dataObject[scope.dataKeys[index]])},WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/select.html",'<select init-widget has-model class="form-control app-select" apply-styles  data-ng-model="modelProxy" title="{{hint}}" data-ng-show="show" data-ng-readonly="readonly"  data-ng-disabled="disabled" data-ng-required="required" data-ng-change="onChangeProxy({$event: $event, $scope: this})" data-ng-options="option.key as $root.locale[option.value] || option.value for option in selectOptions"><option selected disabled value="">{{placeholder}}</option></select>')}]).directive("wmSelect",["PropertiesFactory","WidgetUtilService","CONSTANTS",function(PropertiesFactory,WidgetUtilService,CONSTANTS){"use strict";function getKey(optionObject){var keys=Object.keys(optionObject);return 1===keys.length?keys[0]:"dataValue"}function getDisplayFieldKey(dataSet,scope){var displayField=scope.displayfield||scope.datafield;return displayField&&displayField!==ALLFIELDS||(WM.isArray(dataSet)&&dataSet.length>0?displayField=WM.isObject(dataSet[0])?Object.keys(dataSet[0])[0]:"":WM.isObject(dataSet)&&(displayField="")),displayField}function updateModelProxy(scope,_model_){_modelChangedManually[scope.$id]||(scope.datafield!==ALLFIELDS?scope.modelProxy=WM.isObject(_model_)?_model_:_model_&&_model_.toString():_dataSetModelMap[scope.$id]&&(scope.modelProxy=_dataSetModelMap[scope.$id][JSON.stringify(_model_)])),_modelChangedManually[scope.$id]=!1}function parseDataSet(dataSet,scope){var data=dataSet,dataField=scope.datafield,displayField=getDisplayFieldKey(dataSet,scope);return _dataSetModelProxyMap[scope.$id]={},_dataSetModelMap[scope.$id]={},dataField&&dataField!==ALLFIELDS?(data={},WM.forEach(dataSet,function(option){data[WidgetUtilService.getObjValueByKey(option,dataField)]=WidgetUtilService.getEvaluatedData(scope,option,{fieldName:"displayfield",expressionName:"displayexpression"},displayField)})):(data={},WM.forEach(dataSet,function(option,index){WM.isObject(option)?scope.datafield===ALLFIELDS?(data[index]=WidgetUtilService.getEvaluatedData(scope,option,{fieldName:"displayfield",expressionName:"displayexpression"},displayField),_dataSetModelProxyMap[scope.$id][index]=option,_dataSetModelMap[scope.$id][JSON.stringify(option)]=index.toString()):data[WidgetUtilService.getObjValueByKey(option,dataField)]=WidgetUtilService.getEvaluatedData(scope,option,{fieldName:"displayfield",expressionName:"displayexpression"},displayField):WM.isArray(dataSet)?data[option]=option:data[index]=option})),data}function createSelectOptions(dataset,scope,element){if(dataset){dataset=dataset.hasOwnProperty("data")?dataset.data:dataset;var key;dataset&&""!==dataset.dataValue&&(scope.selectOptions=[],WM.isArray(dataset)?(dataset=parseDataSet(dataset,scope),WM.isObject(dataset[0])?(key=getKey(dataset[0]),WM.forEach(dataset,function(option){scope.selectOptions.push({key:key,value:option.name||option[key]})})):WM.isArray(dataset)?WM.forEach(dataset,function(option){scope.selectOptions.push({key:option,value:option})}):WM.isObject(dataset)&&WM.forEach(dataset,function(val,key){scope.selectOptions.push({key:key,value:val})})):WM.isObject(dataset)?(dataset=parseDataSet(dataset,scope),WM.forEach(dataset,function(val,key){scope.selectOptions.push({key:key,value:val})})):WM.isString(dataset)?WM.forEach(dataset.split(","),function(opt){opt=opt.trim(),scope.selectOptions.push({key:opt,value:opt})}):scope.selectOptions.push({key:dataset,value:dataset}),updateModelProxy(scope,scope._model_))}}function updatePropertyPanelOptions(dataset,propertiesMap,scope){var variableKeys=[];dataset&&WM.isObject(dataset)&&(dataset=dataset[0]||dataset,variableKeys=WidgetUtilService.extractDataSetFields(dataset,propertiesMap)||[]),scope.newcolumns&&(scope.newcolumns=!1,scope.datafield="",scope.displayfield="",scope.$root.$emit("set-markup-attr",scope.widgetid,{datafield:scope.datafield,displayfield:scope.displayfield})),scope.widgetProps.datafield.options=["",ALLFIELDS].concat(variableKeys),scope.widgetProps.displayfield.options=[""].concat(variableKeys)}function propertyChangeHandler(scope,element,attrs,key,newVal){switch(key){case"dataset":scope.widgetid&&WM.isDefined(newVal)&&null!==newVal&&updatePropertyPanelOptions(newVal.data||newVal,newVal.propertiesMap,scope),createSelectOptions(scope.dataset,scope,element);break;case"multiple":attrs.$set("multiple",newVal);break;case"active":scope.widgetid&&scope.dataset&&newVal&&updatePropertyPanelOptions(scope.dataset.data||scope.dataset,scope.dataset.propertiesMap,scope)}}function onChangeProxy(scope,args){return scope.readonly?void(scope.modelProxy=scope._model_):(scope.datafield!==ALLFIELDS?scope._model_=scope.modelProxy:_dataSetModelProxyMap[scope.$id]&&(scope._model_=_dataSetModelProxyMap[scope.$id][scope.modelProxy]),_modelChangedManually[scope.$id]=!0,void scope._onChange({$event:args.$event,$scope:args.$scope}))}function scopeDatasetWatcher(scope,element){scope.widgetid&&updatePropertyPanelOptions(scope.scopedataset,scope),createSelectOptions(scope.scopedataset,scope,element)}var widgetProps=PropertiesFactory.getPropertiesOf("wm.select",["wm.base","wm.base.editors","wm.base.editors.abstracteditors","wm.base.editors.dataseteditors"]),notifyFor={dataset:!0,multiple:!0,active:!0},_dataSetModelProxyMap={},_dataSetModelMap={},_modelChangedManually={},ALLFIELDS="All Fields";return{restrict:"E",replace:!0,scope:{scopedataset:"=?"},template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/form/select.html"),compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(iScope,element,attrs){var scope=element.scope();scope.changeAppLocale=scope.$root.changeLocale,WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,iScope,element,attrs),iScope,notifyFor),attrs.widgetid||(iScope.$watch("scopedataset",scopeDatasetWatcher.bind(void 0,iScope,element)),iScope.$watch("_model_",updateModelProxy.bind(void 0,iScope))),iScope.onChangeProxy=onChangeProxy.bind(void 0,iScope),WidgetUtilService.postWidgetCreate(iScope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/text.html",'<input class="form-control app-textbox" init-widget has-model apply-styles title="{{hint}}"  data-ng-model="_model_" data-ng-readonly="readonly"  data-ng-required="required"  data-ng-disabled="disabled"  data-ng-show="show"  pattern="{{regexp}}" data-ng-change="_onChange({$event: $event, $scope: this})"></input>')}]).directive("wmText",["PropertiesFactory","WidgetUtilService","CONSTANTS",function(PropertiesFactory,WidgetUtilService,CONSTANTS){"use strict";function propertyChangeHandler(scope,attrs,key,newVal){switch(key){case"type":scope.widgetProps.datavalue.type="number"===newVal||"date"===newVal?newVal:"string",scope.widgetProps.accept.show="file"===newVal}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.text",["wm.base","wm.base.editors","wm.base.editors.abstracteditors"]),notifyFor={type:!0};return{restrict:"E",replace:!0,scope:{},template:function(tElement,tAttrs){var updateon,debounce,isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),template=WM.element(WidgetUtilService.getPreparedTemplate("template/widget/form/text.html",tElement,tAttrs));return isWidgetInsideCanvas||(updateon=tAttrs.updateon||"blur",debounce=tAttrs.updatedelay||0,template.attr("ng-model-options",'{ updateOn:"'+updateon+'", debounce: '+debounce+"}"),tAttrs.hasOwnProperty("maxchars")&&template.attr("maxlength","{{maxchars}}"),tAttrs.hasOwnProperty("minvalue")&&template.attr("min","{{minvalue}}"),tAttrs.hasOwnProperty("maxvalue")&&template.attr("max","{{maxvalue}}")),template[0].outerHTML},compile:function(){return{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,attrs),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/textarea.html",'<textarea init-widget has-model class="form-control app-textarea" apply-styles data-ng-model="_model_" title="{{hint}}" data-ng-show = "show"  data-ng-disabled="disabled"  data-ng-readonly="readonly" data-ng-required="required"  data-ng-change="_onChange({$event: $event, $scope: this})"></textarea>')}]).directive("wmTextarea",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.textarea",["wm.base","wm.base.editors","wm.base.editors.abstracteditors"]);return{restrict:"E",replace:!0,scope:{},template:function(tElement,tAttrs){var updateon,debounce,isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),template=WM.element(WidgetUtilService.getPreparedTemplate("template/widget/form/textarea.html",tElement,tAttrs));return isWidgetInsideCanvas||(updateon=tAttrs.updateon||"blur",debounce=tAttrs.updatedelay||0,template.attr("ng-model-options",'{ updateOn:"'+updateon+'", debounce: '+debounce+"}"),tAttrs.hasOwnProperty("maxchars")&&template.attr("maxlength","{{maxchars}}")),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/form/time.html",'<div class="app-timeinput input-group dropdown" dropdown init-widget has-model apply-styles  title="{{hint}}"  data-ng-model="_proxyModel" data-ng-show="show"  data-ng-change="_onChange({$event: $event, $scope: this})" ><input class="form-control app-textbox" data-ng-model="_timeModel" dropdown-toggle><div class="dropdown-menu"><timepicker hour-step="hourstep" minute-step="minutestep" show-meridian="ismeridian"></timepicker></div><input class="model-holder ng-hide" data-ng-disabled="disabled" data-ng-model="_model_"><span class="input-group-btn dropdown-toggle" dropdown-toggle><button type="button" class="btn btn-default"><i class="glyphicon glyphicon-time"></i></button></span></div>')}]).directive("wmTime",["PropertiesFactory","WidgetUtilService","$timeout","$templateCache","$filter",function(PropertiesFactory,WidgetUtilService,$timeout,$templateCache,$filter){"use strict";function propertyChangeHandler(element,key,newVal){var inputEl=element.find("input"),buttonEl=element.find("button");switch(key){case"readonly":case"disabled":inputEl.attr(key,newVal),buttonEl.attr("disabled",newVal),element.css("pointer-events",newVal?"none":"all");break;case"autofocus":inputEl.first().attr(key,newVal)}}function _onClick(scope,evt){evt.stopPropagation(),scope.isOpen=!scope.isOpen,scope.onClick&&scope.onClick({$event:evt,$scope:scope})}var widgetProps=PropertiesFactory.getPropertiesOf("wm.time",["wm.base","wm.base.editors.abstracteditors","wm.base.datetime"]),notifyFor={readonly:!0,disabled:!0,autofocus:!0};return{restrict:"E",replace:!0,scope:{},template:function(tElement,tAttrs){var template=WM.element($templateCache.get("template/widget/form/time.html",tElement,tAttrs)),isWidgetInsideCanvas=tAttrs.hasOwnProperty("widgetid"),target=template.children("input.form-control");return template.find(".model-holder").attr("name",tAttrs.name),isWidgetInsideCanvas||(template.attr("data-ng-click","_onClick($event)"),tAttrs.hasOwnProperty("onMouseenter")&&template.attr("data-ng-mouseenter","onMouseenter({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onMouseleave")&&template.attr("data-ng-mouseleave","onMouseleave({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onFocus")&&target.attr("data-ng-focus","onFocus({$event: $event, $scope: this})"),tAttrs.hasOwnProperty("onBlur")&&target.attr("data-ng-blur","onBlur({$event: $event, $scope: this})")),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){var onPropertyChange=propertyChangeHandler.bind(void 0,element);WidgetUtilService.registerPropertyChangeListener(onPropertyChange,scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs),scope._onClick=_onClick.bind(void 0,scope),$timeout(function(){onPropertyChange("disabled",scope.disabled),onPropertyChange("readonly",scope.readonly)}),Object.defineProperty(scope,"_model_",{get:function(){var timeValue;return this._proxyModel?(this._timeModel=$filter("date")(this._proxyModel,"hh:mm a"),timeValue=moment($filter("date")(this._proxyModel,"yyyy-MM-dd HH:mm")).valueOf(),"timestamp"===this.outputformat?timeValue:(this.outputformat||(this.outputformat="HH:mm:ss"),timeValue?$filter("date")(timeValue,this.outputformat):void 0)):timeValue?timeValue.valueOf():void 0},set:function(val){if(val)if(WM.isDate(val))this._proxyModel=val;else{isNaN(val)?new Date(val).getTime()||(val=(new Date).toDateString()+" "+val):val=parseInt(val,10);var date=new Date(val);this._proxyModel=WM.isDate(date)?date:void 0}else this._proxyModel=void 0;this._timeModel=$filter("date")(this._proxyModel,"hh:mm a")}}),attrs.datavalue||attrs.scopedatavalue||(scope._model_=Date.now()),attrs.datavalue&&(scope._model_=attrs.datavalue)}}}}}]),WM.module("wm.widgets.form").requires=WM.module("wm.widgets.form").requires.concat(["textAngular"]),WM.module("wm.widgets.form").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/richtexteditor.html",'<div class="app-richtexteditor clearfix" init-widget has-model apply-styles data-ng-show="show"><div text-angular data-ng-model="_model_"></div><div data-ng-bind-html="_model_" class="ta-preview" data-ng-if="showpreview"></div><input class="model-holder ng-hide" data-ng-disabled="disabled"></div>');
}]).directive("wmRichtexteditor",["PropertiesFactory","$templateCache","WidgetUtilService",function(PropertiesFactory,$templateCache,WidgetUtilService){"use strict";function propertyChangeHandler(scope,editorElement,btnElements,key,newVal){switch(key){case"placeholder":scope._model_=newVal;break;case"showpreview":scope.showpreview=newVal;break;case"readonly":btnElements.attr("disabled",newVal===!0),newVal===!0?editorElement.on("keypress.readOnlyEvent",function(event){event.preventDefault()}):editorElement.off(".readOnlyEvent")}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.richtexteditor",["wm.base","wm.base.editors"]),notifyFor={placeholder:!0,showpreview:!0,readonly:!0};return{restrict:"E",scope:{},replace:!0,template:function(tElement,tAttrs){var template=WM.element($templateCache.get("template/widget/richtexteditor.html"));return template.find(".model-holder").attr("name",tAttrs.name),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope,element.find(".ta-editor"),element.find(".fa-picture-o, .fa-link, .fa-unlink").parent(".btn")),scope,notifyFor);var ngModelCtrl,hiddenInputEl=element.children("input");!attrs.widgetid&&attrs.scopedatavalue&&scope.$on("$destroy",scope.$watch("_model_",function(newVal){hiddenInputEl.val(newVal)})),ngModelCtrl=element.children("[text-angular]").controller("ngModel"),ngModelCtrl.$viewChangeListeners.push(function(){scope._onChange(new Event("change"))}),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.grid").directive("wmGrid",["PropertiesFactory","WidgetUtilService","$compile","$controller","CONSTANTS","$rootScope","$timeout","Utils",function(PropertiesFactory,WidgetUtilService,$compile,$controller,CONSTANTS,$rootScope,$timeout,Utils){"use strict";var readOnlyGridAttrUpdated,gridColumnCount,widgetProps=PropertiesFactory.getPropertiesOf("wm.grid",["wm.base","wm.base.editors"]),gridColumnMarkup="",notifyFor={width:!0,height:!0,gridfirstrowselect:!0,deleterow:!0,updaterow:!0,dataset:!0,showheader:!0,shownavigation:!0,insertrow:!0,show:!0,gridsearch:!0,searchlabel:!0,multiselect:!0,radioselect:!0,showrowindex:!0,enablesort:!0,readonlygrid:!0,gridcaption:!0,gridclass:!0,nodatamessage:!0,loadingdatamsg:!0,filternullrecords:!0},getObjectIndexInArray=function(key,value,arr){for(var index=-1,i=0;i<arr.length;i++)if(arr[i][key]===value){index=i;break}return index};return{restrict:"E",scope:{scopedataset:"=?",onSelect:"&",onDeselect:"&",onSort:"&",onClick:"&",onHeaderclick:"&",onShow:"&",onHide:"&",onRowdeleted:"&",onRowupdated:"&",onBeforerowinsert:"&",onRowinsert:"&",onRowclick:"&",onColumnselect:"&",onColumndeselect:"&",onEnterkeypress:"&",onSetrecord:"&"},replace:!0,transclude:!1,controller:"gridController",template:function(element){return gridColumnMarkup=element.html(),'<div data-identifier="grid" init-widget data-ng-show="show" title="{{hint}}" class="app-grid panel" apply-styles="shell"><div class="panel-heading" data-ng-if="title"><h3 class="panel-title">{{title}}</h3></div><div class="app-datagrid"></div><div class="panel-footer clearfix" ng-show="shownavigation || actions.length"><div class="app-datagrid-paginator pull-left"><wm-datanavigator show="{{show && shownavigation}}" showrecordcount="{{show && showrecordcount}}"></wm-datanavigator></div><div class="app-datagrid-actions pull-right" data-ng-if="actions"><wm-button ng-repeat="btn in actions" caption="{{btn.label}}" show="{{btn.show}}" class="btn-sm {{btn.class}}" iconname="{{btn.icon}}" on-click="{{btn.action}}"></wm-button></div></div></div>'},compile:function(tElement,tAttr){var showHeader,contextEl=tElement.context;return tAttr.gridnoheader&&(contextEl.removeAttribute("gridnoheader"),tAttr.showheader||(showHeader=!("true"===tAttr.gridnoheader||tAttr.gridnoheader===!0),delete tAttr.gridnoheader,tAttr.showheader=showHeader,contextEl.setAttribute("showheader",showHeader))),WM.isUndefined(tAttr.readonlygrid)&&(tAttr.readonlygrid=!1,contextEl.setAttribute("readonlygrid",!1),readOnlyGridAttrUpdated=!0),tAttr.gridColumnMarkup=gridColumnMarkup,gridColumnCount=(gridColumnMarkup.match(/<wm-grid-column/g)||[]).length,CONSTANTS.isStudioMode&&(window[tAttr.name+"Controller"]=WM.noop),{pre:function(iScope,element){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps,iScope.allowPageable=!0;var elScope=element.scope();iScope.Variables=elScope.Variables,iScope.Widgets=elScope.Widgets,Object.defineProperty(iScope,"selecteditem",{configurable:!0})},post:function(scope,element,attrs){function propertyChangeHandler(key,newVal,oldVal){switch(key){case"width":scope.datagridElement.datagrid("setGridDimensions","width",newVal);break;case"height":scope.datagridElement.datagrid("setGridDimensions","height",newVal);break;case"gridfirstrowselect":scope.setDataGridOption("selectFirstRow",newVal);break;case"deleterow":scope.renderOperationColumns(),scope.setDataGridOption("colDefs",WM.copy(scope.fieldDefs)),CONSTANTS.isStudioMode&&(scope.widgetProps.confirmdelete.show=newVal,scope.widgetProps.deletemessage.show=newVal);break;case"updaterow":scope.renderOperationColumns(),scope.setDataGridOption("colDefs",WM.copy(scope.fieldDefs));break;case"dataset":scope.watchVariableDataSet(newVal,element);break;case"showheader":scope.setDataGridOption("showHeader",newVal);break;case"gridsearch":scope.setDataGridOption("enableSearch",newVal),CONSTANTS.isStudioMode&&(scope.widgetProps.searchlabel.show=newVal);break;case"searchlabel":scope.setDataGridOption("searchLabel",newVal);break;case"multiselect":CONSTANTS.isStudioMode&&newVal&&(scope.radioselect=!1,scope.$root.$emit("set-markup-attr",scope.widgetid,{radioselect:!1})),scope.setDataGridOption("multiselect",newVal);break;case"radioselect":CONSTANTS.isStudioMode&&newVal&&(scope.multiselect=!1,scope.$root.$emit("set-markup-attr",scope.widgetid,{multiselect:!1})),scope.setDataGridOption("showRadioColumn",newVal);break;case"showrowindex":scope.setDataGridOption("showRowIndex",newVal);break;case"enablesort":scope.setDataGridOption("enableSort",newVal);break;case"shownavigation":scope.enablePageNavigation(),CONSTANTS.isStudioMode&&(scope.widgetProps.showrecordcount.show=newVal);break;case"insertrow":scope.insertrow=newVal===!0||"true"===newVal;var addNewRowButtonIndex=getObjectIndexInArray("key","addNewRow",scope.actions);if(scope.insertrow?-1===addNewRowButtonIndex&&scope.actions.unshift({key:"addNewRow",label:"New",value:"new",icon:"new",show:!0,"class":"btn-primary",action:"addNewRow()"}):scope.actions.length&&-1!==addNewRowButtonIndex&&scope.actions.splice(addNewRowButtonIndex,1),CONSTANTS.isStudioMode){var actionsObj={type:"GRID",widgetName:scope.name,scopeId:scope.$id,buttonDefs:scope.actions};$rootScope.$emit("grid-defs-modified",actionsObj)}break;case"show":newVal?scope.onShow():scope.onHide();break;case"readonlygrid":readOnlyGridAttrUpdated&&(scope.insertrow=WM.isDefined(scope.insertrow)?scope.insertrow:!1,scope.updaterow=WM.isDefined(scope.updaterow)?scope.updaterow:!1,scope.deleterow=WM.isDefined(scope.deleterow)?scope.deleterow:!1,scope.widgetid&&($rootScope.$emit("set-markup-attr",scope.widgetid,{readonlygrid:!1,insertrow:scope.insertrow,updaterow:scope.updaterow,deleterow:scope.deleterow}),$rootScope.$emit("save-workspace",void 0,!0)),readOnlyGridAttrUpdated=void 0),scope.widgetid&&(scope.widgetProps.deleterow.show=!newVal,scope.widgetProps.updaterow.show=!newVal,scope.widgetProps.insertrow.show=!newVal);break;case"gridclass":scope.datagridElement.datagrid("option","cssClassNames.grid",newVal);break;case"nodatamessage":scope.datagridElement.datagrid("option","dataStates.nodata",newVal);break;case"loadingdatamsg":scope.datagridElement.datagrid("option","dataStates.loading",newVal);break;case"filternullrecords":scope.datagridElement.datagrid("option","filterNullRecords",newVal)}}attrs.gridcaption&&!attrs.title&&(scope.title=scope.gridcaption),scope.gridElement=element,scope.gridColumnCount=gridColumnCount,scope.displayAllFields=""===attrs.displayall,scope.datagridElement=element.find(".app-datagrid");var gridController,handlers=[];if(scope.isPartOfLiveGrid=element.closest(".app-livegrid").length>0,scope.$on("$destroy",function(){handlers.forEach(Utils.triggerFn),Utils.triggerFn(scope.toggleVariableStateHandler)}),WM.element(element).css({position:"relative"}),void 0===scope.dataset&&"grid"!==attrs.identifier&&scope.watchVariableDataSet("",element),CONSTANTS.isRunMode)try{gridController=scope.name+"Controller",$controller(gridController,{$scope:scope})}catch(ignore){}scope.actions=[],handlers.push($rootScope.$on("grid-action-properties-modified",function(event,scopeId,readonlygrid){scope.$id===scopeId&&(scope.deleterow=!readonlygrid,scope.updaterow=!readonlygrid,scope.insertrow=!readonlygrid,$rootScope.$emit("set-markup-attr",scope.widgetid,{insertrow:scope.insertrow,updaterow:scope.updaterow,deleterow:scope.deleterow}))})),handlers.push($rootScope.$on("compile-grid-columns",function(event,scopeId,markup){scope.$id===scopeId&&(scope.fullFieldDefs=[],scope.fieldDefs=[],$compile(markup)(scope),scope.renderOperationColumns(),scope.setDataGridOption("colDefs",WM.copy(scope.fieldDefs)))})),handlers.push($rootScope.$on("compile-grid-actions",function(event,scopeId,markup){scope.$id===scopeId&&(scope.actions=[],$compile(markup)(scope))})),$compile(attrs.gridColumnMarkup)(scope),scope.datagridElement.datagrid(scope.gridOptions),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler,scope,notifyFor),handlers.push(scope.$watch("binddataset",function(newVal,oldVal){newVal!==oldVal&&(scope.dataNavigatorWatched=!1)})),Object.defineProperty(scope,"selecteditem",{get:function(){var selectedRows=scope.datagridElement.datagrid("getSelectedRows");return selectedRows&&1===selectedRows.length?selectedRows[0]:selectedRows}}),CONSTANTS.isRunMode&&handlers.push(scope.$watch("scopedataset",function(newVal){newVal&&!scope.dataset&&(scope.newcolumns=!scope.columnDefsExists(),scope.createGridColumns(newVal))})),$timeout(function(){scope.dataNavigator=element.find("[data-identifier=datanavigator]").isolateScope(),WidgetUtilService.postWidgetCreate(scope,element,attrs)},0,!1)}}}}}]).controller("gridController",["$rootScope","$scope","$timeout","$element","$compile","Variables","CONSTANTS","Utils","dateFilter","wmToaster","$servicevariable",function($rootScope,$scope,$timeout,$element,$compile,Variables,CONSTANTS,Utils,dateFilter,wmToaster,$servicevariable){"use strict";var currentSearch,isBoundToVariable,isBoundToWidget,isBoundToLiveVariable,isBoundToLiveVariableRoot,isBoundToServiceVariable,navigatorResultWatch,navigatorMaxResultWatch,columnObj={rowOperationsColumn:{field:"rowOperations",type:"custom",displayName:"Actions",width:"80px",readonly:!0,sortable:!1,searchable:!1,resizable:!1,selectable:!1,operations:[],opConfig:{}}},rowOperations={update:{config:{label:"Update",value:"update"},property:"updaterow"},"delete":{config:{label:"Delete",value:"delete"},property:"deleterow"}},transformData=function(dataObject,variableName){var newObj,tempArr,keys,oldKeys,numKeys,newObject,tempObj;return dataObject=dataObject||[],WM.isArray(dataObject)?WM.isString(dataObject[0])&&(tempArr=[],WM.forEach(dataObject,function(str){newObj={},newObj[variableName.split(".").join("-")]=str,tempArr.push(newObj)}),dataObject=tempArr):(WM.isString(dataObject)&&(keys=variableName.substring(variableName.indexOf(".")+1,variableName.length).split("."),oldKeys=[],numKeys=keys.length,newObject={},tempObj=newObject,WM.forEach(keys,function(key,index){WM.forEach(oldKeys,function(oldKey){tempObj=newObject[oldKey]}),tempObj[key]=index===numKeys-1?dataObject:{},oldKeys.push(key)}),dataObject=newObject),dataObject=[dataObject]),dataObject},populateGridData=function(serviceData){var dataValid,variableName,gridElement,parent;$scope.binddataset?(isBoundToVariable?variableName=$scope.binddataset.substr($scope.binddataset.lastIndexOf("bind:Variables.")+15):isBoundToWidget&&(variableName=serviceData.variableName),$scope.gridVariable=serviceData,$scope.gridVariable&&$scope.gridVariable.propertiesMap&&($scope.serverData=$scope.gridVariable.data),$scope.gridVariable.propertiesMap?(dataValid=$scope.serverData&&!$scope.serverData.error,dataValid&&!WM.isArray($scope.serverData)&&($scope.serverData=[$scope.serverData])):(serviceData=transformData(serviceData,variableName),$scope.serverData=serviceData),$scope.serverData=serviceData,$scope.columnDefsExists()&&!$scope.newDefsRequired?setGridData($scope.serverData):CONSTANTS.isRunMode&&($scope.newcolumns=!0,$scope.newDefsRequired=!0,$scope.createGridColumns($scope.serverData))):($scope.serverData=serviceData,setGridData($scope.serverData)),gridElement=WM.element('[data-identifier="grid"][name="'+$scope.name+'"]'),gridElement.length&&!gridElement[0].getBoundingClientRect().height&&(parent=gridElement.closest(".app-accordion-panel, .tab-pane").isolateScope(),parent&&(parent.initialized=!1))},searchGrid=function(searchObj){var filterFields,variable=$scope.gridElement.scope().Variables[$scope.variableName];filterFields={},searchObj.field&&(currentSearch=searchObj,filterFields[searchObj.field]={value:searchObj.value}),variable.update({type:"wm.LiveVariable",isNotTriggerForRelated:!0,page:1,filterFields:filterFields,matchMode:"anywhere",ignoreCase:!0,scope:$scope.gridElement.scope()},function(data,propertiesMap,relatedData,pagingOptions){$scope.serverData=data,$scope.dataNavigator&&($scope.dataNavigator.dataset={data:data,propertiesMap:propertiesMap,relatedData:relatedData,pagingOptions:pagingOptions,filterFields:filterFields,variableName:$scope.variableName},$scope.dataNavigator.pageCount<$scope.dataNavigator.currentPage&&$scope.dataNavigator.navigatePage("prev")),setGridData($scope.serverData)},function(error){wmToaster.show("error","ERROR","No results found."),setGridData([])})},sortHandler=function(sortObj,e){var filterFields,variable=$scope.gridElement.scope().Variables[$scope.variableName],fieldName=variable.getModifiedFieldName(sortObj.field),sortOptions=fieldName+","+sortObj.direction;$scope.gridOptions.sortInfo.field=sortObj.field,$scope.gridOptions.sortInfo.direction=sortObj.direction,sortObj.direction&&($scope.sortInfo=WM.copy(sortObj),$scope.gridsearch&&currentSearch&&(filterFields={},currentSearch.field&&(filterFields[currentSearch.field]={value:currentSearch.value,type:currentSearch.type})),$scope.isBoundToFilter&&$scope.widgetName?$scope.Widgets[$scope.widgetName].applyFilter({orderBy:sortOptions}):variable.update({type:"wm.LiveVariable",isNotTriggerForRelated:!0,page:1,filterFields:filterFields,orderBy:sortOptions,matchMode:"anywhere",ignoreCase:!0,scope:$scope.gridElement.scope()},function(data,propertiesMap,relatedData,pagingOptions){$scope.dataNavigator.navigatePage("first"),$scope.serverData=data,$scope.dataNavigator&&($scope.dataNavigator.dataset={data:data,propertiesMap:propertiesMap,relatedData:relatedData,pagingOptions:pagingOptions,filterFields:filterFields,sortOptions:sortOptions,variableName:$scope.variableName},$scope.dataNavigator.pageCount<$scope.dataNavigator.currentPage&&$scope.dataNavigator.navigatePage("prev")),setGridData($scope.serverData)},function(error){wmToaster.show("error","ERROR",error)})),$scope.onSort({$event:e,$data:$scope.serverData})},getCompiledTemplate=function(htm,row,colDef){var rowScope=$scope.$new(),el=WM.element(htm);return rowScope.row=row,rowScope.row.getProperty=function(field){return row[field]},rowScope.colDef=colDef,rowScope.columnValue=row[colDef.field],$compile(el)(rowScope)},isEmptyRecord=function(record){var data,isDisplayed,properties=Object.keys(record);return properties.every(function(prop,index){return data=record[prop],isDisplayed=$scope.fieldDefs.length&&WM.isDefined($scope.fieldDefs[index])&&(CONSTANTS.isMobile?$scope.fieldDefs[index].mobileDisplay:$scope.fieldDefs[index].pcDisplay)||!0,isDisplayed?null===data||void 0===data||""===data:!0})},removeEmptyRecords=function(serviceData){var allRecords=serviceData.data||serviceData,filteredData=[];return allRecords&&allRecords.length&&(filteredData=allRecords.filter(function(record){return record&&!isEmptyRecord(record)})),filteredData},setGridData=function(serverData){var data=serverData;if(isBoundToLiveVariableRoot||WM.isDefined(serverData.propertiesMap)){if(!serverData.data||Utils.isEmptyObject(serverData.data))return;data=serverData.data}$scope.filternullrecords?$scope.gridData=removeEmptyRecords(data):$scope.gridData=data,$scope.gridData&&0===$scope.gridData.length?$scope.datagridElement.datagrid("setStatus","nodata",$scope.nodatamessage):$scope.datagridElement.datagrid("setStatus","ready")},deleteRecord=function(row,cancelRowDeleteCallback){if($scope.gridVariable.propertiesMap&&"VIEW"===$scope.gridVariable.propertiesMap.tableType)return wmToaster.show("info","Not Editable","Table of type view, not editable"),void $scope.$root.$safeApply($scope);if(confirm($scope.confirmdelete)){var variable=$scope.gridElement.scope().Variables[$scope.variableName];if(!variable)return;variable.deleteRecord({row:row,transform:!0,scope:$scope.gridElement.scope()},function(success){return success&&success.error?void wmToaster.show("error","ERROR",success.error):($scope.$emit("on-row-delete",row),$scope.onRecordDelete(),wmToaster.show("success","SUCCESS",$scope.deletemessage),void $scope.onRowdeleted({$data:row}))},function(error){wmToaster.show("error","ERROR",error)})}else cancelRowDeleteCallback&&cancelRowDeleteCallback()},insertRecord=function(rowData,evt){var variable=$scope.gridElement.scope().Variables[$scope.variableName];variable&&variable.insertRecord({row:rowData,transform:!0,scope:$scope.gridElement.scope()},function(response){if(response.error)wmToaster.show("error","ERROR",response.error);else{var row=$(evt.target).closest("tr");$scope.datagridElement.datagrid("hideRowEditMode",row),wmToaster.show("success","SUCCESS","Record added successfully"),$scope.initiateHighlightRow("last",response,$scope.primaryKey)}},function(error){wmToaster.show("error","ERROR",error)})},updateRecord=function(rowData,prevData,evt){var variable=$scope.gridElement.scope().Variables[$scope.variableName];variable&&variable.updateRecord({row:rowData,transform:!0,prevData:prevData,scope:$scope.gridElement.scope()},function(response){if(response.error)wmToaster.show("error","ERROR",response.error);else{$scope.operationType="";var row=$(evt.target).closest("tr");$scope.datagridElement.datagrid("hideRowEditMode",row),wmToaster.show("success","SUCCESS","Record updated successfully"),$scope.initiateHighlightRow("current",response,$scope.primaryKey)}},function(error){wmToaster.show("error","ERROR",error)})},removeOperationColumns=function(){var lastColumn=$scope.fieldDefs[$scope.fieldDefs.length-1];"custom"===lastColumn.type&&"rowOperations"===lastColumn.field&&$scope.fieldDefs.pop()},fetchReferenceDetails=function(){var bindDataSetSplit,referenceWidgetName,referenceWidget,referenceBindDataSet,referenceVariableName,relatedFieldName,relatedFieldType,fields,details,referenceVariable,isBoundToSelectedItemSubset=-1!==$scope.binddataset.indexOf("selecteditem.");return bindDataSetSplit=$scope.binddataset.split("."),referenceWidgetName=bindDataSetSplit[1],referenceWidget=$scope.Widgets[referenceWidgetName],referenceBindDataSet=referenceWidget.binddataset,referenceVariableName=referenceBindDataSet.replace("bind:Variables.",""),referenceVariableName=referenceVariableName.substr(0,referenceVariableName.indexOf(".")),referenceVariable=Variables.getVariableByName(referenceVariableName),relatedFieldName=isBoundToSelectedItemSubset&&bindDataSetSplit[3],fields=null!==referenceVariable&&$rootScope.dataTypes&&$rootScope.dataTypes[referenceVariable["package"]].fields,details={referenceVariableName:referenceVariableName,referenceWidget:referenceWidget,referenceVariable:referenceVariable,relatedFieldName:relatedFieldName},relatedFieldName&&fields?(relatedFieldType=fields[relatedFieldName].type,details.relatedFieldType=relatedFieldType):details.fields=fields,details},isBoundToView=function(){return $scope.dataset.propertiesMap&&"VIEW"===$scope.dataset.propertiesMap.tableType};$scope.resetColumnDefinitions=function(){$scope.fieldDefs=[],$scope.setDataGridOption("colDefs",WM.copy($scope.fieldDefs))},$scope.renderOperationColumns=function(){if($scope.fieldDefs.length){removeOperationColumns();var opConfig={},operations=[];WM.forEach(rowOperations,function(field,fieldName){$scope[field.property]&&(opConfig[fieldName]=rowOperations[fieldName].config,operations.push(fieldName))}),operations.length&&(columnObj.rowOperationsColumn.operations=operations,columnObj.rowOperationsColumn.opConfig=opConfig,$scope.fieldDefs.push(columnObj.rowOperationsColumn))}},$scope.fieldDefs=[],$scope.fullFieldDefs=[],$scope.selectedItems=[],$scope.toggleVariableHandlerAttached=!1,$scope.$watch("gridData",function(newValue,oldValue){if(WM.isDefined(newValue)){if($scope.shownavigation&&$scope.dataNavigator&&$scope.dataNavigator.currentPage){var startRowIndex=($scope.dataNavigator.currentPage-1)*$scope.dataNavigator.maxResults+1;$scope.setDataGridOption("startRowIndex",startRowIndex)}var gridOptions=$scope.datagridElement.datagrid("getOptions");!gridOptions.colDefs.length&&$scope.fieldDefs.length&&$scope.setDataGridOption("colDefs",WM.copy($scope.fieldDefs)),$scope.setDataGridOption("data",WM.copy(newValue))}}),$scope.addNewRow=function(){var shouldInsert=$scope.onBeforerowinsert();(WM.isUndefined(shouldInsert)||shouldInsert)&&($scope.datagridElement.datagrid("addNewRow"),$scope.$emit("add-new-row"),$rootScope.$safeApply($scope))},$scope.isGridEditMode=!1,$scope.gridData=[],$scope.gridOptions={data:WM.copy($scope.gridData),colDefs:$scope.fieldDefs,startRowIndex:1,onRowSelect:function(rowData,e){$scope.selectedItems=$scope.datagridElement.datagrid("getSelectedRows"),$scope.onSelect({$data:rowData,$event:e}),$scope.onRowclick({$data:rowData,$event:e}),WM.isDefined($scope.onClick)&&$scope.onClick({$data:rowData,$event:e}),$rootScope.$safeApply($scope)},onRowDeselect:function(rowData,e){$scope.selectedItems=$scope.datagridElement.datagrid("getSelectedRows"),$scope.onDeselect({$data:rowData,$event:e}),$rootScope.$safeApply($scope)},onColumnSelect:function(col,e){$scope.selectedColumns=$scope.datagridElement.datagrid("getSelectedColumns"),$scope.onColumnselect({$data:col,$event:e}),$rootScope.$safeApply($scope)},onColumnDeselect:function(col,e){$scope.selectedColumns=$scope.datagridElement.datagrid("getSelectedColumns"),$scope.onColumndeselect({$data:col,$event:e}),$rootScope.$safeApply($scope)},onHeaderClick:function(e){$scope.onHeaderclick({$event:e,$data:e.data.col})},onRowDelete:function(rowData,cancelRowDeleteCallback,e){deleteRecord(rowData,cancelRowDeleteCallback)},onRowInsert:function(rowData,e){insertRecord(rowData,e)},beforeRowUpdate:function(rowData,e,eventName){$scope.$emit("update-row",$scope.widgetid,rowData,eventName),$scope.prevData=WM.copy(rowData),$rootScope.$safeApply($scope)},afterRowUpdate:function(rowData,e){updateRecord(rowData,$scope.prevData,e)},onSetRecord:function(rowData,e){$scope.onSetrecord({$data:rowData,$event:e})},allowDeleteRow:!0,allowInlineEditing:!0,sortInfo:{field:"",direction:""},getCompiledTemplate:function(htm,row,colDef){return getCompiledTemplate(htm,row,colDef)},setGridEditMode:function(val){$scope.isGridEditMode=val},noChangesDetected:function(){wmToaster.show("info","","No changes detected"),$scope.$root.$safeApply($scope)},afterSort:function(){$rootScope.$safeApply($scope)}},$scope.resetPageNavigation=function(){$scope.dataNavigator&&$scope.dataNavigator.resetPageNavigation()},$scope.enablePageNavigation=function(){if($scope.dataset&&$scope.dataNavigator){if($scope.dataNavigator.pagingOptions={maxResults:$scope.pagesize||5},Utils.triggerFn(navigatorResultWatch),$scope.dataNavigator.dataset=$scope.binddataset,CONSTANTS.isStudioMode&&"wm.ServiceVariable"===$scope.variableType)return;navigatorResultWatch=$scope.dataNavigator.$watch("result",function(newVal){WM.isDefined(newVal)&&$scope.watchVariableDataSet(newVal,$scope.gridElement)}),Utils.triggerFn(navigatorMaxResultWatch),navigatorMaxResultWatch=$scope.dataNavigator.$watch("maxResults",function(newVal){$scope.pagesize=newVal}),$scope.dataNavigatorWatched=!0}},$scope.fetchDynamicColumnDefs=function(){var fields,result;if(result=fetchReferenceDetails(),result.fields){var f=result.fields,dataKeys=Object.keys(f),fields={};dataKeys.forEach(function(key){fields[key]=""})}else result.relatedFieldType&&(fields=$servicevariable.getServiceModel({typeRef:result.relatedFieldType,variable:result.referenceVariable}));fields&&$scope.watchVariableDataSet(fields,$scope.gridElement)},$scope.fetchDynamicData=function(){var reference,referenceVariableKey,watchSelectedItem,referenceVariable;reference=fetchReferenceDetails(),$scope.selectedItemWatched||(watchSelectedItem=reference.referenceWidget.$watch("selecteditem",function(newVal,oldVal){$scope.selectedItemWatched=!0,newVal&&!WM.equals(newVal,oldVal)&&(referenceVariable=Variables.getVariableByName(reference.referenceVariableName),!referenceVariableKey&&referenceVariable&&"wm.LiveVariable"===referenceVariable.category&&(referenceVariableKey=referenceVariable.getPrimaryKey(),1===referenceVariableKey.length&&(referenceVariableKey=referenceVariableKey[0]),watchSelectedItem(),reference.referenceWidget.$watch("selecteditem."+referenceVariableKey,function(newVal){newVal&&referenceVariable.updateRelatedData({id:reference.referenceWidget.selecteditem[referenceVariableKey],relatedFieldName:reference.relatedFieldName,scope:$scope.gridElement.scope()},function(data,propertiesMap,relatedData,pagingOptions){WM.isDefined(data)&&($scope.dataNavigatorWatched||($scope.dataNavigator.dataset=$scope.binddataset),$scope.watchVariableDataSet(data,$scope.gridElement)),$scope.dataNavigator&&($scope.dataNavigator.dataset={data:data,propertiesMap:propertiesMap,relatedData:relatedData,pagingOptions:pagingOptions,variableName:reference.referenceVariableName},$scope.dataNavigator.pageCount<$scope.dataNavigator.currentPage&&$scope.dataNavigator.navigatePage("prev"))},function(error){wmToaster.show("error","ERROR",error)})})))},!0))},$scope.isDataValid=function(){var error;return $scope.dataset.error&&(error=$scope.dataset.error),$scope.dataset.data&&$scope.dataset.data.error&&$scope.dataset.data.errorMessage&&(error=$scope.dataset.data.errorMessage),error?(setGridData([]),$scope.datagridElement.datagrid("setStatus","error",error),!1):!0},$scope.watchVariableDataSet=function(newVal,element){var variableName,widgetName,variableObj,elScope,result,isBoundToSelectedItem,isBoundToSelectedItemSubset,isBoundToFilter,columns;if($scope.datagridElement.datagrid("setStatus","loading",$scope.loadingdatamsg),result=Utils.getValidJSON(newVal),isBoundToLiveVariable=void 0,isBoundToLiveVariableRoot=void 0,isBoundToServiceVariable=void 0,isBoundToFilter=void 0,$scope.gridVariable="",CONSTANTS.isStudioMode&&WM.isDefined($scope.$parent)&&$scope.$parent.redrawColumns&&($scope.newcolumns=$scope.$parent.redrawColumns),result&&(newVal=result),$scope.isDataValid()){if(WM.isObject(newVal)&&Utils.isPageable(newVal)&&(newVal=newVal.content),newVal?$scope.dataNavigatorWatched||$scope.enablePageNavigation():($scope.resetPageNavigation(),CONSTANTS.isRunMode&&($scope.datagridElement.datagrid("setStatus","nodata",$scope.nodatamessage),$scope.setDataGridOption("selectFirstRow",$scope.gridfirstrowselect))),$scope.binddataset){if(isBoundToVariable=-1!==$scope.binddataset.indexOf("bind:Variables."),isBoundToWidget=-1!==$scope.binddataset.indexOf("bind:Widgets."),isBoundToVariable)variableName=$scope.binddataset.replace("bind:Variables.",""),variableName=variableName.substr(0,variableName.indexOf("."));else if(isBoundToWidget&&(widgetName=$scope.binddataset.replace("bind:Widgets.","").split(".")[0],isBoundToFilter="wm-livefilter"===$scope.Widgets[widgetName]._widgettype,$scope.isBoundToFilter=isBoundToFilter,$scope.widgetName=widgetName,variableName=Utils.getVariableName($scope),isBoundToSelectedItem=-1!==$scope.binddataset.indexOf("selecteditem"),isBoundToSelectedItemSubset=-1!==$scope.binddataset.indexOf("selecteditem."),isBoundToSelectedItemSubset||isBoundToSelectedItem)){if(null===variableName){var widgetBindingDetails=fetchReferenceDetails();if(!widgetBindingDetails.fields){var relatedTables=widgetBindingDetails.referenceVariable&&widgetBindingDetails.referenceVariable.relatedTables||[];variableName=widgetBindingDetails.referenceVariableName,relatedTables.forEach(function(val){val.columnName===widgetBindingDetails.relatedFieldName&&(variableName=val.watchOn)})}}if(CONSTANTS.isStudioMode&&""!==newVal){if($scope.binddataset==="bind:"+newVal||WM.isArray(newVal)&&!newVal.length)return void $scope.fetchDynamicColumnDefs()}else newVal||$scope.fetchDynamicData()}variableName&&!$scope.toggleVariableHandlerAttached&&($scope.toggleVariableStateHandler=$rootScope.$on("toggle-variable-state",function(event,boundVariableName,active){boundVariableName===variableName&&($scope.variableInflight=active)}),$scope.toggleVariableHandlerAttached=!0),elScope=element.scope(),$scope.variableName&&variableName!==$scope.variableName&&CONSTANTS.isStudioMode&&($scope.fullFieldDefs=[]),$scope.variableName=variableName,variableObj=elScope.Variables&&elScope.Variables[$scope.variableName],variableObj?($scope.widgetProps.selecteditem.type="object, "+variableObj.type,$scope.variableType=variableObj.category,isBoundToLiveVariable="wm.LiveVariable"===$scope.variableType,isBoundToLiveVariableRoot=isBoundToLiveVariable&&-1===$scope.binddataset.indexOf("dataSet.")&&-1===$scope.binddataset.indexOf("selecteditem"),isBoundToServiceVariable="wm.ServiceVariable"===$scope.variableType,isBoundToLiveVariable&&($scope.setDataGridOption("searchHandler",searchGrid),$scope.setDataGridOption("sortHandler",sortHandler),$scope.dataset.propertiesMap&&$scope.dataset.propertiesMap.columns&&($scope.primaryKey=variableObj.getPrimaryKey()),$scope.contentBaseUrl=(""!==variableObj.prefabName&&void 0!==variableObj.prefabName?"prefabs/"+variableObj.prefabName:"services")+"/"+variableObj.liveSource+"/"+variableObj.type+"/")):-1===$scope.binddataset.indexOf("bind:Widgets")&&$scope.datagridElement.datagrid("setStatus","error",$scope.nodatamessage)}return CONSTANTS.isStudioMode&&($scope.widgetProps.pagesize.disabled=isBoundToLiveVariable,$scope.binddataset&&isBoundToServiceVariable||isBoundToView()?($scope.isPartOfLiveGrid?($scope.readonlygrid=!0,$scope.insertrow=!1,$scope.updaterow=!1,$scope.deleterow=!1,$rootScope.$emit("set-markup-attr",$scope.widgetid,{readonlygrid:$scope.readonlygrid,insertrow:$scope.insertrow,updaterow:$scope.updaterow,deleterow:$scope.deleterow})):$rootScope.$emit("update-widget-property","readonlygrid",!0),$scope.widgetProps.readonlygrid.disabled=!0):$scope.widgetProps.readonlygrid.disabled=!1,isBoundToWidget&&-1!==$scope.binddataset.indexOf("livefilter")?($rootScope.$emit("update-widget-property","gridsearch",!1),$scope.widgetProps.gridsearch.disabled=!0):$scope.widgetProps.gridsearch.disabled=!1),!WM.isObject(newVal)||newVal&&""===newVal.dataValue?void((""===newVal||newVal&&""===newVal.dataValue)&&(CONSTANTS.isStudioMode&&$scope.newcolumns&&($scope.prepareFieldDefs(),$scope.newcolumns=!1),$scope.variableInflight||setGridData([]))):void(newVal?(CONSTANTS.isStudioMode&&($scope.createGridColumns(isBoundToLiveVariableRoot?newVal.data:newVal,newVal.propertiesMap||void 0),$scope.newcolumns=!1),$scope.fieldDefs&&$scope.columnDefsExists()&&newVal.propertiesMap&&(columns=Utils.fetchPropertiesMapColumns(newVal.propertiesMap),$scope.fieldDefs.forEach(function(fieldDef){Object.keys(columns).forEach(function(key){key===fieldDef.field&&(fieldDef.type=columns[key].type)})})),populateGridData(newVal),isBoundToServiceVariable&&CONSTANTS.isStudioMode&&($scope.gridData=[],$scope.datagridElement.datagrid("setStatus","error",$rootScope.locale.MESSAGE_GRID_CANNOT_LOAD_DATA_IN_STUDIO))):CONSTANTS.isStudioMode&&($scope.datagridElement.datagrid("setStatus","nodata",$scope.nodatamessage),
$scope.setDataGridOption("selectFirstRow",$scope.gridfirstrowselect),$scope.newcolumns&&($scope.prepareFieldDefs(),$scope.newcolumns=!1)))}},$scope.createGridColumns=function(data,propertiesMap){var dataValid=data&&!data.error;dataValid&&!WM.isArray(data)&&(data=[data]),$scope.newcolumns&&(propertiesMap?$scope.prepareFieldDefs(data,propertiesMap):$scope.prepareFieldDefs(data)),dataValid&&($scope.serverData=data,setGridData($scope.serverData))},$scope.prepareFieldDefs=function(data,propertiesMap){var defaultFieldDefs,properties,columns,gridObj;$scope.fieldDefs=[],propertiesMap?(columns=Utils.fetchPropertiesMapColumns(propertiesMap),properties=[Utils.resetObjectWithEmptyValues(columns)]):properties=data,defaultFieldDefs=Utils.prepareFieldDefs(properties,$scope.displayAllFields?-1:10),WM.forEach(defaultFieldDefs,function(columnDef){columnDef.pcDisplay=!0,columnDef.mobileDisplay=!0,WM.forEach($scope.fullFieldDefs,function(column){column.field&&column.field===columnDef.field&&(columnDef.pcDisplay=column.pcDisplay,columnDef.mobileDisplay=column.mobileDisplay,columnDef.customExpression=column.customExpression,columnDef.width=column.width,columnDef.textAlignment=column.textAlignment,columnDef.backgroundColor=column.backgroundColor,columnDef.textColor=column.textColor,columnDef.widgetType=column.widgetType,columnDef.displayName=column.displayName,columnDef["class"]=column["class"],columnDef.ngClass=column.ngClass,columnDef.searchPlaceholder=column.searchPlaceholder||("date"!==columnDef.type?"Search":"Enter date in yyyy-mm-dd"),columnDef.formatpattern=column.formatpattern,columnDef.datepattern=column.datepattern,columnDef.currencypattern=column.currencypattern,columnDef.fractionsize=column.fractionsize,columnDef.suffix=column.suffix,columnDef.prefix=column.prefix)}),propertiesMap&&(columnDef.type=columns[columnDef.field].type,columnDef.primaryKey=columns[columnDef.field].isPrimaryKey,columnDef.generator=columns[columnDef.field].generator,columnDef.readonly=WM.isDefined(columns[columnDef.field].readonly)?"true"===columns[columnDef.field].readonly:"identity"===columnDef.generator&&"true"!==columns[columnDef.field].isRelatedPk,columnDef.searchable=columnDef.sortable=!(columnDef.field&&-1!==columnDef.field.indexOf(".")&&!columnDef.primaryKey),("timestamp"===columnDef.type||"datetime"===columnDef.type||"date"===columnDef.type)&&(columnDef.formatpattern||(columnDef.formatpattern="toDate"),columnDef.datepattern||(columnDef.datepattern="date"===columnDef.type?"yyyy-MM-dd":"dd-MMM-yyyy HH:mm:ss")),"blob"!==columnDef.type||columnDef.customExpression||("image"===columnDef.widgetType?columnDef.customExpression='<img width="48px" height="28px" class="wm-icon wm-icon24 glyphicon glyphicon-file" data-ng-src="{{contentBaseUrl + row[primaryKey] + \'/content/\'+ colDef.field}}"/>':columnDef.customExpression='<a ng-if="columnValue != null" class="col-md-9" target="_blank" data-ng-href="{{contentBaseUrl + row[primaryKey] + \'/content/\'+ colDef.field}}"><i class="wm-icon wm-icon24 glyphicon glyphicon-file"></i></a>'),columnDef.disableInlineEditing=columns[columnDef.field].disableInlineEditing)}),$scope.fieldDefs=WM.copy(defaultFieldDefs),gridObj={widgetName:$scope.name,fieldDefs:defaultFieldDefs,scopeId:$scope.$id},$rootScope.$emit("grid-defs-modified",gridObj),$scope.setDataGridOption("colDefs",WM.copy($scope.fieldDefs))},$scope.setDataGridOption=function(optionName,newVal){var option={};WM.isDefined(newVal)&&!WM.equals(newVal,$scope.gridOptions[optionName])&&(option[optionName]=newVal,$scope.datagridElement.datagrid("option",option),$scope.gridOptions[optionName]=newVal)},$scope.initiateHighlightRow=function(index,row,primaryKey,skipHighlightRow){"last"===index&&($scope.dataNavigator.dataSize+=1,$scope.shownavigation||(index="current")),$scope.dataNavigator.calculatePagingValues(),$scope.dataNavigator.navigatePage(index,null,!0,function(){skipHighlightRow||$timeout(function(){$scope.highlightRow(row,$scope.dataset.data)},null,!1)})},$scope.highlightRow=function(result,data){data&&($scope.serverData=data),$scope.datagridElement.datagrid("selectRow",result,!0)},$scope.columnDefsExists=function(){var i,n;for(i=0,n=$scope.fieldDefs.length;n>i;i+=1)if($scope.fieldDefs[i].field)return!0;return!1},$scope.deleteRow=function(row){row=row||$scope.selectedItems[0],deleteRecord(row)},$scope.editRow=function(row){row=row||$scope.selectedItems[0],$scope.gridOptions.beforeRowUpdate(row)},$scope.addRow=function(){$scope.addNewRow()},$scope.selectRow=$scope.highlightRow,$scope.onRecordDelete=function(){if($scope.dataNavigator)$scope.dataNavigator.dataSize-=1,$scope.dataNavigator.calculatePagingValues(),$scope.dataNavigator.pageCount<$scope.dataNavigator.currentPage?$scope.dataNavigator.navigatePage("prev"):$scope.dataNavigator.navigatePage();else{var variable=$scope.gridElement.scope().Variables[$scope.variableName];if(!variable)return;variable.update({type:"wm.LiveVariable",isNotTriggerForRelated:!0,page:$scope.dataNavigator?$scope.dataNavigator.currentPage:1,scope:$scope.gridElement.scope()},function(data){$scope.serverData=data,setGridData($scope.serverData)},function(error){wmToaster.show("error","ERROR",error)})}}}]).directive("wmGridColumn",["$parse","Utils","CONSTANTS",function($parse,Utils,CONSTANTS){"use strict";return{restrict:"E",scope:!0,template:"<div></div>",replace:!0,compile:function(tElement){return{pre:function(scope,element,attrs){var textAlignment=attrs.textalignment||"left",backgroundColor=attrs.backgroundcolor||"",textColor=attrs.textcolor||"",width=attrs.width||"",styleDef="width: "+width+"; background-color: "+backgroundColor+"; color: "+textColor+";",columnDef={field:attrs.binding,displayName:attrs.caption,pcDisplay:"1"===attrs.pcdisplay||"true"===attrs.pcdisplay,mobileDisplay:"1"===attrs.mobiledisplay||"true"===attrs.mobiledisplay,width:attrs.width||"*",textAlignment:textAlignment,backgroundColor:backgroundColor,textColor:textColor,type:attrs.type||"string",primaryKey:attrs.primaryKey?$parse(attrs.primaryKey)():"",generator:attrs.generator,isRelatedPk:"true"===attrs.isRelatedPk,widgetType:attrs.widgetType,style:styleDef,"class":attrs.colClass||"",ngClass:attrs.colNgClass||"",searchPlaceholder:attrs.searchPlaceholder||("date"!==attrs.type?"Search":"Enter date in yyyy-mm-dd"),datepattern:attrs.datepattern,formatpattern:attrs.formatpattern,currencypattern:attrs.currencypattern,fractionsize:attrs.fractionsize,suffix:attrs.suffix,prefix:attrs.prefix},updateCustomExpression=function(column){var widgetType=column.widgetType,field=column.field,val="{{row.getProperty('"+field+"')}}";if(widgetType)switch(widgetType){case"image":"blob"===column.type&&(column.customExpression='<img width="48px" height="28px" class="wm-icon wm-icon24 glyphicon glyphicon-file" data-ng-src="{{contentBaseUrl + row[primaryKey] + \'/content/\'+ colDef.field}}"/>'),column.customExpression='<img data-ng-src="'+val+'" alt="'+val+'"/>';break;case"button":var widgetTitle=val||"";column.customExpression='<wm-button caption="'+widgetTitle+'" show="true" class="btn-sm btn-primary"></wm-button>'}};if(tElement.context.innerHTML&&(columnDef.customExpression=tElement.context.innerHTML),columnDef.searchable=columnDef.sortable=!(columnDef.field&&-1!==columnDef.field.indexOf(".")&&!columnDef.primaryKey),columnDef.readonly=WM.isDefined(attrs.readonly)?"true"===attrs.readonly:"identity"===columnDef.generator&&!columnDef.isRelatedPk,"blob"!==columnDef.type||columnDef.customExpression||"image"!==columnDef.widgetType&&(columnDef.customExpression='<a ng-if="columnValue != null" class="col-md-9" target="_blank" data-ng-href="{{contentBaseUrl + row[primaryKey] + \'/content/\'+ colDef.field}}"><i class="wm-icon wm-icon24 glyphicon glyphicon-file"></i></a>'),columnDef.disableInlineEditing="true"===attrs.disableInlineEditing,scope.$parent.fullFieldDefs.push(columnDef),columnDef.widgetType&&!columnDef.customExpression&&(updateCustomExpression(columnDef),CONSTANTS.isStudioMode&&scope.$parent.fullFieldDefs.length===scope.$parent.gridColumnCount)){var config={widgetName:scope.name,scopeId:scope.$parent.$id,fieldDefs:scope.$parent.fullFieldDefs};scope.$root.$emit("grid-defs-modified",config),scope.$root.$emit("save-workspace",void 0,!0)}if(Utils.isMobile()){if(!columnDef.mobileDisplay)return}else if(!columnDef.pcDisplay)return;scope.$parent.fieldDefs.push(columnDef),element.remove()}}}}}]).directive("wmGridAction",["$compile","CONSTANTS",function($compile,CONSTANTS){"use strict";return{restrict:"E",scope:!0,replace:!0,compile:function(){return{post:function(scope,element,attrs){var parentIsolateScope,buttonDef={key:attrs.key||attrs.binding,label:attrs.label||attrs.caption,show:"1"===attrs.show||"true"===attrs.show,"class":attrs["class"]||"",icon:attrs.icon,action:attrs.action,type:attrs.type||"button"};parentIsolateScope=CONSTANTS.isRunMode?scope:scope.parentIsolateScope=element.parent()&&element.parent().length>0?element.parent().closest('[data-identifier="grid"]').isolateScope()||scope.$parent:scope.$parent,parentIsolateScope.actions=parentIsolateScope.actions||[],parentIsolateScope.actions.push(buttonDef)}}}}}]),WM.module("wm.widgets.live").controller("liveFormDialogController",WM.noop).directive("wmLiveform",["PropertiesFactory","WidgetUtilService","$compile","$rootScope","CONSTANTS","$controller","Utils","$templateCache","wmToaster","$filter","LiveWidgetUtils",function(PropertiesFactory,WidgetUtilService,$compile,$rootScope,CONSTANTS,$controller,Utils,$templateCache,wmToaster,$filter,LiveWidgetUtils){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.liveform",["wm.layouts","wm.base.events.successerror"]),notifyFor={dataset:!0,captionsize:!0,novalidate:!0,autocomplete:!0,rowdata:!0,formdata:!0,updatemode:!0,formtype:!0,layout:!0,defaultmode:!0},isTimeType=function(field){return"Time"===field.widgetType||"time"===field.type&&!field.widgetType},getValidTime=function(val){var date=(new Date).toDateString();return new Date(date+" "+val).getTime()},dateTimeFormats=Utils.getDateTimeDefaultFormats();return{restrict:"E",replace:!0,scope:{onBeforeservicecall:"&",onResult:"&"},require:"?^wmLivegrid",template:function(template,attrs){return!CONSTANTS.isRunMode||"dialog"!==attrs.formtype&&"dialog"!==attrs.layout?'<form data-identifier="liveform" init-widget data-ng-show="show" role="form" class="app-liveform panel panel-default liveform-inline align-{{captionalign}} position-{{captionposition}}" data-ng-submit="formSave($event);" autocomplete="autocomplete" apply-styles="shell"><div data-ng-show="isLayoutDialog"><i class="wm-icon24 glyphicon glyphicon-cog"></i>Live form in dialog mode</div><div class="form-header panel-heading" data-ng-show="!isLayoutDialog" data-ng-if="title"><h3 class="panel-title"><i class="{{iconclass}}" data-ng-style="{width:iconwidth, height:iconheight, margin:iconmargin}"></i><span class="form-header-text">{{title}}</span></h3></div><div class="form-elements panel-body" data-ng-class="{\'update-mode\': isUpdateMode }" data-ng-show="!isLayoutDialog" data-ng-style="{height: height, overflow: height ? \'auto\': overflow, paddingTop: paddingtop + paddingunit,paddingRight: paddingright + paddingunit,paddingLeft: paddingleft + paddingunit,paddingBottom: paddingbottom + paddingunit}">'+template.context.innerHTML+'</div><div class="basic-btn-grp form-action panel-footer clearfix" data-ng-hide="isLayoutDialog"></div></form>':(attrs.dialogid="liveformdialog-"+attrs.name+"-"+Utils.generateGUId(),'<div data-identifier="liveform" init-widget data-ng-show="show" class="app-liveform liveform-dialog" autocomplete="autocomplete" ><wm-dialog width="{{dialogWidth}}" name="'+attrs.dialogid+'" title="{{title}}" modal="true" controller="liveFormDialogController"><wm-dialogheader></wm-dialogheader><wm-dialogcontent class="noscroll"><form data-identifier="liveform" role="form" name="'+attrs.name+'" class="app-liveform align-{{captionalign}} position-{{captionposition}}" data-ng-submit="formSave($event);" apply-styles="shell"><div class="form-elements" data-ng-class="{\'update-mode\': isUpdateMode }" data-ng-style="{height: height, overflow: height ? \'auto\': overflow, paddingTop: paddingtop + paddingunit,paddingRight: paddingright + paddingunit,paddingLeft: paddingleft + paddingunit,paddingBottom: paddingbottom + paddingunit}"><div class="form-content">'+template.context.innerHTML+'</div></div><div class="basic-btn-grp form-action modal-footer clearfix"><div class="action-content"></div></div></form></wm-dialogcontent></wm-dialog></div>')},controller:function($scope,Variables){function emptyDataModel(){$scope.formFields.forEach(function(dataValue){"blob"===dataValue.type&&(WM.element($scope.formElement).find("[name="+dataValue.key+"]").val(""),dataValue.href=""),dataValue.value=""})}$scope.__compileWithIScope=!0;var prevformFields,prevDataObject={},onResult=function(data,status,event){$scope.onResult({$event:event,$operation:$scope.operationType,$data:data}),status?Utils.triggerFn($scope.onSuccess,{$event:event,$operation:$scope.operationType,$data:data}):Utils.triggerFn($scope.onError,{$event:event,$operation:$scope.operationType,$data:data})};$scope.prevDataValues={},$scope.isCompositeKey=function(){return!$scope.primaryKey||$scope.primaryKey&&(!$scope.primaryKey.length||$scope.primaryKey.length>1)},$scope.isNoPrimaryKey=function(){return!$scope.primaryKey||$scope.primaryKey&&!$scope.primaryKey.length},$scope.findOperationType=function(){var operation;return $scope.primaryKey&&$scope.formdata&&(1===$scope.primaryKey.length?$scope.formdata[$scope.primaryKey[0]]&&(operation="update"):operation=0===$scope.primaryKey.length?WM.forEach($scope.formdata,function(value){return value?"update":void 0}):$scope.primaryKey.some(function(primarykey){return $scope.formdata[primarykey]?"update":void 0})),operation||"insert"},$scope.saveAndNew=function(){$scope.formSave(void 0,!0)},$scope.formSave=function(event,newForm){var data,prevData,isValid,requestData={},elScope=$scope.element.scope(),variable=elScope.Variables[$scope.variableName];if($scope.propertiesMap&&"VIEW"===$scope.propertiesMap.tableType)return void wmToaster.show("info","Not Editable","Table of type view, not editable");if($scope.formElement=$scope.isLayoutDialog?document.forms[$scope.name]:$scope.formElement||document.forms[$scope.name],!WM.isFunction($scope.formElement[0].checkValidity)||$scope.formElement[0].checkValidity()){$scope.operationType=$scope.operationType||$scope.findOperationType(),data=$scope.constructDataObject($scope.formFields),$scope.dataoutput=data,prevData=prevformFields?$scope.constructDataObject(prevformFields):data;try{if(isValid=$scope.onBeforeservicecall({$event:event,$operation:$scope.operationType,$data:data}),isValid===!1)return;if(isValid&&isValid.error)return void wmToaster.show("error","ERROR",isValid.error)}catch(err){if("Abort"===err.message)return}switch(requestData={row:data,transform:!0,multipartData:$scope.multipartData},elScope.prefabname&&(requestData.scope=elScope),$scope.operationType){case"update":requestData.rowData=$scope.rowdata,requestData.prevData=prevData,variable.updateRecord(requestData,function(response){response.error?(wmToaster.show("error","ERROR",response.error),onResult(response,!1,event)):(wmToaster.show("success","SUCCESS",$scope.updatemessage),onResult(response,!0,event),$scope.ctrl?$scope.$emit("on-result","update",response,newForm):variable.update({type:"wm.LiveVariable",isNotTriggerForRelated:!0},WM.noop))},function(error){wmToaster.show("error","ERROR",error),onResult(error,!1,event)});break;case"insert":variable.insertRecord(requestData,function(response){response.error?(wmToaster.show("error","ERROR",response.error),onResult(response,!1,event)):(wmToaster.show("success","SUCCESS",$scope.insertmessage),onResult(response,!0,event),$scope.ctrl?$scope.$emit("on-result","insert",response,newForm):variable.update({type:"wm.LiveVariable",isNotTriggerForRelated:!0},WM.noop))},function(error){wmToaster.show("error","ERROR",error),onResult(error,!1,event)});break;case"delete":if($scope.ctrl&&!$scope.ctrl.confirmMessage())return;variable.deleteRecord(requestData,function(success){return success&&success.error?(wmToaster.show("error","ERROR",success.error),void onResult(success,!1)):(onResult(success,!0),$scope.clearData(),wmToaster.show("success","SUCCESS",$scope.deletemessage),$scope.isSelected=!1,void($scope.ctrl?$scope.$emit("on-result","delete",success):variable.update({type:"wm.LiveVariable",isNotTriggerForRelated:!0},WM.noop)))},function(error){wmToaster.show("error","ERROR",error),onResult(error,!1)})}}},$scope.setPrevformFields=function(formFields){prevformFields=WM.copy(formFields),prevDataObject=WM.copy($scope.rowdata)},$scope.formCancel=function(){$scope.clearData(),$scope.isSelected&&($scope.formFields=WM.copy(prevformFields)||$scope.formFields),$scope.$emit("on-cancel")},$scope.setPrevDataValues=function(){$scope.formFields&&($scope.prevDataValues=$scope.formFields.map(function(obj){return{key:obj.key,value:obj.value}}))},$scope.reset=function(){WM.isArray($scope.formFields)&&$scope.formFields.forEach(function(dataValue){var prevObj=_.find($scope.prevDataValues,function(obj){return obj.key===dataValue.key});dataValue.value=prevObj?prevObj.value:void 0})},$scope.edit=function(){$scope.isLayoutDialog||($scope.isSelected&&(prevformFields=WM.copy($scope.formFields)),prevDataObject=WM.copy($scope.rowdata)),$scope.setReadonlyFields(),$scope.isUpdateMode=!0,$scope.operationType="update"},$scope["new"]=function(){$scope.isSelected&&!$scope.isLayoutDialog&&(prevformFields=WM.copy($scope.formFields)),$scope.formFields&&$scope.formFields.length>0&&emptyDataModel(),$scope.setDefaults(),$scope.setPrevDataValues(),$scope.isUpdateMode=!0,$scope.operationType="insert"},$scope.filetypes={image:"image/*",video:"video/*",audio:"audio/*"},$scope.isDateTimeWidgets=Utils.getDateTimeTypes(),$scope.setDefaults=function(){$scope.formFields.forEach(function(fieldObj){$scope.setDefaultValueToValue(fieldObj)})},$scope.setDefaultValueToValue=function(fieldObj){var defaultValue=fieldObj.defaultValue;defaultValue&&"null"!==defaultValue?fieldObj.value=LiveWidgetUtils.getDefaultValue(defaultValue,fieldObj.type):fieldObj.value=void 0,"blob"===fieldObj.type&&(fieldObj.permitted=$scope.filetypes[fieldObj.filetype]+(fieldObj.extensions?","+fieldObj.extensions:"")),fieldObj.primaryKey&&"assigned"===fieldObj.generator&&(fieldObj.readonly=!1),$scope.setPrevDataValues()},$scope.setReadonlyFields=function(){$scope.formFields.forEach(function(column){column.primaryKey&&(column.readonly=!0)})},$scope["delete"]=function(){$scope.operationType="delete",$scope.formSave()},$scope.isInReqdFormat=function(data){return WM.isArray(data)&&data[0].key&&data[0].type},$scope.constructDataObject=function(formFields){var formData,dataObject="update"===$scope.operationType?WM.copy(Utils.isEmptyObject(prevDataObject)?$scope.formdata:prevDataObject):{},formName=$scope.name,isFormDataSupported=window.File&&window.FileReader&&window.FileList&&window.Blob;return isFormDataSupported&&(formData=new FormData),formFields.forEach(function(field){field.widgetType&&$scope.isDateTimeWidgets[field.widgetType.toLowerCase()]||$scope.isDateTimeWidgets[field.type]?(field.value&&!isNaN(field.value)&&(field.value=Number(field.value)),field.outputformat&&"timestamp"!==field.outputformat?dataObject[field.key]=$filter("date")(field.value,field.outputformat):dataObject[field.key]=field.value):"blob"===field.type?isFormDataSupported&&($scope.multipartData=!0,formData.append(field.key,document.forms[formName][field.key].files[0])):"list"===field.type?field.value&&(dataObject[field.key]=field.value):dataObject[field.key]=field.value}),$scope.multipartData?(formData.append("wm_data_json",new Blob([JSON.stringify(dataObject)],{type:"application/json"})),formData):dataObject},$scope.clearData=function(){$scope.formFields&&$scope.formFields.length>0&&emptyDataModel()},$scope.setReadonly=function(element){WM.element(element).find("input, textarea").attr("disabled",!0)},$scope.removeReadonly=function(element){WM.element(element).find("input, textarea").attr("disabled",!1)},$scope.isUpdateMode=!1,$scope.getPrimaryKey=function(columnArray){var primaryKey;return WM.forEach(columnArray,function(column){column.isPrimaryKey&&(primaryKey=column.fieldName)}),primaryKey},$scope.setPrimaryKey=function(columnName){-1===WM.element.inArray(columnName,$scope.primaryKey)&&$scope.primaryKey.push(columnName)},$scope.translateVariableObject=function(rawObject){return LiveWidgetUtils.translateVariableObject(rawObject,$scope)},$scope.changeDataObject=function(dataObj){var primaryKey,href;$scope.formFields.forEach(function(value){isTimeType(value)?value.value=getValidTime(dataObj[value.key]):"blob"===value.type?(primaryKey=$scope.dataset.propertiesMap.primaryKeys.join(),href=(""!==$scope.variableObj.prefabName&&void 0!==$scope.variableObj.prefabName?"prefabs/"+$scope.variableObj.prefabName:"services")+"/",href=href+$scope.variableObj.liveSource+"/"+$scope.variableObj.type+"/"+dataObj[primaryKey]+"/content/"+value.key+"?"+Math.random(),value.href=href):value.value=dataObj[value.key]}),$scope.setPrevDataValues()},$scope.setFieldVal=function(fieldDef){var primaryKey,href,dataObj=$scope.rowdata;dataObj&&(isTimeType(fieldDef)?fieldDef.value=getValidTime(dataObj[fieldDef.key]):"blob"===fieldDef.type?(primaryKey=$scope.dataset.propertiesMap.primaryKeys.join(),href="services/"+$scope.variableObj.liveSource+"/"+$scope.variableObj.type+"/"+dataObj[primaryKey]+"/content/"+fieldDef.key+"?"+Math.random(),fieldDef.href=href):fieldDef.value=dataObj[fieldDef.key])},$scope.getDisplayExpr=function(object,displayExpr){return WM.isObject(object)?(displayExpr||(displayExpr=Object.keys(object)[0]),Utils.getEvaluatedExprValue(object,displayExpr,$scope)):object},$scope.getOutputPatterns=function(type,outputFormat){return"date"===type||"time"===type||"datetime"===type?dateTimeFormats[type]:outputFormat},$scope.save=function(){$scope.formSave()},$scope.cancel=function(){$scope.formCancel()},$scope.update=function(){$scope.edit()}},compile:function(){return{pre:function(scope,element,attrs){var elScope=element.scope();scope.widgetProps=widgetProps,("dialog"===attrs.layout||"dialog"===attrs.formtype)&&(scope.isLayoutDialog=!0,scope._dialogid=attrs.dialogid),scope.Variables=elScope.Variables,scope.Widgets=elScope.Widgets},post:function(scope,element,attrs,controller){function getEmptyDataSetGridObj(){return{widgetName:scope.name,fieldDefs:[],buttonDefs:[],scopeId:scope.$id,numColumns:scope.getActiveLayout()}}function getNonEmptyDatSetGridObj(){return{widgetName:scope.name,fieldDefs:scope.formFields,buttonDefs:scope.buttonArray,scopeId:scope.$id,numColumns:scope.getActiveLayout()}}function propertyChangeHandler(key,newVal){var value,labelElements,elementScope,translatedObj,tempVarName,gridObj,variableObj,variableRegex=/^bind:Variables\.(.*)\.dataSet$/,elScope=element.scope();switch(key){case"dataset":newVal.propertiesMap&&WM.isArray(newVal.propertiesMap.columns)?(tempVarName=scope.binddataset.match(variableRegex)[1],scope.variableName&&tempVarName!==scope.variableName&&(scope.formCreated=!1,scope.formConstructed=!1),scope.variableName=tempVarName,(scope.formCreated||scope.formConstructed)&&scope.formFields?(translatedObj=scope.translateVariableObject(newVal),scope.translatedObj=translatedObj,scope.formFields.forEach(function(fieldObject){translatedObj.forEach(function(transObj){transObj.key===fieldObject.key&&(fieldObject.isRelated=transObj.isRelated,fieldObject.type=transObj.type,fieldObject.outputformat=scope.getOutputPatterns(fieldObject.type,fieldObject.outputformat))})}),variableObj=elScope.Variables&&elScope.Variables[scope.variableName],scope.variableObj=variableObj,variableObj&&(scope.widgetProps.formdata.type=variableObj.type,scope.widgetProps.dataoutput.type="object, "+variableObj.type)):(scope.buttonArray=LiveWidgetUtils.getFormButtons().filter(function(button){return"cancel"===button.key||"save"===button.key}),variableObj=elScope.Variables&&elScope.Variables[scope.variableName],scope.variableObj=variableObj,variableObj&&(scope.widgetProps.formdata.type=variableObj.type),translatedObj=scope.isInReqdFormat(newVal)?newVal:scope.translateVariableObject(newVal),scope.translatedObj=translatedObj,scope.formFields=translatedObj),gridObj=getNonEmptyDatSetGridObj(),CONSTANTS.isRunMode&&scope.setDefaults()):newVal||(CONSTANTS.isStudioMode&&element.find(".form-elements").empty(),scope.variableName="",gridObj=getEmptyDataSetGridObj()),CONSTANTS.isStudioMode&&gridObj&&(!scope.formFieldCompiled||scope.newcolumns)&&(scope.newcolumns=!1,gridObj.bindDataSetChanged=!0,$rootScope.$emit("formFieldsDefs-modified",gridObj));break;case"captionsize":labelElements=WM.element(element).find(".app-label"),WM.forEach(labelElements,function(childelement){elementScope=WM.element(childelement).isolateScope(),elementScope.width=newVal});break;case"novalidate":newVal===!0||"true"===newVal?element.attr("novalidate",""):element.removeAttr("novalidate");break;case"autocomplete":value=newVal===!0||"true"===newVal?"on":"off",element.attr(key,value);break;case"rowdata":newVal&&WM.isObject(newVal)&&scope.changeDataObject(newVal);break;case"formdata":newVal&&WM.isObject(newVal)&&scope.changeDataObject(newVal);break;case"updatemode":scope.isUpdateMode=newVal===!0||"true"===newVal;break;case"defaultmode":newVal&&"Edit"===newVal?scope.updateMode=!0:scope.updateMode=!1,scope.isUpdateMode=scope.updateMode;break;case"formtype":scope.isLayoutDialog="dialog"===newVal,element.toggleClass("liveform-dialog",scope.isLayoutDialog);break;case"layout":newVal&&("dialog"===newVal||"inline"===newVal?scope.formtype=newVal:(gridObj=getNonEmptyDatSetGridObj(),CONSTANTS.isStudioMode&&gridObj&&scope.newcolumns&&(scope.newcolumns=!1,$rootScope.$emit("formFieldsDefs-modified",gridObj))))}}scope.ctrl=controller,"dialog"!==attrs.formtype&&"dialog"!==attrs.layout?scope.formElement=element:CONSTANTS.isRunMode&&(scope.dialogWidth=scope.width,scope.width="100%"),scope.element=element;var formController,handlers=[];if(scope.getActiveLayout=function(){return LiveWidgetUtils.getColumnCountByLayoutType(scope.layout)},CONSTANTS.isRunMode)try{formController=scope.name+"Controller",$controller(formController,{$scope:scope})}catch(ignore){}WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler,scope,notifyFor),scope.widgetid&&handlers.push($rootScope.$on("compile-form-fields",function(event,scopeId,markup,newVal,fromDesigner){if(scope.$id===scopeId&&(scope.formFields=void 0,scope.buttonArray=void 0,element.find(".form-elements").empty(),element.find(".basic-btn-grp").empty(),scope.formConstructed=fromDesigner,markup)){scope.formConstructed=!0;var markupObj=WM.element("<div>"+markup+"</div>"),fieldsObj=markupObj.find("wm-layoutgrid"),actionsObj=markupObj.find("wm-form-action");fieldsObj?$rootScope.$emit("prepare-element",fieldsObj,function(){element.find(".form-elements").append(fieldsObj),element.find(".basic-btn-grp").append(actionsObj),$compile(fieldsObj)(scope),$compile(actionsObj)(scope)}):(fieldsObj=markupObj.find("wm-form-field"),element.find(".form-elements").append(fieldsObj),element.find(".basic-btn-grp").append(actionsObj),$compile(fieldsObj)(scope),$compile(actionsObj)(scope))}})),scope.$on("$destroy",function(){handlers.forEach(Utils.triggerFn)}),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmFormField",["Utils","$compile","CONSTANTS","Variables","BindingManager","LiveWidgetUtils",function(Utils,$compile,CONSTANTS,Variables,BindingManager,LiveWidgetUtils){"use strict";return{restrict:"E",template:"",scope:!0,replace:!0,compile:function(){return{pre:function(scope){scope.widgetProps=[]},post:function(scope,element,attrs){var parentIsolateScope,template,index,columnDef,expr,exprWatchHandler,variable,variableData,dataSetWatchHandler,defaultObj,variableObj={};parentIsolateScope=CONSTANTS.isRunMode&&scope.isLayoutDialog?scope:scope.parentIsolateScope=element.parent()&&element.parent().length>0?element.parent().closest('[data-identifier="liveform"]').isolateScope()||scope.$parent:scope.$parent,columnDef=WM.extend(LiveWidgetUtils.getColumnDef(attrs),{key:attrs.key||attrs.binding,outputformat:attrs.outputformat,displayvalue:attrs.displayvalue,regexp:attrs.regexp||".*",datafield:attrs.datafield,displayfield:attrs.displayfield,width:attrs.width,height:attrs.height,maxvalue:attrs.maxvalue,minvalue:attrs.minvalue}),attrs.isRelated="true"===attrs.isRelated||attrs.primaryKey===!0,columnDef.isRelated=attrs.isRelated,CONSTANTS.isRunMode&&columnDef.show===!1&&"identity"!==columnDef.generator&&(columnDef.required=!1),attrs.defaultValue&&(Utils.stringStartsWith(attrs.defaultValue,"bind:")&&CONSTANTS.isRunMode?(expr=attrs.defaultValue.replace("bind:",""),exprWatchHandler=BindingManager.register(scope,expr,function(newVal){parentIsolateScope.formFields[index].defaultValue=newVal,"update"!==parentIsolateScope.operationType&&parentIsolateScope.setDefaultValueToValue(columnDef)},{deepWatch:!0,allowPageable:!0,acceptsArray:!1})):columnDef.defaultValue=attrs.defaultValue),attrs.widgetType&&(columnDef.widgetType=attrs.widgetType),attrs.dataset?Utils.stringStartsWith(attrs.dataset,"bind:")&&CONSTANTS.isRunMode?(expr=attrs.dataset.replace("bind:",""),dataSetWatchHandler=parentIsolateScope.$watch(expr,function(newVal){variable=parentIsolateScope.Variables[expr.split(".")[1]],WM.isObject(variable)&&(WM.isObject(newVal)&&Utils.isPageable(newVal)?parentIsolateScope.formFields[index].dataset=newVal.content:"wm.LiveVariable"===variable.category?parentIsolateScope.formFields[index].dataset=newVal.data:parentIsolateScope.formFields[index].dataset=newVal,attrs.datafield||(parentIsolateScope.formFields[index].datafield="All Fields"))})):columnDef.dataset=attrs.dataset:attrs.isRelated&&(expr=parentIsolateScope.binddataset.replace("bind:",""),dataSetWatchHandler=parentIsolateScope.$watch(expr,function(newVal){newVal&&(parentIsolateScope.formFields[index].dataset=newVal.relatedData&&newVal.relatedData[columnDef.key],variableObj.type=columnDef.displayName,variableObj.isDefault=!0,variableObj.category="wm.LiveVariable",variableData=Variables.filterByVariableKeys(variableObj,!0),variableData.length?(parentIsolateScope.formFields[index].displayfield=parentIsolateScope.getPrimaryKey(variableData[0].propertiesMap.columns),parentIsolateScope.formFields[index].datafield="All Fields"):newVal.propertiesMap&&(parentIsolateScope.formFields[index].displayfield=columnDef.relatedFieldName,parentIsolateScope.formFields[index].datafield="All Fields"))})),attrs.extensions&&(columnDef.extensions=attrs.extensions),attrs.filetype&&(columnDef.filetype=attrs.filetype),scope.isLayoutDialog&&(defaultObj=_.find(parentIsolateScope.translatedObj,function(obj){return obj.key===columnDef.key}),defaultObj&&(columnDef.isRelated=defaultObj.isRelated,columnDef.type=defaultObj.type,columnDef.outputformat=parentIsolateScope.getOutputPatterns(columnDef.type,columnDef.outputformat)),parentIsolateScope.setDefaultValueToValue(columnDef),parentIsolateScope.setFieldVal(columnDef),"update"===scope.operationType&&scope.setReadonlyFields()),scope.options=columnDef,parentIsolateScope.formFields=parentIsolateScope.formFields||[],index=parentIsolateScope.formFields.push(columnDef)-1,scope.isLayoutDialog&&parentIsolateScope.setPrevDataValues(),parentIsolateScope.formCreated=!0,parentIsolateScope.formFieldCompiled=!0,template=LiveWidgetUtils.getTemplate(columnDef,index,"form"),element.html(template),$compile(element.contents())(parentIsolateScope),parentIsolateScope.$on("$destroy",function(){dataSetWatchHandler&&dataSetWatchHandler(),exprWatchHandler&&exprWatchHandler()})}}}}}]).directive("wmFormAction",["$compile","CONSTANTS",function($compile,CONSTANTS){"use strict";var getTemplate=function(btnField,index){var template="";return template=btnField.updateMode?'<wm-button name="{{buttonArray['+index+'].key}}" caption="{{buttonArray['+index+'].displayName}}" show="{{isUpdateMode && buttonArray['+index+'].show}}" class="{{buttonArray['+index+'].class}}" iconname="{{buttonArray['+index+'].iconname}}"  iconclass="{{buttonArray['+index+'].iconclass}}" on-click="'+btnField.action+'" type="{{buttonArray['+index+'].type}}" ></wm-button>':'<wm-button name="{{buttonArray['+index+'].key}}" caption="{{buttonArray['+index+'].displayName}}" show="{{!isUpdateMode && buttonArray['+index+'].show}}" class="{{buttonArray['+index+'].class}}" iconname="{{buttonArray['+index+'].iconname}}" iconclass="{{buttonArray['+index+'].iconclass}}" on-click="'+btnField.action+'" type="{{buttonArray['+index+'].type}}" ></wm-button>';
};return{restrict:"E",scope:!0,replace:!0,template:"<div></div>",compile:function(){return{post:function(scope,element,attrs){var parentIsolateScope,template,index,buttonDef={key:attrs.key||attrs.binding,displayName:attrs.displayName||attrs.caption,show:"1"===attrs.show||"true"===attrs.show,"class":attrs["class"]||"",iconname:attrs.iconname,iconclass:attrs.iconclass,action:attrs.action,type:attrs.type||"button",updateMode:attrs.updateMode===!0||"true"===attrs.updateMode};parentIsolateScope=CONSTANTS.isRunMode&&scope.isLayoutDialog?scope:scope.parentIsolateScope=element.parent()&&element.parent().length>0?element.parent().closest('[data-identifier="liveform"]').isolateScope()||scope.$parent:scope.$parent,scope.options=buttonDef,parentIsolateScope.buttonArray=parentIsolateScope.buttonArray||[],index=parentIsolateScope.buttonArray.push(buttonDef)-1,parentIsolateScope.formCreated=!0,parentIsolateScope.formFieldCompiled=!0,template=getTemplate(buttonDef,index),element.closest('[data-identifier="liveform"]').find("> .basic-btn-grp").append($compile(template)(parentIsolateScope))}}}}}]),WM.module("wm.widgets.live").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/livefilter/livefilter.html",'<div data-identifier="livefilter" class="app-livefilter clearfix" init-widget title="{{hint}}" data-ng-show="show" apply-styles><div data-identifier="filter-elements" ng-transclude></div><div class="basic-btn-grp form-action clearfix app-button-group" style="text-align: right;"></div></div>')}]).directive("wmLivefilter",["PropertiesFactory","$rootScope","$templateCache","WidgetUtilService","$compile","CONSTANTS","QueryBuilder","$filter","Utils","$controller","LiveWidgetUtils",function(PropertiesFactory,$rootScope,$templateCache,WidgetUtilService,$compile,CONSTANTS,QueryBuilder,$filter,Utils,$controller,LiveWidgetUtils){"use strict";var notifyFor,widgetProps=PropertiesFactory.getPropertiesOf("wm.livefilter",["wm.layouts","wm.containers"]),filterMarkup="";return notifyFor=CONSTANTS.isStudioMode?{dataset:!0,layout:!0,pagesize:!0}:{dataset:!0,layout:!0},{restrict:"E",replace:!0,transclude:!0,scope:{},controller:function($scope){$scope.dateTimeFormats=Utils.getDateTimeDefaultFormats(),$scope.isDateTime=Utils.getDateTimeTypes(),$scope.isUpdateMode=!0,$scope.getWidgetType=function(type){var widgetType;switch(type){case"date":widgetType="date";break;case"time":widgetType="time";break;case"datetime":widgetType="datetime";break;case"boolean":widgetType="checkbox";break;default:widgetType="text"}return widgetType},$scope.__compileWithIScope=!0,$scope.clearFilter=function(){WM.forEach($scope.formFields,function(filterField){!filterField.readonly&&filterField.show&&(filterField.isRange?(filterField.minValue="",filterField.maxValue=""):filterField.value="")}),$scope.orderBy="",$scope.filter()},$scope.applyFilter=function(options){options=options||{},options.page=options.page||1,options.orderBy=options.orderBy||$scope.orderBy||"",$scope.filter(options)},$scope.filter=function(options){var query,orderBy,formFields=[],variable=$scope.Variables[$scope.variableName],page=1,ORACLE_DB_SYSTEM="oracle",DB_SYS_KEY="dbSystem",isOracleDbSystem=function(){return variable&&variable[DB_SYS_KEY]&&variable[DB_SYS_KEY].toLowerCase()===ORACLE_DB_SYSTEM};options=options||{},page=options.page||page,orderBy=options.orderBy||"",$scope.orderBy=options.orderBy,orderBy=orderBy.split(",").join(" "),WM.forEach($scope.formFields,function(filterField){var fieldValue,minQuery,maxQuery,noQuotes=!1,minValue=filterField.minValue,maxvalue=filterField.maxValue,colName=variable.getModifiedFieldName(filterField.field),getFormattedDateTime=function(value,widget){var formattedValue;return value?("datetime"===widget&&isOracleDbSystem()?(formattedValue=$filter("date")(value,$scope.dateTimeFormats[widget+"_oracle"]),formattedValue="to_date('"+formattedValue+"', 'YYYY-MM-DD HH24:MI:SS')",noQuotes=!0):formattedValue=$filter("date")(value,$scope.dateTimeFormats[widget]),formattedValue):void 0};if(filterField.isRelated&&(colName+="."+filterField.lookupField),filterField.isRange)$scope.isDateTime[filterField.widget]&&(minValue=getFormattedDateTime(minValue,filterField.widget),maxvalue=getFormattedDateTime(maxvalue,filterField.widget)),noQuotes?(minQuery="("+minValue+"<="+colName,maxQuery=colName+"<="+maxvalue+")"):(minQuery="('"+minValue+"'<="+colName,maxQuery=colName+"<='"+maxvalue+"')"),minValue&&maxvalue?formFields.push({clause:minQuery+" AND "+maxQuery}):minValue?formFields.push({clause:minQuery+")"}):maxvalue&&formFields.push({clause:"("+maxQuery});else{switch(filterField.widget){case"select":case"radioset":"boolean"===filterField.type?(WM.isDefined(filterField.value)&&!WM.isString(filterField.value)&&(fieldValue=filterField.value),noQuotes=!0):fieldValue=filterField.value;break;case"checkboxset":filterField.value&&filterField.value.length&&(fieldValue=filterField.value);break;case"date":case"time":case"datetime":fieldValue=getFormattedDateTime(filterField.value,filterField.widget);break;case"checkbox":case"toggle":WM.isDefined(filterField.value)&&!WM.isString(filterField.value)&&(fieldValue=filterField.value),noQuotes=!0;break;default:fieldValue=filterField.value}WM.isDefined(fieldValue)&&""!==fieldValue&&null!==fieldValue&&formFields.push({column:colName,value:fieldValue,noQuotes:noQuotes})}}),query=QueryBuilder.getQuery({tableName:$scope.result.propertiesMap.entityName,filterFields:formFields,orderby:orderBy}),QueryBuilder.executeQuery({databaseName:variable.liveSource,query:query,page:page,size:$scope.pagesize||20,nativeSql:!1,prefabName:variable.prefabName},function(data){var tempObj={};$scope.result.data=data.content,WM.forEach(formFields,function(filterField){tempObj[filterField.column]={},tempObj[filterField.column].value=filterField.value}),$scope.result.formFields=tempObj,$scope.result.pagingOptions={dataSize:data.totalElements,maxResults:$scope.pagesize||20,currentPage:page},$scope.result.options={page:page,orderBy:orderBy}})},$scope.constructDefaultData=function(dataset){var colDef,column,index,columnObj=dataset.propertiesMap.columns,colDefArray=[],numColumns=Math.min(columnObj.length,5);for(index=0;numColumns>index;index++)column=columnObj[index],colDef={},colDef.field=column.fieldName,colDef.displayName=Utils.prettifyLabel(column.fieldName),colDef.widget=$scope.getWidgetType(column.type),colDef.isRange=!1,colDef.filterOn=column.fieldName,colDef.lookupType="",colDef.lookupField="",colDef.minPlaceholder="",colDef.maxPlaceholder="",colDef.placeholder="",colDef.datepattern="",colDef["class"]="",colDef.required="",colDef.minValue="",colDef.maxValue="",colDef.multiple="",colDef.value="",colDef.type=column.type,colDef.step=LiveWidgetUtils.getStepValue(colDef.type),colDef.isPrimaryKey=column.isPrimaryKey,colDef.generator=column.generator,colDef.show=!0,column.isRelated?(colDef.field=column.fieldName.charAt(0).toLowerCase()+column.fieldName.slice(1),colDef.displayName=colDef.field,colDef.isRelated=!0,colDef.lookupType=column.relatedEntityName,colDef.lookupField="",WM.forEach(column.columns,function(subcolumn){subcolumn.isPrimaryKey&&(colDef.lookupField=subcolumn.fieldName)}),colDef.relatedEntityName=column.relatedEntityName):colDef.isRelated=!1,colDefArray.push(colDef);return colDefArray},$scope.filterOnDefault=function(){var defaultObj=_.find($scope.formFields,function(obj){return obj.value});defaultObj&&$scope.result&&$scope.filter()}},template:function(element){return filterMarkup=element.html(),$templateCache.get("template/widget/livefilter/livefilter.html")},compile:function(tElement,tAttr){return tAttr.gridColumnMarkup=filterMarkup,{pre:function(iScope,element){var elScope=element.scope();CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps,iScope.filterElement=element,iScope.Variables=elScope.Variables,iScope.Widgets=elScope.Widgets},post:function(scope,element,attrs){function updateAllowedValues(){var variable=scope.Variables[scope.variableName];WM.forEach(scope.formFields,function(filterField){var query,tableName,columns,fieldColumn;fieldColumn=variable.getModifiedFieldName(filterField.field),("select"===filterField.widget||"radioset"===filterField.widget||"checkboxset"===filterField.widget)&&(filterField.isRelated?(tableName=filterField.lookupType,columns=filterField.lookupField,query=QueryBuilder.getQuery({tableName:tableName,columns:[" DISTINCT "+columns+" AS "+columns]}),filterField.datafield=columns,filterField.displayfield=columns):(query=QueryBuilder.getQuery({tableName:scope.result.propertiesMap.entityName,columns:[" DISTINCT "+fieldColumn+" AS "+filterField.field]}),filterField.datafield=filterField.field,filterField.displayfield=filterField.field),QueryBuilder.executeQuery({databaseName:variable.liveSource,query:query,page:1,size:500,nativeSql:!1,prefabName:variable.prefabName},function(data){filterField.dataset=data.content}))})}function propertyChangeHandler(key,newVal,oldVal){switch(key){case"dataset":var fieldsObj,buttonsObj,designerObj;newVal.propertiesMap&&WM.isArray(newVal.propertiesMap.columns)?(oldVal&&oldVal.propertiesMap&&WM.equals(newVal.propertiesMap.columns,oldVal.propertiesMap.columns)&&WM.equals(newVal.data,oldVal.data)||(scope.result=scope.result||{data:[],pagingOptions:newVal.pagingOptions,options:{page:1}},scope.variableName=scope.binddataset.match(variableRegex)[1],scope.result.variableName=scope.variableName,scope.result.propertiesMap=newVal.propertiesMap,scope.result.widgetName=scope.name,scope.result.isBoundToFilter=!0,fieldsObj=scope.constructDefaultData(newVal),scope.formFields&&newVal&&newVal.propertiesMap&&scope.formFields.forEach(function(filterField){var filterObj=_.find(newVal.propertiesMap.columns,function(obj){return obj.fieldName===filterField.field});filterObj&&(filterField.type=filterObj.type,!CONSTANTS.isStudioMode||"datetime"!==filterField.type||filterField.widget&&"text"!==filterField.widget||(filterField.widget=scope.getWidgetType(filterField.type),scope.$root.$emit("set-markup-attr",scope.widgetid,{type:filterField.type,widget:filterField.widget},"wm-filter-field[field="+filterField.field+"]")))}),buttonsObj=defaultButtonsArray,scope.filter(scope.result.options)),updateAllowedValues()):!newVal&&CONSTANTS.isStudioMode&&(scope.variableName="",scope.result="",scope.formFields="",scope.filterConstructed=!1,scope.fieldObjectCreated=!1,fieldsObj=[],buttonsObj=[]),CONSTANTS.isStudioMode&&scope.newcolumns&&fieldsObj&&(scope.newcolumns=!1,designerObj={widgetName:scope.name,fieldDefs:fieldsObj,buttonDefs:buttonsObj,variableName:scope.variableName,scopeId:scope.$id,numColumns:scope.getActiveLayout(),bindDataSetChanged:!0},scope.$root.$emit("filterDefs-modified",designerObj));break;case"layout":CONSTANTS.isStudioMode&&scope.newcolumns&&(scope.newcolumns=!1,designerObj={widgetName:scope.name,fieldDefs:scope.formFields,buttonDefs:scope.buttonArray,variableName:scope.variableName,scopeId:scope.$id,numColumns:scope.getActiveLayout()},$rootScope.$emit("filterDefs-modified",designerObj));break;case"pagesize":WM.isDefined(scope.variableName)&&WM.isDefined(newVal)&&!WM.equals(newVal,oldVal)&&scope.filter()}}if(CONSTANTS.isRunMode)try{var filterController=scope.name+"Controller";$controller(filterController,{$scope:scope})}catch(ignore){}var variableRegex=/^bind:Variables\.(.*)\.dataSet$/,handlers=[],defaultButtonsArray=[{key:"filter","class":"btn-primary",iconname:"filter",action:"filter()",displayName:"Filter",show:!0,type:"button"},{key:"clear","class":"btn",iconname:"clear",action:"clearFilter()",displayName:"Clear",show:!0,type:"button"}];scope.filterContainer=element,scope.primaryKey=null,scope.getActiveLayout=function(){return LiveWidgetUtils.getColumnCountByLayoutType(scope.layout)},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler,scope,notifyFor),handlers.push($rootScope.$on("compile-filters",function(event,scopeId,markup,filterObj,variableName,fromDesigner){if(scope.$id===scopeId){var markupObj=WM.element("<div>"+markup+"</div>"),fieldsObj=markupObj.find("wm-layoutgrid"),actionsObj=markupObj.find("wm-filter-action");scope.filterConstructed=fromDesigner,scope.variableName=variableName,scope.formFields=void 0,scope.buttonArray=void 0,element.find('[data-identifier="filter-elements"]').empty(),element.find(".basic-btn-grp").empty(),fieldsObj&&fieldsObj.length?$rootScope.$emit("prepare-element",fieldsObj,function(){element.find('[data-identifier="filter-elements"]').append(fieldsObj),element.find(".basic-btn-grp").append(actionsObj),$compile(fieldsObj)(scope),$compile(actionsObj)(scope)}):(fieldsObj=markupObj.find("wm-filter-field"),element.find('[data-identifier="filter-elements"]').append(fieldsObj),element.find(".basic-btn-grp").append(actionsObj),$compile(fieldsObj)(scope),$compile(actionsObj)(scope)),updateAllowedValues(),scope.filterConstructed=!0}})),scope.$on("$destroy",function(){handlers.forEach(Utils.triggerFn)}),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmFilterField",["$compile","Utils","CONSTANTS","BindingManager","LiveWidgetUtils",function($compile,Utils,CONSTANTS,BindingManager,LiveWidgetUtils){"use strict";return{restrict:"E",scope:!0,template:"",replace:!0,compile:function(){return{post:function(scope,element,attrs){scope.parentIsolateScope=element.parent()&&element.parent().length>0?element.parent().closest('[data-identifier="livefilter"]').isolateScope():scope.$parent;var expr,exprWatchHandler,template,index,defaultVal,parentIsolateScope=scope.parentIsolateScope,columnsDef=WM.extend(LiveWidgetUtils.getColumnDef(attrs),{field:attrs.field||attrs.binding,filterOn:attrs.filterOn||attrs.field||attrs.binding,isRange:"true"===attrs.isRange||attrs.isRange===!0,isRelated:"true"===attrs.isRelated||attrs.isRelated===!0,widget:attrs.widget,lookupType:attrs.lookupType,lookupField:attrs.lookupField,minPlaceholder:attrs.minPlaceholder,maxPlaceholder:attrs.maxPlaceholder,relatedEntityName:attrs.relatedEntityName});columnsDef.key=columnsDef.field,attrs.value&&(Utils.stringStartsWith(attrs.value,"bind:")&&CONSTANTS.isRunMode?(expr=attrs.value.replace("bind:",""),scope.Variables&&!Utils.isEmptyObject(scope.Variables)&&scope.$eval(expr)?(defaultVal=scope.$eval(expr),columnsDef.value=defaultVal,columnsDef.isRange&&(columnsDef.minValue=defaultVal,columnsDef.maxValue=defaultVal)):exprWatchHandler=BindingManager.register(scope,expr,function(newVal){parentIsolateScope.formFields[index].value=newVal,columnsDef.isRange&&(parentIsolateScope.formFields[index].minValue=newVal,parentIsolateScope.formFields[index].maxValue=newVal),parentIsolateScope.filterOnDefault()},{deepWatch:!0,allowPageable:!0,acceptsArray:!1})):(defaultVal=attrs.value,CONSTANTS.isRunMode&&(defaultVal=LiveWidgetUtils.getDefaultValue(defaultVal,columnsDef.type)),columnsDef.value=defaultVal,columnsDef.isRange&&(columnsDef.minValue=defaultVal,columnsDef.maxValue=defaultVal))),parentIsolateScope.formFields=parentIsolateScope.formFields||[],parentIsolateScope.columnsDefCreated=!0,index=parentIsolateScope.formFields.push(columnsDef)-1,template=LiveWidgetUtils.getTemplate(columnsDef,index,"filter"),element.html(template),$compile(element.contents())(parentIsolateScope),parentIsolateScope.$on("$destroy",function(){exprWatchHandler&&exprWatchHandler()})}}}}}]).directive("wmFilterAction",["$compile",function($compile){"use strict";return{restrict:"E",scope:!0,template:"",replace:!0,compile:function(){return{post:function(scope,element,attrs){scope.parentIsolateScope=element.parent()&&element.parent().length>0?element.parent().closest('[data-identifier="livefilter"]').isolateScope():scope.$parent;var buttonTemplate,index,buttonDef={key:attrs.key||attrs.binding,displayName:attrs.displayName||attrs.caption,show:"true"===attrs.show||attrs.show===!0,"class":attrs["class"]||"",iconname:attrs.iconname,action:attrs.action};scope.parentIsolateScope.buttonArray=scope.parentIsolateScope.buttonArray||[],index=scope.parentIsolateScope.buttonArray.push(buttonDef)-1,scope.parentIsolateScope.columnsDefCreated=!0,buttonTemplate='<wm-button caption="{{buttonArray['+index+'].displayName}}" show="{{buttonArray['+index+'].show}}" class="{{buttonArray['+index+'].class}}" iconname="{{buttonArray['+index+'].iconname}}" on-click="'+buttonDef.action+'" type="{{buttonArray['+index+'].type}}" ></wm-button>',element.closest('[data-identifier="livefilter"]').find(".basic-btn-grp").append($compile(buttonTemplate)(scope.parentIsolateScope)),$compile(element.contents())(scope.parentIsolateScope)}}}}}]),WM.module("wm.widgets.live").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/livegrid/livegrid.html",'<div class="app-livegrid" init-widget title="{{hint}}" apply-styles="container" data-ng-show="show"><div wmtransclude></div></div>')}]).directive("wmLivegrid",["PropertiesFactory","$templateCache","WidgetUtilService","DialogService","$compile","$timeout","Utils","CONSTANTS",function(PropertiesFactory,$templateCache,WidgetUtilService,DialogService,$compile,$timeout,Utils,CONSTANTS){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.livegrid",["wm.base"]),gridMarkup="",notifyFor={formlayout:!0};return{restrict:"E",replace:!0,transclude:!0,scope:{},controller:function($scope){this.confirmMessage=function(){return $scope.grid?confirm($scope.grid.confirmdelete):!0}},template:function(element){return gridMarkup=element.html(),$templateCache.get("template/widget/livegrid/livegrid.html")},compile:function(tElement,tAttr){return tAttr.gridColumnMarkup=gridMarkup,{pre:function(iScope){CONSTANTS.isStudioMode?iScope.widgetProps=WM.copy(widgetProps):iScope.widgetProps=widgetProps},post:function(scope,element,attrs){function propertyChangeHandler(key,newVal){switch(key){case"formlayout":scope.gridform&&(scope.isLayoutDialog="dialog"===newVal,scope.gridform.formtype=newVal,scope.$root.$emit("set-markup-attr",scope.gridform.widgetid,{formtype:newVal}))}}var handlers=[],liveGridOptions={allowInlineEditing:!1,multiselect:!1,allowAddNewRow:!1};scope.getRegExp=function(){return new RegExp(scope.regexp)},scope.primaryKey=null,scope.fullFieldDefs=[],scope.fieldDefs=[],scope.grid=element.find("[data-identifier=grid]").isolateScope(),scope.gridform=element.find("[data-identifier=liveform]").isolateScope(),scope.isLayoutDialog=!1,scope.grid&&scope.gridform&&(scope.grid.datagridElement.datagrid("option",liveGridOptions),scope.grid.parentgrid=!0,scope.grid.isGridPartOfLiveGrid=!0,scope.grid.newcolumns=scope.newcolumns,scope.grid.$watch("selectedItems",function(newValue){scope.grid&&scope.gridform&&scope.grid.variableName===scope.gridform.variableName&&(newValue&&newValue.length>0&&!scope.gridform.isSelected&&(scope.gridform.isSelected=!0),newValue&&newValue.length>0?(scope.grid.multiselect?scope.gridform.rowdata=newValue[0]:scope.gridform.rowdata=newValue[newValue.length-1],scope.gridform.isUpdateMode&&scope.gridform.edit()):(scope.gridform.isSelected=!1,scope.gridform.rowdata="",scope.gridform.clearData()))},!0),scope.grid.$watch("fullFieldDefs",function(newVal){scope.fullFieldDefs=newVal},!0),scope.grid.$watch("fieldDefs",function(newVal){scope.fieldDefs=newVal},!0),scope.grid.$watch("serverData",function(newVal){scope.serverData=newVal},!0),handlers.push(scope.grid.$on("add-new-row",function(){scope.gridform.isSelected=!0,scope.gridform.rowdata="",scope.gridform.isLayoutDialog&&(scope.gridform.setPrevformFields(scope.gridform.formFields),scope.gridform.formFields=[]),scope.gridform["new"](),scope.isLayoutDialog&&DialogService.showDialog(scope.gridform._dialogid,{resolve:{},scope:scope.gridform})})),handlers.push(scope.grid.$on("update-row",function(event,widgetid,row,eventName){scope.gridform.rowdata=row,scope.gridform.isLayoutDialog&&(scope.gridform.setPrevformFields(scope.gridform.formFields),scope.gridform.formFields=[]),scope.gridform.edit(),scope.$root.$safeApply(scope),scope.isLayoutDialog&&(scope.gridform.isUpdateMode="dblclick"===eventName?scope.gridform.updateMode:!0,DialogService.showDialog(scope.gridform._dialogid,{resolve:{},scope:scope.gridform}))})),handlers.push(scope.grid.$on("on-row-delete",function(){scope.gridform.clearData(),scope.gridform.isSelected=!1})),scope.gridform.$watch("primaryKey",function(newVal){scope.primaryKey=newVal}),handlers.push(scope.gridform.$on("on-cancel",function(){scope.gridform.isUpdateMode=!1,scope.isLayoutDialog&&DialogService.hideDialog(scope.gridform._dialogid)})),handlers.push(scope.gridform.$on("on-result",function(event,operation,response,newForm){switch(scope.gridform.isUpdateMode=newForm?!0:!1,operation){case"insert":newForm?(scope.grid.gridfirstrowselect=!1,scope.grid.initiateHighlightRow("last",response,scope.primaryKey,!0)):scope.grid.initiateHighlightRow("last",response,scope.primaryKey),WM.isDefined(scope.grid.onRowinsert)&&scope.grid.onRowinsert(response);break;case"update":scope.grid.initiateHighlightRow("current",response,scope.primaryKey);break;case"delete":scope.grid.onRecordDelete()}scope.isLayoutDialog&&(newForm?"insert"===operation?scope.gridform["new"]():"update"===operation&&scope.gridform.edit():DialogService.hideDialog(scope.gridform._dialogid))}))),$compile(attrs.gridColumnMarkup)(scope),scope.$on("$destroy",function(){handlers.forEach(Utils.triggerFn)}),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler,scope,notifyFor),$timeout(function(){WidgetUtilService.postWidgetCreate(scope,element,attrs)},0,!1)}}}}}]),WM.module("wm.layouts.containers").directive("wmListtemplate",["PropertiesFactory","WidgetUtilService","$rootScope","CONSTANTS","$timeout",function(PropertiesFactory,WidgetUtilService,$rootScope,CONSTANTS,$timeout){"use strict";function updateLiveListTemplate($is){$timeout(function(){$rootScope.$emit("livelist-template-modified",{widgetName:$is.name,bindDataset:null,fields:null,forceUpdate:!0,isTemplateUpdate:!0})},void 0)}function propertyChangeHandler($is,key,newVal){switch(key){case"layout":newVal&&$is.newcolumns&&(updateLiveListTemplate($is),$is.newcolumns=!1)}}function templateFn(){return'<li init-widget class="app-listtemplate list-group-item app-list-item" data-ng-show="show" apply-styles="container" wmtransclude></li>'}function preLinkFn($is){$is.widgetProps=widgetProps}function studioMode_postLinkFn($is,$el,attrs){var onPropertyChange=propertyChangeHandler.bind(void 0,$is);onPropertyChange.notifyFor=notifyFor,$is.propertyManager.add($is.propertyManager.ACTIONS.CHANGE,onPropertyChange),WidgetUtilService.postWidgetCreate($is,$el,attrs)}function runMode_preLinkFn($is,$el,attrs,listCtrl){listCtrl.$set("listTemplate",$el.children()),$el.remove()}var widgetProps,notifyFor,directiveDefn={restrict:"E",replace:!0};return CONSTANTS.isStudioMode&&(widgetProps=PropertiesFactory.getPropertiesOf("wm.layouts.listtemplate",["wm.containers"]),notifyFor={layout:!0}),CONSTANTS.isStudioMode?WM.extend(directiveDefn,{transclude:!0,scope:{},template:templateFn,link:{pre:preLinkFn,post:studioMode_postLinkFn}}):WM.extend(directiveDefn,{terminal:!0,require:"^wmLivelist",link:{pre:runMode_preLinkFn}}),directiveDefn}]),WM.module("wm.widgets.live").run(["$templateCache",function($tc){"use strict";$tc.put("template/widget/list.html",'<div class="app-livelist panel" init-widget apply-styles="shell" data-ng-show="show"><div class="panel-heading" data-ng-if="title"><h4 class="panel-title">{{title}}</h4></div><ul data-identifier="list" class="clearfix" title="{{hint}}" data-ng-class="listclass" wmtransclude data-ng-style="{height: height, overflow: overflow, paddingTop: paddingtop + paddingunit, paddingRight: paddingright + paddingunit, paddingLeft: paddingleft + paddingunit, paddingBottom: paddingbottom + paddingunit}"></ul><div class="no-data-msg" data-ng-show="noDataFound">{{::$root.appLocale.MESSAGE_LIVELIST_NO_DATA}}</div><div class="panel-footer" data-ng-if="navigation !== \'None\'"><wm-datanavigator showrecordcount="true" navcontrols="{{navControls}}"></wm-datanavigator></div></div>')}]).controller("listController",[function(){"use strict";var _map={};this.$set=function(key,value){_map[key]=value},this.$get=function(key){return _map[key]}}]).directive("wmLivelist",["WidgetUtilService","PropertiesFactory","$templateCache","CONSTANTS","$compile","Utils","$rootScope","$servicevariable","$timeout",function(WidgetUtilService,PropertiesFactory,$tc,CONSTANTS,$compile,Utils,$rs,$servicevariable,$timeout){"use strict";function getRowClass(itemsperrow){if(!itemsperrow)return void 0;var col=itemsperrow&&12/+itemsperrow;return $rs.isMobileApplicationType?" col-xs-"+col:"col-sm-"+col+" col-md-"+col}function getVariable($is,variableName){if(!variableName)return void 0;var variables=$is.Variables||{};return variables[variableName]}function updateSelectedItemDataType($is,variable){variable&&($is.widgetProps.selecteditem.type=variable.type)}function getColumnsFromDataSet(dataset){return WM.isObject(dataset)?WM.isArray(dataset)&&WM.isObject(dataset[0])?_.keys(dataset[0]):_.keys(dataset):[]}function getColumnsFromPropertiesMap(propertiesMap){return propertiesMap&&propertiesMap.columns?propertiesMap.columns.map(function(column){return column.fieldName}):[]}function getBoundWidgetDatasetDetails($is){var dataSetParts,refVariable,refVariableName,relFieldName,relFieldType,fields,details,isBoundToSelectedItemSubset=_.includes($is.binddataset,"selecteditem.");return dataSetParts=$is.binddataset.split("."),refVariableName=Utils.getVariableName($is),refVariable=getVariable($is,refVariableName),relFieldName=isBoundToSelectedItemSubset&&dataSetParts[3],fields=$rs.dataTypes[refVariable["package"]].fields,details={refVariableName:refVariableName,refVariable:refVariable},relFieldName?(relFieldType=fields[relFieldName].type,details.relFieldType=relFieldType):details.fields=fields,details}function fetchDynamicColumns($is){var result,fields=[];return result=getBoundWidgetDatasetDetails($is),result.fields?fields=result.fields:result.relFieldType&&(fields=$servicevariable.getServiceModel({typeRef:result.relFieldType,variable:result.refVariable})),WM.isObject(fields)?_.keys(fields):fields}function updateLiveListBindings($is,forceUpdate){var columns;columns=$is.dataset&&$is.dataset.propertiesMap?getColumnsFromPropertiesMap($is.dataset.propertiesMap):getColumnsFromDataSet($is.dataset),columns&&columns.length||_.includes($is.binddataset,"bind:Widgets.")&&(columns=fetchDynamicColumns($is)),$rs.$emit("livelist-template-modified",{widgetName:$is.name,bindDataset:$is.binddataset,fields:columns,forceUpdate:forceUpdate})}function handlePageSizeDisplay($is,variableObj){variableObj&&($is.widgetProps.pagesize.disabled="wm.LiveVariable"===variableObj.category)}function setFetchInProgress($is,inProgress){$is.$liScope.fetchInProgress=inProgress}function bindScrollEvt($is,$el){var $dataNavigator=$el.find("> .panel-footer > [data-identifier=datanavigator]"),navigator=$dataNavigator.isolateScope();$el.find("> ul").children().first().scrollParent(!1).off("scroll.livelist").on("scroll.livelist",function(evt){var clientHeight,totalHeight,scrollTop,target=evt.target;target=target===document?target.scrollingElement:target,clientHeight=target.clientHeight,totalHeight=target.scrollHeight,scrollTop=target.scrollTop,scrollTop+clientHeight>.9*totalHeight&&$rs.$safeApply($is,function(){setFetchInProgress($is,!0),navigator.navigatePage("next"),navigator.isLastPage()&&setFetchInProgress($is,!1)})})}function updateFieldDefs($is,$el,data){var unbindWatcher,_s=$is.$liScope,fieldDefs=_s.fieldDefs;$is.infScroll?(WM.isUndefined(fieldDefs)&&(_s.fieldDefs=fieldDefs=[]),_.forEach(data,function(item){fieldDefs.push(item)}),$timeout(function(){setFetchInProgress($is,!1),fieldDefs.length&&bindScrollEvt($is,$el)})):_s.fieldDefs=data,data.length||($is.noDataFound=!0,$is.selecteditem=void 0),$is.selectfirstitem&&(unbindWatcher=$is.$watch(function(){var items=$el.find(".list-group li.app-list-item:first-of-type");items.length&&$rs.$safeApply($is,function(){$timeout(function(){items.first().click()},0,!1),unbindWatcher()})}))}function onDataChange($is,$el,nv){if(nv){if($is.noDataFound=!1,nv.data)nv=nv.data;else if(!_.includes($is.binddataset,"bind:Widgets.")){var boundVariableName=Utils.getVariableName($is),variable=getVariable($is,boundVariableName);if(variable&&"wm.LiveVariable"===variable.category)return}WM.isObject(nv)&&Utils.isPageable(nv)&&(nv=nv.content),WM.isObject(nv)&&!WM.isArray(nv)&&(nv=[nv]),$is.binddataset||WM.isString(nv)&&(nv=nv.split(",")),WM.isArray(nv)&&updateFieldDefs($is,$el,nv)}else CONSTANTS.isRunMode&&updateFieldDefs($is,$el,[])}function setupDataSource($is,$el,nv){var $dataNavigator,dataNavigator,binddataset;$is.navControls||$is.infScroll?(binddataset=$is.binddataset,Utils.triggerFn($is._watchers.dataset),$timeout(function(){$dataNavigator=$el.find("> .panel-footer > [data-identifier=datanavigator]"),dataNavigator=$dataNavigator.isolateScope(),dataNavigator.pagingOptions={maxResults:$is.pagesize||20},Utils.triggerFn($is._watchers.dataNavigatorResult),Utils.triggerFn($is._watchers.dataNavigatorMaxResults),$is._watchers.dataNavigatorResult=dataNavigator.$watch("result",function(_nv){onDataChange($is,$el,_nv)}),$is._watchers.dataNavigatorMaxResults=dataNavigator.$watch("maxResults",function(_nv){$is.pagesize=_nv}),dataNavigator.dataset=binddataset})):onDataChange($is,$el,nv)}function studioMode_onDataSetChange($is,doNotRemoveTemplate){var boundVariableName=Utils.getVariableName($is),variable=getVariable($is,boundVariableName);$is.oldbinddataset!==$is.binddataset&&$is._isInitialized&&(doNotRemoveTemplate||updateLiveListBindings($is,!0)),handlePageSizeDisplay($is,variable),updateSelectedItemDataType($is,variable)}function runMode_onDataSetChange($is,$el,nv){$is.oldbinddataset!==$is.binddataset?setupDataSource($is,$el,nv):onDataChange($is,$el,nv)}function onDataSetChange($is,$el,doNotRemoveTemplate,nv){CONSTANTS.isStudioMode?studioMode_onDataSetChange($is,doNotRemoveTemplate):runMode_onDataSetChange($is,$el,nv),$is.oldbinddataset=$is.binddataset}function resetNavigation($is){$is.navControls=void 0,$is.infScroll=!1}function enableBasicNavigation($is){$is.navControls=NAVIGATION.BASIC}function enableAdvancedNavigation($is){$is.navControls=NAVIGATION.ADVANCED}function enableInfiniteScroll($is){$is.infScroll=!0}function onNavigationTypeChange($is,type){switch(resetNavigation($is),type){case NAVIGATION.BASIC:enableBasicNavigation($is);break;case NAVIGATION.ADVANCED:enableAdvancedNavigation($is);break;case NAVIGATION.SCROLL:enableInfiniteScroll($is)}}function propertyChangeHandler($is,$el,attrs,key,nv,ov){var doNotRemoveTemplate,oldClass,newClass;return"dataset"===key?(doNotRemoveTemplate="true"===attrs.template,void onDataSetChange($is,$el,doNotRemoveTemplate,nv)):void(CONSTANTS.isStudioMode&&("itemsperrow"===key?(oldClass=ov&&"col-md-"+12/+ov,newClass=nv&&"col-md-"+12/+nv,$el.find(".app-listtemplate").removeClass(oldClass).addClass(newClass)):onNavigationTypeChange($is,nv)))}function defineProps($is,$el){var _scope=$el.scope();Object.defineProperties($is,{Variables:{get:function(){return _scope.Variables}},Widgets:{get:function(){return _scope.Widgets}}})}function createChildScope($is,$el,attrs){var _scope=$el.scope(),$liScope=_scope.$new();return WM.extend($liScope,{onClick:$is.onClick,onMouseenter:$is.onMouseenter,onMouseleave:$is.onMouseleave,onEnterkeypress:$is.onEnterkeypress,onSetrecord:$is.onSetrecord,itemclass:$is.itemclass,itemsPerRowClass:getRowClass(attrs.itemsperrow)}),$liScope}function updateTmplAttrs(parentDataSet,idx,node){var _parentDataSet=parentDataSet.replace("bind:",""),regex=new RegExp("("+_parentDataSet+")(\\[0\\])?(.data\\[\\$i\\])?(.content\\[\\$i\\])?(\\[\\$i\\])?","g");_.forEach(node.attributes,function(attr){var value=attr.value;_.startsWith(value,"bind:")&&_.includes(value,_parentDataSet)&&(value=value.replace("bind:",""),value=value.replace(regex,"item"),attr.value="{{"+value+"}}")})}function applyWrapper($tmplContent,attrs){var tmpl=liTemplateWrapper_start;return attrs.hasOwnProperty("onMouseenter")&&(tmpl+=' data-ng-mouseenter="onMouseenter({$event: $event, $scope: this})" '),
attrs.hasOwnProperty("onMouseleave")&&(tmpl+=' data-ng-mouseleave="onMouseleave({$event: $event, $scope: this})" '),tmpl+=liTemplateWrapper_end,tmpl=WM.element(tmpl),tmpl.first().append($tmplContent),tmpl}function prepareLITemplate(tmpl,attrs){var $tmpl=WM.element(tmpl),$div=WM.element("<div></div>").append($tmpl),parentDataSet=attrs.dataset||attrs.scopedataset;return parentDataSet&&$div.find("*").each(updateTmplAttrs.bind(void 0,parentDataSet)),$tmpl=applyWrapper($tmpl,attrs)}function setupEvtHandlers($is,$el){$el.on("click.wmActive","ul",function(evt){var $li=WM.element(evt.target).closest("li.app-list-item"),$liScope=$li.scope();$li&&($el.find("li.active").removeClass("active"),$li.addClass("active"),$liScope&&($is.selecteditem=$liScope.item||null,Utils.triggerFn($liScope.onClick,{$event:evt,$scope:$liScope}),$rs.$safeApply($is)))})}function preLinkFn($is,$el,attrs){CONSTANTS.isStudioMode?$is.widgetProps=WM.copy(widgetProps):$is.widgetProps=widgetProps,$is.oldbinddataset=CONSTANTS.isStudioMode?attrs.dataset:void 0,$is.dataset=[],$is.fieldDefs=[],$is.noDataFound=!1,defineProps($is,$el)}function postLinkFn($is,$el,attrs,listCtrl){var $liScope,$liTemplate;$liScope=createChildScope($is,$el,attrs),$is.$liScope=$liScope,CONSTANTS.isRunMode&&($liTemplate=prepareLITemplate(listCtrl.$get("listTemplate"),attrs),$el.find("> [data-identifier=list]").prepend($liTemplate),$compile($liTemplate)($liScope),attrs.scopedataset&&$is.$watch("scopedataset",function(nv){nv&&!$is.dataset&&updateFieldDefs($is,$el,nv)},!0),setupEvtHandlers($is,$el)),WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,$is,$el,attrs),$is,notifyFor),attrs.hasOwnProperty("shownavigation")&&"true"===attrs.shownavigation&&($is.navigation=NAVIGATION.ADVANCED),onNavigationTypeChange($is,$is.navigation),WidgetUtilService.postWidgetCreate($is,$el,attrs)}function compileFn($tEl,tAttrs){return CONSTANTS.isStudioMode&&(window[tAttrs.name+"Controller"]=WM.noop),{pre:preLinkFn,post:postLinkFn}}var directiveDefn,widgetProps=PropertiesFactory.getPropertiesOf("wm.livelist",["wm.base","wm.base.editors","wm.base.events"]),liTemplateWrapper_start='<li data-ng-repeat="item in fieldDefs track by $index" class="app-list-item" data-ng-class="[itemsPerRowClass, itemclass]" ',liTemplateWrapper_end='></li><li data-ng-show="fetchInProgress"><i class="fa fa-spinner fa-spin fa-2x"></i> loading...</li>',notifyFor={dataset:!0,navigation:CONSTANTS.isStudioMode,itemsperrow:CONSTANTS.isStudioMode},NAVIGATION={BASIC:"Basic",ADVANCED:"Advanced",SCROLL:"Scroll"};return directiveDefn={restrict:"E",replace:!0,transclude:!0,scope:{},template:$tc.get("template/widget/list.html"),compile:compileFn},CONSTANTS.isRunMode&&(directiveDefn.controller="listController",directiveDefn.scope={scopedataset:"=?",onClick:"&",onMouseenter:"&",onMouseleave:"&",onEnterkeypress:"&",onSetrecord:"&"}),directiveDefn}]),WM.module("wm.widgets.advanced").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/calendar.html",'<div class="app-calendar" init-widget has-model  data-ng-model ="_model_" data-ng-show = "show" data-ng-change="_onChange({$event: $event, $scope: this})" apply-styles="shell"><div ui-calendar="calendarOptions.calendar" calendar="{{name}}" ng-model="eventSources"></div></div>')}]).directive("wmCalendar",["PropertiesFactory","WidgetUtilService","$compile","$locale","CONSTANTS","Utils",function(PropertiesFactory,WidgetUtilService,$compile,$locale,CONSTANTS,Utils){"use strict";function updateCalendarOptions(scope){var ctrls=scope.controls,viewType=scope.calendartype,left="",right="";ctrls&&viewType&&(_.includes(ctrls,"navigation")&&(left+=" prev next"),_.includes(ctrls,"today")&&(left+=" today"),_.includes(ctrls,"month")&&(right+=" month"),_.includes(ctrls,"week")&&(right+=viewType===VIEW_TYPES.BASIC?" basicWeek":" agendaWeek"),_.includes(ctrls,"day")&&(right+=viewType===VIEW_TYPES.BASIC?" basicDay":" agendaDay"),WM.extend(scope.calendarOptions.calendar.header,{left:left,right:right}))}function propertyChangeHandler(scope,key,newVal){var calendar=scope.calendarOptions.calendar;switch(key){case"dataset":_.includes(scope.eventSources,newVal)||scope.eventSources.push(newVal);break;case"height":calendar.height=parseInt(newVal,10);break;case"controls":case"calendartype":updateCalendarOptions(scope);break;case"view":"month"!==newVal?calendar.defaultView=scope.calendartype+_.capitalize(newVal):calendar.defaultView=newVal}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.calendar",["wm.base","wm.base.datetime"]),notifyFor={dataset:!0,height:!0,controls:!0,calendartype:!0,view:!0},defaultHeaderOptions={left:"prev next today",center:"title",right:"month basicWeek basicDay"},VIEW_TYPES={BASIC:"basic",AGENDA:"agenda"};return{restrict:"E",replace:!0,scope:{scopedataset:"=?",onDayclick:"&",onEventdrop:"&",onEventresize:"&",onEventclick:"&",onEventrender:"&"},template:function(tElement,tAttrs){var template=WM.element(WidgetUtilService.getPreparedTemplate("template/widget/calendar.html",tElement,tAttrs));return template.find(".model-holder").attr("name",tAttrs.name),tAttrs.hasOwnProperty("disabled")&&template.find("datepicker").attr("date-disabled",!0),template[0].outerHTML},compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps,scope.events=[],scope.eventSources=[scope.events]},post:function(scope,element,attrs){function dayProxy(date,jsEvent,view){scope.onDayclick({$date:date,$jsEvent:jsEvent,$view:view})}function eventProxy(method,event,delta,revertFunc,jsEvent,ui,view){var fn=scope[method]||WM.noop;fn({$event:event,$delta:delta,$revertFunc:revertFunc,$jsEvent:jsEvent,$ui:ui,$view:view})}function eventClickProxy(event,jsEvent,view){scope.onEventclick({$event:event,$jsEvent:jsEvent,$view:view})}function eventRenderProxy(event,jsEvent,view){scope.onEventrender({$event:event,jsEvent:{},$view:view})}var uiCalScope,handlers=[],headerOptions=WM.copy(defaultHeaderOptions);scope.calendarOptions={calendar:{height:parseInt(scope.height,10),editable:!0,header:headerOptions,dayClick:dayProxy,eventDrop:eventProxy.bind(void 0,"onEventdrop"),eventResize:eventProxy.bind(void 0,"onEventresize"),eventClick:eventClickProxy,eventRender:eventRenderProxy,dayNames:$locale.DATETIME_FORMATS.DAY,dayNamesShort:$locale.DATETIME_FORMATS.SHORTDAY}},scope.$root.$on("locale-change",function(){scope.calendarOptions.calendar.dayNames=$locale.DATETIME_FORMATS.DAY,scope.calendarOptions.calendar.dayNamesShort=$locale.DATETIME_FORMATS.SHORTDAY}),scope.addRemoveEventSource=function(sources,source){var canAdd=0;WM.forEach(sources,function(value,key){sources[key]===source&&(sources.splice(key,1),canAdd=1)}),0===canAdd&&sources.push(source)},scope.addEvent=function(eventObject){scope.events.push(eventObject)},scope.remove=function(index){scope.events.splice(index,1)},scope.eventRender=function(event,element){element.attr({tooltip:event.title,"tooltip-append-to-body":!0}),$compile(element)(scope)},CONSTANTS.isRunMode&&(attrs.scopedataset&&handlers.push(scope.$watch("scopedataset",function(newVal){scope.eventSources.push(newVal)},!0)),uiCalScope=element.children().first().isolateScope(),scope.redraw=_.debounce(function(){uiCalScope.destroy(),uiCalScope.init()},50)),scope.$on("$destroy",function(){handlers.forEach(Utils.triggerFn)}),scope.redraw=function(){element.children().first().fullCalendar("render")},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,scope),scope,notifyFor),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.advanced").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/advanced/login.html",'<div init-widget class="app-login" data-ng-show="show" apply-styles="container"><wm-message scopedataset="loginMessage" class="app-login-message"></wm-message><form autocomplete="off" class="app-form app-login-form" method="post" wmtransclude></form></div>')}]).directive("wmLogin",["PropertiesFactory","$rootScope","$templateCache","WidgetUtilService","CONSTANTS","$controller",function(PropertiesFactory,$rootScope,$templateCache,WidgetUtilService,CONSTANTS,$controller){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.login",["wm.base","wm.base.editors","wm.base.events.successerror"]);return{restrict:"E",replace:!0,scope:{onSuccess:"&",onError:"&"},transclude:!0,template:$templateCache.get("template/widget/advanced/login.html"),compile:function(tElement,tAttr){return CONSTANTS.isStudioMode&&(window[tAttr.name+"Controller"]=WM.noop),{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs){if(CONSTANTS.isRunMode){var loginController;try{loginController=scope.name+"Controller",$controller(loginController,{$scope:element.scope()})}catch(ignore){}element.find(".app-login-button").unbind("click"),element.find(".app-login-button").click(function(event){var loginDetails,successFn=attrs.onSuccess||"",errorFn=attrs.onError||"",submitFn=attrs.onSubmit||"",clickFn=WM.element(this).isolateScope().onClick||"",onSuccess=function(){element.trigger("success"),-1!==successFn.indexOf("(")?scope.onSuccess({$event:event,$scope:scope}):$rootScope.$emit("invoke-service",successFn,{scope:element.scope()})},onError=function(error){scope.loginMessage={type:"error",caption:scope.errormessage||error||$rootScope.appLocale.LABEL_INVALID_USERNAME_OR_PASSWORD},element.trigger("error"),-1!==errorFn.indexOf("(")?scope.onError({$event:event,$scope:scope}):$rootScope.$emit("invoke-service",errorFn,{scope:element.scope()})};scope.loginMessage=null,submitFn||clickFn?(clickFn&&clickFn({$event:event,$scope:scope}),-1!==submitFn.indexOf("(")?scope.onSubmit({$event:event,$scope:scope}):$rootScope.$emit("invoke-service",submitFn,{scope:element.scope()},onSuccess,onError)):(loginDetails={username:element.find('[name="usernametext"]').val(),password:element.find('[name="passwordtext"]').val()},element.scope().Variables.loginVariable.login({loginInfo:loginDetails},onSuccess,onError))})}WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.advanced").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/advanced/carousel/carousel.html",'<div init-widget class="app-carousel carousel slide" data-ng-show="show" apply-styles><ol class="carousel-indicators"><li data-ng-repeat="content in contents" data-ng-class="{\'active\': activeIndex === $index}" data-ng-click="goTo($index)"></li></ol><div class="carousel-inner" wmtransclude></div><a class="left carousel-control" data-ng-click="previous()"><i class="glyphicon glyphicon-chevron-left"></i></a><a class="right carousel-control" data-ng-click="next()"><i class="glyphicon glyphicon-chevron-right"></i></a></div>'),$templateCache.put("template/widget/advanced/carousel/design/carousel.html",'<div init-widget class="app-carousel carousel slide" data-ng-show="show" apply-styles><div class="carousel-inner" wmtransclude></div><div class="carousel-actions"><ul class="pagination" ><li data-ng-repeat="content in contents" data-ng-class="{\'active\': activeIndex === $index}""><a href="javascript:void(0);" data-ng-click="goTo($index)">{{$index + 1}}</a></li></ul></div></div>'),$templateCache.put("template/widget/advanced/carousel/carousel-content.html",'<div class="app-carousel-item item" apply-styles init-widget wmtransclude></div>')}]).directive("wmCarousel",["$interval","PropertiesFactory","$templateCache","CONSTANTS","$timeout","WidgetUtilService",function($interval,PropertiesFactory,$templateCache,CONSTANTS,$timeout,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.carousel",["wm.base","wm.containers"]);return{restrict:"E",scope:{},transclude:!0,template:$templateCache.get("template/widget/advanced/carousel"+(CONSTANTS.isStudioMode?"/design/":"/")+"carousel.html"),replace:!0,controller:function($scope){this.register=function(contentScope){$scope.contents.length||contentScope.getElement().addClass("active"),$scope.contents.push(contentScope),CONSTANTS.isStudioMode&&$scope.last()},this.unregister=function(contentScope){var i,len=$scope.contents.length;for(i=0;len>i&&$scope.contents[i].$id!==contentScope.$id;i++);$scope.contents.splice(i,1),$scope.goTo($scope.activeIndex)}},compile:function(){return{pre:function(scope){function animateSlide($active,$next,type){var direction="next"===type?"left":"right";$next.addClass(type),$next[0].offsetWidth,$active.addClass(direction),$next.addClass(direction),$timeout(function(){$next.removeClass([type,direction].join(" ")).addClass("active"),$active.removeClass(["active",direction].join(" "))},600,!1)}scope.widgetProps=widgetProps,scope.contents=[],scope.activeIndex=0,scope.goTo=function(index){if(scope.contents[scope.activeIndex]){var oldElement=scope.contents[scope.activeIndex].getElement(),newElement=scope.contents[index].getElement(),type="next";CONSTANTS.isStudioMode?(oldElement.removeClass("active"),newElement.addClass("active"),scope.activeIndex=index):(scope.stop(),scope.activeIndex>index&&(type="prev"),animateSlide(oldElement,newElement,type),scope.activeIndex=index,scope.play())}},scope.next=function(){scope.activeIndex>scope.contents.length-2?scope.goTo(0):scope.goTo(scope.activeIndex+1)},scope.previous=function(){scope.activeIndex<1?scope.goTo(scope.contents.length-1):scope.goTo(scope.activeIndex-1)},scope.first=function(){scope.goTo(0)},scope.last=function(){scope.goTo(scope.contents.length-1)},CONSTANTS.isRunMode&&(scope.play=function(){!scope.autoPlay&&scope.animationinterval>=1&&(scope.autoPlay=$interval(function(){scope.next()},1e3*scope.animationinterval))},scope.stop=function(){scope.autoPlay&&$interval.cancel(scope.autoPlay),scope.autoPlay=void 0})},post:function(scope,element,attrs){CONSTANTS.isRunMode&&scope.play(),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]).directive("wmCarouselContent",["PropertiesFactory","$templateCache","WidgetUtilService",function(PropertiesFactory,$templateCache,WidgetUtilService){"use strict";var widgetProps=PropertiesFactory.getPropertiesOf("wm.carouselcontent",["wm.base","wm.layouts"]);return{restrict:"E",scope:{},transclude:!0,template:$templateCache.get("template/widget/advanced/carousel/carousel-content.html"),replace:!0,require:"^wmCarousel",compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(scope,element,attrs,controller){scope.getElement=function(){return element},scope.$on("$destroy",function(){controller.unregister(scope)}),controller.register(scope),WidgetUtilService.postWidgetCreate(scope,element,attrs)}}}}}]),WM.module("wm.widgets.advanced").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("template/widget/advanced/rating.html",'<div data-ng-model="_model_" data-ng-show="show" class="app-ratings" init-widget has-model apply-styles><div data-ng-if="!readonly" class="rating-style"><label data-ng-class="{active : rate.value <= datavalue}" for="{{$id}}+{{rate.value}}" data-ng-style="{\'font-size\':iconsize}" data-ng-repeat="rate in range track by $index" title="{{rate.value}}"><input type="radio" id="{{$id}}+{{rate.value}}" data-ng-click="getActiveElements($event)" name="{{ratingname}}" value="{{rate.value}}"/></label></div><div data-ng-if="readonly" data-ng-style="{\'font-size\':iconsize}" class="ratings-container disabled" ><div class="ratings active" data-ng-style="{width: ratingsWidth()}"></div></div><label class="caption">{{caption}}</label></div>')}]).directive("wmRating",["PropertiesFactory","WidgetUtilService",function(PropertiesFactory,WidgetUtilService){"use strict";function propertyChangeHandler(scope,key,newVal){switch(key){case"maxvalue":var i,range=[],maxValue=parseInt(newVal,10);for(i=maxValue||MAX_RATING;i>0;i--)range.push({value:i});scope.range=range,scope.ratingname="ratings-"+scope.$id}}var widgetProps=PropertiesFactory.getPropertiesOf("wm.rating",["wm.base","wm.base.editors"]),notifyFor={maxvalue:!0,readonly:!0},MAX_RATING=5;return{restrict:"E",replace:!0,scope:{},template:WidgetUtilService.getPreparedTemplate.bind(void 0,"template/widget/advanced/rating.html"),compile:function(){return{pre:function(scope){scope.widgetProps=widgetProps},post:function(iScope,$el,attrs){WM.isString(iScope.datavalue)&&(iScope.datavalue=parseInt(iScope.datavalue,10)),iScope.getActiveElements=function($event){iScope._model_=$el.find(":checked").val(),iScope._onChange($event)},iScope.ratingsWidth=function(){var dataValue=parseFloat(iScope.datavalue),starWidth=.925,maxValue=parseInt(iScope.maxvalue,10)||MAX_RATING;return $el.find(".ratings-container").css("width",starWidth*maxValue+"em"),void 0===iScope.datavalue||""===iScope.datavalue||null===iScope.datavalue?0:maxValue>=dataValue&&dataValue>=0?dataValue*starWidth+"em":dataValue>maxValue?maxValue*starWidth+"em":void 0},WidgetUtilService.registerPropertyChangeListener(propertyChangeHandler.bind(void 0,iScope),iScope,notifyFor),WidgetUtilService.postWidgetCreate(iScope,$el,attrs)}}}}}]),WM.module("wm.prefabs").factory("debugModePrefabResourceInterceptor",[function(){"use strict";function getDevModePrefabUrl(requestUrl){var matchFound,redirectUrl,url;return(url=cache[requestUrl])?url:(matchFound=_.some(configs,function(config){var _url,index,resourceMatch=config.resourceMatch,servicesMatch=config.servicesMatch,prefabName=config.prefabName;return index=requestUrl.indexOf(resourceMatch),-1!==index?_url=requestUrl.substr(index+prefabName.length+13):(index=requestUrl.indexOf(servicesMatch),-1!==index&&(_url=requestUrl.substr(index+prefabName.length+10),_url="/services/"+_url)),redirectUrl=config.prefabAppUrl+_url,!!_url}),matchFound?(cache[requestUrl]=redirectUrl,redirectUrl):void 0)}function requestInterceptor(config){if(enableInterceptor){var _url=getDevModePrefabUrl(config.url);_url&&(config.url=_url)}return config}function registerConfig(pfName,url){enableInterceptor=!0,url.endsWith("/")||(url+="/"),configs.push({prefabName:pfName,prefabAppUrl:url,resourceMatch:"app/prefabs/"+pfName+"/",servicesMatch:"/prefabs/"+pfName+"/"})}var enableInterceptor,configs=[],cache={};return{request:requestInterceptor,register:registerConfig}}]).directive("wmPrefab",["PrefabManager","Utils","$compile","PropertiesFactory","WidgetUtilService","CONSTANTS","$timeout","WIDGET_CONSTANTS","$rootScope","DialogService","PrefabService","debugModePrefabResourceInterceptor",function(PrefabManager,Utils,$compile,PropertiesFactory,WidgetUtilService,CONSTANTS,$timeout,WIDGET_CONSTANTS,$rootScope,DialogService,PrefabService,debugModePrefabResourceInterceptor){"use strict";function onConfigLoad(iScope,serverProps,config){if(prefabWidgetPropsMap[iScope.prefabname])return iScope.widgetProps=WM.copy(prefabWidgetPropsMap[iScope.prefabname]),iScope._methodsMap=prefabMethodsMap[iScope.prefabname],void(CONSTANTS.isStudioMode&&(iScope.serverProps=serverProps));var prefabProperties,prefabEvents,userDefinedProps,widgetProps={},methodsMap={};CONSTANTS.isStudioMode&&(prefabProperties=[],prefabEvents=[],propertiesGroup.subGroups.splice(1,0,{boundPrefabName:iScope.prefabname,name:iScope.prefabname+"_properties",parent:"properties",properties:prefabProperties}),eventsGroup.subGroups.push({boundPrefabName:iScope.prefabname,name:iScope.prefabname+"_events",parent:"events",properties:prefabEvents}),iScope.serverProps=serverProps),userDefinedProps=config.properties||{},iScope.prefabid=config.id,WM.forEach(userDefinedProps,function(prop,key){if("method"===prop.type)return void(methodsMap[key]=prop);if(widgetProps[key]=prop,Utils.stringStartsWith(prop.value,"bind:")&&(prop.__value=prop.value,prop.value=void 0),CONSTANTS.isStudioMode){var found=propertyGroups.some(function(group){return-1!==group.properties.indexOf(key)});found||("event"===prop.type?prefabEvents.push(key):prefabProperties.push(key)),prop.hasOwnProperty("show")||(prop.show=!0),prop.hasOwnProperty("disabled")||(prop.disabled=!1),"event"===prop.type?prop.options=WIDGET_CONSTANTS.EVENTS_OPTIONS:prop.label=Utils.initCaps(key)}}),WM.forEach(prefabDefaultProps,function(prop,key){WM.isUndefined(widgetProps[key])&&(widgetProps[key]=prop)}),prefabWidgetPropsMap[iScope.prefabname]=widgetProps,prefabMethodsMap[iScope.prefabname]=methodsMap,iScope.widgetProps=WM.copy(prefabWidgetPropsMap[iScope.prefabname]),iScope._methodsMap=prefabMethodsMap[iScope.prefabname],CONSTANTS.isStudioMode&&(iScope.serverProps=serverProps)}var propertyGroups,propertiesGroup,eventsGroup,prefabDefaultProps=PropertiesFactory.getPropertiesOf("wm.prefabs",["wm.base"]),depsMap={},prefabWidgetPropsMap={},prefabMethodsMap={};return CONSTANTS.isStudioMode&&!function(){var groups=PropertiesFactory.getPropertyGroups();propertyGroups=groups.filter(function(group){return"properties"===group.name?propertiesGroup=group:"events"===group.name&&(eventsGroup=group),!!group.parent})}(),{restrict:"E",scope:{prefabname:"@"},replace:!0,template:'<section  data-role="prefab" init-widget class="app-prefab" data-ng-style="{width:width, height:height,marginBottom: marginbottom + marginunit, marginLeft: marginleft + marginunit, marginRight: marginright + marginunit, marginTop: margintop + marginunit }" data-ng-show="show"></section>',compile:function(){return{pre:function(iScope,element,attrs){function loadDependencies(){CONSTANTS.isStudioMode&&PrefabService.getAppPrefabServerProps({projectID:$rootScope.project.id,prefabName:iScope.prefabname},function(response){serverProps=response||{}}),PrefabManager.loadAppPrefabConfig(iScope.prefabname,onConfigLoad.bind(void 0,iScope,serverProps))}var serverProps;CONSTANTS.isStudioMode&&void 0!==attrs.registrationRequired?PrefabManager.registerPrefab(iScope.prefabname,loadDependencies):loadDependencies()},post:function(iScope,element,attrs){function listenerFn(event,eventName){var parts,methodProps,fn,fnName,subParts,dialogId;eventName&&(parts=eventName.split("."),parts[0]===iScope.name&&2===parts.length&&iScope._methodsMap[parts[1]]&&(event.stopPropagation(),methodProps=iScope._methodsMap[parts[1]],fnName=methodProps.method,fn=iScope.ctrlScope[fnName],WM.isFunction(fn)?Utils.triggerFn(fn):(subParts=fnName.split("."),2===subParts.length?(dialogId=subParts[0],"show"===subParts[1]?DialogService.showDialog(dialogId,{scope:iScope.ctrlScope}):"hide"===subParts[1]&&DialogService.hideDialog(dialogId)):$rootScope.$emit("invoke-service",fnName,{scope:iScope.ctrlScope}))))}function onTemplateLoad(){var pfScope=element.find("[data-ng-controller]").scope();WM.forEach(iScope.widgetProps,function(propDetails,propName){if(propDetails.__value&&!attrs.hasOwnProperty(propName)){var key=propDetails.__value.replace("bind:","");iScope._watchers[propName]=pfScope.$watch(key,function(nv){iScope[propName+"__updateFromWatcher"]=!0,iScope[propName]=nv})}}),WidgetUtilService.postWidgetCreate(iScope,element,attrs),Utils.triggerFn(pfScope.onInitPrefab),CONSTANTS.isRunMode&&(Utils.triggerFn(iScope.onLoad),iScope.$on("$destroy",iScope.onDestroy)),iScope.ctrlScope=pfScope}function compileTemplate(prefabContent){var prefabEle=WM.element('<div class="full-width full-height">'+prefabContent+"</div>");element.append(prefabEle),$compile(element.children())(iScope),$timeout(onTemplateLoad)}var prefabName=iScope.prefabname;iScope.__compileWithIScope=!0,Object.defineProperty(iScope,"appLocale",{get:function(){return iScope.$root.appLocale}}),iScope.$on("$destroy",$rootScope.$on("invoke-service",listenerFn)),depsMap[prefabName]?compileTemplate(depsMap[prefabName].templateContent):PrefabManager.loadDependencies(prefabName).then(function(templateContent){depsMap[prefabName]={templateContent:templateContent},compileTemplate(templateContent)}),iScope.showServerProps=iScope.serverProps&&Object.keys(iScope.serverProps).length}}}}}]).directive("wmPrefabRun",["$rootScope","Utils","$compile","PrefabManager","WidgetUtilService",function($rootScope,Utils,$compile,PrefabManager,WidgetUtilService){"use strict";function isExternalResource(path){return Utils.stringStartsWith(path,"http://|https://|//")}return{restrict:"E",scope:{},replace:!0,template:'<section  data-role="prefab" init-widget class="app-prefab app-prefab-run"></section>',compile:function(){return{pre:function(scope){var config=$rootScope.prefabConfig;scope.widgetProps=config.properties||[]},post:function(scope,element,attrs){function compileTemplate(){element.append(WM.element($rootScope.prefabTemplate)),$compile(element.children())(scope);var pfScope=element.find("[data-ng-controller]").scope();Object.defineProperties(element.scope(),{Widgets:{get:function(){return pfScope.Widgets}},Variables:{get:function(){return pfScope.Variables}}}),WidgetUtilService.postWidgetCreate(scope,element,attrs),Utils.triggerFn(pfScope.onInitPrefab),scope.ctrlScope=pfScope}var resources,config=$rootScope.prefabConfig;scope.__compileWithIScope=!0,Object.defineProperty(scope,"appLocale",{get:function(){return scope.$root.appLocale}}),config&&(resources=WM.copy(config.resources),resources.scripts&&(resources.scripts=resources.scripts.map(function(script){var _script=script&&script.trim();return isExternalResource(_script)||"/"!==_script.charAt(0)||(_script="."+_script),_script})),resources.styles&&(resources.styles=resources.styles.map(function(style){var _style=style&&style.trim();return isExternalResource(_style)||"/"!==_style.charAt(0)||(_style="."+_style),_style})),resources.modules&&(resources.modules=resources.modules.map(function(module){return module.files=module.files.map(function(file){var _file=file&&file.trim();return isExternalResource(_file)||"/"!==_file.charAt(0)||(_file="."+_file),_file}),module})),Utils.loadStyleSheets(resources.styles),PrefabManager.loadScripts(resources.scripts).then(PrefabManager.loadModules.bind(void 0,resources.modules)).then(compileTemplate))}}}}}]),wm.plugins.database=WM.module("wm.plugins.database",[]),wm.plugins.database.directives={},wm.plugins.database.controllers={},wm.plugins.database.services={},wm.plugins.database.factories={},wm.plugins.database.directive(wm.plugins.database.directives),wm.plugins.database.controller(wm.plugins.database.controllers),wm.plugins.database.service(wm.plugins.database.services),wm.plugins.database.factory(wm.plugins.database.factories),wm.plugins.database.constant("DB_SERVICE_URLS",{Database:{testConnection:{url:"services/projects/:projectID/database/testConnection",method:"POST"},importDB:{url:"services/projects/:projectID/database/import",method:"POST"},reImportDB:{url:"services/projects/:projectID/database/reimport?serviceId=:serviceId",method:"POST"},exportDB:{url:"services/projects/:projectID/database/export",method:"POST"},loadModelInfo:{url:"services/projects/:projectID/database/loadModelInfo",method:"POST"},getAllDataModels:{url:"services/projects/:projectID/datamodels/",method:"GET"},getDataModel:{url:"services/projects/:projectID/datamodels/:dataModelName?isdraft=:isdraft",method:"GET"},createDataModel:{url:"services/projects/:projectID/datamodels",method:"POST"},deleteDataModel:{url:"services/projects/:projectID/datamodels/:dataModelName",method:"DELETE"},saveDataModel:{url:"services/projects/:projectID/datamodels/:dataModelName/save",method:"POST"},applyDataModel:{url:"services/projects/:projectID/datamodels/:dataModelName/apply",method:"POST"},revertDataModel:{url:"services/projects/:projectID/datamodels/:dataModelName/revert",method:"POST"},getAllEntities:{url:"services/projects/:projectID/datamodels/:dataModelName/tables",method:"GET"},getEntity:{url:"services/projects/:projectID/datamodels/:dataModelName/tables/:tableName",method:"GET"},createEntity:{url:"services/projects/:projectID/datamodels/:dataModelName/tables",method:"POST"},updateEntity:{url:"services/projects/:projectID/datamodels/:dataModelName/tables/:entityName",method:"POST"},deleteEntity:{url:"services/projects/:projectID/datamodels/:dataModelName/tables/:entityName",method:"DELETE"},addColumns:{url:"services/projects/:projectID/datamodels/:dataModelName/tables/:entityName/columns",method:"POST"},updateColumn:{url:"services/projects/:projectID/datamodels/:dataModelName/tables/:entityName/columns/:columnName?forceDataLoss=:forceDataLoss",method:"PUT"},deleteColumn:{url:"services/projects/:projectID/datamodels/:dataModelName/tables/:entityName/columns/:columnName",method:"DELETE"},addRelation:{url:"services/projects/:projectID/datamodels/:dataModelName/tables/:entityName/relations",method:"POST"},updateRelation:{url:"services/projects/:projectID/datamodels/:dataModelName/tables/:entityName/relations/:relationName",method:"PUT"},deleteRelation:{url:"services/projects/:projectID/datamodels/:dataModelName/tables/:entityName/relations/:relationName",method:"DELETE"},getAllQueries:{url:"services/projects/:projectID/datamodels/:dataModelName/queries",method:"GET"},getQuery:{url:"services/projects/:projectID/datamodels/:dataModelName/queries/:queryName",method:"GET"},createQuery:{url:"services/projects/:projectID/datamodels/:dataModelName/queries",method:"POST"},updateQuery:{url:"services/projects/:projectID/datamodels/:dataModelName/queries/:queryName",method:"PUT"},deleteQuery:{url:"services/projects/:projectID/datamodels/:dataModelName/queries/:queryName",method:"DELETE"},setQueryMetaData:{url:"services/projects/:projectID/datamodels/:dataModelName/queries/:queryName/metadata",method:"POST"},validateQuery:{url:"services/projects/:projectID/datamodels/:dataModelName/query/validate",method:"POST"},executeQuery:{url:"services/projects/:projectID/datamodels/:dataModelName/query/execute",method:"POST"},getAllProcedures:{url:"services/projects/:projectID/datamodels/:dataModelName/procedures",method:"GET"},getProcedure:{url:"services/projects/:projectID/datamodels/:dataModelName/procedures/:procedureName",method:"GET"},createProcedure:{url:"services/projects/:projectID/datamodels/:dataModelName/procedures",method:"POST"},updateProcedure:{url:"services/projects/:projectID/datamodels/:dataModelName/procedures/:procedureName",method:"PUT"},deleteProcedure:{url:"services/projects/:projectID/datamodels/:dataModelName/procedures/:procedureName",method:"DELETE"},setProcedureMetaData:{url:"services/projects/:projectID/datamodels/:dataModelName/procedures/:procedureName/metadata",method:"POST"},executeProcedure:{url:"services/projects/:projectID/datamodels/:dataModelName/procedures/execute",method:"POST"},readTableData:{url:"/:service/:dataModelName/:entityName/?page=:page&size=:size&:sort",method:"GET"},insertTableData:{url:"/:service/:dataModelName/:entityName/",method:"POST"},insertMultiPartTableData:{url:"/:service/:dataModelName/:entityName/",method:"POST",headers:{"Content-Type":void 0},transformRequest:WM.identity},updateTableData:{url:"/:service/:dataModelName/:entityName/:id",method:"PUT"},updateMultiPartTableData:{url:"/:service/:dataModelName/:entityName/:id",method:"POST",headers:{"Content-Type":void 0},transformRequest:WM.identity},deleteTableData:{url:"/:service/:dataModelName/:entityName/:id",method:"DELETE"},updateCompositeTableData:{url:"/:service/:dataModelName/:entityName/composite-id?:id",method:"PUT"},deleteCompositeTableData:{url:"/:service/:dataModelName/:entityName/composite-id?:id",method:"DELETE"},searchTableData:{url:"/:service/:dataModelName/:entityName/search?page=:page&size=:size&:sort",method:"POST"},readTableRelatedData:{url:"/:service/:dataModelName/:entityName/:id/:relatedFieldName?page=:page&size=:size&:sort",method:"GET"},executeNamedQuery:{url:"/:service/:dataModelName/queryExecutor/queries/:queryName?page=:page&size=:size&:queryParams",method:"GET"},executeCustomQuery:{url:"/:service/:dataModelName/queryExecutor/queries/wm_custom?page=:page&size=:size",method:"POST"},getCustomQueryMetaData:{url:"/:service/:dataModelName/queries/wm_querymetadata",method:"POST"},executeCustomUpdateQuery:{url:"/:service/:dataModelName/queryExecutor/queries/wm_custom_update",method:"POST"},executeNamedProcedure:{url:"/:service/:dataModelName/procedureExecutor/procedure/execute/:procedureName?page=:page&size=:size&:procedureParams",
method:"GET"},executeCustomProcedure:{url:"/:service/:dataModelName/procedureExecutor/procedure/execute/wm_custom",method:"POST"},getCustomProcedureMetaData:{url:"/:service/:dataModelName/procedures/wm_proceduremetadata",method:"POST"},getSampleDbConnectionProperties:{url:"services/projects/:projectID/database/sample/connectionProps",method:"GET"},getConnectionProperties:{url:"services/projects/:projectID/datamodels/:dataModelName/connectionproperties",method:"GET"},updateConnectionProperties:{url:"services/projects/:projectID/datamodels/:dataModelName/connectionproperties",method:"PUT"}}}),wm.plugins.database.constant("DB_CONSTANTS",{DATABASE_WORKSPACE_TYPE:"db",WAVEMAKER_SAMPLE_DB_NAME:"hrdb",DEFAULT_DB_NAME:"MyTestDatabase",HSQL_DB_TYPE:"HSQLDB",MYSQL_DB_TYPE:"MySQL",POSTGRESQL_DB_TYPE:"PostgreSQL",ORACLE_DB_TYPE:"Oracle",SQL_SERVER_DB_TYPE:"SQLServer",LOGIN:{SAAS_MYSQL_CLOUD:{USERNAME:"root",PASSWORD:"cloudjee123"}},DATABASE_NUMERIC_DATA_TYPES:{big_decimal:"big_decimal",big_integer:"big_integer","double":"double","float":"float",integer:"integer"},DATABASE_DATA_TYPES:{big_decimal:{sql_type:"big_decimal",default_value:"0",length:!0,precision:!0},big_integer:{sql_type:"big_integer",default_value:"0",length:!0},blob:{sql_type:"blob",default_value:"null",length:!0},"boolean":{sql_type:"boolean",default_value:"false"},"byte":{sql_type:"byte",default_value:"null",length:!0},character:{sql_type:"character",default_value:"null",length:!0},clob:{sql_type:"clob",default_value:"null",length:!0},date:{sql_type:"date",default_value:"null"},datetime:{sql_type:"datetime",default_value:"null"},"double":{sql_type:"double",default_value:"0",length:!0,precision:!0},"float":{sql_type:"float",default_value:"0",length:!0,precision:!0},integer:{sql_type:"integer",default_value:"0",length:!0},string:{sql_type:"string",default_value:"null",length:!0},"short":{sql_type:"short",default_value:"0",length:!0},text:{sql_type:"text",default_value:"null",length:!0},time:{sql_type:"time",default_value:"null"},timestamp:{sql_type:"timestamp",default_value:"null"}},DATABASE_SECONDARY_DATA_TYPES:{binary:{sql_type:"blob",default_value:"null"},"long":{sql_type:"double",default_value:"null"}},DATABASE_GENERATORS:{assigned:"assigned",identity:"auto increment",sequence:"sequence"},DATABASE_MATCH_MODES:{start:"STARTING_WITH",end:"ENDING_WITH",anywhere:"CONTAINING",exact:"EQUALS"},ACTIONS:{CREATE:"CREATE",UPDATE:"UPDATE",DELETE:"DELETE",SAVED:"SAVED"},OBJECTS:{DATABASE:"wm-db",TABLE:"wm-db-table",COLUMN:"wm-db-table-column",RELATION:"wm-db-column-relation"},DML_QUERY_INDICATORS:{SELECT:"SELECT",UPDATE:["INSERT INTO","UPDATE","DELETE FROM"]},DDL_QUERY_INDICATORS:["CREATE","ALTER","RENAME","DROP"]}),wm.plugins.database.config(function(BaseServiceManagerProvider,DB_SERVICE_URLS){"use strict";BaseServiceManagerProvider.register(DB_SERVICE_URLS)}),wm.plugins.database.services.QueryBuilder=["$rootScope","DatabaseService","Utils","ProjectService","$liveVariable",function($rootScope,DatabaseService,Utils,ProjectService,$liveVariable){"use strict";return{getQuery:function(options){var selectClause,fromClause,groupByClause,orderByClause,query,columnClause="",whereClause="",logicalOp=options.logicalOp&&"or"===options.logicalOp.toLowerCase()?" OR ":" AND ",logicalOpSliceLength=" OR "===logicalOp?-4:-5;return selectClause="SELECT ",options.columns?(columnClause="",WM.forEach(options.columns,function(column){columnClause+=column+","}),columnClause=columnClause.slice(0,-1)):selectClause="",fromClause=" FROM "+options.tableName,WM.isArray(options.filterFields)&&options.filterFields.length?(whereClause=" WHERE ",WM.forEach(options.filterFields,function(field){field.clause?whereClause+=field.clause+logicalOp:WM.isArray(field.value)?(whereClause+="("+field.column+"='",field.value.forEach(function(element,index){whereClause+=index+1===field.value.length?element:element+"' OR "+field.column+"='"}),whereClause+="')"+logicalOp):whereClause+=field.noQuotes?field.column+"="+field.value+logicalOp:field.column+"='"+field.value+"'"+logicalOp}),whereClause=whereClause.slice(0,logicalOpSliceLength)):WM.element.isEmptyObject(options.filterFields)||(whereClause=" WHERE ",WM.forEach(options.filterFields,function(field,fieldName){var fieldValue;if(field.value)fieldValue=field.value;else{if(WM.isObject(field))return;fieldValue=field}whereClause+=fieldName+"='"+fieldValue+"'"+logicalOp}),whereClause=whereClause.slice(0,logicalOpSliceLength)),groupByClause=options.groupby?" GROUP BY "+options.groupby:"",orderByClause=options.orderby?" ORDER BY "+options.orderby:"",query=selectClause+columnClause+fromClause+whereClause+groupByClause+orderByClause},executeQuery:function(options,success,error){var executeQuery=function(){DatabaseService.executeCustomQuery({projectID:$rootScope.project.id,dataModelName:options.databaseName,page:options.page,size:options.size,data:{queryStr:options.query,queryParams:options.queryParams||[],nativeSql:options.nativeSql},service:options.prefabName?"":"services",url:options.prefabName?$rootScope.project.deployedUrl+"/prefabs/"+options.prefabName:$rootScope.project.deployedUrl},function(response){response.errors?Utils.triggerFn(error,response):($liveVariable.processResponse(response.content),Utils.triggerFn(success,response))},function(response){Utils.triggerFn(error,response)})};$rootScope.project.deployedUrl?executeQuery():ProjectService.run({projectId:$rootScope.project.id},function(result){$rootScope.project.deployedUrl=Utils.removeProtocol(result),executeQuery()})}}}],wm.plugins.database.services.DatabaseService=["$rootScope","BaseService","BaseServiceManager","CONSTANTS","Utils","WebService","$window",function($rootScope,BaseService,BaseServiceManager,CONSTANTS,Utils,WebService,$window){"use strict";var initiateAction=function(action,params,successCallback,failureCallback){var param,val,config,connectionParams,urlParams,requestData;if(config=BaseServiceManager.getConfig(),config=WM.copy(config.Database[action]),requestData=params.data,urlParams={projectID:params.projectID,service:WM.isDefined(params.service)?params.service:"services",dataModelName:params.dataModelName,entityName:params.entityName,queryName:params.queryName,queryParams:params.queryParams,procedureName:params.procedureName,procedureParams:params.procedureParams,id:params.id,relatedFieldName:params.relatedFieldName,page:params.page,size:params.size,sort:params.sort},!(params.url&&CONSTANTS.isStudioMode&&$rootScope.preferences.workspace.loadXDomainAppDataUsingProxy))return connectionParams={target:"Database",action:action,urlParams:urlParams,data:requestData,config:{url:params.url}},CONSTANTS.isStudioMode&&(connectionParams.headers={skipSecurity:"true"}),BaseService.execute(connectionParams,successCallback,failureCallback);if(urlParams)for(param in urlParams)urlParams.hasOwnProperty(param)&&(val=urlParams[param],WM.isDefined(val)&&null!==val&&(config.url=config.url.replace(new RegExp(":"+param,"g"),val)));connectionParams={endpointAddress:$window.location.protocol+params.url+config.url,method:config.method,contentType:"application/json",requestBody:JSON.stringify(requestData),headers:{skipSecurity:"true"}},WebService.testRestService(connectionParams,function(response){var errMsg,localeObject,parsedData=Utils.getValidJSON(response.responseBody);parsedData.hasOwnProperty("result")?Utils.triggerFn(successCallback,parsedData.result):parsedData.hasOwnProperty("error")?Utils.triggerFn(failureCallback,parsedData.error&&parsedData.error.message||parsedData.error):parsedData.hasOwnProperty("errorDetails")?(localeObject=$rootScope.locale||$rootScope.appLocale,errMsg=WM.copy(localeObject[parsedData.errorDetails.code]),Utils.triggerFn(failureCallback,Utils.replace(errMsg,parsedData.errorDetails.data)||parsedData.errorDetails)):Utils.triggerFn(successCallback,parsedData)},failureCallback)};return{testConnection:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"testConnection",data:{username:params.username,password:params.password,url:params.url,driverClass:params.driverClass,dialect:params.dialect},urlParams:{projectID:params.projectID}},successCallback,failureCallback)},importDB:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"importDB",data:{serviceId:params.serviceId,packageName:params.packageName,username:params.username,password:params.password,url:params.url,tableFilter:params.tableFilter,schemaFilter:params.schemaFilter,driverClass:params.driverClass,dialect:params.dialect,revengNamingStrategyClassName:params.revengNamingStrategyClassName,impersonateUser:!1,activeDirectoryDomain:params.activeDirectoryDomain},urlParams:{projectID:params.projectID}},successCallback,failureCallback)},reImportDB:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"reImportDB",urlParams:{projectID:params.projectID,serviceId:params.serviceId}},successCallback,failureCallback)},exportDB:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"exportDB",data:{serviceId:params.serviceId,username:params.username,password:params.password,url:params.url,schemaName:params.schemaName,schemaFilter:params.schemaFilter,driverClass:params.driverClass,dialect:params.dialect,revengNamingStrategyClassName:params.revengNamingStrategyClassName,impersonateUser:!1,overwrite:params.overwrite},urlParams:{projectID:params.projectID}},successCallback,failureCallback)},loadModelInfo:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"loadModelInfo",data:{serviceId:params.serviceId,packageName:params.packageName,username:params.username,password:params.password,url:params.url,schemaFilter:params.schemaFilter,tableFilter:params.tableFilter,driverClass:params.driverClass,dialect:params.dialect,revengNamingStrategyClassName:params.revengNamingStrategyClassName,impersonateUser:!1},urlParams:{projectID:params.projectID}},successCallback,failureCallback)},getAllDataModels:function(projectID,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getAllDataModels",urlParams:{projectID:projectID}},successCallback,failureCallback)},getDataModel:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getDataModel",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,isdraft:params.isdraft}},successCallback,failureCallback)},createDataModel:function(projectID,dataModelName,successCallback,failureCallback){BaseService.execute({target:"Database",action:"createDataModel",urlParams:{projectID:projectID},data:dataModelName},successCallback,failureCallback)},deleteDataModel:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"deleteDataModel",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName}},successCallback,failureCallback)},saveDataModel:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"saveDataModel",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName}},successCallback,failureCallback)},applyDataModel:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"applyDataModel",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName}},successCallback,failureCallback)},revertDataModel:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"revertDataModel",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName}},successCallback,failureCallback)},getAllEntities:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getAllEntities",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName}},successCallback,failureCallback)},getEntity:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getEntity",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,tableName:params.tableName}},successCallback,failureCallback)},createEntity:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"createEntity",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName},data:params.data},successCallback,failureCallback)},updateEntity:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"updateEntity",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,entityName:params.entityName},data:params.data},successCallback,failureCallback)},deleteEntity:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"deleteEntity",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,entityName:params.entityName}},successCallback,failureCallback)},addColumns:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"addColumns",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,entityName:params.entityName},data:params.data},successCallback,failureCallback)},updateColumn:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"updateColumn",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,entityName:params.entityName,columnName:params.columnName,forceDataLoss:params.forceDataLoss||!1},data:params.data},successCallback,failureCallback)},deleteColumn:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"deleteColumn",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,entityName:params.entityName,columnName:params.columnName}},successCallback,failureCallback)},addRelation:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"addRelation",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,entityName:params.entityName},data:params.data},successCallback,failureCallback)},updateRelation:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"updateRelation",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,entityName:params.entityName,relationName:params.relationName},data:params.data},successCallback,failureCallback)},deleteRelation:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"deleteRelation",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,entityName:params.entityName,relationName:params.relationName}},successCallback,failureCallback)},getAllQueries:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getAllQueries",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName}},successCallback,failureCallback)},getQuery:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getQuery",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,queryName:params.queryName}},successCallback,failureCallback)},createQuery:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"createQuery",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName},data:params.data},successCallback,failureCallback)},setQueryMetaData:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"setQueryMetaData",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,queryName:params.queryName},data:params.data},successCallback,failureCallback)},updateQuery:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"updateQuery",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,queryName:params.queryName},data:params.data},successCallback,failureCallback)},deleteQuery:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"deleteQuery",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,queryName:params.queryName}},successCallback,failureCallback)},validateQuery:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"validateQuery",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName},data:params.queryDetails},successCallback,failureCallback)},executeQuery:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"executeQuery",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName},data:params.data},successCallback,failureCallback)},getAllProcedures:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getAllProcedures",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName}},successCallback,failureCallback)},getProcedure:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getProcedure",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,procedureName:params.procedureName}},successCallback,failureCallback)},createProcedure:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"createProcedure",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName},data:params.data},successCallback,failureCallback)},setProcedureMetaData:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"setProcedureMetaData",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,procedureName:params.procedureName},data:params.data},successCallback,failureCallback)},updateProcedure:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"updateProcedure",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,procedureName:params.procedureName},data:params.data},successCallback,failureCallback)},deleteProcedure:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"deleteProcedure",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName,procedureName:params.procedureName}},successCallback,failureCallback)},validateProcedure:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"validateProcedure",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName},data:params.queryDetails},successCallback,failureCallback)},executeProcedure:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"executeProcedure",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName},data:params.data},successCallback,failureCallback)},getSampleDbConnectionProperties:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getSampleDbConnectionProperties",urlParams:{projectID:params.projectID}},successCallback,failureCallback)},getConnectionProperties:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"getConnectionProperties",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName}},successCallback,failureCallback)},updateConnectionProperties:function(params,successCallback,failureCallback){BaseService.execute({target:"Database",action:"updateConnectionProperties",urlParams:{projectID:params.projectID,dataModelName:params.dataModelName},data:params.data},successCallback,failureCallback)},readTableData:function(params,successCallback,failureCallback){return initiateAction("readTableData",params,successCallback,failureCallback)},searchTableData:function(params,successCallback,failureCallback){return initiateAction("searchTableData",params,successCallback,failureCallback)},readTableRelatedData:function(params,successCallback,failureCallback){return initiateAction("readTableRelatedData",params,successCallback,failureCallback)},insertTableData:function(params,successCallback,failureCallback){return initiateAction("insertTableData",params,successCallback,failureCallback)},insertMultiPartTableData:function(params,successCallback,failureCallback){return initiateAction("insertMultiPartTableData",params,successCallback,failureCallback)},updateTableData:function(params,successCallback,failureCallback){return initiateAction("updateTableData",params,successCallback,failureCallback)},updateMultiPartTableData:function(params,successCallback,failureCallback){return initiateAction("updateMultiPartTableData",params,successCallback,failureCallback)},deleteTableData:function(params,successCallback,failureCallback){return initiateAction("deleteTableData",params,successCallback,failureCallback)},updateCompositeTableData:function(params,successCallback,failureCallback){return initiateAction("updateCompositeTableData",params,successCallback,failureCallback)},deleteCompositeTableData:function(params,successCallback,failureCallback){return initiateAction("deleteCompositeTableData",params,successCallback,failureCallback)},executeNamedQuery:function(params,successCallback,failureCallback){return initiateAction("executeNamedQuery",params,successCallback,failureCallback)},executeNamedProcedure:function(params,successCallback,failureCallback){return initiateAction("executeNamedProcedure",params,successCallback,failureCallback)},executeCustomQuery:function(params,successCallback,failureCallback){return initiateAction("executeCustomQuery",params,successCallback,failureCallback)},executeCustomProcedure:function(params,successCallback,failureCallback){return initiateAction("executeCustomProcedure",params,successCallback,failureCallback)},getCustomQueryMetaData:function(params,successCallback,failureCallback){return initiateAction("getCustomQueryMetaData",params,successCallback,failureCallback)},getCustomProcedureMetaData:function(params,successCallback,failureCallback){return initiateAction("getCustomProcedureMetaData",params,successCallback,failureCallback)},executeCustomUpdateQuery:function(params,successCallback,failureCallback){return initiateAction("executeCustomUpdateQuery",params,successCallback,failureCallback)}}}],wm.plugins.webServices=WM.module("wm.plugins.webServices",["base64"]),wm.plugins.webServices.controllers={},wm.plugins.webServices.services={},wm.plugins.webServices.factories={},wm.plugins.webServices.controller(wm.plugins.webServices.controllers),wm.plugins.webServices.service(wm.plugins.webServices.services),wm.plugins.webServices.factory(wm.plugins.webServices.factories),wm.plugins.webServices.constant("WS_SERVICE_URLS",{WebService:{invokeRestCall:{url:"services/restservices/invoke",method:"POST"},generateRESTWsdlSettings:{url:"services/projects/:projectID/restservice/settings",method:"POST"},buildRestService:{url:"services/projects/:projectID/restservice",method:"POST"},updateRestService:{url:"services/projects/:projectID/restservice",method:"PUT"},importWSDL:{url:"services/projects/:projectID/soapservice/import",method:"POST"},uploadWSDL:{url:"services/projects/:projectID/soapservice/import",method:"POST",headers:{"Content-Type":void 0},transformRequest:WM.identity},registerFeedService:{url:"services/projects/:projectID/feed/register",method:"POST"},getRESTDetails:{url:"services/projects/:projectID/restservice/:serviceID",method:"GET"},getWSDL:{url:"services/projects/:projectID/soapservice/:serviceID/wsdl",method:"GET"},getBindingProperties:{url:"services/projects/:projectID/services/:serviceID/properties",method:"GET"},setBindingProperties:{url:"services/projects/:projectID/services/:serviceID/properties",method:"POST"},listTypes:{url:"services/projects/:projectID/services/types",method:"GET"},listPrefabTypes:{url:"services/projects/:projectID/prefabs/:prefabName/types",method:"GET"},listServicesWithType:{url:"services/projects/:projectID/services",method:"GET"},getServiceMethods:{url:"services/projects/:projectID/services/:serviceID/operations",method:"GET"},getServiceOperationParams:{url:"services/projects/:projectID/services/:serviceID/operations/:operationID",method:"GET"},invoke:{url:"/:serviceFile",method:"POST"},invokeRestService:{url:"/services/:serviceID/:operationID",method:"POST"},invokePrefabRestService:{url:"/:serviceID/:operationID",method:"POST"},remove:{url:"services/projects/:projectID/services/:serviceID",method:"DELETE"},retrieveServiceOperations:{url:"services/projects/:projectId/services/:serviceId/servicedef",method:"GET"},invokeRuntimeRestCall:{url:""},buildApiRestService:{url:"services/restservices/create",method:"POST"},getSoapServiceSettings:{url:"services/projects/:projectId/soapservice/:serviceId/settings",method:"GET"},setSoapServiceSettings:{url:"services/projects/:projectId/soapservice/:serviceId/settings",method:"POST"}}}),wm.plugins.webServices.constant("WS_CONSTANTS",{WEBSERVICE_WORKSPACE_TYPE:"ws",HTTP_METHODS:["GET","POST","PUT","HEAD","PATCH","DELETE","TRACE","OPTIONS"],NON_BODY_HTTP_METHODS:["GET","HEAD"],PRIMITIVE_DATA_TYPES:["number","integer","string","boolean","file"]}),wm.plugins.webServices.config(function(BaseServiceManagerProvider,WS_SERVICE_URLS){"use strict";BaseServiceManagerProvider.register(WS_SERVICE_URLS)}),wm.plugins.webServices.services.WebService=function(BaseService){"use strict";return{testRestService:function(connectionParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"invokeRestCall",data:connectionParams},successCallback,failureCallback)},populateRestService:function(connectionParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"generateRESTWsdlSettings",data:connectionParams.data,urlParams:connectionParams.urlParams},successCallback,failureCallback)},buildRestService:function(connectionParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"buildRestService",data:connectionParams.data,urlParams:connectionParams.urlParams},successCallback,failureCallback)},updateRestService:function(connectionParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"updateRestService",data:connectionParams.data,urlParams:connectionParams.urlParams},successCallback,failureCallback)},importWSDL:function(connectionParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"importWSDL",params:connectionParams.params,urlParams:connectionParams.urlParams},successCallback,failureCallback)},uploadWSDL:function(connectionParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"uploadWSDL",params:connectionParams.params,urlParams:connectionParams.urlParams,data:connectionParams.content},successCallback,failureCallback)},listServicesWithType:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"listServicesWithType",urlParams:urlParams},successCallback,failureCallback)},getServiceOperations:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"getServiceMethods",urlParams:urlParams},successCallback,failureCallback)},getServiceOperationParams:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"getServiceOperationParams",urlParams:urlParams},successCallback,failureCallback)},getRESTDetails:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"getRESTDetails",urlParams:urlParams},successCallback,failureCallback)},getSoapServiceSettings:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"getSoapServiceSettings",urlParams:urlParams},successCallback,failureCallback)},setSoapServiceSettings:function(connectionParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"setSoapServiceSettings",data:connectionParams.data,urlParams:connectionParams.urlParams},successCallback,failureCallback)},getWSDL:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"getWSDL",urlParams:urlParams},successCallback,failureCallback)},getBindingProperties:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"getBindingProperties",urlParams:urlParams},successCallback,failureCallback)},setBindingProperties:function(urlParams,data,successCallback,failureCallback){BaseService.send({target:"WebService",action:"setBindingProperties",urlParams:urlParams,data:data},successCallback,failureCallback)},listTypes:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"listTypes",urlParams:urlParams},successCallback,failureCallback)},listPrefabTypes:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"listPrefabTypes",urlParams:urlParams},successCallback,failureCallback)},registerFeedService:function(connectionParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"registerFeedService",urlParams:connectionParams},successCallback,failureCallback)},invoke:function(connectionParams,successCallback,failureCallback){return BaseService.send({target:"WebService",action:"invoke",urlParams:{serviceFile:connectionParams.serviceFile},data:{id:123,method:connectionParams.method,params:connectionParams.params},config:{url:connectionParams.url},byPassResult:!0},successCallback,failureCallback)},invokeRestService:function(connectionParams,successCallback,failureCallback){return BaseService.send({target:"WebService",action:connectionParams.target,data:connectionParams.params[2],urlParams:{serviceID:connectionParams.params[0],operationID:connectionParams.params[1]},config:{url:connectionParams.url},byPassResult:!0},successCallback,failureCallback)},remove:function(urlParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"remove",urlParams:urlParams},successCallback,failureCallback)},retrieveServiceOperations:function(params,successCallback,failureCallback){BaseService.send({target:"WebService",action:"retrieveServiceOperations",urlParams:params.urlParams},successCallback,failureCallback)},invokeJavaService:function(params,successCallback,failureCallback){BaseService.send({target:"WebService",action:"invokeRuntimeRestCall",method:params.method,config:{url:params.url,method:params.method,headers:params.headers},data:params.dataParams||void 0,byPassResult:!0},successCallback,failureCallback)},buildApiRestService:function(connectionParams,successCallback,failureCallback){BaseService.send({target:"WebService",action:"buildApiRestService",data:connectionParams},successCallback,failureCallback)}}},wm.plugins.webServices.factories.ServiceFactory=["WebService","wmToaster","$rootScope","Utils","VARIABLE_CONSTANTS","WS_CONSTANTS",function(WebService,wmToaster,$rootScope,Utils,VARIABLE_CONSTANTS,WS_CONSTANTS){"use strict";var services=[],projectId=$rootScope.project&&$rootScope.project.id,requestQueue={services:[],operations:{},serviceDef:{}},serviceDefMap={},supportedOperations=WS_CONSTANTS.HTTP_METHODS.map(function(method){return method.toLowerCase()}),primitiveDataTypes=WS_CONSTANTS.PRIMITIVE_DATA_TYPES,IS_LIST_KEY="x-WM-IS_LIST",FULLY_QUALIFIED_NAME_KEY="x-WM-FULLY_QUALIFIED_NAME",parameterTypeKey="in",AUTH_TYPE_KEY="WM_Rest_Service_Authorization",getServiceObjectByName=function(name){var serviceObject={operations:[]};return WM.forEach(services,function(serviceObj){serviceObj.name===name&&(serviceObject=serviceObj)}),serviceObject},getServiceOperationObjectByName=function(serviceName,operationName){var serviceObj,operationObject={};return serviceObj=getServiceObjectByName(serviceName),WM.forEach(serviceObj.operations,function(operation){operation.name===operationName&&(operationObject=operation)}),operationObject},getServicesWithType=function(successCallBack,reloadFlag){
if(reloadFlag=!(!reloadFlag||"false"===reloadFlag),services.length>0&&!reloadFlag)return void Utils.triggerFn(successCallBack,services);if(requestQueue.services=requestQueue.services||[],requestQueue.services.push(successCallBack),!(requestQueue.services.length>1)){var urlParams={projectID:projectId||$rootScope.project.id};WebService.listServicesWithType(urlParams,function(response){services=[],WM.forEach(response,function(serviceObj){services.push({type:serviceObj.type,name:serviceObj.name,url:serviceObj.url,operations:[]})}),WM.forEach(requestQueue.services,function(fn){Utils.triggerFn(fn,services)}),requestQueue.services=null},function(){wmToaster.show("error",$rootScope.locale.MESSAGE_ERROR_TITLE,$rootScope.locale.MESSAGE_ERROR_FETCH_WEB_DATA_SERVICES_DESC)})}},getServiceDef=function(serviceId,success,error,forceReload){var callback,urlParams={urlParams:{serviceId:serviceId,projectId:$rootScope.project.id}};return serviceDefMap[serviceId]&&!forceReload?void Utils.triggerFn(success,serviceDefMap[serviceId]):(requestQueue.serviceDef[serviceId]=requestQueue.serviceDef[serviceId]||[],requestQueue.serviceDef[serviceId].push(success),void(requestQueue.serviceDef[serviceId].length>1||WebService.retrieveServiceOperations(urlParams,function(response){for(serviceDefMap[serviceId]=response;;)if(callback=requestQueue.serviceDef[serviceId].shift(),Utils.triggerFn(callback,response),!requestQueue.serviceDef[serviceId].length)break},function(errMsg){Utils.triggerFn(error,errMsg)})))},getFullyQualifiedName=function(refValue,definitions){var returnType;return refValue=refValue.split("/").pop(),returnType=definitions[refValue],returnType=returnType?returnType[FULLY_QUALIFIED_NAME_KEY]:"Object"},getReturnType=function(responseObject,definitions){var type;return responseObject.type?-1!==primitiveDataTypes.indexOf(responseObject.type)?responseObject.type:"array"===responseObject.type?(responseObject[IS_LIST_KEY]?responseObject.items.type?type=responseObject.items.type:responseObject.items.$ref&&(type=getFullyQualifiedName(responseObject.items.$ref,definitions)):responseObject.items.type?type=responseObject.items.type:responseObject.items.$ref&&(type=getFullyQualifiedName(responseObject.items.$ref,definitions)),type):void 0:getFullyQualifiedName(responseObject.$ref,definitions)},isRESTSupported=function(type){return-1!==VARIABLE_CONSTANTS.REST_SUPPORTED_SERVICES.indexOf(type)},processOperations=function(serviceObj,operations,swagger){var paramsKey,definitions,securityDefinitions,isRestSupportedService=isRESTSupported(serviceObj.type);serviceObj.operations=[],isRestSupportedService&&(definitions=swagger.definitions,securityDefinitions=swagger.securityDefinitions),WM.forEach(operations,function(operation){var isList,typeRef,returnObj,returnType,operationObject={},isDbServiceOp=function(type){return"hqlquery"===type||"nativequery"===type||"procedure"===type};isDbServiceOp(operation.operationType)?returnType=operation["return"]:operation.responses&&operation.responses[200].schema?(returnType=getReturnType(operation.responses[200].schema,definitions),isList=operation.responses[200].schema.type&&"array"===operation.responses[200].schema.type):returnType="void",isRestSupportedService?(returnObj={typeRef:returnType},paramsKey="parameters"):(returnObj=returnType,paramsKey="parameter",IS_LIST_KEY="isList",parameterTypeKey="parameterType"),operationObject={name:operation.operationId||operation.name,operationType:operation.operationType||null,parameter:void 0,isList:isList,"return":returnObj},serviceObj.operations.push(operationObject),WM.element.isEmptyObject(operation[paramsKey])||(operationObject.parameter=[],WM.forEach(operation[paramsKey],function(param){param.type?typeRef=param.type:param.schema?typeRef=getReturnType(param.schema,definitions):param.items&&(typeRef=getReturnType(param.items,definitions)),isList=param[IS_LIST_KEY],operationObject.parameter.push({name:param.name,typeRef:typeRef,isList:isList,parameterType:param[parameterTypeKey]})})),securityDefinitions&&securityDefinitions[AUTH_TYPE_KEY]&&"basic"===securityDefinitions[AUTH_TYPE_KEY].type&&operation.security[0][AUTH_TYPE_KEY]&&(operationObject.parameter||(operationObject.parameter=[]),operationObject.parameter.push({name:"wm_auth_username",parameterType:"auth"}),operationObject.parameter.push({name:"wm_auth_password",parameterType:"auth"}))})},getServiceOperations=function(serviceId,successCallBack,reloadFlag){if(serviceId&&""!==serviceId){reloadFlag=!(!reloadFlag||"false"===reloadFlag);var urlParams,operations,serviceObj=getServiceObjectByName(serviceId),onOperationsFetch=function(operations,swagger){processOperations(serviceObj,operations,swagger);for(var callback;;)if(callback=requestQueue.operations[serviceId].shift(),Utils.triggerFn(callback,serviceObj.operations),!requestQueue.operations[serviceId].length)break};if(serviceObj.operations.length>0&&!reloadFlag)return void Utils.triggerFn(successCallBack,serviceObj.operations);requestQueue.operations[serviceId]=requestQueue.operations[serviceId]||[],requestQueue.operations[serviceId].push(successCallBack),requestQueue.operations[serviceId].length>1||(isRESTSupported(serviceObj.type)?(operations=[],getServiceDef(serviceId,function(response){WM.forEach(response.paths,function(path){WM.forEach(supportedOperations,function(operation){path[operation]&&(path[operation].operationType=operation,operations.push(path[operation]))})}),onOperationsFetch(operations,response)},function(){wmToaster.show("error",$rootScope.locale.MESSAGE_ERROR_TITLE,$rootScope.locale.MESSAGE_ERROR_FETCH_SERVICE_METHODS_DESC)},reloadFlag)):(urlParams={projectID:projectId||$rootScope.project.id,serviceID:serviceId},WebService.getServiceOperations(urlParams,function(response){onOperationsFetch(response)},function(){wmToaster.show("error",$rootScope.locale.MESSAGE_ERROR_TITLE,$rootScope.locale.MESSAGE_ERROR_FETCH_SERVICE_METHODS_DESC)})))}},getServiceOperationParams=function(serviceId,operationId,successCallBack,reloadFlag){if(serviceId&&""!==serviceId&&operationId&&""!==operationId){reloadFlag=!(!reloadFlag||"false"===reloadFlag);var urlParams,serviceObj=getServiceObjectByName(serviceId),operationObj=getServiceOperationObjectByName(serviceId,operationId),onOperationParamsFetch=function(response,isRestSupported){var parameters=isRestSupported?response.parameters:response.parameter;WM.element.isEmptyObject(parameters)||(operationObj.parameter=[],WM.forEach(parameters,function(param){var paramTypeRefsKey,paramTypeListRefsKey,isList,typeRef,paramExists=!1,isRestSupportedService=isRESTSupported(serviceObj.type);isRestSupportedService?(paramTypeRefsKey="fullyQualifiedType",paramTypeListRefsKey="fullyQualifiedTypeArguments"):paramTypeRefsKey="typeRef",WM.forEach(operationObj.parameter,function(existingParam){param.name===existingParam.name&&(paramExists=!0)}),isList=param[IS_LIST_KEY],typeRef=isRestSupportedService&&isList?param[paramTypeListRefsKey][0]||"java.lang.Object":param[paramTypeRefsKey],paramExists||operationObj.parameter.push({name:param.name,typeRef:typeRef,isList:isList,parameterType:param[parameterTypeKey]})})),operationObj["return"]=response["return"]||{typeRef:"java.lang.String",isList:!1},Utils.triggerFn(successCallBack,operationObj)};return operationObj.parameter&&!reloadFlag?void Utils.triggerFn(successCallBack,operationObj):void(isRESTSupported(serviceObj.type)?getServiceOperations(serviceId,function(){onOperationParamsFetch(getServiceOperationObjectByName(serviceId,operationId),!0)},!0):(urlParams={projectID:projectId||$rootScope.project.id,serviceID:serviceId,operationID:operationId},WebService.getServiceOperationParams(urlParams,function(response){onOperationParamsFetch(response)},function(){wmToaster.show("error",$rootScope.locale.MESSAGE_ERROR_TITLE,$rootScope.locale.MESSAGE_ERROR_FETCH_SERVICE_METHOD_PARAMS_DESC)})))}},addService=function(service){var serviceExists=!1;return WM.forEach(services,function(existingService){service.name===existingService.name&&service.type===existingService.type&&(serviceExists=!0)}),serviceExists||services.push({name:service.name,type:service.type,operations:[],url:service.url||"/services/"+service.name,sampleResponse:service.sampleResponse}),!serviceExists},getSampleResponse=function(serviceId){var service=getServiceObjectByName(serviceId);return service.sampleResponse},setSampleResponse=function(serviceId,response){var service=getServiceObjectByName(serviceId);service.sampleResponse=response};return{getServicesWithType:getServicesWithType,getServiceOperations:getServiceOperations,getServiceOperationParams:getServiceOperationParams,add:addService,getServiceObjectByName:getServiceObjectByName,getSampleResponse:getSampleResponse,setSampleResponse:setSampleResponse,getServiceDef:getServiceDef}}],wm.plugins.security=WM.module("wm.plugins.security",[]),wm.plugins.security.controllers={},wm.plugins.security.services={},wm.plugins.security.factories={},wm.plugins.security.directives={},wm.plugins.security.controller(wm.plugins.security.controllers),wm.plugins.security.service(wm.plugins.security.services),wm.plugins.security.factory(wm.plugins.security.factories),wm.plugins.security.directive(wm.plugins.security.directives),wm.plugins.security.constant("SECURITY_URLS",{Security:{getMethods:{url:"services/projects/:projectID/services/securityService/operations",method:"GET"},getGeneralOptions:{url:"services/projects/:projectID/securityservice/general",method:"GET"},configDemo:{url:"services/projects/:projectID/securityservice/providers/demo",method:"POST"},getDemoOptions:{url:"services/projects/:projectID/securityservice/providers/demo",method:"GET"},configDatabase:{url:"services/projects/:projectID/securityservice/providers/database",method:"POST"},getDatabaseOptions:{url:"services/projects/:projectID/securityservice/providers/database",method:"GET"},configAD:{url:"services/projects/:projectID/securityservice/providers/activedirectory",method:"POST"},getADOptions:{url:"services/projects/:projectID/securityservice/providers/activedirectory",method:"GET"},configLDAP:{url:"services/projects/:projectID/securityservice/providers/ldap",method:"POST"},getLDAPOptions:{url:"services/projects/:projectID/securityservice/providers/ldap",method:"GET"},testLDAPConnection:{url:"services/projects/:projectID/securityservice/providers/ldap/testconnection",method:"POST"},getCASOptions:{url:"services/projects/:projectID/securityservice/providers/cas",method:"GET"},configCAS:{url:"services/projects/:projectID/securityservice/providers/cas",method:"POST"},configCustomAuth:{url:"services/projects/:projectID/securityservice/providers/customauth",method:"POST"},getCustomAuthOptions:{url:"services/projects/:projectID/securityservice/providers/customauth",method:"GET"},getPortMapping:{url:"services/projects/:projectID/securityservice/portmapping",method:"GET"},getSecurityInterceptURLs:{url:"services/projects/:projectID/securityservice/intercepturls",method:"GET"},setSecurityInterceptURLs:{url:"services/projects/:projectID/securityservice/intercepturls",method:"POST"},getRoles:{url:"services/projects/:projectID/securityservice/roles",method:"GET"},setRoles:{url:"services/projects/:projectID/securityservice/roles",method:"POST"},getRolesConfig:{url:"services/projects/:projectID/securityservice/rolesconfig",method:"GET"},setRolesConfig:{url:"services/projects/:projectID/securityservice/rolesconfig",method:"POST"},appLogin:{url:"j_spring_security_check",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}},appLogout:{url:"services/security/logout",method:"POST"},getLoggedInUser:{url:"services/security/user",method:"GET"},configCustomSecurity:{url:"services/projects/:projectID/securityservice/providers/customauth",method:"POST"},getCustomSecurityConfig:{url:"services/projects/:projectID/securityservice/providers/customauth",method:"GET"},getServiceOperations:{url:"services/projects/:projectId/services/:serviceId/servicedef",method:"GET"},testADConnection:{url:"services/projects/:projectID/securityservice/providers/ad/testconnection",method:"POST"}}}),wm.plugins.security.config(function(BaseServiceManagerProvider,SECURITY_URLS){"use strict";BaseServiceManagerProvider.register(SECURITY_URLS)}),wm.plugins.security.services.SecurityService=["BaseService","Utils",function(BaseService,Utils){"use strict";var _roles,_rolesConfig,_interceptUrls,_generalOptions,loggedInUser,serviceOperationsMap={},getLoggedInUser=function(successCallback,failureCallback){loggedInUser?Utils.triggerFn(successCallback,loggedInUser):BaseService.send({target:"Security",action:"getLoggedInUser"},function(user){loggedInUser=user,Utils.triggerFn(successCallback,user)},function(error){Utils.triggerFn(failureCallback,error)})};return{getMethods:function(projectID,successCallback,failureCallback){BaseService.send({target:"Security",action:"getMethods",urlParams:{projectID:projectID}},successCallback,failureCallback)},getGeneralOptions:function(projectID,successCallback,failureCallback){_generalOptions?Utils.triggerFn(successCallback,_generalOptions):BaseService.send({target:"Security",action:"getGeneralOptions",urlParams:{projectID:projectID}},function(generalOptions){_generalOptions=generalOptions,Utils.triggerFn(successCallback,generalOptions)},failureCallback)},setGeneralOptions:function(generalOptions){_generalOptions=generalOptions},configDemo:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"configDemo",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},getDemoOptions:function(projectID,successCallback,failureCallback){BaseService.send({target:"Security",action:"getDemoOptions",urlParams:{projectID:projectID}},successCallback,failureCallback)},configDatabase:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"configDatabase",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},getDatabaseOptions:function(projectID,successCallback,failureCallback){BaseService.send({target:"Security",action:"getDatabaseOptions",urlParams:{projectID:projectID}},successCallback,failureCallback)},configAD:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"configAD",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},getADOptions:function(projectID,successCallback,failureCallback){BaseService.send({target:"Security",action:"getADOptions",urlParams:{projectID:projectID}},successCallback,failureCallback)},configLDAP:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"configLDAP",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},getLDAPOptions:function(projectID,successCallback,failureCallback){BaseService.send({target:"Security",action:"getLDAPOptions",urlParams:{projectID:projectID}},successCallback,failureCallback)},testLDAPConnection:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"testLDAPConnection",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},getCASOptions:function(projectID,successCallback,failureCallback){BaseService.send({target:"Security",action:"getCASOptions",urlParams:{projectID:projectID}},successCallback,failureCallback)},configCAS:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"configCAS",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},configCustomAuth:function(projectID,successCallback,failureCallback){BaseService.send({target:"Security",action:"configCustomAuth",urlParams:{projectID:projectID}},successCallback,failureCallback)},getCustomAuthOptions:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"getCustomAuthOptions",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},getPortMapping:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"getPortMapping",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},getSecurityInterceptURLs:function(projectID,successCallback,failureCallback){void 0===_interceptUrls?BaseService.send({target:"Security",action:"getSecurityInterceptURLs",urlParams:{projectID:projectID}},function(response){_interceptUrls=response,Utils.triggerFn(successCallback,response)},failureCallback):Utils.triggerFn(successCallback,_interceptUrls)},setSecurityInterceptURLs:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"setSecurityInterceptURLs",urlParams:{projectID:params.projectID},data:params.config},function(response){_interceptUrls=params.config,Utils.triggerFn(successCallback,response)},failureCallback)},getRoles:function(projectID,successCallback,failureCallback){void 0===_roles?BaseService.send({target:"Security",action:"getRoles",urlParams:{projectID:projectID}},function(response){_roles=response,Utils.triggerFn(successCallback,response)},failureCallback):Utils.triggerFn(successCallback,_roles)},getRolesConfig:function(projectID,successCallback,failureCallback){_rolesConfig?Utils.triggerFn(successCallback,_rolesConfig):BaseService.send({target:"Security",action:"getRolesConfig",urlParams:{projectID:projectID}},function(response){_rolesConfig=response,Utils.triggerFn(successCallback,response)},failureCallback)},setRolesConfig:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"setRolesConfig",urlParams:{projectID:params.projectID},data:params.config},function(response){_rolesConfig=params.config,Utils.triggerFn(successCallback,response)},failureCallback)},setRoles:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"setRoles",urlParams:{projectID:params.projectID},data:params.config},function(response){_roles=params.config,Utils.triggerFn(successCallback,response)},failureCallback)},appLogin:function(params,successCallback,failureCallback){return BaseService.send({target:"Security",action:"appLogin",data:"j_username="+encodeURIComponent(params.username)+"&j_password="+encodeURIComponent(params.password)},successCallback,failureCallback)},appLogout:function(successCallback,failureCallback){return BaseService.send({target:"Security",action:"appLogout"},successCallback,failureCallback)},isAuthenticated:function(successCallback,failureCallback){getLoggedInUser(function(loggedInUser){Utils.triggerFn(successCallback,loggedInUser.authenticated)},failureCallback)},getUserName:function(successCallback,failureCallback){getLoggedInUser(function(loggedInUser){Utils.triggerFn(successCallback,loggedInUser.userName)},failureCallback)},getUserId:function(successCallback,failureCallback){getLoggedInUser(function(loggedInUser){Utils.triggerFn(successCallback,loggedInUser.userId)},failureCallback)},getTenantId:function(successCallback,failureCallback){getLoggedInUser(function(loggedInUser){Utils.triggerFn(successCallback,loggedInUser.tenantId)},failureCallback)},getUserRoles:function(successCallback,failureCallback){getLoggedInUser(function(loggedInUser){Utils.triggerFn(successCallback,loggedInUser.userRoles)},failureCallback)},isSecurityEnabled:function(successCallback,failureCallback){getLoggedInUser(function(loggedInUser){Utils.triggerFn(successCallback,loggedInUser.securityEnabled)},failureCallback)},configCustomSecurity:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"configCustomSecurity",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},getCustomSecurityConfig:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"getCustomSecurityConfig",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},getServiceOperations:function(params,successCallback,failureCallback,forceReload){serviceOperationsMap[params.urlParams.serviceId]&&!forceReload?Utils.triggerFn(successCallback,serviceOperationsMap[params.urlParams.serviceId]):BaseService.send({target:"Security",action:"getServiceOperations",urlParams:params.urlParams},function(response){serviceOperationsMap[params.urlParams.serviceId]=response,Utils.triggerFn(successCallback,response)},failureCallback)},testADConnection:function(params,successCallback,failureCallback){BaseService.send({target:"Security",action:"testADConnection",urlParams:{projectID:params.projectID},data:params.config},successCallback,failureCallback)},setLoggedInUser:function(user){loggedInUser=user}}}],wm.variables.services.LoginVariableService=["Variables","BaseVariablePropertyFactory","SecurityService","Utils","$window","$rootScope","VARIABLE_CONSTANTS","CONSTANTS",function(Variables,BaseVariablePropertyFactory,SecurityService,Utils,$window,$rootScope,VARIABLE_CONSTANTS,CONSTANTS){"use strict";var methods,loginVariableObj,initiateCallback;return initiateCallback=Variables.initiateCallback,methods={login:function(variable,options,success,error){var callBackScope,errMsg,paramKey,params={},variableOwner=variable.owner,variableEvents=VARIABLE_CONSTANTS.EVENTS,loginInfo={};callBackScope="App"===variableOwner?$rootScope||{}:variable.prefabName?options.scope||{}:options.scope&&options.scope.$$childTail?options.scope.$$childTail:{},loginInfo=options.loginInfo?options.loginInfo:variable.dataBinding;for(paramKey in loginInfo){if(loginInfo.hasOwnProperty(paramKey)&&(""===loginInfo[paramKey]||void 0===loginInfo[paramKey])){errMsg="Please provide "+paramKey+".";break}params[paramKey]=loginInfo[paramKey]}return errMsg?void(CONSTANTS.isRunMode&&(Utils.triggerFn(error,errMsg),initiateCallback("onError",variable,callBackScope,errMsg))):void(variable.promise=SecurityService.appLogin(params,function(response){CONSTANTS.isRunMode&&($rootScope.isUserAuthenticated=!0,Utils.triggerFn(success),$rootScope.$emit("update-loggedin-user"),WM.forEach(variableEvents,function(event){"onError"!==event&&initiateCallback(event,variable,callBackScope)})),variable.useDefaultSuccessHandler&&($window.location=response&&response.url?response.url:"index.html")},function(){CONSTANTS.isRunMode&&initiateCallback("onError",variable,callBackScope,"Invalid username or password."),Utils.triggerFn(error,"Invalid username or password.")}))},cancel:function(variable){variable.promise&&variable.promise.abort()}},loginVariableObj={login:function(options,success,error){options=options||{},options.scope=this.activeScope||options.scope,methods.login(this,options,success,error)},cancel:function(){return methods.cancel(this)}},BaseVariablePropertyFactory.register("wm.LoginVariable",loginVariableObj,["wm.Variable","wm.ServiceVariable"],methods),{}}],wm.variables.services.LogoutVariableService=["Variables","BaseVariablePropertyFactory","SecurityService","Utils","$window","CONSTANTS","VARIABLE_CONSTANTS","$rootScope",function(Variables,BaseVariablePropertyFactory,SecurityService,Utils,$window,CONSTANTS,VARIABLE_CONSTANTS,$rootScope){"use strict";function onLogoutSuccess(){$rootScope.$emit("app-logout-success")}var methods,logoutVariableObj,initiateCallback;return initiateCallback=Variables.initiateCallback,methods={logout:function(variable,options,success,error){var callBackScope,performLogout,variableOwner=variable.owner,variableEvents=VARIABLE_CONSTANTS.EVENTS,logoutErrorMessage="No authenticated user to logout.";callBackScope="App"===variableOwner?$rootScope||{}:variable.prefabName?options.scope||{}:options.scope&&options.scope.$$childTail?options.scope.$$childTail:{},performLogout=$rootScope.isUserAuthenticated,performLogout?variable.promise=SecurityService.appLogout(function(){$rootScope.isUserAuthenticated=!1,Utils.triggerFn(success),variable.useDefaultSuccessHandler?variable.redirectTo&&"Login"!==variable.redirectTo&&"login.html"!==variable.redirectTo?$window.location.hash="#/"+("index.html"===variable.redirectTo?"Main":variable.redirectTo):$window.location="login.html":CONSTANTS.isRunMode&&WM.forEach(variableEvents,function(event){"onError"!==event&&initiateCallback(event,variable,callBackScope)}),$rootScope.$emit("update-loggedin-user")},function(){CONSTANTS.isRunMode&&initiateCallback("onError",variable,callBackScope),Utils.triggerFn(error)}):(CONSTANTS.isRunMode&&initiateCallback("onError",variable,callBackScope,logoutErrorMessage),Utils.triggerFn(error,logoutErrorMessage))},cancel:function(variable){variable.promise&&variable.promise.abort()}},logoutVariableObj={logout:function(options,success,error){options.scope=options.scope||this.activeScope,methods.logout(this,options,function(){onLogoutSuccess(),Utils.triggerFn(success)},error)},cancel:function(){return methods.cancel(this)}},BaseVariablePropertyFactory.register("wm.LogoutVariable",logoutVariableObj,["wm.Variable","wm.ServiceVariable"],methods),{}}],wm.variables.services.TimerVariableService=["Variables","BaseVariablePropertyFactory","$rootScope","$interval","$timeout","CONSTANTS",function(Variables,BaseVariablePropertyFactory,$rootScope,$interval,$timeout,CONSTANTS){"use strict";var methods,timerVariableObj,initiateCallback,timerMap={},DEFAULT_TIMER_DELAY=500;return initiateCallback=Variables.initiateCallback,methods={fire:function(variable,options,success,error){if(!WM.isDefined(timerMap[variable.name])&&!CONSTANTS.isStudioMode){var repeatTimer=variable.repeating,delay=variable.delay||DEFAULT_TIMER_DELAY,event="onTimerFire",callBackScope=options.scope||$rootScope,exec=function(){initiateCallback(event,variable,callBackScope)};timerMap[variable.name]=repeatTimer?$interval(exec,delay):$timeout(function(){exec(),timerMap[variable.name]=void 0},delay)}},cancel:function(variable,options){WM.isDefined(timerMap[variable.name])&&(variable.repeating?$interval.cancel(timerMap[variable.name]):$timeout.cancel(timerMap[variable.name]),timerMap[variable.name]=void 0)}},timerVariableObj={fire:function(success,error){methods.fire(this,{scope:this.activeScope},success,error)},cancel:function(){return methods.cancel(this)}},BaseVariablePropertyFactory.register("wm.TimerVariable",timerVariableObj,[],methods),{}}],WM.module("i18n",[]),WM.module("i18n").service("i18nService",["$rootScope","Utils","$http","$locale","CONSTANTS","$q",function($rootScope,Utils,$http,$locale,CONSTANTS,$q){"use strict";function extendLocale(dst,src){dst.id=src.id,dst.pluralCat=src.pluralCat,["DATETIME_FORMATS","NUMBER_FORMATS"].forEach(function(type){Object.keys(src[type]).forEach(function(key){dst[type][key]=src[type][key]})})}function loadComponentLocaleBundles(){var deferred=$q.defer(),count=_componentLocalePaths.length,content={};return count||deferred.resolve(content),_componentLocalePaths.forEach(function(path){path+=_selectedLocale+".json",$http.get(path).success(function(response){WM.extend(content,response),count--,count||deferred.resolve(content)})}),deferred.promise}function loadAppLocaleBundle(content){var path=_appLocaleRootPath+_selectedLocale+".json";$http.get(path).success(function(response){WM.extend($rootScope[localeKey],response,content)})}function loadNgLocaleBundle(){var deferred=$q.defer(),ngLocaleFilePath=_ngLocaleRootPath;return ngLocaleFilePath||deferred.resolve(),ngLocaleFilePath+="angular-locale_"+_selectedLocale+".js",WM.element.ajax({dataType:"script",url:ngLocaleFilePath,cache:!0}).done(function(){extendLocale($locale,WM.injector(["ngLocale"]).get("$locale")),deferred.resolve()}),deferred.promise}function loadLocaleBundles(emitEvent){loadNgLocaleBundle().then(loadComponentLocaleBundles).then(loadAppLocaleBundle).then(function(){emitEvent&&$rootScope.$emit("locale-change")})}function setSelectedLocale(locale){_initSuccess&&-1!==_supportedLocale.indexOf(locale)&&locale&&locale!==_selectedLocale&&(_selectedLocale=locale,$rootScope[localeKey]={},loadLocaleBundles(!0))}function getDefaultLocale(){return _defaultLocale}function getSelectedLocale(){return _selectedLocale}function init(supportedLocale,defaultLocale,appLocaleRootPath,ngLocaleRootPath){supportedLocale&&WM.isArray(supportedLocale)&&0!==supportedLocale.length&&(_supportedLocale=supportedLocale,appLocaleRootPath&&0!==appLocaleRootPath.length&&(_appLocaleRootPath=appLocaleRootPath,_defaultLocale=defaultLocale||supportedLocale[0],_ngLocaleRootPath=ngLocaleRootPath,_initSuccess=!0,setSelectedLocale(_defaultLocale)))}function extendAppLocale(path){path+=_selectedLocale+".json",$http.get(path).success(function(response){WM.extend($rootScope.appLocale,response)})}function loadComponentLocaleBundle(path){_initSuccess&&path&&-1===_componentLocalePaths.indexOf(path)&&(_componentLocalePaths.push(path),extendAppLocale(path))}function getLocaleCodesMap(){return localeCodesMap}var _defaultLocale,_appLocaleRootPath,_ngLocaleRootPath,_selectedLocale,_supportedLocale=[],localeKey=CONSTANTS.isStudioMode?"locale":"appLocale",_componentLocalePaths=[],_initSuccess=!1,localeCodesMap={};return localeCodesMap={af:"Afrikaans","af-na":"Afrikaans (Namibië)","af-za":"Afrikaans (Suid-Afrika)",am:"አማርኛ","am-et":"አማርኛ (ኢትዮጵያ)",ar:"العربية","ar-001":"(العالم) العربية","ar-ae":"(الإمارات العربية المتحدة) العربية ","ar-bh":"(البحرين) العربية‏","ar-dz":"(الجزائر) العربية","ar-eg":"(مصر) العربية","ar-iq":"(العراق) العربية","ar-jo":"(الأردن) العربية","ar-kw":"(الكويت) العربية","ar-lb":"(لبنان) العربية","ar-ly":"(ليبيا) العربية","ar-ma":"(المغرب) العربية","ar-om":"(عمان) العربية ","ar-qa":"(قطر) العربية ","ar-sa":"(السعودية جزيره العرب) العربية","ar-sd":"(السودان) العربية","ar-sy":"(سوريا) العربية","ar-tn":"(تونس) العربية","ar-ye":"(اليمن) العربية",bg:"български","bg-bg":"български (България)",bn:"বাংলা","bn-bd":"বাংলা (বাংলাদেশ)","bn-in":"বাংলা (ভারত)",ca:"català","ca-es":"català (Espanya)",cs:"čeština","cs-cz":"čeština (Česká republika)",da:"dansk","da-dk":"dansk (Danmark)",de:"Deutsch","de-at":"Deutsch (Österreich)","de-be":"Deutsch (Belgien)","de-ch":"Deutsch (Schweiz)","de-de":"Deutsch (Deutschland)","de-li":"Deutsch (Liechtenstein)","de-lu":"Deutsch (Luxemburg)",el:"ελληνικά","el-cy":"ελληνικά (Κύπρος)","el-gr":"ελληνικά (Ελλάδα)",en:"English","en-as":"English (American Samoa)","en-au":"English (Australia)","en-bb":"English (Barbados)","en-be":"English (Belgium)","en-bm":"English (Bermuda)","en-bw":"English (Botswana)","en-bz":"English (Belize)","en-ca":"English (Canada)","en-gb":"English (United Kingdom)","en-gu":"English (Guam)","en-gy":"English (Guyana)","en-hk":"English (Hong Kong SAR China)","en-ie":"English (Ireland)","en-in":"English (India)","en-jm":"English (Jamaica)","en-mh":"English (Marshall Islands)","en-mp":"English (Northern Mariana Islands)","en-mt":"English (Malta)","en-mu":"English (Mauritius)","en-na":"English (Namibia)","en-nz":"English (New Zealand)","en-ph":"English (Philippines)","en-pk":"English (Pakistan)","en-sg":"English (Singapore)","en-tt":"English (Trinidad and Tobago)","en-um":"English (U.S. Minor Outlying Islands)","en-us":"English (United States)","en-vi":"English (U.S. Virgin Islands)","en-za":"English (South Africa)","en-zw":"English (Zimbabwe)",es:"español","es-419":"español (Latinoamérica)","es-ar":"español (Argentina)","es-bo":"español (Bolivia)","es-cl":"español (Chile)","es-co":"español (colombia)","es-cr":"español (Costa Rica)","es-do":"español (República Dominicana)","es-ec":"español (Ecuador)","es-es":"español (España)","es-gq":"española (Guinea Ecuatorial)","es-gt":"español (Guatemala)","es-hn":"español (Honduras)","es-mx":"español (México)","es-ni":"español (Nicaragua)","es-pa":"español (Panamá)","es-pe":"español (Perú)","es-pr":"español (Puerto Rico)","es-py":"español (Paraguay)","es-sv":"español (El Salvador)","es-us":"español (estados unidos)","es-uy":"español (Uruguay)","es-ve":"español (Venezuela)",et:"eesti","et-ee":"eesti (Eesti)",eu:"euskara","eu-es":"euskara (euskara)",fa:"فارسی","fa-af":"(افغانستان) فارسی","fa-ir":"(ایران) فارسی",fi:"suomi","fi-fi":"suomi (Suomi)",fil:"Filipino","fil-ph":"Filipino (Pilipinas)",
fr:"français","fr-be":"français (belgique)","fr-bf":"français (Burkina Faso)","fr-bi":"français (Burundi)","fr-bj":"français (Bénin)","fr-bl":"français (saints Barthélemy)","fr-ca":"français (Canada)","fr-cd":"français (Congo-Kinshasa)","fr-cf":"français (République centrafricaine)","fr-cg":"français (Congo-Brazzaville)","fr-ch":"français (Suisse)","fr-ci":"français (Côte d’Ivoire)","fr-cm":"français (Cameroun)","fr-dj":"français (Djibouti)","fr-fr":"français (France)","fr-ga":"français (Gabon)","fr-gf":"français (Guyane française)","fr-gn":"français (Guinée)","fr-gp":"français (Guadeloupe)","fr-gq":"français (Guinée équatoriale)","fr-km":"français (Comores)","fr-lu":"français (luxembourg)","fr-mc":"français (Monaco)","fr-mf":"français (Saint-Martin)","fr-mg":"français (Madagascar)","fr-ml":"français (Mali)","fr-mq":"français (Martinique)","fr-ne":"français (Niger)","fr-re":"français (Réunion)","fr-yt":"français (Mayotte)",gl:"galego","gl-es":"galego (España)",gsw:"Elsässisch",gu:"ગુજરાતી","gu-in":"ગુજરાતી (ભારત)",he:"עברית","he-il":"(ישראל) עברית",hi:"हिंदी","hi-in":"हिंदी (भारत)",hr:"hrvatski","hr-hr":"hrvatski (Hrvatska)",hu:"magyar","hu-hu":"magyar (Magyarország)",id:"indonesia","id-id":"indonesia (Indonesia)",is:"íslenska","is-is":"íslenska (Ísland)",it:"italiano","it-it":"italiano (svizzera)",ja:"日本の","ja-jp":"日本語（日本）",kn:"ಕನ್ನಡ","kn-in":"ಕನ್ನಡ (ಭಾರತ)",ko:"한국의","ko-kr":"한국어 (한국)",ln:"Lingala","ln-cd":"Lingala (Congo - Kinshasa)",lt:"lietuvių","lt-lt":"lietuvių (Lietuva)",lv:"latviešu","lv-lv":"latviešu (Latvija)",ml:"മലയാളം","ml-in":"മലയാളം (ഭാരതം)",mr:"मराठी","mr-in":"मराठी (भारत)",ms:"Melayu","ms-my":"Melayu (Malaysia)",mt:"Malti","mt-mt":"Malti (Malta)",nl:"nederlands","nl-cw":"nederlands (Curacao)","nl-nl":"nederlands (Nederland)","nl-sx":"nederlands (Sint Maarten)",no:"norsk",or:"ଓଡ଼ିଆ","or-in":"ଓଡ଼ିଆ (ଭାରତ)",pl:"polski","pl-pl":"polski (Polska)",pt:"Português","pt-br":"Português (Brasil)","pt-pt":"português (Portugal)","pt-st":"português (São Tomé and Príncipe)",ro:"română","ro-ro":"română (România)",ru:"русский","ru-ru":"русский (Россия)",sk:"slovenčina","sk-sk":"Slovak (Slovakia)",sl:"slovenski","sl-si":"slovenski (Slovenija)",sq:"shqipe","sq-al":"shqipe (Shqipëria)",sr:"srpski","sr-cyrl-rs":"српски (Србија)","sr-latn-rs":"srpski (Srbija)",sv:"svenska","sv-se":"svenska (Sverige)",sw:"Swahili","sw-tz":"Swahili (Tanzania)",ta:"தமிழ்","ta-in":"தமிழ் (இந்தியா)",te:"తెలుగు","te-in":"తెలుగు (భారత దేశం)",th:"ไทย","th-th":"ไทย (ไทย)",tl:"Tigrinya ",tr:"Türkçe","tr-tr":"Türkçe (Türkiye)",uk:"українська","uk-ua":"українська (Україна)",ur:"اُردو‏","ur-pk":" (پاکستان)‏ اُردو",vi:"Tiếng Việt","vi-vn":"Tiếng Việt (Việt Nam)",zh:"中文","zh-cn":"中文(中华人民共和国)","zh-hans-cn":"中国（简体，中国）","zh-hk":"中文(香港特別行政區)","zh-tw":"中文(台灣)",zu:"isiZulu","zu-za":"isiZulu (iNingizimu Afrika)"},$rootScope[localeKey]={},$rootScope.getLocalizedMessage=function(){var args=Array.prototype.slice.call(arguments),key=$rootScope[localeKey][args.shift()];return Utils.replace(key,args)},{init:init,getDefaultLocale:getDefaultLocale,getSelectedLocale:getSelectedLocale,setSelectedLocale:setSelectedLocale,loadComponentLocaleBundle:loadComponentLocaleBundle,getLocaleCodesMap:getLocaleCodesMap}}]),WM.module("wm.mobile",[]),wm.variables.services.DeviceVariableService=WM.noop,WM.element.holdReady(!0),document.addEventListener("DOMContentLoaded",function(){"use strict";WM.element("#wm-app-content").attr("ng-view",""),WM.element('<i id="wm-mobile-display"></i>').appendTo(".wm-app"),WM.element.holdReady(!1)});var Application=WM.module("Application",["ngRoute","ui.bootstrap","wm.common","wm.variables","wm.plugins.database","wm.plugins.webServices","wm.plugins.security","wm.widgets","wm.layouts","wm.mobile","wm.utils","oc.lazyLoad","wm.prefabs","i18n","angular-gestures"]);Application.constant("CONSTANTS",{isRunMode:!0}).service("PrefabService",WM.noop).config(["$controllerProvider","$httpProvider","$compileProvider","$filterProvider",function($controllerProvider,$httpProvider,$compileProvider,$filterProvider){"use strict";Application.$controller=$controllerProvider.register,Application.$directive=$compileProvider.directive,Application.$filter=$filterProvider.register,$httpProvider.useApplyAsync(!0),$controllerProvider.allowGlobals()}]).service("AppManager",["$q","Utils","BaseService","$location","$rootScope","wmToaster","SecurityService","i18nService","$compile","Variables","$cacheFactory",function($q,Utils,BaseService,$location,$rs,wmToaster,SecurityService,i18nService,$compile,Variables,$cacheFactory){"use strict";function defaultPageLoadSuccessHandler(pageName,response){cache.put(pageName,Utils.parseCombinedPageContent(response.data,pageName)),$rs.activePageName=pageName,prevRoute=$location.path()}function defaultPageLoadErrorHandler(pageName,onSuccess,onError,jqxhr){401!==jqxhr.status||jqxhr.headers("X-WM-Login-ErrorMessage")?403===jqxhr.status&&(wmToaster.show("error",$rs.appLocale.LABEL_ACCESS_DENIED||"Access Denied",$rs.appLocale.LABEL_FORBIDDEN_MESSAGE||"The requested resource access/action is forbidden."),$location.path(prevRoute)):(BaseService.pushToErrorCallStack(null,function(){_load(pageName,onSuccess,onError)},WM.noop),BaseService.handleSessionTimeOut())}function _load(pageName,onSuccess,onError){BaseService.getHttpPromise({method:"GET",url:Utils.preventCachingOf("pages/"+pageName+"/page.min.html")}).then(function(response){defaultPageLoadSuccessHandler(pageName,response),Utils.triggerFn(onSuccess,cache.get(pageName))},function(jqxhr){defaultPageLoadErrorHandler(pageName,onSuccess,onError,jqxhr)})}function loadPage(pageName){var content,deferred=$q.defer();return pageName=pageName.split(".").shift(),content=cache.get(pageName),content?deferred.resolve(content):_load(pageName,deferred.resolve,deferred.reject),deferred.promise}function getPageContent(pageName,type){return(cache.get(pageName)||{})[type]}function loadUserRoles(){var deferred=$q.defer();return SecurityService.isSecurityEnabled(function(isEnabled){$rs.isSecurityEnabled="boolean"==typeof isEnabled?isEnabled:!1,$rs.isSecurityEnabled?SecurityService.getUserRoles(function(roles){var dataset;WM.isArray(roles)&&($rs.userRoles=roles,$rs.Variables&&$rs.Variables.loggedInUser&&(dataset=$rs.Variables.loggedInUser.dataSet,dataset.roles=roles,dataset.isSecurityEnabled=!0)),deferred.resolve()},function(){deferred.resolve()}):deferred.resolve()},function(){$rs.isSecurityEnabled=!1,deferred.resolve()}),deferred.promise}function initI18nService(supportedLocale,defaultLocale){var _sl=supportedLocale,_dl=defaultLocale||"en";_sl=_sl||[_dl],i18nService.init(_sl,_dl,APP_LOCALE_PATH,NG_LOCALE_PATH),i18nService.setSelectedLocale(_dl)}function loadCommonPage($s){var pageName="Common";return loadPage(pageName).then(function(content){Variables.setPageVariables(pageName,content.variables);var $html=WM.element(Utils.processMarkup(content.html));WM.element("#wm-common-content").append($html),$compile($html)($s)})}function initAppVariables($s){var deferred=$q.defer();return Variables.initAppVariables($s,deferred.resolve,deferred.reject),deferred.promise}function updateLoggedInUser(checkVariable){var loggedInUser=$rs.Variables&&$rs.Variables.loggedInUser;(!checkVariable||loggedInUser)&&SecurityService.isAuthenticated(function(isAuthenticated){$rs.isUserAuthenticated="boolean"==typeof isAuthenticated?isAuthenticated:!1,$rs.isUserAuthenticated&&loggedInUser?(loggedInUser.dataSet.isAuthenticated=$rs.isUserAuthenticated,loggedInUser.dataSet.roles=$rs.userRoles,SecurityService.getUserName(function(name){loggedInUser.dataSet.name=name}),SecurityService.getUserId(function(id){loggedInUser.dataSet.id=id}),SecurityService.getTenantId(function(tenantId){loggedInUser.dataSet.tenantId=tenantId})):loggedInUser&&(loggedInUser.dataSet.isAuthenticated=!1,loggedInUser.dataSet.roles=[],loggedInUser.dataSet.name="",loggedInUser.dataSet.id="",loggedInUser.dataSet.tenantId="")})}function getPreparedPageContent(pageName){var content=cache.get(pageName).html,$content=content||"";return $content=WM.element(Utils.processMarkup(content)),$rs.isPrefabType&&($rs.prefabTemplate=$content,$rs.isPrefabTemplate=!0,$content=WM.element("<wm-prefab-run></wm-prefab-run>")),$content}function clearPagesCache(){cache.destroy(),cache=$cacheFactory("APP_PAGES")}var prevRoute,cache=$cacheFactory("APP_PAGES"),NG_LOCALE_PATH="resources/ngLocale/",APP_LOCALE_PATH="resources/i18n/";$rs.$on("app-logout-success",clearPagesCache),this.loadPage=loadPage,this.loadUserRoles=loadUserRoles,this.getPageContent=getPageContent,this.loadCommonPage=loadCommonPage,this.initI18nService=initI18nService,this.initAppVariables=initAppVariables,this.updateLoggedInUser=updateLoggedInUser,this.getPreparedPageContent=getPreparedPageContent}]).config(["$routeProvider",function($routeProvider){"use strict";function isLoginPage(){return"login.html"===window.location.pathname.split("/").pop()}var routeConfig={template:"<div>Loading Page Content...</div>",resolve:{pageContent:function(AppManager,$route){var pageName=$route.current.params.name;return AppManager.loadPage(pageName)}}},route="/:name";isLoginPage()?$routeProvider.when("/:name",routeConfig).otherwise({redirectTo:"Login"}):(WM.extend(routeConfig.resolve,{userRoles:function(AppManager){return AppManager.loadUserRoles()}}),$routeProvider.when(route,routeConfig).when("/Common",{redirectTo:"Main"}).otherwise({redirectTo:"Main"}),_.range(1,7).forEach(function(idx){route=route+"/:param"+idx,$routeProvider.when(route,routeConfig)}))}]).controller("AppController",["$scope","$rootScope","ProjectService","i18nService","Utils","AppManager","SecurityService","Variables","CONSTANTS","BasicVariableService","$servicevariable","$liveVariable","NavigationVariableService","NotificationVariableService","LoginVariableService","LogoutVariableService","TimerVariableService",function($s,$rs,ProjectService,i18nService,Utils,AppManager,SecurityService,Variables,CONSTANTS){"use strict";var pageReadyDeregister,projectID=ProjectService.getId(),appProperties=WM.copy(_WM_APP_PROPERTIES);$rs.isPrefabType="PREFAB"===appProperties.type,$rs.isApplicationType="APPLICATION"===appProperties.type,$rs.isTemplateBundleType="TEMPLATEBUNDLE"===appProperties.type,$rs.$on("$routeChangeSuccess",function(evt,$route){var pageVars,supportedLocale,pageName=$route.params.name;pageName&&(pageName=pageName.split(".").shift(),$route.locals.$template=AppManager.getPreparedPageContent(pageName),pageVars=AppManager.getPageContent(pageName,"variables"),Variables.setPageVariables(pageName,pageVars),$rs.isPrefabType&&(supportedLocale=Utils.findValueOf(pageVars,"supportedLocale.dataSet"),AppManager.initI18nService(_.keys(supportedLocale),appProperties.defaultLanguage)))}),$rs.project={id:projectID,activeTheme:appProperties.activeTheme,deployedUrl:ProjectService.getDeployedUrl()},$rs.changeLocale=function($is){i18nService.setSelectedLocale($is.datavalue)},$rs.isPrefabType&&Utils.fetchContent("json",Utils.preventCachingOf("./config.json"),function(response){response.error||($rs.prefabConfig=response)},WM.noop,!0),$rs.isApplicationType&&"login.html"!==Utils.getCurrentPage()&&AppManager.loadCommonPage($s).then(function(){return AppManager.initAppVariables($s)}).then(function(appVariables){var supportedLocale=(appVariables.supportedLocale||{}).dataSet;AppManager.initI18nService(_.keys(supportedLocale),appProperties.defaultLanguage),AppManager.updateLoggedInUser()}),$rs.$on("update-loggedin-user",function(){SecurityService.setLoggedInUser(null),AppManager.updateLoggedInUser(!0)}),$rs.$on("invoke-service",function(event,name,options,onSuccess,onError){if(-1===name.indexOf("(")){var variable;if(variable=options&&options.scope&&options.scope.Variables&&options.scope.Variables[name]?options.scope.Variables[name]:Variables.getVariableByName(name))switch(variable.category){case"wm.LiveVariable":"read"===variable.operation?variable.update(options,onSuccess,onError):variable[variable.operation+"Record"](options,onSuccess,onError);break;case"wm.ServiceVariable":variable.update(options,onSuccess,onError);break;case"wm.NavigationVariable":variable.navigate(options,onSuccess,onError);break;case"wm.NotificationVariable":variable.notify(options,onSuccess,onError);break;case"wm.LoginVariable":variable.login(options,onSuccess,onError);break;case"wm.LogoutVariable":variable.logout(options,onSuccess,onError);break;case"wm.TimerVariable":variable.fire(options,onSuccess,onError);break;case"wm.DeviceVariable":variable.invoke(options,onSuccess,onError)}}}),CONSTANTS.hasCordova&&(pageReadyDeregister=$rs.$on("page-ready",function(){navigator.splashscreen.hide(),pageReadyDeregister()})),$rs.$emit("application-ready")}]);